import{r as p,c as r,o as d,d as t,y as w,z as i,H as k,e as h,A as c,F as D,m as C,b as M,f as V,a as B,I as S,n as T,t as j}from"./vendor-D9AtPSqO.js";const z={class:"fixed inset-0 z-50 overflow-y-auto"},I={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},L={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},N={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},K={class:"sm:flex sm:items-start"},U={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},A={class:"mt-4"},F={class:"space-y-4"},E={class:"flex space-x-4"},R=["value"],$={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},q=["disabled"],H={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},G={__name:"AddDamageModal",props:{inspectionId:Number,currentMenuId:Number},emits:["close","damage-added"],setup(b,{emit:g}){const m=b,f=g,o=p({type:"",location:"",severity:"low",description:"",images:[]}),l=p(!1),v=[{value:"low",label:"Rendah"},{value:"medium",label:"Sedang"},{value:"high",label:"Tinggi"},{value:"critical",label:"Kritis"}],x=s=>({low:"text-green-600",medium:"text-yellow-600",high:"text-orange-600",critical:"text-red-600"})[s]||"text-gray-600",y=s=>{o.value.images=Array.from(s.target.files)},u=async()=>{l.value=!0;try{const s=new FormData;s.append("inspection_id",m.inspectionId),s.append("menu_id",m.currentMenuId),s.append("type",o.value.type),s.append("location",o.value.location),s.append("severity",o.value.severity),s.append("description",o.value.description),o.value.images.forEach((a,n)=>{s.append(`images[${n}]`,a)});const e=await B.post("/api/form-inspection/damage",s,{headers:{"Content-Type":"multipart/form-data"}});e.data.success&&f("damage-added",e.data.damage)}catch(s){console.error("Error adding damage:",s),alert("Gagal menambahkan damage")}finally{l.value=!1}};return(s,e)=>(d(),r("div",z,[t("div",I,[e[16]||(e[16]=t("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[t("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),t("div",L,[t("div",N,[t("div",K,[e[13]||(e[13]=t("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 sm:mx-0 sm:h-10 sm:w-10"},[t("svg",{class:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.998-.833-2.732 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),t("div",U,[e[12]||(e[12]=t("h3",{class:"text-lg leading-6 font-medium text-gray-900"}," Tambah Damage ",-1)),t("div",A,[t("form",{onSubmit:w(u,["prevent"])},[t("div",F,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Jenis Damage ",-1)),i(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.type=a),required:"",class:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md"},e[5]||(e[5]=[h('<option value="" disabled>Pilih jenis damage</option><option value="crack">Retak</option><option value="corrosion">Korosi</option><option value="leak">Kebocoran</option><option value="wear">Keausan</option><option value="other">Lainnya</option>',6)]),512),[[k,o.value.type]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Lokasi ",-1)),i(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.location=a),type:"text",required:"",placeholder:"Contoh: Pipa inlet, bagian atas",class:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,512),[[c,o.value.location]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Tingkat Keparahan ",-1)),t("div",E,[(d(),r(D,null,C(v,a=>t("label",{key:a.value,class:"inline-flex items-center"},[i(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.severity=n),type:"radio",value:a.value,class:"focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300"},null,8,R),[[S,o.value.severity]]),t("span",{class:T(["ml-2 text-sm",x(a.value)])},j(a.label),3)])),64))])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Deskripsi ",-1)),i(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.description=a),rows:"3",placeholder:"Deskripsikan damage secara detail...",class:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,512),[[c,o.value.description]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Foto Damage ",-1)),t("input",{type:"file",onChange:y,accept:"image/*",multiple:"",class:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md"},null,32),e[11]||(e[11]=t("p",{class:"mt-1 text-xs text-gray-500"}," Upload foto untuk dokumentasi (maks. 5MB per file) ",-1))])])],32)])])])]),t("div",$,[t("button",{onClick:u,disabled:l.value,type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-yellow-600 text-base font-medium text-white hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[l.value?(d(),r("svg",H,e[14]||(e[14]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):M("",!0),e[15]||(e[15]=V(" Tambah Damage "))],8,q),t("button",{onClick:e[4]||(e[4]=a=>s.$emit("close")),type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Batal ")])])])]))}};export{G as default};
