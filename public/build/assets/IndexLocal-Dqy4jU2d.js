import{x as oa,r as y,g as st,q as te,H as wt,G as xe,c as i,o as n,d as e,b as d,k as Te,z as Le,A as dt,n as re,t as q,F as Ne,m as Pe,f as Ue,u as ee,e as ia,y as ct,w as Fe,L as qe,D as Pt,M as Lt,j as De,a as jt,l as aa,T as gt,N as Dt,p as xa,O as sa,J as at,B as wa,S as ka,I as Bt,W as Ut}from"./vendor-CUNG9NG6.js";import{l as la}from"./lodash-CeUj5J-L.js";import{_ as Ia}from"./PrimaryButton-h2qnLbgr.js";import{_ as _a}from"./ActionMessage-C19FCsLq.js";import{F as Sa}from"./fuse-Ch1WBRTM.js";import{_ as Ke}from"./app-BEb0DUDJ.js";import{_ as ra}from"./InputNumber-BM446ncS.js";const Ca={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},$a={key:0,class:"p-4 space-y-2"},Aa={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Va={class:"flex items-center space-x-2"},Ta={key:0,class:"text-xs text-red-500 font-normal ml-2"},Ma={key:1,class:"text-xs text-red-500 font-normal ml-2"},Ea={key:2,class:"text-xs text-green-500 font-normal ml-2"},Na={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Ua={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},Da={class:"col-span-2 flex space-x-3"},Pa={class:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},La={class:"flex items-start"},Ra={class:"text-sm text-blue-700"},ja={class:"mt-1"},Ba={key:0,class:"inline-flex items-center px-2 py-1 rounded bg-blue-100 text-blue-800 text-xs font-medium mr-2"},Fa={key:1,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium mr-2"},Oa={key:2,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium"},za={key:3,class:"text-blue-600"},qa={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Ka={class:"relative"},Ha={key:0,class:"absolute right-3 top-3"},Ga={key:1,class:"mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},Wa={key:0},Ya=["onMousedown"],Za={class:"font-medium text-gray-900"},Ja={class:"text-sm text-gray-500"},Xa={key:1,class:"p-4 text-sm text-gray-500 text-center"},Qa={key:0,class:"text-xs text-red-500 font-normal ml-2"},es={key:0,class:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},ts={key:1,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},as={key:0,class:"mb-4"},ss=["innerHTML"],ns={key:1},os={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},is=["onClick"],ls=["src","alt"],rs={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},us={class:"text-white text-xs text-center"},ds={key:2,class:"text-center py-4 text-gray-500 text-sm"},cs={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},gs=["src","alt"],ps={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},ms={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},vs={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},fs={__name:"VehicleDetails",props:{inspection:{type:Object,default:null},CarDetail:Array,allInspections:{type:Array,default:()=>[]}},emits:["update-vehicle","update:validation","update:hasUnsavedChanges","update:vehicle-type"],setup(a,{emit:ae}){var u,P,L,he,me,fe;const t=a,C=ae,c=oa({plate_number:((u=t.inspection)==null?void 0:u.plate_number)||"",car_id:((P=t.inspection)==null?void 0:P.car_id)||null,car_name:((L=t.inspection)==null?void 0:L.car_name)||""}),$=y(((he=t.inspection)==null?void 0:he.plate_number)||""),h=y(((me=t.inspection)==null?void 0:me.car_id)||null),S=y(((fe=t.inspection)==null?void 0:fe.car_name)||""),I=y(""),j=y(""),w=y(""),D=y(null),M=y({rear_door:!1}),Q=y(!1),v=y(""),g=y(""),T=y(c.car_name),K=y(!1),E=y(!1),G=y([]),Z=y(null),O=y([]),k=y(!1),B=y(0);st(()=>{var p,m,ne,A,oe;if(z((p=t.inspection)==null?void 0:p.plate_number),(m=t.inspection)!=null&&m.car_id&&((ne=t.CarDetail)==null?void 0:ne.length)>0){const Ae=t.CarDetail.find(Ve=>Ve.id===t.inspection.car_id);Ae&&pe(Ae)}else!((A=t.inspection)!=null&&A.car_id)&&((oe=t.inspection)!=null&&oe.car_name)&&(T.value=t.inspection.car_name,c.car_id=null);window.addEventListener("keydown",Ee),de(),C("update:hasUnsavedChanges",N.value),C("update:validation",U.value)}),wt(()=>{window.removeEventListener("keydown",Ee)});const de=()=>{try{const p=localStorage.getItem("vehicle_features");if(p){const m=JSON.parse(p);M.value.rear_door=m.rear_door||!1,m.pick_up?D.value="pick_up":m.box?D.value="box":D.value=null}else M.value.rear_door=!1,D.value=null;x()}catch(p){console.error("Error loading vehicle type from localStorage:",p),M.value.rear_door=!1,D.value=null,x()}},_=()=>{M.value.rear_door=!M.value.rear_door,s()},f=p=>{D.value===p?D.value=null:D.value=p,s()},s=()=>{try{const p={rear_door:M.value.rear_door,pick_up:D.value==="pick_up",box:D.value==="box"};localStorage.setItem("vehicle_features",JSON.stringify(p)),x(),console.log("Vehicle features saved to localStorage:",p)}catch(p){console.error("Error saving vehicle type to localStorage:",p)}},x=()=>{const p={rear_door:M.value.rear_door,pick_up:D.value==="pick_up",box:D.value==="box"};C("update:vehicle-type",p)},z=p=>{if(!p){I.value="",j.value="",w.value="";return}const m=p.toUpperCase().trim(),ne=m.match(/^([A-Z]{1,2})?([0-9]{1,4})?([A-Z]{1,3})?$/);if(ne)I.value=ne[1]||"",j.value=ne[2]||"",w.value=ne[3]||"";else{let A="area",oe="",Ae="",Ve="";for(const _e of m)A==="area"&&/[A-Z]/.test(_e)?oe+=_e:A==="area"&&/[0-9]/.test(_e)?(A="number",Ae+=_e):A==="number"&&/[0-9]/.test(_e)?Ae+=_e:A==="number"&&/[A-Z]/.test(_e)?(A="suffix",Ve+=_e):A==="suffix"&&/[A-Z]/.test(_e)&&(Ve+=_e);I.value=oe,j.value=Ae,w.value=Ve}ue()},ue=()=>{const p=`${I.value}${j.value}${w.value}`;c.plate_number=p,l()},Y=p=>{p==="area"?I.value=I.value.toUpperCase().replace(/[^A-Z]/g,""):p==="number"?j.value=j.value.replace(/[^0-9]/g,""):p==="suffix"&&(w.value=w.value.toUpperCase().replace(/[^A-Z]/g,"")),ue()},W=te(()=>{const p=c.plate_number;return/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test(p)}),ie=te(()=>!T.value||T.value.trim()===""),ge=te(()=>c.plate_number.length>0&&!W.value?"Format plat nomor tidak valid.":null),U=te(()=>{const p=!c.plate_number||c.plate_number.trim()==="",m=!T.value||T.value.trim()==="";return p||m||!W.value||Q.value}),N=te(()=>{const p=c.plate_number!==$.value,m=c.car_id!==h.value||T.value!==S.value;return p||m}),R=te(()=>N.value&&!U.value),H=p=>{var ne,A,oe;if(!p)return"";const m=[];return(ne=p.brand)!=null&&ne.name&&m.push(p.brand.name),(A=p.model)!=null&&A.name&&m.push(p.model.name),(oe=p.type)!=null&&oe.name&&m.push(p.type.name),p.cc&&m.push((p.cc/1e3).toFixed(1)),p.transmission&&m.push(p.transmission),p.year&&m.push(p.year.toString()),p.fuel_type&&m.push(p.fuel_type),p.production_period&&m.push(`(${p.production_period})`),m.join(" ")},X=la.debounce(()=>{if(!T.value.trim()){G.value=[],K.value=!1;return}E.value=!0;try{const p=T.value.trim();if(t.CarDetail&&t.CarDetail.length>0){const m=t.CarDetail.map(oe=>({...oe,formattedName:H(oe)})),A=new Sa(m,{keys:["formattedName","brand.name","model.name","type.name"],threshold:.6,findAllMatches:!0,includeScore:!0,shouldSort:!0}).search(p).slice(0,10);G.value=A.map(oe=>oe.item)}else G.value=[];K.value=!0}finally{E.value=!1}},300),se=()=>{if(c.car_id&&(c.car_id=null,Z.value=null,O.value=[]),!T.value.trim()){G.value=[],K.value=!1;return}X()},ve=()=>{setTimeout(()=>{K.value=!1,!c.car_id&&T.value&&(c.car_name=T.value,l())},200)},pe=async p=>{Z.value=p,T.value=H(p),c.car_id=p.id,c.car_name=H(p),K.value=!1,X.cancel(),await Ie(p.id),l(),C("update:hasUnsavedChanges",N.value),C("update:validation",U.value)},Me=p=>!p||!p.file_path?"":`/storage/${p.file_path}`,Ie=async p=>{try{const m=await fetch(`/api/cars/${p}/images`);if(m.ok){const ne=await m.json();O.value=Array.isArray(ne)?ne:[]}else O.value=[]}catch(m){console.error("Error loading car images:",m),O.value=[]}},be=p=>{B.value=p,k.value=!0,document.body.style.overflow="hidden"},Ce=()=>{k.value=!1,document.body.style.overflow=""},$e=()=>{B.value=(B.value+1)%O.value.length},ke=()=>{B.value=(B.value-1+O.value.length)%O.value.length},Ee=p=>{if(k.value)switch(p.key){case"Escape":Ce();break;case"ArrowRight":$e();break;case"ArrowLeft":ke();break}},l=()=>{const p={plate_number:c.plate_number,car_id:c.car_id,car_name:c.car_name};C("update-vehicle",p)},b=()=>{t.inspection&&c.post(route("inspections.updateVehicleDetails",{inspection:t.inspection.id}),{preserveScroll:!0,onSuccess:()=>{$.value=c.plate_number,h.value=c.car_id,S.value=c.car_name,C("update:hasUnsavedChanges",!1),console.log("Data berhasil disimpan!")},onError:p=>{console.error("Gagal menyimpan data:",p)}})};return xe([()=>c.plate_number,()=>c.car_name],p=>{v.value="",Q.value=!1,g.value="";const m=p[0];if(m&&m.length>=6){const ne=t.allInspections.filter(A=>{var oe;return A.plate_number===m&&A.id!==((oe=t.inspection)==null?void 0:oe.id)});if(ne.length>0){const A=["draft","in_progress","pending","pending_review","revision"],oe=ne.find(Ae=>A.includes(Ae.status));if(oe)Q.value=!0,v.value=`Nomor plat ini sedang dalam proses inspeksi dengan status: ${oe.status.replace(/_/g," ").toUpperCase()}.`;else{const Ae=ne.filter(Ve=>["approved","rejected","completed","cancelled"].includes(Ve.status));if(Ae.length>0){Ae.sort((_e,He)=>new Date(He.created_at)-new Date(_e.created_at));const Ve=Ae[0];if(Ve.car_id){const _e=t.CarDetail.find(He=>He.id===Ve.car_id);_e&&pe(_e)}else Ve.car_name&&(T.value=Ve.car_name,c.car_name=Ve.car_name,c.car_id=null);g.value=`Nomor plat ini sudah pernah diperiksa ${Ae.length} kali sebelumnya.`}}}}C("update:hasUnsavedChanges",N.value),C("update:validation",U.value)},{deep:!0}),xe([()=>M.value.rear_door,()=>D.value],()=>{s()}),xe(()=>{var p;return(p=t.inspection)==null?void 0:p.car_id},p=>{var m,ne;if(p!==c.car_id)if(c.car_id=p,p&&((m=t.CarDetail)==null?void 0:m.length)>0){const A=t.CarDetail.find(oe=>oe.id===p);A&&pe(A)}else!p&&((ne=t.inspection)!=null&&ne.car_name)&&(T.value=t.inspection.car_name,c.car_name=t.inspection.car_name,c.car_id=null)}),xe(()=>{var p;return(p=t.inspection)==null?void 0:p.car_name},p=>{p&&p!==T.value&&(T.value=p)}),(p,m)=>{var ne;return n(),i("div",Ca,[m[27]||(m[27]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),a.inspection?(n(),i("div",$a,[e("div",Aa,[m[11]||(m[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nomor Plat Kendaraan ",-1)),e("div",Va,[Le(e("input",{"onUpdate:modelValue":m[0]||(m[0]=A=>I.value=A),type:"text",placeholder:"Contoh: B",class:re(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!W.value||Q.value}]),onInput:m[1]||(m[1]=A=>Y("area")),maxlength:"2"},null,34),[[dt,I.value]]),Le(e("input",{"onUpdate:modelValue":m[2]||(m[2]=A=>j.value=A),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:re(["w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!W.value||Q.value}]),onInput:m[3]||(m[3]=A=>Y("number")),maxlength:"4"},null,34),[[dt,j.value]]),Le(e("input",{"onUpdate:modelValue":m[4]||(m[4]=A=>w.value=A),type:"text",placeholder:"ABC",class:re(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!W.value||Q.value}]),onInput:m[5]||(m[5]=A=>Y("suffix")),maxlength:"3"},null,34),[[dt,w.value]])]),ge.value?(n(),i("span",Ta,q(ge.value),1)):d("",!0),v.value?(n(),i("span",Ma,q(v.value),1)):d("",!0),g.value?(n(),i("span",Ea,q(g.value),1)):d("",!0)]),e("div",Na,[m[15]||(m[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Jenis Kendaraan ",-1)),e("div",Ua,[e("div",{class:re(["w-full px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":M.value.rear_door,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":!M.value.rear_door}]),onClick:_},m[12]||(m[12]=[e("span",null,"Pintu Belakang",-1)]),2),e("div",Da,[e("div",{class:re(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":D.value==="pick_up","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":D.value!=="pick_up"}]),onClick:m[6]||(m[6]=A=>f("pick_up"))}," Pick Up ",2),e("div",{class:re(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":D.value==="box","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":D.value!=="box"}]),onClick:m[7]||(m[7]=A=>f("box"))}," Box ",2)])]),e("div",Pa,[e("div",La,[m[14]||(m[14]=e("svg",{class:"w-4 h-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),e("div",Ra,[m[13]||(m[13]=e("p",{class:"font-medium"},"Status Kendaraan:",-1)),e("p",ja,[M.value.rear_door?(n(),i("span",Ba," ✓ Mobil Pada Umum nya yang memiliki Pintu Belakang ")):d("",!0),D.value==="pick_up"?(n(),i("span",Fa," ✓ Pick Up ")):d("",!0),D.value==="box"?(n(),i("span",Oa," ✓ Box ")):d("",!0),!M.value.rear_door&&!D.value?(n(),i("span",za," Pilih jenis kendaraan agar point bisa menyesuaikan dengan tipe kendaraan anda ")):d("",!0)])])])])]),e("div",qa,[m[18]||(m[18]=e("label",{class:"block text-sm font-medium text-gray-700"}," Nama Mobil ",-1)),e("div",Ka,[Le(e("input",{"onUpdate:modelValue":m[8]||(m[8]=A=>T.value=A),type:"text",placeholder:"Cari atau ketik nama mobil...",class:re(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{"border-red-500 focus:border-red-500":ie.value}]),onInput:se,onFocus:m[9]||(m[9]=A=>K.value=!0),onBlur:ve},null,34),[[dt,T.value]]),E.value?(n(),i("div",Ha,m[16]||(m[16]=[e("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):d("",!0),K.value?(n(),i("div",Ga,[G.value.length>0?(n(),i("div",Wa,[(n(!0),i(Ne,null,Pe(G.value,A=>(n(),i("div",{key:A.id,class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:oe=>pe(A)},[e("div",Za,q(H(A)),1),e("div",Ja,q(A.year)+" • "+q(A.cc)+"cc • "+q(A.transmission)+" • "+q(A.fuel_type),1)],40,Ya))),128))])):(n(),i("div",Xa,m[17]||(m[17]=[Ue(" Tidak ada data mobil yang cocok. "),e("br",null,null,-1),Ue(" Silakan input manual dengan format: "),e("br",null,null,-1),e("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):d("",!0)]),ie.value?(n(),i("span",Qa,"Nama mobil tidak boleh kosong.")):d("",!0)]),!ee(c).car_id&&T.value&&!K.value?(n(),i("div",es,m[19]||(m[19]=[ia('<div class="flex items-start" data-v-f5fe3b58><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-600 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-f5fe3b58><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-f5fe3b58></path></svg><div data-v-f5fe3b58><p class="text-yellow-800 font-medium mb-1" data-v-f5fe3b58>Informasi Penting</p><p class="text-yellow-700 text-sm mb-2" data-v-f5fe3b58> Anda memasukkan nama mobil secara manual. Data detail mobil (spesifikasi, gambar, deskripsi) <span class="font-semibold" data-v-f5fe3b58>tidak akan tersedia</span> dalam laporan inspeksi. </p><p class="text-yellow-700 text-sm mb-2" data-v-f5fe3b58> Untuk laporan yang lengkap dengan semua detail mobil, silakan pilih mobil dari hasil pencarian. </p><p class="text-yellow-700 text-sm" data-v-f5fe3b58> Jika tidak ingin mengubah data mobil dan anda tidak sengaja sudah menghapus atau edit, <span class="font-semibold" data-v-f5fe3b58>jangan klik tombol &quot;Perbarui Detail Kendaraan&quot;</span>. Sebagai gantinya, <span class="font-semibold" data-v-f5fe3b58>refresh halaman</span> untuk kembali ke data awal. </p></div></div>',1)]))):d("",!0),ee(c).car_id&&Z.value?(n(),i("div",ts,[Z.value.description?(n(),i("div",as,[m[20]||(m[20]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),e("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:Z.value.description},null,8,ss)])):d("",!0),O.value.length>0?(n(),i("div",ns,[m[21]||(m[21]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),e("div",os,[(n(!0),i(Ne,null,Pe(O.value,(A,oe)=>(n(),i("div",{key:A.id||oe,class:"relative group cursor-pointer",onClick:Ae=>be(oe)},[e("img",{src:Me(A),alt:A.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,ls),A.note?(n(),i("div",rs,[e("p",us,q(A.note),1)])):d("",!0)],8,is))),128))])])):(n(),i("div",ds," Tidak ada gambar tersedia untuk mobil ini "))])):d("",!0),k.value?(n(),i("div",{key:2,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:Ce},[e("div",cs,[e("button",{onClick:Ce,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},m[22]||(m[22]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),O.value.length>1?(n(),i("button",{key:0,onClick:ct(ke,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},m[23]||(m[23]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):d("",!0),O.value.length>1?(n(),i("button",{key:1,onClick:ct($e,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},m[24]||(m[24]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):d("",!0),e("img",{src:Me(O.value[B.value]),alt:"Car Image "+(B.value+1),class:"max-w-full max-h-full object-contain",onClick:m[10]||(m[10]=ct(()=>{},["stop"]))},null,8,gs),O.value.length>1?(n(),i("div",ps,q(B.value+1)+" / "+q(O.value.length),1)):d("",!0),(ne=O.value[B.value])!=null&&ne.note?(n(),i("div",ms,q(O.value[B.value].note),1)):d("",!0)])])):d("",!0),Te(Ia,{type:"button",onClick:b,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed",disabled:!R.value},{default:Fe(()=>[ee(c).processing?(n(),i("svg",vs,m[25]||(m[25]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):d("",!0),e("span",null,q(ee(c).processing?"Mengirim...":"Perbarui Detail Kendaraan"),1),Te(_a,{on:ee(c).recentlySuccessful,class:"me-3 text-sm text-green-600 font-medium"},{default:Fe(()=>m[26]||(m[26]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),Ue(" Tersimpan. ")])),_:1,__:[26]},8,["on"])]),_:1},8,["disabled"])])):d("",!0)])}}},hs=Ke(fs,[["__scopeId","data-v-f5fe3b58"]]),bs={class:"mt-1"},ys=["value","required","minlength","maxlength","allowSpace","placeholder"],xs={key:0,class:"mt-2 text-sm text-red-600"},ua={__name:"InputText",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],pattern:String,placeholder:String,error:String,pointId:[String,Number],textTransform:{type:String,default:"none"},allowSpace:{type:Boolean,default:!0}},emits:["update:modelValue","save"],setup(a,{emit:ae}){const t=a,C=ae,c=te(()=>{if(!t.modelValue)return"";let h=t.modelValue;switch(t.allowSpace||(h=h.replace(/\s+/g,"")),t.textTransform){case"uppercase":return h.toUpperCase();case"lowercase":return h.toLowerCase();case"capitalize":return h.replace(/\b\w/g,S=>S.toUpperCase());default:return h}}),$=h=>{let S=h.target.value;switch(t.allowSpace||(S=S.replace(/\s+/g,"")),t.textTransform){case"uppercase":S=S.toUpperCase();break;case"lowercase":S=S.toLowerCase();break;case"capitalize":S=S.replace(/\b\w/g,I=>I.toUpperCase());break}C("update:modelValue",S),C("save",t.pointId)};return(h,S)=>(n(),i("div",bs,[e("input",{value:c.value,onInput:$,type:"text",required:a.required,minlength:a.minLength,maxlength:a.maxLength,allowSpace:a.allowSpace,placeholder:a.placeholder,class:re(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{uppercase:a.textTransform==="uppercase",lowercase:a.textTransform==="lowercase",capitalize:a.textTransform==="capitalize"}])},null,42,ys),a.error?(n(),i("p",xs,q(a.error),1)):d("",!0)]))}},ws={class:"mt-1"},ks=["value","required","min","max"],Is={key:0,class:"mt-2 text-sm text-red-600"},da={__name:"InputDate",props:{modelValue:String,required:Boolean,minDate:String,maxDate:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(a,{emit:ae}){const t=a,C=ae,c=$=>{C("update:modelValue",$.target.value),C("save",t.pointId)};return($,h)=>(n(),i("div",ws,[e("input",{value:a.modelValue,onChange:c,type:"date",required:a.required,min:a.minDate,max:a.maxDate,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,ks),a.error?(n(),i("p",Is,q(a.error),1)):d("",!0)]))}},_s={class:"mt-1"},Ss=["value","required","placeholder"],Cs={key:0,class:"mt-2 text-sm text-red-600"},ca={__name:"InputAccount",props:{modelValue:[String,Number],required:Boolean,placeholder:String,error:String,pointId:[String,Number],settings:{type:Object,default:()=>({currency_symbol:"Rp",thousands_separator:",",min_value:0,max_value:1e9})}},emits:["update:modelValue","save"],setup(a,{emit:ae}){const t=a,C=ae,c=y(""),$=te(()=>{var w,D,M,Q;return{currency_symbol:((w=t.settings)==null?void 0:w.currency_symbol)||"Rp",thousands_separator:((D=t.settings)==null?void 0:D.thousands_separator)||",",min_value:((M=t.settings)==null?void 0:M.min_value)!==void 0?Number(t.settings.min_value):0,max_value:((Q=t.settings)==null?void 0:Q.max_value)!==void 0?Number(t.settings.max_value):1e9}}),h=w=>{if(w==null||w==="")return"";const D=Number(w);if(isNaN(D))return"";let M=D.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return $.value.thousands_separator!==","&&(M=M.replace(/,/g,$.value.thousands_separator)),M},S=w=>w?w.replace(/[^\d]/g,""):"",I=te(()=>c.value?`${$.value.currency_symbol} ${h(c.value)}`:""),j=w=>{let D=S(w.target.value),M=Number(D);$.value.min_value!==void 0&&M<$.value.min_value&&(D=$.value.min_value.toString()),$.value.max_value!==void 0&&M>$.value.max_value&&(D=$.value.max_value.toString()),c.value=D,C("update:modelValue",D),C("save",t.pointId)};return xe(()=>t.modelValue,w=>{w!=null&&(c.value=w.toString())},{immediate:!0}),(w,D)=>(n(),i("div",_s,[e("input",{value:I.value,onInput:j,type:"text",required:a.required,placeholder:a.placeholder,class:re(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",a.error?"border-red-300":"border-gray-300"])},null,42,Ss),a.error?(n(),i("p",Cs,q(a.error),1)):d("",!0)]))}},$s={class:"mt-1 space-y-3"},As={key:0,class:"space-y-2"},Vs={class:"flex flex-wrap gap-2"},Ts=["onClick"],Ms=["value","required","minlength","maxlength","placeholder"],Es={class:"flex justify-between items-center mt-1"},Ns={class:"text-xs text-gray-500"},Us={key:0,class:"text-xs text-red-600"},ga={__name:"InputTextarea",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],placeholder:String,error:String,pointId:[String,Number],inspectionId:[String,Number],settings:Object},emits:["update:modelValue","save"],setup(a,{emit:ae}){const t=a,C=ae,c=y([]),$=y(""),h=w=>c.value.some(D=>D.value===w),S=w=>{h(w.value)?c.value=c.value.filter(v=>v.value!==w.value):c.value.push(w);const M=[...c.value.map(v=>v.value)];$.value.trim()&&M.push($.value.trim());const Q=M.join(", ");C("update:modelValue",Q),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,notes:Q})},I=w=>{const D=w.target.value;C("update:modelValue",D),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,notes:D}),j(D)},j=w=>{var v,g,T,K;if(!w){c.value=[],$.value="";return}const D=w.split(",").map(E=>E.trim()).filter(E=>E),M=((g=(v=t.settings)==null?void 0:v.damage_options)==null?void 0:g.map(E=>E.value))||[];c.value=((K=(T=t.settings)==null?void 0:T.damage_options)==null?void 0:K.filter(E=>D.includes(E.value)))||[];const Q=D.filter(E=>!M.includes(E));$.value=Q.join(", ")};return xe(()=>t.modelValue,w=>{w!=null&&j(w)},{immediate:!0}),xe(()=>{var w;return(w=t.settings)==null?void 0:w.damage_options},(w,D)=>{if(w!==D){const M=w?w.map(T=>T.value):[];c.value=c.value.filter(T=>M.includes(T.value));const v=[...c.value.map(T=>T.value)];$.value.trim()&&v.push($.value.trim());const g=v.filter(T=>T).join(", ");C("update:modelValue",g),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,notes:g})}},{deep:!0,immediate:!1}),(w,D)=>{var M,Q,v;return n(),i("div",$s,[(M=a.settings)!=null&&M.enable_damage&&((Q=a.settings)!=null&&Q.damage_options)?(n(),i("div",As,[D[0]||(D[0]=e("h4",{class:"text-sm font-medium text-gray-700"},"Pilih Kerusakan:",-1)),e("div",Vs,[(n(!0),i(Ne,null,Pe(a.settings.damage_options,(g,T)=>(n(),i("button",{key:T,type:"button",onClick:K=>S(g),class:re(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors border",{"border-indigo-500 bg-indigo-100 text-indigo-700":h(g.value),"border-gray-300 bg-white text-gray-700 hover:bg-gray-50":!h(g.value)}])},q(g.label),11,Ts))),128))])])):d("",!0),e("div",null,[e("textarea",{value:a.modelValue,onInput:I,required:a.required,minlength:a.minLength,maxlength:a.maxLength,placeholder:a.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",rows:"4"},null,40,Ms),e("div",Es,[e("span",Ns,q(((v=a.modelValue)==null?void 0:v.length)||0)+"/"+q(a.maxLength||400),1),a.error?(n(),i("p",Us,q(a.error),1)):d("",!0)])])])}}},Ds={class:"mt-1"},Ps=["value","required"],Ls={key:0,class:"mt-2 text-sm text-red-600"},Rs={__name:"InputSelect",props:{modelValue:String,required:Boolean,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(a,{emit:ae}){const t=a,C=ae,c=$=>{C("update:modelValue",$.target.value),C("save",t.pointId)};return($,h)=>(n(),i("div",Ds,[e("select",{value:a.modelValue,onChange:c,required:a.required,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},h[0]||(h[0]=[e("option",{value:"",disabled:""},"Select status",-1),e("option",{value:"good"},"Good",-1),e("option",{value:"bad"},"Bad",-1),e("option",{value:"na"},"N/A",-1)]),40,Ps),a.error?(n(),i("p",Ls,q(a.error),1)):d("",!0)]))}},js=Ke(Rs,[["__scopeId","data-v-1b6c0201"]]),Bs={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},Fs={class:"bg-white rounded-xl p-8 w-full max-w-sm mx-auto shadow-2xl transform transition-all duration-300 scale-100 opacity-100"},Os={class:"text-xs text-gray-500 mt-2 text-center"},zs={class:"flex flex-row space-x-4 mb-6"},qs={class:"mt-4 text-right"},Ks={__name:"ImageSourceOptionsModal",props:{show:{type:Boolean,default:!1},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})}},emits:["close","open-webcam","trigger-gallery"],setup(a){return(ae,t)=>a.show?(n(),i("div",Bs,[e("div",Fs,[t[7]||(t[7]=e("h3",{class:"text-xl font-bold text-gray-800 mb-2 text-center"},"Pilih Sumber Gambar",-1)),e("p",Os,[t[3]||(t[3]=Ue("Ambil Foto Maksimal: ")),e("b",null,q(a.settings.max_files),1),t[4]||(t[4]=Ue(" Dengan Rasio & Ukuran: ")),e("b",null,q(a.settings.camera_aspect_ratio),1)]),e("div",zs,[e("button",{onClick:t[0]||(t[0]=C=>ae.$emit("open-webcam")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-blue-50 hover:border-blue-400 hover:text-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-blue-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),e("span",{class:"text-sm font-medium"},"Ambil Foto",-1)])),e("button",{onClick:t[1]||(t[1]=C=>ae.$emit("trigger-gallery")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},t[6]||(t[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("span",{class:"text-sm font-medium"},"Galeri",-1)]))]),e("div",qs,[e("button",{onClick:t[2]||(t[2]=C=>ae.$emit("close")),class:"px-5 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-colors duration-200 ease-in-out"}," Batal ")])])])):d("",!0)}},Hs={key:0,class:"fixed inset-0 bg-black bg-opacity-95 z-50 flex flex-col items-center justify-center"},Gs={class:"w-full h-full flex flex-col"},Ws={class:"flex justify-between items-center p-4 bg-black bg-opacity-70 text-white shadow-md"},Ys=["disabled"],Zs={class:"text-lg font-semibold"},Js={class:"flex items-center gap-2"},Xs=["disabled"],Qs={key:0,class:"px-4 py-2 bg-indigo-900 text-white"},en={class:"flex justify-between items-center text-sm"},tn={class:"w-full bg-gray-700 rounded-full h-2 mt-1"},an={class:"flex-1 flex items-center justify-center overflow-hidden relative"},sn=["src"],nn={key:1,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-3"},on=["disabled"],ln=["disabled"],rn={key:2,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},un={key:3,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},dn=["disabled"],cn=["disabled"],gn=["disabled"],pn={class:"flex flex-col gap-3 p-4 bg-black bg-opacity-70 shadow-inner"},mn={class:"flex justify-between items-center w-full"},vn=["disabled"],fn={key:1,class:"flex-1"},hn=["disabled"],bn={class:"flex gap-3 w-full"},yn={key:1,class:"flex-1 px-4 py-3 bg-gradient-to-r from-indigo-700 to-sky-600 rounded-lg cursor-not-allowed flex items-center justify-center font-medium opacity-75",disabled:""},xn={class:"flex items-center gap-2"},wn={key:0,class:"text-center"},kn={__name:"PreviewModal",props:{show:Boolean,images:{type:Array,default:()=>[]},initialIndex:{type:Number,default:0},allowMultiple:Boolean,maxFiles:Number,isUploading:Boolean,aspectRatio:Number,point:Object,uploadProgress:{type:Number,default:0},currentUpload:{type:Number,default:0},totalUpload:{type:Number,default:0}},emits:["close","saveImages","removePreviewImage","triggerAddMorePhotos","update:images","retryImage"],setup(a,{emit:ae}){const t=a,C=ae,c=y(0),$=y([]),h=te(()=>$.value.length>0?$.value[c.value]:null);xe(()=>t.images,K=>{$.value=K.map(E=>({...E,rotation:E.isNew&&E.rotation||0})),K.length===0&&t.show&&M()},{deep:!0,immediate:!0}),xe(()=>t.show,K=>{K&&t.images.length>0&&(c.value=t.initialIndex)}),xe(()=>t.uploadProgress,K=>{K===100&&console.log("Upload completed")});const S=K=>K.preview||(K.image_path?`/${K.image_path}`:""),I=K=>{if(h.value&&h.value.isNew&&!t.isUploading){const E=h.value.rotation||0;let G;K==="left"?G=E-90:G=E+90,G=(G%360+360)%360,$.value[c.value].rotation=G,C("update:images",$.value)}},j=()=>{t.isUploading||(c.value=c.value<$.value.length-1?c.value+1:0)},w=()=>{t.isUploading||(c.value=c.value>0?c.value-1:$.value.length-1)},D=()=>{t.isUploading||C("saveImages",$.value)},M=()=>{t.isUploading||C("close")},Q=()=>{if(h.value&&!t.isUploading){const K=h.value,E=$.value.findIndex(G=>G.isNew&&K.isNew&&G.preview===K.preview||!G.isNew&&!K.isNew&&G.id===K.id);E!==-1&&(C("removePreviewImage",K),$.value.splice(E,1),C("update:images",$.value)),c.value>=$.value.length&&(c.value=Math.max(0,$.value.length-1)),$.value.length===0&&C("close")}},v=()=>{t.isUploading||C("triggerAddMorePhotos")},g=()=>{h.value&&!t.isUploading&&C("retryImage",h.value)},T=K=>{K.key==="Escape"&&!t.isUploading&&M()};return st(()=>{document.addEventListener("keydown",T)}),wt(()=>{document.removeEventListener("keydown",T)}),(K,E)=>{var G;return a.show?(n(),i("div",Hs,[e("div",Gs,[e("div",Ws,[e("button",{onClick:M,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:a.isUploading},E[2]||(E[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ys),e("div",Zs,q(((G=a.point)==null?void 0:G.name)||"Preview")+" ("+q(c.value+1)+"/"+q($.value.length)+") ",1),e("div",Js,[h.value&&h.value.isNew?(n(),i("button",{key:0,onClick:Q,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors","aria-label":"Remove new image",disabled:a.isUploading},E[3]||(E[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]),8,Xs)):d("",!0)])]),a.isUploading?(n(),i("div",Qs,[e("div",en,[e("span",null,"Mengupload: "+q(a.currentUpload)+"/"+q(a.totalUpload),1),e("span",null,q(a.uploadProgress)+"%",1)]),e("div",tn,[e("div",{class:"bg-gradient-to-r from-indigo-500 to-sky-400 h-2 rounded-full progress-bar",style:qe({width:a.uploadProgress+"%"})},null,4)])])):d("",!0),e("div",an,[e("div",{class:"relative w-full max-w-full",style:qe({paddingTop:a.aspectRatio?100/a.aspectRatio+"%":"75%"})},[h.value?(n(),i("img",{key:0,src:S(h.value),class:"absolute inset-0 w-full h-full object-contain transition-transform duration-300 ease-in-out bg-black",style:qe({transform:`rotate(${h.value.rotation}deg)`})},null,12,sn)):d("",!0),h.value&&h.value.isNew&&!h.value.isUploading&&!h.value.isFailed?(n(),i("div",nn,[e("button",{onClick:E[0]||(E[0]=Z=>I("left")),class:"p-3 bg-black bg-opacity-60 text-white rounded-full hover:bg-opacity-80 transition-colors",disabled:a.isUploading,title:"Putar ke kiri"},E[4]||(E[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12a9 9 0 1018 0 9 9 0 00-18 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l3-3m0 0l3 3m-3-3v9",transform:"rotate(180 12 12)"})],-1)]),8,on),e("button",{onClick:E[1]||(E[1]=Z=>I("right")),class:"p-3 bg-black bg-opacity-60 text-white rounded-full hover:bg-opacity-80 transition-colors",disabled:a.isUploading,title:"Putar ke kanan"},E[5]||(E[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12a9 9 0 1018 0 9 9 0 00-18 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l3-3m0 0l3 3m-3-3v9"})],-1)]),8,ln)])):d("",!0),h.value&&h.value.isUploading?(n(),i("div",rn,E[6]||(E[6]=[e("div",{class:"text-center text-white"},[e("div",{class:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e("p",{class:"text-sm"},"Mengupload...")],-1)]))):d("",!0),h.value&&h.value.isFailed?(n(),i("div",un,[E[7]||(E[7]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),E[8]||(E[8]=e("p",{class:"text-lg font-medium mb-2"},"Upload Gagal",-1)),e("button",{onClick:g,class:"px-4 py-2 bg-white text-red-600 rounded-lg font-medium hover:bg-gray-100 transition-colors",disabled:a.isUploading}," Coba Lagi ",8,dn)])):d("",!0)],4),$.value.length>1&&!a.isUploading?(n(),i("button",{key:0,onClick:w,class:"absolute left-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:a.isUploading},E[9]||(E[9]=[e("svg",{xmlns:"http://www.w3.org2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]),8,cn)):d("",!0),$.value.length>1&&!a.isUploading?(n(),i("button",{key:1,onClick:j,class:"absolute right-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:a.isUploading},E[10]||(E[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,gn)):d("",!0)]),e("div",pn,[e("div",mn,[h.value&&!h.value.isNew?(n(),i("button",{key:0,onClick:Q,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-red-400",disabled:a.isUploading},E[11]||(E[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Ue(" Hapus Foto ")]),8,vn)):(n(),i("div",fn)),a.allowMultiple&&$.value.length<a.maxFiles&&!a.isUploading?(n(),i("button",{key:2,onClick:v,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-indigo-400",disabled:a.isUploading},E[12]||(E[12]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Ue(" Tambah Foto ")]),8,hn)):d("",!0)]),e("div",bn,[a.isUploading?(n(),i("button",yn,[e("div",xn,[E[13]||(E[13]=e("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)),e("span",null,"Mengupload... "+q(a.uploadProgress)+"%",1)])])):(n(),i("button",{key:0,onClick:D,class:"flex-1 px-4 py-3 rounded-lg bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white transition-colors font-medium hover:from-indigo-600 hover:to-sky-500"}," Simpan & Upload "))]),a.isUploading?(n(),i("div",wn,E[14]||(E[14]=[e("p",{class:"text-xs text-blue-300"}," Modal akan tertutup otomatis. Upload terus berjalan di background. ",-1)]))):d("",!0)])])])):d("",!0)}}},In=Ke(kn,[["__scopeId","data-v-0e4bb6d9"]]),_n={key:0,class:"fixed inset-0 z-40 p-0 webcam-modal-container"},Sn={class:"webcam-content-box"},Cn={class:"webcam-header"},$n={class:"inspection-point-name"},An={class:"camera-quality-indicator"},Vn={class:"quality-badge"},Tn={key:1,class:"auto-focus-indicator"},Mn={key:2,class:"error-overlay"},En={class:"error-content"},Nn={class:"error-message"},Un={class:"webcam-footer"},Dn={class:"camera-controls"},Pn=["disabled"],Ln={class:"camera-icon-container"},Rn={key:0,class:"camera-spinner"},jn={key:1,class:"camera-shutter"},Bn=["disabled"],Fn={__name:"WebCamRTC",props:{show:Boolean,aspectRatio:{type:Number,default:4/3},settings:{type:Object,default:()=>({enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object,cameraQuality:{type:String}},emits:["close","photoCaptured"],setup(a,{emit:ae}){const t=a,C=ae,c=y(null),$=y(null);let h=null,S=null;const I=y("environment"),j=y(null),w=y([]),D=y(!1),M=y(!1),Q=y(!1),v=y(!1),g=y(!1),T=y(null),K=y(null),E=y(!1),G=y(!0),Z=y({}),O=te(()=>({aspectRatio:`${t.aspectRatio} / 1`,maxWidth:"100%",maxHeight:"70vh",margin:"0 auto"})),k=async()=>{h&&h.getTracks().forEach(U=>U.stop()),T.value=null,g.value=!0;try{const U=B();console.log("Mencoba inisialisasi kamera dengan:",U),h=await navigator.mediaDevices.getUserMedia({video:U,audio:!1}),S=h.getVideoTracks()[0],c.value.srcObject=h,await new Promise((N,R)=>{c.value.onloadedmetadata=N,c.value.onerror=R,setTimeout(N,1e3)}),await c.value.play(),await s(),de(),setTimeout(async()=>{try{await _()}catch(N){console.warn("Gagal mendapatkan daftar perangkat:",N)}},500),g.value=!1,console.log("Kamera berhasil diinisialisasi")}catch(U){if(console.error("Error mengakses kamera: ",U),!h)try{console.log("Mencoba fallback berdasarkan kualitas kamera...");let N,R,H,X;switch(t.cameraQuality){case"SD":N=1280,R=720,H=640,X=480;break;case"HD":N=1920,R=1080,H=1280,X=720;break;case"4K":N=3840,R=2160,H=1920,X=1080;break;default:N=1920,R=1080,H=1280,X=720}const se={video:{facingMode:I.value,width:{min:H,ideal:N},height:{min:X,ideal:R}}};h=await navigator.mediaDevices.getUserMedia(se),S=h.getVideoTracks()[0],c.value.srcObject=h,await c.value.play(),g.value=!1,console.log("Fallback berhasil dengan kualitas:",t.cameraQuality)}catch(N){console.error("Fallback juga gagal:",N),T.value=f(N),g.value=!1}}},B=()=>{let U,N,R,H,X,se;switch(t.cameraQuality){case"SD":U=1280,N=720,R=1280,H=720,X=640,se=480;break;case"HD":U=1920,N=1080,R=1920,H=1080,X=1280,se=720;break;case"4K":U=3840,N=2160,R=3840,H=2160,X=1920,se=1080;break;default:U=1920,N=1080,R=1920,H=1080,X=1280,se=720}return{facingMode:{ideal:"environment"},width:{ideal:U,max:R,min:X},height:{ideal:N,max:H,min:se},focusMode:{ideal:["continuous","single-shot","manual"]},exposureMode:{ideal:["continuous","manual"]},whiteBalanceMode:{ideal:["continuous","manual"]}}},de=async()=>{if(S)try{const U=S.getCapabilities();K.value=U;const N=U.focusMode&&(U.focusMode.includes("continuous")||U.focusMode.includes("single-shot")),R=U.exposureMode&&U.exposureMode.includes("continuous");if(N||R){const H={};N&&(H.focusMode="continuous"),R&&(H.exposureMode="continuous",H.exposureCompensation={ideal:0}),Object.keys(H).length>0&&(await S.applyConstraints({advanced:[H]}),console.log("Auto-focus/exposure diaktifkan"))}M.value=!!U.torch||!!U.fillLightMode}catch(U){console.warn("Tidak bisa mengatur auto-focus/exposure:",U)}},_=async()=>{try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(R=>R.stop());const N=await navigator.mediaDevices.enumerateDevices();if(w.value=N.filter(R=>R.kind==="videoinput"),D.value=w.value.length>1,!j.value&&w.value.length>0){const R=w.value.find(H=>H.label.toLowerCase().includes("back")||H.label.toLowerCase().includes("rear")||H.label.toLowerCase().includes("environment"));j.value=R?R.deviceId:w.value[0].deviceId}}catch(U){console.warn("Error getting camera devices:",U)}},f=U=>{switch(U.name){case"NotAllowedError":return"Izin akses kamera ditolak. Silakan izinkan akses kamera di pengaturan browser.";case"NotFoundError":return"Tidak ada kamera yang ditemukan.";case"NotSupportedError":return"Browser tidak mendukung akses kamera.";case"NotReadableError":return"Kamera sedang digunakan oleh aplikasi lain.";case"OverconstrainedError":return"Perangkat tidak mendukung pengaturan kamera yang diminta.";default:return`Tidak dapat mengakses kamera: ${U.message}`}},s=()=>{var U,N;if(S)try{const R=S.getCapabilities();K.value=R,M.value=!!R.torch||!!R.fillLightMode,console.log("Kamera mendukung:",{maxRes:`${((U=R.width)==null?void 0:U.max)||"N/A"}x${((N=R.height)==null?void 0:N.max)||"N/A"}`,torch:R.torch,focusModes:R.focusMode,exposureModes:R.exposureMode})}catch(R){console.warn("Tidak bisa mendapatkan kemampuan kamera:",R)}},x=async()=>{if(!(!S||!M.value))try{I.value==="environment"?(await S.applyConstraints({advanced:[{torch:!Q.value}]}),Q.value=!Q.value):(console.log("Flash tidak didukung untuk kamera depan"),Q.value=!1)}catch(U){console.error("Gagal mengontrol flash:",U),Q.value=!1}},z=async()=>{if(!D.value||g.value)return;g.value=!0,h&&h.getTracks().forEach(H=>H.stop());const N=(w.value.findIndex(H=>H.deviceId===j.value)+1)%w.value.length;j.value=w.value[N].deviceId;const R=w.value[N];I.value=R.label.toLowerCase().includes("front")?"user":"environment",await k()},ue=async U=>{if(!c.value||!S)return;const N=U.currentTarget.getBoundingClientRect(),R=U.type.includes("mouse")?U.clientX-N.left:U.touches[0].clientX-N.left,H=U.type.includes("mouse")?U.clientY-N.top:U.touches[0].clientY-N.top;E.value=!0,Z.value={left:`${R-40}px`,top:`${H-40}px`},setTimeout(()=>{E.value=!1},1e3);try{const X=S.getCapabilities();if(X.focusMode&&X.focusMode.includes("manual")){const se=R/N.width,ve=H/N.height;X.focusDistance&&X.pan&&X.tilt&&await S.applyConstraints({advanced:[{focusMode:"manual",focusDistance:.3,pointsOfInterest:[{x:se,y:ve}]}]})}else X.focusMode&&X.focusMode.includes("single-shot")&&await S.applyConstraints({advanced:[{focusMode:"single-shot"}]})}catch(X){console.warn("Penyesuaian fokus tidak didukung:",X)}},Y=async()=>{var U,N;if(!(v.value||!c.value||!$.value)){v.value=!0;try{const R=c.value,H=$.value;await new Promise(ke=>setTimeout(ke,100));const X=R.videoWidth,se=R.videoHeight;let ve,pe,Me,Ie;X/se>t.aspectRatio?(pe=se,ve=se*t.aspectRatio,Me=(X-ve)/2,Ie=0):(ve=X,pe=X/t.aspectRatio,Me=0,Ie=(se-pe)/2),H.width=ve,H.height=pe,H.getContext("2d").drawImage(R,Me,Ie,ve,pe,0,0,ve,pe);const Ce=Math.min(.95,.7+X*se/(3840*2160)*.25),$e=await new Promise(ke=>{H.toBlob(ke,"image/jpeg",Ce)});if($e)if($e.size/1024>t.settings.max_size){const ke=await W($e,t.settings.max_size),Ee=`inspeksi_${((U=t.point)==null?void 0:U.name)||"foto"}_${Date.now()}.jpg`,l=new File([ke],Ee,{type:"image/jpeg",lastModified:Date.now()});C("photoCaptured",l)}else{const ke=`inspeksi_${((N=t.point)==null?void 0:N.name)||"foto"}_${Date.now()}.jpg`,Ee=new File([$e],ke,{type:"image/jpeg",lastModified:Date.now()});C("photoCaptured",Ee)}}catch(R){console.error("Error mengambil foto:",R)}finally{v.value=!1}}},W=async(U,N)=>new Promise(R=>{const H=new Image;H.onload=()=>{const X=document.createElement("canvas");let se=H.width,ve=H.height;const pe=1920;(se>pe||ve>pe)&&(se>ve?(ve=ve*pe/se,se=pe):(se=se*pe/ve,ve=pe)),X.width=se,X.height=ve,X.getContext("2d").drawImage(H,0,0,se,ve);let Ie=.9;const be=()=>{X.toBlob(Ce=>{Ce.size/1024<=N||Ie<=.3?R(Ce):(Ie-=.1,be())},"image/jpeg",Ie)};be()},H.src=URL.createObjectURL(U)}),ie=()=>{h&&h.getTracks().forEach(U=>U.stop()),C("close")},ge=async()=>{T.value=null,await k()};return xe(()=>t.show,async U=>{U?(await Pt(),await k()):h&&h.getTracks().forEach(N=>N.stop())}),wt(()=>{h&&h.getTracks().forEach(U=>U.stop())}),(U,N)=>{var R;return a.show?(n(),i("div",_n,[e("div",Sn,[e("div",Cn,[e("div",$n,q(((R=a.point)==null?void 0:R.name)||"Camera"),1),e("div",An,[e("span",Vn,q(a.cameraQuality),1)]),e("button",{onClick:ie,class:"p-2 rounded-full text-white hover:bg-gray-700 transition-colors"},N[0]||(N[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",{class:"webcam-video-container",style:qe(O.value),onTouchstart:ue,onClick:ue},[e("video",{ref_key:"webcamVideo",ref:c,autoplay:"",playsinline:"",class:"webcam-video"},null,512),e("canvas",{ref_key:"webcamCanvas",ref:$,class:"hidden"},null,512),E.value?(n(),i("div",{key:0,class:"focus-indicator",style:qe(Z.value)},N[1]||(N[1]=[e("div",{class:"focus-ring"},null,-1)]),4)):d("",!0),G.value&&!E.value?(n(),i("div",Tn,N[2]||(N[2]=[e("div",{class:"auto-focus-ring"},null,-1)]))):d("",!0),T.value?(n(),i("div",Mn,[e("div",En,[N[3]||(N[3]=e("div",{class:"error-icon"},"⚠️",-1)),N[4]||(N[4]=e("h3",{class:"error-title"},"Gagal Mengakses Kamera",-1)),e("p",Nn,q(T.value),1),e("button",{onClick:ge,class:"retry-button"}," Coba Lagi ")])])):d("",!0)],36),e("div",Un,[e("div",Dn,[a.settings.enable_flash&&M.value?(n(),i("button",{key:0,onClick:x,class:re(["control-button flash-button",{active:Q.value}])},N[5]||(N[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2)):d("",!0),e("button",{onClick:Y,class:"capture-button",disabled:v.value||g.value},[e("div",Ln,[v.value?(n(),i("div",Rn)):(n(),i("div",jn))])],8,Pn),a.settings.enable_camera_switch&&D.value?(n(),i("button",{key:1,onClick:z,class:"control-button switch-button",disabled:g.value},N[6]||(N[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]),8,Bn)):d("",!0)])])])])):d("",!0)}}},On=Ke(Fn,[["__scopeId","data-v-472cc13f"]]),zn={key:0,class:"fixed inset-0 z-40 p-0 webcam-modal-container"},qn={class:"webcam-content-box"},Kn={class:"webcam-header"},Hn={class:"rounded-full text-white hover:bg-gray-700 transition-colors"},Gn={class:"inspection-point-name"},Wn={key:0,class:"screen-flash-overlay"},Yn={key:2,class:"zoom-controls"},Zn=["max"],Jn={class:"webcam-footer"},Xn={class:"camera-controls"},Qn=["disabled"],eo={class:"camera-icon-container"},to={key:0,class:"camera-spinner"},ao={key:1,class:"camera-body"},so={__name:"WebcamModal",props:{show:Boolean,aspectRatio:Number,settings:Object,point:Object},emits:["close","photoCaptured"],setup(a,{emit:ae}){const t=a,C=ae,c=y(null),$=y(null);let h=null,S=null;const I=y("environment"),j=y(!1),w=y(!1),D=y(!1),M=y(!1),Q=y(!1),v=y({}),g=y(!1),T=y(1),K=y(1),E=y(!1),G=te(()=>{var Y;return((Y=t.settings)==null?void 0:Y.max_size)||2048}),Z=te(()=>t.aspectRatio?{aspectRatio:`${t.aspectRatio} / 1`,maxWidth:"100%",maxHeight:"70vh",margin:"0 auto"}:{}),O=te(()=>{if(!t.aspectRatio)return{};const Y=t.aspectRatio,W=Y>1?80:60,ie=Y>1?80/Y:60*Y;return{width:`${W}%`,height:`${ie}%`}}),k=async()=>{h&&h.getTracks().forEach(Y=>Y.stop());try{const Y={facingMode:I.value,width:{ideal:4096},height:{ideal:2160},aspectRatio:{ideal:t.aspectRatio||1.3333333333333333},frameRate:{ideal:30},advanced:[{focusMode:"continuous"},{exposureMode:"continuous"},{whiteBalanceMode:"continuous"}]};h=await navigator.mediaDevices.getUserMedia({video:Y,audio:!1}),S=h.getVideoTracks()[0],c.value.srcObject=h,c.value.onloadedmetadata=async()=>{await de(),await c.value.play()}}catch(Y){console.error("Error accessing camera: ",Y),alert("Failed to access camera. Please allow camera permission."),C("close")}},B=()=>{h&&h.getTracks().forEach(Y=>Y.stop()),C("close")},de=async()=>{if(S)try{const Y=await navigator.mediaDevices.enumerateDevices();j.value=Y.filter(ie=>ie.kind==="videoinput").length>1;const W=S.getCapabilities();W.zoom?(E.value=!0,K.value=W.zoom.max,console.log(`Zoom supported. Max zoom: ${K.value}`)):(E.value=!1,console.warn("Zoom is not supported by this camera.")),w.value=W.torch||W.fillLightMode&&W.fillLightMode.includes("torch")}catch(Y){console.error("Error checking camera capabilities:",Y)}},_=async Y=>{if(!S)return;const W=c.value.getBoundingClientRect(),ie=Y.clientX-W.left,ge=Y.clientY-W.top;Q.value=!0,v.value={left:`${ie}px`,top:`${ge}px`,transform:"translate(-50%, -50%)"};try{if(S.getCapabilities().pointsOfInterest){const N=ie/W.width,R=ge/W.height;await S.applyConstraints({advanced:[{focusMode:"manual",pointsOfInterest:[{x:N,y:R}]}]})}else console.warn("Manual focus with point of interest is not supported.")}catch(U){console.warn("Manual focus failed:",U)}setTimeout(()=>{Q.value=!1,S.getCapabilities().focusMode.includes("continuous")&&S.applyConstraints({advanced:[{focusMode:"continuous"}]})},1e3)},f=async Y=>{if(!S||!E.value)return;const W=Math.min(Math.max(Y,1),K.value);T.value=W;try{await S.applyConstraints({advanced:[{zoom:W}]})}catch(ie){console.error("Failed to set zoom:",ie)}},s=async()=>{if(!(!S||!w.value))try{I.value==="user"?(D.value=!D.value,M.value=D.value):(await S.applyConstraints({advanced:[{torch:!D.value}]}),D.value=!D.value)}catch(Y){console.error("Flash toggle failed:",Y)}},x=async()=>{j.value&&(I.value=I.value==="environment"?"user":"environment",h&&h.getTracks().forEach(Y=>Y.stop()),await k())},z=async Y=>new Promise(W=>{const ie=G.value*1024;if(Y.size<=ie){W(Y);return}const ge=new Image,U=new FileReader;U.onload=N=>{ge.onload=()=>{const R=document.createElement("canvas"),H=R.getContext("2d"),X=Math.sqrt(ie/Y.size);R.width=ge.width*X,R.height=ge.height*X,H.drawImage(ge,0,0,R.width,R.height);let se=.9;const ve=()=>{R.toBlob(pe=>{pe.size>ie&&se>.1?(se-=.1,ve()):W(pe)},"image/jpeg",se)};ve()},ge.src=N.target.result},U.readAsDataURL(Y)}),ue=async()=>{if(!(g.value||!c.value||!$.value)){g.value=!0;try{const Y=c.value,W=$.value,ie=Y.videoWidth,ge=Y.videoHeight;let U,N,R,H;ie/ge>t.aspectRatio?(N=ge,U=ge*t.aspectRatio,R=(ie-U)/2,H=0):(U=ie,N=ie/t.aspectRatio,R=0,H=(ge-N)/2),W.width=U,W.height=N,W.getContext("2d").drawImage(Y,R,H,U,N,0,0,U,N);const se=await new Promise(pe=>{W.toBlob(pe,"image/jpeg",1)}),ve=await z(se);if(ve){const pe=new File([ve],`capture_${Date.now()}.jpeg`,{type:"image/jpeg",lastModified:Date.now()});C("photoCaptured",pe),M.value=!0,setTimeout(()=>{M.value=!1},100)}}catch(Y){console.error("Error capturing photo:",Y),alert("Failed to capture photo. Please try again.")}finally{g.value=!1}}};return xe(()=>t.show,Y=>{Y?k():B()}),wt(()=>{h&&h.getTracks().forEach(Y=>Y.stop())}),(Y,W)=>{var ie;return a.show?(n(),i("div",zn,[e("div",qn,[e("div",Kn,[e("p",Hn,q(a.settings.camera_aspect_ratio),1),e("div",Gn,q(((ie=a.point)==null?void 0:ie.name)||"Camera"),1),e("button",{onClick:B,class:"p-2 rounded-full text-white hover:bg-gray-700 transition-colors"},W[2]||(W[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",{class:"webcam-video-container",style:qe(Z.value),onClick:_,onTouchstart:_},[e("video",{ref_key:"webcamVideo",ref:c,autoplay:"",playsinline:"",class:"webcam-video"},null,512),e("canvas",{ref_key:"webcamCanvas",ref:$,class:"hidden"},null,512),M.value?(n(),i("div",Wn)):d("",!0),e("div",{class:"aspect-ratio-guide",style:qe(O.value)},null,4),Q.value?(n(),i("div",{key:1,class:"focus-indicator",style:qe(v.value)},W[3]||(W[3]=[e("div",{class:"focus-ring"},null,-1)]),4)):d("",!0),W[4]||(W[4]=e("div",{class:"hd-badge"},[e("span",{class:"hd-text"},"HD")],-1)),E.value?(n(),i("div",Yn,[Le(e("input",{type:"range",min:"1",max:K.value,step:"0.1","onUpdate:modelValue":W[0]||(W[0]=ge=>T.value=ge),onInput:W[1]||(W[1]=ge=>f(parseFloat(ge.target.value))),class:"zoom-slider"},null,40,Zn),[[dt,T.value]])])):d("",!0)],36),e("div",Jn,[e("div",Xn,[a.settings.enable_flash&&w.value?(n(),i("button",{key:0,onClick:s,class:re(["control-button",{active:D.value,disabled:!w.value}])},W[5]||(W[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2)):d("",!0),e("button",{onClick:ue,class:"capture-button",disabled:g.value},[e("div",eo,[g.value?(n(),i("div",to)):(n(),i("div",ao,W[6]||(W[6]=[e("div",{class:"camera-lens"},null,-1),e("div",{class:"camera-flash"},null,-1)])))])],8,Qn),a.settings.enable_camera_switch&&j.value?(n(),i("button",{key:1,onClick:x,class:"control-button"},W[7]||(W[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]))):d("",!0)])])])])):d("",!0)}}},no=Ke(so,[["__scopeId","data-v-d307c818"]]),oo={__name:"NativeCameraInput",emits:["photoCaptured"],setup(a,{expose:ae,emit:t}){const C=t,c=y(null);ae({openCamera:()=>{var S;(S=c.value)==null||S.click()}});const h=async S=>{var j;const I=(j=S.target.files)==null?void 0:j[0];I&&(C("photoCaptured",I),S.target.value="")};return(S,I)=>(n(),i("input",{ref_key:"cameraInput",ref:c,type:"file",accept:"image/*",capture:"environment",class:"hidden",onChange:h},null,544))}},io=["accept","multiple","disabled"],lo={class:"text-xs text-gray-500 mb-2"},ro=["disabled"],uo={class:"h-full flex flex-col items-center justify-center p-4 text-center"},co={class:"text-xs text-gray-400 mt-1"},go={key:0,class:"flex items-center gap-4"},po=["src"],mo={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},vo=["disabled"],fo={key:1,class:"flex space-x-2 overflow-x-auto pb-2 scrollbar-hide"},ho=["disabled"],bo=["onClick"],yo=["src","onError"],xo={key:0,class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center text-white text-xs font-bold"},wo={key:0},ko={key:1,class:"ml-1"},Io={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},_o={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},So={key:2,class:"mt-1 text-xs text-red-600"},Co={__name:"InputImage",props:{modelValue:{type:Array,default:()=>[]},error:String,inspectionId:{type:[String,Number],required:!0},pointId:{type:[String,Number],required:!0},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object},emits:["update:modelValue","save","removeImage","uploaded","uploadProgress"],setup(a,{emit:ae}){const t=a,C=ae,c=y(null),$=y(null),h=y(null),S=y(!1),I=y(!1),j=y(!1),w=y([]),D=y(0),M=y(!1),Q=y(!1),v=y(0),g=y(0),T=y(0),K=Lt("imageSourceSetting",y("all")),E=Lt("cameraQualitySetting",y("HD_Std")),G=`inspection-${t.inspectionId}-point-${t.pointId}-backup`,Z=te(()=>Number(t.settings.max_files)>1),O=te(()=>t.settings.allowed_types.map(l=>`.${l}`).join(", ")),k=te(()=>{const l=t.settings.camera_aspect_ratio.split(":");if(l.length===2){const b=parseFloat(l[0]),u=parseFloat(l[1]);if(!isNaN(b)&&!isNaN(u)&&u!==0)return b/u}return 3/4}),B=te(()=>{console.log("🔄 allImages computed called");const l=[],b=new Set;for(const u of t.modelValue){if(!u||typeof u!="object"||u.id&&b.has(u.id))continue;u.id&&b.add(u.id),console.log("📥 Database image:",u),console.log("📥 Type of preview:",typeof u.preview),console.log("📥 Type of public_url:",typeof u.public_url);const P=de(u);l.push({...P,rotation:P.rotation||0,isNew:!1,isUploaded:!0,isUploading:!1,isFailed:!1})}for(const u of w.value)u.id&&b.add(u.id),l.push({...u,isUploading:u.isUploading||!1,isFailed:u.isFailed||!1});return console.log("✅ Final allImages:",l),l}),de=l=>{if(!l||typeof l!="object")return{};const b={...l};return["preview","public_url","original_url","optimized_url"].forEach(P=>{b[P]&&(b[P]=_(b[P]))}),b.image_path&&(b.image_path=b.image_path.replace(/^storage\//,"")),b},_=l=>{if(!l||typeof l!="string")return l;let b=l.replace(/\/storage\/storage\//g,"/storage/");return b=b.replace(/\/\/storage\/storage\//g,"/storage/"),b.startsWith("storage/")&&(b=`/${b}`),!b.startsWith("/")&&!b.startsWith("http")&&(b=`/storage/${b}`),b},f=l=>{if(!l||typeof l!="object")return console.warn("❌ safeImageSrc: image is not object",l),"";const b=s(l);return typeof b!="string"?(console.error("🚨 CRITICAL: getImageSrc returned non-string:",typeof b,b),""):(b&&console.log("✅ safeImageSrc result:",b),b)},s=l=>{if(!l||typeof l!="object")return"";if(console.log("🔍 getImageSrc called with:",l),console.log("🔍 Available fields:",Object.keys(l)),l.preview&&typeof l.preview=="string"){const b=_(l.preview);return console.log("✅ Using preview URL:",b),b}if(l.public_url&&typeof l.public_url=="string"){const b=_(l.public_url);return console.log("✅ Using public_url:",b),b}if(l.original_url&&typeof l.original_url=="string"){const b=_(l.original_url);return console.log("✅ Using original_url:",b),b}if(l.optimized_url&&typeof l.optimized_url=="string"){const b=_(l.optimized_url);return console.log("✅ Using optimized_url:",b),b}if(l.image_path&&typeof l.image_path=="string"){const u=`/storage/${l.image_path.replace(/^\/?storage\//,"")}`;return console.log("✅ Generated from image_path:",u),u}if(l.path&&typeof l.path=="string"){const u=`/storage/${l.path.replace(/^\/?storage\//,"")}`;return console.log("✅ Generated from path:",u),u}return console.warn("⚠️ No valid image source found for:",l),""},x=l=>{console.error("❌ Image load error for:",l),console.error("❌ Attempted URL:",f(l)),Q.value=!0;const b=z(l);if(b&&b!==f(l)){console.log("🔄 Trying fallback URL:",b);const u=event==null?void 0:event.target;u&&(u.src=b)}},z=l=>{if(!l||typeof l!="object")return"";const b=["original_url","optimized_url","public_url","preview"];for(const u of b)if(l[u]&&typeof l[u]=="string")return _(l[u]);return""},ue=()=>{j.value&&(j.value=!1),K.value==="camera"?W():K.value==="gallery"?Y():S.value=!0},Y=()=>{S.value=!1,$.value.click()},W=()=>{var l;S.value=!1,E.value==="Native"?(l=c.value)==null||l.openCamera():I.value=!0},ie=()=>{S.value=!1,B.value.length>0&&(j.value=!0)},ge=()=>{I.value=!1,B.value.length>0&&(j.value=!0)},U=()=>{j.value=!1,M.value||(w.value.forEach(l=>{l.preview&&l.preview.startsWith("blob:")&&URL.revokeObjectURL(l.preview)}),w.value=[])};xe(()=>t.modelValue,l=>{var b;console.log("🔄 modelValue updated:",l),l&&l.length>0&&(console.log("📊 First image structure:",JSON.stringify(l[0],null,2)),console.log("🔍 Type of preview:",typeof((b=l[0])==null?void 0:b.preview)))},{deep:!0});const N=l=>new Promise(b=>{const u=new FileReader;u.onload=P=>{const L=new Image;L.onload=()=>{b({file:l,preview:URL.createObjectURL(l),rotation:0,width:L.naturalWidth,height:L.naturalHeight,isNew:!0})},L.onerror=()=>{console.error("Failed to load image for dimensions:",l.name),b({file:l,preview:URL.createObjectURL(l),rotation:0,width:0,height:0,isNew:!0})},L.src=P.target.result},u.readAsDataURL(l)}),R=l=>{const b=l.name.split(".").pop().toLowerCase();return t.settings.allowed_types.includes(b)},H=async l=>{const u=(t.settings.max_size||2048)*1024;return new Promise(P=>{const L=new Image,he=new FileReader;he.onload=me=>{L.onload=()=>{const fe=document.createElement("canvas"),p=fe.getContext("2d"),m=Math.max(L.width,L.height);fe.width=m,fe.height=m,p.fillStyle="white",p.fillRect(0,0,m,m);const ne=(m-L.width)/2,A=(m-L.height)/2;p.drawImage(L,ne,A,L.width,L.height);let oe=.9;const Ae=()=>{fe.toBlob(Ve=>{if(Ve.size>u&&oe>.1)oe-=.1,Ae();else{const _e=new File([Ve],l.name,{type:"image/jpeg",lastModified:Date.now()});P(_e)}},"image/jpeg",oe)};Ae()},L.src=me.target.result},he.readAsDataURL(l)})},X=async l=>{const b=Array.from(l.target.files);if(!b.length){S.value=!1,B.value.length>0&&(j.value=!0);return}try{const u=b.filter(p=>!R(p));if(u.length>0){const p=u.map(m=>m.name.split(".").pop()).join(", ");alert(`File type not allowed: ${p}. Allowed types: ${t.settings.allowed_types.join(", ")}`),l.target.value="";return}const P=B.value.length,L=t.settings.max_files-P,he=await Promise.all(b.slice(0,L).map(async p=>await H(p))),me=await Promise.all(he.map(N)),fe=Z.value?me:me.slice(0,1);Z.value?w.value.push(...fe):(w.value.forEach(p=>{p.preview&&p.preview.startsWith("blob:")&&URL.revokeObjectURL(p.preview)}),w.value=fe),S.value=!1,fe.length>0?(D.value=Math.max(0,B.value.length-fe.length),j.value=!0):B.value.length>0&&(j.value=!0),l.target.value=""}catch(u){console.error("Error processing selected images:",u),alert("Failed to process selected images. Please try again."),S.value=!1,B.value.length>0&&(j.value=!0)}},se=async l=>{const b=B.value.length;if(!Z.value||b<t.settings.max_files)try{const u=await H(l),P=new Image;P.onload=()=>{const L={file:u,preview:URL.createObjectURL(u),rotation:0,width:P.naturalWidth,height:P.naturalHeight,isNew:!0};Z.value?w.value.push(L):(w.value.forEach(he=>{he.preview&&he.preview.startsWith("blob:")&&URL.revokeObjectURL(he.preview)}),w.value=[L]),I.value=!1,S.value=!1,D.value=B.value.length-1,j.value=!0},P.src=URL.createObjectURL(u)}catch(u){console.error("Error processing captured image:",u),alert("Failed to process captured image. Please try again.")}else alert(`Maximum ${t.settings.max_files} files allowed.`),I.value=!1,S.value=!1,B.value.length>0&&(j.value=!0)},ve=(l=0)=>{D.value=l,j.value=!0},pe=l=>new Promise(b=>{if(l.rotation===0||!h.value){if(!l.isNew&&!l.file){b({file:null,width:l.width,height:l.height,isOriginal:!0});return}b({file:l.file,width:l.width,height:l.height});return}const u=new Image;u.onload=async()=>{try{const P=h.value,L=P.getContext("2d"),he=u.width,me=u.height;let fe,p;l.rotation===90||l.rotation===270?(fe=me,p=he):(fe=he,p=me),P.width=fe,P.height=p,L.clearRect(0,0,P.width,P.height),L.translate(P.width/2,P.height/2),L.rotate(l.rotation*Math.PI/180),L.drawImage(u,-he/2,-me/2,he,me),L.setTransform(1,0,0,1,0,0);const m=await new Promise(oe=>{P.toBlob(oe,"image/jpeg",.9)}),ne=new File([m],l.file?l.file.name:`rotated_image_${Date.now()}.jpg`,{type:"image/jpeg"}),A=await H(ne);b({file:A,width:fe,height:p})}catch(P){console.error("Error processing rotated image:",P),b({file:l.file,width:l.width,height:l.height})}},u.onerror=()=>{console.error("Failed to load image for rotation processing:",l.preview),b({file:l.file,width:l.width,height:l.height})},u.src=l.preview}),Me=l=>{try{const b={images:l.map(u=>{var P;return{fileName:((P=u.file)==null?void 0:P.name)||`image-${Date.now()}.jpg`,rotation:u.rotation||0,width:u.width||0,height:u.height||0,timestamp:Date.now()}}),inspectionId:t.inspectionId,pointId:t.pointId};localStorage.setItem(G,JSON.stringify(b))}catch(b){console.error("Error saving backup:",b)}},Ie=()=>{localStorage.removeItem(G)},be=async l=>{M.value=!0;const b=[],u=[];if(!t.pointId){alert("Error: Point ID is missing. Cannot upload image."),M.value=!1;return}try{Me(l);for(const P of l){if(!P.isNew&&P.rotation===0&&P.id&&P.image_path){b.push({id:P.id,image_path:P.image_path,width:P.width,height:P.height,rotation:0,preview:P.preview,isUploaded:!0});continue}const{file:L,width:he,height:me,isOriginal:fe}=await pe(P);if(fe&&!P.isNew){b.push({id:P.id,image_path:P.image_path,width:P.width,height:P.height,rotation:P.rotation||0,preview:P.preview,isUploaded:!0});continue}L&&u.push({file:L,width:he,height:me,rotation:P.rotation||0,originalImage:P})}U(),u.length>0?await Ce(u,b):(C("update:modelValue",b),C("save",t.pointId))}catch(P){console.error("Error during image processing:",P),alert("Terjadi error saat memproses gambar. Data tersimpan secara lokal.")}finally{M.value=!1}},Ce=async(l,b)=>{T.value=l.length,g.value=0,v.value=0;const u=[...b];let P=0;try{for(let L=0;L<l.length;L++){const he=l[L],me=new FormData;me.append("inspection_id",t.inspectionId),me.append("point_id",t.pointId),me.append("images[]",he.file);const fe=w.value.findIndex(p=>{var m;return p.preview===((m=he.originalImage)==null?void 0:m.preview)});fe!==-1&&(w.value[fe].isUploading=!0,w.value[fe].isFailed=!1);try{const m=(await jt.post(route("inspections.upload-image"),me,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:ne=>{if(ne.total){const A=Math.round(ne.loaded*100/ne.total);v.value=Math.round((L+ne.loaded/ne.total)/l.length*100),g.value=L+1}}})).data.images;if(m&&m.length>0){const ne=m[0];if(u.push({id:ne.image_id,image_path:ne.path,width:ne.width||he.width||0,height:ne.height||he.height||0,rotation:he.rotation||0,preview:ne.public_url,isUploaded:!0}),fe!==-1){const A=w.value.splice(fe,1)[0];A.preview&&A.preview.startsWith("blob:")&&URL.revokeObjectURL(A.preview)}P++}}catch(p){console.error(`Error uploading image ${L+1}:`,p),fe!==-1&&(w.value[fe].isUploading=!1,w.value[fe].isFailed=!0)}}P>0&&(C("update:modelValue",u),C("save",t.pointId),C("uploaded",{pointId:t.pointId,images:u,newImagesCount:P})),P===l.length&&Ie(),console.log(`✅ Successfully uploaded ${P}/${l.length} images`)}catch(L){console.error("Error in upload process:",L),l.forEach(he=>{const me=w.value.findIndex(fe=>{var p;return fe.preview===((p=he.originalImage)==null?void 0:p.preview)});me!==-1&&(w.value[me].isUploading=!1,w.value[me].isFailed=!0)})}finally{v.value=0,g.value=0,T.value=0,M.value=!1}},$e=async l=>{if(!l||!l.file){console.error("No file to retry upload");return}M.value=!0;const b=[...t.modelValue];try{const u=new FormData;u.append("inspection_id",t.inspectionId),u.append("point_id",t.pointId),u.append("images[]",l.file);const P=w.value.findIndex(me=>me.preview===l.preview);P!==-1&&(w.value[P].isUploading=!0,w.value[P].isFailed=!1);const he=(await jt.post(route("inspections.upload-image"),u,{headers:{"Content-Type":"multipart/form-data"}})).data.images;if(he&&he.length>0){const me=he[0];if(b.push({id:me.image_id,image_path:me.path,width:me.width||l.width||0,height:me.height||l.height||0,rotation:l.rotation||0,preview:me.public_url,isUploaded:!0}),P!==-1){const p=w.value.splice(P,1)[0];p.preview&&p.preview.startsWith("blob:")&&URL.revokeObjectURL(p.preview)}C("update:modelValue",b),C("save",t.pointId),C("uploaded",{pointId:t.pointId,images:b,newImagesCount:1}),w.value.some(p=>p.isFailed)||Ie(),console.log("✅ Successfully retried upload for 1 image")}}catch(u){console.error("Error retrying upload:",u),previewIndex!==-1&&(w.value[previewIndex].isUploading=!1,w.value[previewIndex].isFailed=!0)}finally{M.value=!1}},ke=l=>{if(l){if(l.id&&!l.isNew)Ee(l);else{const b=w.value.findIndex(u=>u.preview&&u.preview===l.preview&&u.isNew||u.id&&u.id===l.id);if(b!==-1){const u=w.value.splice(b,1)[0];u.preview&&u.preview.startsWith("blob:")&&URL.revokeObjectURL(u.preview)}C("update:modelValue",t.modelValue.filter(u=>!(u.id&&u.id===l.id)&&!(u.preview&&u.preview===l.preview)))}D.value>=B.value.length&&(D.value=Math.max(0,B.value.length-1)),B.value.length===0&&U()}},Ee=async l=>{var u,P;if(l.id||l.image_path)try{await jt.delete(route("inspections.delete-image"),{data:{image_id:l.id,image_path:l.image_path}})}catch(L){console.error("Error deleting image from server:",L),(P=(u=L.response)==null?void 0:u.data)!=null&&P.message?alert(`Failed to delete image from server: ${L.response.data.message}`):alert(`Failed to delete image from server: ${L.message}`);return}l.preview&&l.preview.startsWith("blob:")&&URL.revokeObjectURL(l.preview);const b=t.modelValue.filter(L=>L.id!==l.id);C("update:modelValue",b),w.value=w.value.filter(L=>L.isNew&&l.isNew?L.preview!==l.preview:L.id!==l.id),C("removeImage",{image:l}),j.value&&B.value.length===0?U():j.value&&D.value>=B.value.length&&(D.value=Math.max(0,B.value.length-1))};return st(()=>{try{localStorage.getItem(G)&&console.log("Found backup images, ready for recovery if needed")}catch(l){console.error("Error loading backup:",l)}}),(l,b)=>(n(),i("div",null,[e("input",{ref_key:"galleryInput",ref:$,type:"file",accept:O.value,class:"hidden",onChange:X,multiple:Z.value,disabled:M.value},null,40,io),e("canvas",{ref_key:"processingCanvas",ref:h,class:"hidden"},null,512),e("p",lo,"Foto Maksimal: "+q(a.settings.max_files)+" | Rasio: "+q(a.settings.camera_aspect_ratio),1),B.value.length===0?(n(),i("label",{key:0,onClick:ue,class:re(["block w-full border-2 border-dashed rounded-lg cursor-pointer transition-colors duration-200 h-28",{"border-gray-300 hover:border-indigo-400 bg-gray-50":!0}]),disabled:M.value},[e("div",uo,[b[3]||(b[3]=e("svg",{class:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),b[4]||(b[4]=e("p",{class:"text-sm text-gray-600 font-medium"},"Upload Image",-1)),e("p",co,"Tipe: "+q(O.value),1)])],8,ro)):(n(),i("div",{key:1,class:re(["block w-full rounded-lg transition-colors duration-200 p-2",{"border-2 border-dashed border-indigo-200 bg-indigo-50 h-auto p-2":a.settings.max_files==1,"bg-transparent":a.settings.max_files>1}]),"aria-label":"Image gallery"},[a.settings.max_files===1?(n(),i("div",go,[e("div",{class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:b[1]||(b[1]=u=>ve(0))},[e("img",{src:f(B.value[0]),onError:b[0]||(b[0]=u=>x(B.value[0])),class:"w-full h-full object-cover"},null,40,po),B.value[0].isUploading?(n(),i("div",mo,b[5]||(b[5]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):d("",!0)]),e("button",{onClick:b[2]||(b[2]=ct(u=>Ee(B.value[0]),["stop"])),type:"button",class:"flex items-center gap-1 text-red-600 font-medium hover:text-red-800 transition-colors",disabled:M.value},b[6]||(b[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Ue(" Hapus Foto ")]),8,vo)])):(n(),i("div",fo,[Z.value&&B.value.length<a.settings.max_files?(n(),i("div",{key:0,class:"flex-shrink-0 flex flex-col items-center justify-center p-2 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 transition-colors w-24 h-24",onClick:ue,disabled:M.value},b[7]||(b[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("p",{class:"mt-1 text-xs text-gray-600"},"Tambah",-1)]),8,ho)):d("",!0),(n(!0),i(Ne,null,Pe(B.value,(u,P)=>(n(),i("div",{key:u.id||u.preview||P,class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:L=>u.isFailed?$e(u):ve(P)},[e("img",{src:f(u),onError:L=>x(u),class:"w-full h-full object-cover"},null,40,yo),u.isNew||u.rotation!==0?(n(),i("div",xo,[u.isNew?(n(),i("span",wo,"BARU")):d("",!0),u.rotation!==0?(n(),i("span",ko,"ROTASI")):d("",!0)])):d("",!0),u.isUploading?(n(),i("div",Io,b[8]||(b[8]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):d("",!0),u.isFailed?(n(),i("div",_o,b[9]||(b[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("span",{class:"text-xs font-medium"},"Retry",-1)]))):d("",!0)],8,bo))),128))]))],2)),a.error?(n(),i("p",So,q(a.error),1)):d("",!0),Te(Ks,{show:S.value,settings:a.settings,onClose:ie,onOpenWebcam:W,onTriggerGallery:Y},null,8,["show","settings"]),ee(E)!=="HD_Std"?(n(),De(On,{key:3,show:I.value,"aspect-ratio":k.value,settings:a.settings,point:a.point,"camera-quality":ee(E),onClose:ge,onPhotoCaptured:se},null,8,["show","aspect-ratio","settings","point","camera-quality"])):d("",!0),ee(E)==="HD_Std"?(n(),De(no,{key:4,show:I.value,"aspect-ratio":k.value,settings:a.settings,point:a.point,"camera-quality":ee(E),onClose:ge,onPhotoCaptured:se},null,8,["show","aspect-ratio","settings","point","camera-quality"])):d("",!0),ee(E)==="Native"?(n(),De(oo,{key:5,ref_key:"nativeCamera",ref:c,onPhotoCaptured:se},null,512)):d("",!0),Te(In,{show:j.value,images:B.value,point:a.point,"initial-index":D.value,"allow-multiple":Z.value,"max-files":a.settings.max_files,"is-uploading":M.value,"aspect-ratio":k.value,"upload-progress":v.value,"current-upload":g.value,"total-upload":T.value,onClose:U,onSaveImages:be,onRemovePreviewImage:ke,onTriggerAddMorePhotos:ue,onRetryImage:$e},null,8,["show","images","point","initial-index","allow-multiple","max-files","is-uploading","aspect-ratio","upload-progress","current-upload","total-upload"])]))}},Ft=Ke(Co,[["__scopeId","data-v-dd0cc2d8"]]),$o={key:0,class:"fixed inset-0 z-50 overflow-hidden"},Ao={class:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[85vh] overflow-hidden flex flex-col"},Vo={class:"px-4 pb-2 border-b border-gray-200"},To={class:"text-lg font-semibold text-gray-900"},Mo={key:0,class:"text-sm text-gray-500 mt-1"},Eo={class:"flex-1 overflow-y-auto p-4"},No={key:0,class:"border-t border-gray-200 p-4 bg-gray-50"},Uo={__name:"BottomSheetModal",props:{show:Boolean,title:String,subtitle:String},setup(a){return(ae,t)=>(n(),De(gt,{name:"bottom-sheet"},{default:Fe(()=>[a.show?(n(),i("div",$o,[t[1]||(t[1]=e("div",{class:"absolute inset-0 bg-black bg-opacity-50"},null,-1)),e("div",Ao,[t[0]||(t[0]=e("div",{class:"flex justify-center py-3"},[e("div",{class:"w-12 h-1.5 bg-gray-300 rounded-full"})],-1)),e("div",Vo,[e("h3",To,q(a.title),1),a.subtitle?(n(),i("p",Mo,q(a.subtitle),1)):d("",!0)]),e("div",Eo,[aa(ae.$slots,"default",{},void 0,!0)]),ae.$slots.footer?(n(),i("div",No,[aa(ae.$slots,"footer",{},void 0,!0)])):d("",!0)])])):d("",!0)]),_:3}))}},pa=Ke(Uo,[["__scopeId","data-v-fd942535"]]),Do={class:"space-y-4"},Po={key:0,class:"mt-2"},Lo={key:1,class:"mt-2"},Ro={key:2,class:"mt-2"},jo={key:3,class:"mt-2"},Bo={key:4,class:"mt-2"},Fo={class:"text-sm font-medium text-gray-700 mb-2"},Oo={key:0,class:"text-red-500"},zo={key:0,class:"text-xs text-red-500"},qo=["type","name","value","checked","onChange"],Ko={key:6,class:"mt-4"},Ho={class:"text-sm font-medium text-gray-700 mb-2"},Go={key:0,class:"text-red-500"},Wo={key:0,class:"text-xs text-red-500"},Yo={key:7,class:"space-y-2"},Zo={key:0,class:"text-red-500"},Jo={key:1,class:"text-xs text-red-500"},Xo={class:"flex gap-2"},Qo=["disabled"],Ot={__name:"RadioOptionModal",props:{show:Boolean,title:String,subtitle:String,name:String,options:{type:Array,default:()=>[]},selectedValue:[String,Array],notesValue:String,imagesValue:{type:Array,default:()=>[]},pointId:[String,Number],inspectionId:[String,Number],showTextarea:{type:Boolean,default:!0},showImageUpload:{type:Boolean,default:!0},selectedPoint:Object,point:Object},emits:["update:selectedValue","update:notesValue","update:imagesValue","close","save","hapus","saveTextarea","saveImage","saveText","saveNumber","saveAccount","saveDate"],setup(a,{emit:ae}){const t=a,C=ae,c=v=>C("hapus",v),$=te(()=>Array.isArray(t.selectedValue)?t.options.find(v=>t.selectedValue.includes(v.value)):t.options.find(v=>v.value===t.selectedValue)),h=te(()=>{if(Array.isArray(t.selectedValue))return t.options.filter(v=>t.selectedValue.includes(v.value));if(t.selectedValue){const v=typeof t.selectedValue=="string"?t.selectedValue.split(",").map(g=>g.trim()):[t.selectedValue];return t.options.filter(g=>v.includes(g.value))}return[]}),S=te(()=>{var v;if(Array.isArray(t.selectedValue))return h.value.some(g=>{var T;return g.multi&&((T=g.settings)==null?void 0:T.show_textarea)});{const g=t.options.find(T=>T.value===t.selectedValue);return(v=g==null?void 0:g.settings)==null?void 0:v.show_textarea}}),I=te(()=>{var v;if(Array.isArray(t.selectedValue))return h.value.some(g=>{var T;return g.multi&&((T=g.settings)==null?void 0:T.show_image_upload)});{const g=t.options.find(T=>T.value===t.selectedValue);return(v=g==null?void 0:g.settings)==null?void 0:v.show_image_upload}}),j=te(()=>{var v;if(Array.isArray(t.selectedValue)){const g=h.value.filter(G=>{var Z;return G.multi&&((Z=G.settings)==null?void 0:Z.show_textarea)});if(g.length===0)return null;const T={...g[0].settings},K=[];g.forEach(G=>{var Z;(Z=G.settings)!=null&&Z.damage_options&&K.push(...G.settings.damage_options)});const E=K.filter((G,Z,O)=>Z===O.findIndex(k=>k.value===G.value));return T.damage_options=E,{...g[0],settings:T}}else{const g=t.options.find(T=>T.value===t.selectedValue);return(v=g==null?void 0:g.settings)!=null&&v.show_textarea?g:null}}),w=te(()=>{var v;if(Array.isArray(t.selectedValue))return h.value.find(g=>{var T;return g.multi&&((T=g.settings)==null?void 0:T.show_image_upload)});{const g=t.options.find(T=>T.value===t.selectedValue);return(v=g==null?void 0:g.settings)!=null&&v.show_image_upload?g:null}});te(()=>h.value.find(v=>{var g;return v.multi&&((g=v.settings)==null?void 0:g.show_textarea)})),te(()=>h.value.find(v=>{var g;return v.multi&&((g=v.settings)==null?void 0:g.show_image_upload)}));const D=v=>Array.isArray(t.selectedValue)?t.selectedValue.includes(v.value):t.selectedValue?(typeof t.selectedValue=="string"?t.selectedValue.split(",").map(T=>T.trim()):[t.selectedValue]).includes(v.value):!1,M=(v,g)=>{let T;if(v.multi){const K=Array.isArray(t.selectedValue)?t.selectedValue:[];g.target.checked?T=[...K,v.value]:T=K.filter(E=>E!==v.value)}else T=v.value;C("update:selectedValue",T)},Q=te(()=>{var g,T,K,E,G,Z,O;if(t.point.input_type==="text"&&(!((g=t.notesValue)!=null&&g.trim())||t.point.settings.min_length&&t.notesValue.length<t.point.settings.min_length||t.point.settings.max_length&&t.notesValue.length>t.point.settings.max_length)||t.point.input_type==="number"&&(!((T=t.notesValue)!=null&&T.trim())||t.point.settings.min&&t.notesValue.length<t.point.settings.min||t.point.settings.max&&t.notesValue.length>t.point.settings.max)||t.point.input_type==="account"&&(!((K=t.notesValue)!=null&&K.trim())||t.point.settings.min_value&&t.notesValue.length<t.point.settings.min_value||t.point.settings.max_value&&t.notesValue.length>t.point.settings.max_value)||t.point.input_type==="date"&&(!((E=t.notesValue)!=null&&E.trim())||t.point.settings.min_date&&t.notesValue.length<t.point.settings.min_date||t.point.settings.max_date&&t.notesValue.length>t.point.settings.max_date))return!1;if(t.point.input_type==="imageTOradio"){if(t.imagesValue.length===0)return!1;const k=t.imagesValue.some(de=>de.status==="error"),B=t.imagesValue.some(de=>de.status==="uploading");if(k||B)return!1}if(t.options.length&&(!t.selectedValue||Array.isArray(t.selectedValue)&&t.selectedValue.length===0))return!1;const v=$.value;if(t.showTextarea&&((G=v==null?void 0:v.settings)!=null&&G.show_textarea)&&(!((Z=t.notesValue)!=null&&Z.trim())||v.settings.min_length&&t.notesValue.length<v.settings.min_length||v.settings.max_length&&t.notesValue.length>v.settings.max_length))return!1;if(t.showImageUpload&&((O=v==null?void 0:v.settings)!=null&&O.show_image_upload)){if(t.imagesValue.length===0||v.settings.max_files&&t.imagesValue.length>v.settings.max_files)return!1;const k=t.imagesValue.some(de=>de.status==="error"),B=t.imagesValue.some(de=>de.status==="uploading");if(k||B)return!1}return!0});return(v,g)=>(n(),De(pa,{show:a.show,title:a.title,subtitle:a.subtitle,onClose:g[17]||(g[17]=T=>v.$emit("close"))},{footer:Fe(()=>[a.selectedPoint?(n(),i("button",{key:0,onClick:g[14]||(g[14]=T=>c(a.pointId)),class:"flex items-center justify-center text-red-600 hover:text-red-800 mb-3"},g[19]||(g[19]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7h6m2-3H7m5 0v3"})],-1),Ue(" Hapus Data ")]))):d("",!0),e("div",Xo,[e("button",{type:"button",onClick:g[15]||(g[15]=T=>v.$emit("close")),class:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),e("button",{type:"button",onClick:g[16]||(g[16]=T=>v.$emit("save")),disabled:!Q.value,class:"flex-1 px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-white hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Simpan ",8,Qo)])]),default:Fe(()=>{var T,K,E,G,Z,O,k,B,de,_,f,s,x,z,ue,Y,W,ie,ge,U,N,R,H,X,se,ve,pe,Me,Ie,be,Ce,$e,ke,Ee,l,b;return[e("div",Do,[a.point.input_type==="text"?(n(),i("div",Po,[Te(ua,{"model-value":a.notesValue,required:(T=a.point.settings)==null?void 0:T.is_required,"min-length":(K=a.point.settings)==null?void 0:K.min_length,"max-length":(E=a.point.settings)==null?void 0:E.max_length,allowSpace:(G=a.point.settings)==null?void 0:G.allow_space,textTransform:(Z=a.point.settings)==null?void 0:Z.text_transform,placeholder:((O=a.point.settings)==null?void 0:O.placeholder)||"Masukan text",error:v.error,"onUpdate:modelValue":g[0]||(g[0]=u=>v.$emit("update:notesValue",u)),onSave:g[1]||(g[1]=u=>v.$emit("saveText",u))},null,8,["model-value","required","min-length","max-length","allowSpace","textTransform","placeholder","error"])])):d("",!0),a.point.input_type==="number"?(n(),i("div",Lo,[Te(ra,{"model-value":a.notesValue,required:(k=a.point.settings)==null?void 0:k.is_required,min:(B=a.point.settings)==null?void 0:B.min,max:(de=a.point.settings)==null?void 0:de.max,step:((_=a.point.settings)==null?void 0:_.step)||1,placeholder:((f=a.point.settings)==null?void 0:f.placeholder)||"Masukan number",error:v.error,"onUpdate:modelValue":g[2]||(g[2]=u=>v.$emit("update:notesValue",u)),onSave:g[3]||(g[3]=u=>v.$emit("saveNumber",u))},null,8,["model-value","required","min","max","step","placeholder","error"])])):d("",!0),a.point.input_type==="account"?(n(),i("div",Ro,[Te(ca,{"model-value":a.notesValue,required:(s=a.point.settings)==null?void 0:s.is_required,placeholder:((x=a.point.settings)==null?void 0:x.placeholder)||"Masukkan nilai",error:v.error,"point-id":a.pointId,settings:a.point.settings,"onUpdate:modelValue":g[4]||(g[4]=u=>v.$emit("update:notesValue",u)),onSave:g[5]||(g[5]=u=>v.$emit("saveAccount",u))},null,8,["model-value","required","placeholder","error","point-id","settings"])])):d("",!0),a.point.input_type==="date"?(n(),i("div",jo,[Te(da,{"model-value":a.notesValue,required:(z=a.point.settings)==null?void 0:z.is_required,"min-date":(ue=a.point.settings)==null?void 0:ue.min_date,"max-date":(Y=a.point.settings)==null?void 0:Y.max_date,error:v.error,"onUpdate:modelValue":g[6]||(g[6]=u=>v.$emit("update:notesValue",u)),onSave:g[7]||(g[7]=u=>v.$emit("saveDate",u))},null,8,["model-value","required","min-date","max-date","error"])])):d("",!0),a.point.input_type==="imageTOradio"?(n(),i("div",Bo,[e("h4",Fo,[(W=a.point.settings)!=null&&W.required?(n(),i("span",Oo,"*")):d("",!0)]),Te(Ft,{"model-value":a.imagesValue,"point-id":a.pointId,point:a.point.inspection_point,"inspection-id":a.inspectionId,settings:a.point.settings,"onUpdate:modelValue":g[8]||(g[8]=u=>v.$emit("update:imagesValue",u)),onSave:g[9]||(g[9]=u=>v.$emit("saveImage",u))},null,8,["model-value","point-id","point","inspection-id","settings"]),(ie=a.point.settings)!=null&&ie.required&&a.imagesValue.length===0?(n(),i("p",zo," Foto wajib diupload ")):d("",!0)])):d("",!0),a.options.length?(n(),i("div",{key:5,class:re(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(n(!0),i(Ne,null,Pe(a.options,(u,P)=>(n(),i("label",{key:P,class:"cursor-pointer"},[e("input",{type:u.multi?"checkbox":"radio",name:u.multi?`checkbox-${a.name}`:a.name,value:u.value,checked:D(u),onChange:L=>M(u,L),class:"hidden peer"},null,40,qo),e("div",{class:re(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":D(u),"border-gray-300 text-gray-700 hover:bg-gray-50":!D(u)}])},q(u.label),3)]))),128))],2)):d("",!0),I.value?(n(),i("div",Ko,[e("h4",Ho,[g[18]||(g[18]=Ue(" Upload Foto ")),(U=(ge=w.value)==null?void 0:ge.settings)!=null&&U.required?(n(),i("span",Go,"*")):d("",!0)]),Te(Ft,{"model-value":a.imagesValue,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,settings:(N=w.value)==null?void 0:N.settings,"onUpdate:modelValue":g[10]||(g[10]=u=>v.$emit("update:imagesValue",u)),onSave:g[11]||(g[11]=u=>v.$emit("saveImage",u))},null,8,["model-value","point-id","point","inspection-id","settings"]),(H=(R=w.value)==null?void 0:R.settings)!=null&&H.required&&a.imagesValue.length===0?(n(),i("p",Wo," Foto wajib diupload ")):d("",!0)])):d("",!0),S.value?(n(),i("div",Yo,[(se=(X=j.value)==null?void 0:X.settings)!=null&&se.required?(n(),i("span",Zo,"*")):d("",!0),Te(ga,{"model-value":a.notesValue,"point-id":a.pointId,"inspection-id":a.inspectionId,settings:(ve=j.value)==null?void 0:ve.settings,required:(Me=(pe=j.value)==null?void 0:pe.settings)==null?void 0:Me.required,"min-length":(be=(Ie=j.value)==null?void 0:Ie.settings)==null?void 0:be.min_length,"max-length":($e=(Ce=j.value)==null?void 0:Ce.settings)==null?void 0:$e.max_length,placeholder:((Ee=(ke=j.value)==null?void 0:ke.settings)==null?void 0:Ee.placeholder)||"Tambahkan keterangan...","onUpdate:modelValue":g[12]||(g[12]=u=>v.$emit("update:notesValue",u)),onSave:g[13]||(g[13]=u=>v.$emit("saveTextarea",u))},null,8,["model-value","point-id","inspection-id","settings","required","min-length","max-length","placeholder"]),(b=(l=j.value)==null?void 0:l.settings)!=null&&b.required&&!a.notesValue?(n(),i("p",Jo," Keterangan wajib diisi ")):d("",!0)])):d("",!0)])]}),_:1},8,["show","title","subtitle"]))}},ei={class:"mt-2 space-y-2"},ti=["type","name","value","checked","onChange","required"],ai={key:0,class:"p-2 rounded-lg bg-gray-50"},si={key:0,class:"mt-2"},ni={class:"flex gap-2 overflow-x-auto",style:{"scrollbar-width":"none"}},oi=["src"],ii={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},li={key:1,class:"mt-2"},ri={class:"text-sm text-gray-600"},ui={key:2,class:"mt-2 text-sm text-red-600"},di={__name:"InputRadio",props:{modelValue:[String,Array],required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(a,{emit:ae}){const t=a,C=ae,c=y(t.notes),$=y([...t.images]),h=y(!1),S=y(""),I=y([]),j=y(""),w=y([]);te(()=>t.options.find(k=>k.value===t.modelValue));const D=te(()=>Array.isArray(t.modelValue)?t.options.filter(k=>t.modelValue.includes(k.value)):t.modelValue?[t.options.find(k=>k.value===t.modelValue)].filter(Boolean):[]),M=k=>Array.isArray(t.modelValue)?t.modelValue.includes(k.value):t.modelValue?(typeof t.modelValue=="string"?t.modelValue.split(",").map(de=>de.trim()):[t.modelValue]).includes(k.value):!1,Q=k=>k.settings&&(k.settings.show_textarea||k.settings.show_image_upload);xe(()=>t.notes,k=>{c.value=k}),xe(()=>t.images,k=>{$.value=[...k]}),xe(()=>t.modelValue,k=>{k?j.value=Array.isArray(k)?[...k]:k:j.value=""});const v=(k,B)=>{let de;if(k.multi){const _=Array.isArray(t.modelValue)?t.modelValue:[];B.target.checked?de=[..._,k.value]:de=_.filter(f=>f!==k.value)}else de=k.value;C("update:modelValue",de),Q(k)?T():C("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:de,notes:"",images:[]})},g=k=>k.preview||(k.image_path?`/${k.image_path}`:k),T=()=>{j.value=t.modelValue,S.value=c.value,I.value=[...$.value],w.value=[...$.value],h.value=!0},K=()=>{S.value="",I.value=[],j.value=Array.isArray(t.modelValue)?[...t.modelValue]:t.modelValue,h.value=!1},E=k=>{I.value=k,$.value=[...k],C("update:images",[...k]),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:t.modelValue,notes:c.value,images:[...k]})},G=k=>{},Z=()=>{j.value!==t.modelValue&&C("update:modelValue",j.value),c.value=S.value,C("update:notes",S.value),$.value=[...I.value],C("update:images",[...I.value]),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:j.value,notes:S.value,images:I.value}),h.value=!1},O=k=>{j.value="",S.value="",I.value=[],c.value="",$.value=[],C("update:modelValue",""),C("update:notes",""),C("update:images",[]),C("hapus",k),h.value=!1};return(k,B)=>{var de;return n(),i("div",ei,[e("div",{class:re(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(n(!0),i(Ne,null,Pe(a.options,(_,f)=>(n(),i("label",{key:f,class:"cursor-pointer"},[e("input",{type:_.multi?"checkbox":"radio",name:_.multi?`checkbox-${a.pointId}`:"radio-"+a.pointId,value:_.value,checked:M(_),onChange:s=>v(_,s),class:"hidden peer",required:a.required&&!_.multi},null,40,ti),e("div",{class:re(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":M(_),"border-gray-300 text-gray-700 hover:bg-gray-50":!M(_)}])},q(_.label),3)]))),128))],2),a.modelValue&&D.value.length>0&&D.value.some(_=>Q(_))?(n(),i("div",ai,[e("div",{class:"flex justify-between items-start"},[B[4]||(B[4]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail : ",-1)),e("button",{onClick:T,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),a.images.length>0&&D.value.some(_=>{var f;return(f=_.settings)==null?void 0:f.show_image_upload})?(n(),i("div",si,[e("div",ni,[(n(!0),i(Ne,null,Pe(a.images,(_,f)=>(n(),i("div",{key:f,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:g(_),class:"w-full h-full object-cover rounded"},null,8,oi),f===3&&a.images.length>4?(n(),i("span",ii," +"+q(a.images.length-4),1)):d("",!0)]))),128))])])):d("",!0),a.notes&&D.value.some(_=>{var f;return(f=_.settings)==null?void 0:f.show_textarea})?(n(),i("div",li,[e("p",ri,q(a.notes),1)])):d("",!0)])):d("",!0),h.value?(n(),De(Ot,{key:(de=a.selectedPoint)==null?void 0:de.id,show:h.value,title:a.pointName||"Detail",subtitle:a.subtitle||"",name:"modal-radio-"+a.pointId,options:a.options,"selected-value":j.value,"notes-value":S.value,"images-value":I.value,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,"selected-point":a.selectedPoint,"onUpdate:selectedValue":B[0]||(B[0]=_=>j.value=_),"onUpdate:notesValue":B[1]||(B[1]=_=>S.value=_),"onUpdate:imagesValue":B[2]||(B[2]=_=>E(_)),onClose:K,onSave:Z,onSaveTextarea:k.handleTextareaSave,onSaveImage:G,onHapus:B[3]||(B[3]=_=>O(a.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point","onSaveTextarea"])):d("",!0),a.error?(n(),i("p",ui,q(a.error),1)):d("",!0)])}}},ci={class:"mt-2 space-y-2"},gi={key:0,class:"flex flex-wrap gap-3"},pi={key:1,class:"p-2"},mi={key:0,class:"mt-2"},vi={class:"flex gap-2 overflow-x-auto scrollbar-hide"},fi=["src"],hi={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},bi=["type","name","value","checked"],yi={key:1,class:"mt-2"},xi={class:"text-sm text-gray-600"},wi={key:3,class:"mt-2 text-sm text-red-600"},ki={__name:"InputImageToRadio",props:{modelValue:[String,Array],required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(a,{emit:ae}){const t=a,C=ae,c=y(t.notes),$=y([...t.images]),h=y(!1),S=y(""),I=y([]),j=y(""),w=y([]),D=te(()=>{if(Array.isArray(t.modelValue))return t.options.find(O=>t.modelValue.includes(O.value));if(t.modelValue){const O=typeof t.modelValue=="string"?t.modelValue.split(",").map(k=>k.trim()):[t.modelValue];return t.options.find(k=>O.includes(k.value))}return null}),M=te(()=>{if(Array.isArray(t.modelValue))return t.options.filter(O=>t.modelValue.includes(O.value));if(t.modelValue){const O=typeof t.modelValue=="string"?t.modelValue.split(",").map(k=>k.trim()):[t.modelValue];return t.options.filter(k=>O.includes(k.value))}return[]}),Q=te(()=>M.value.some(O=>{var k;return O.multi&&((k=O.settings)==null?void 0:k.show_textarea)}));te(()=>M.value.find(O=>{var k;return O.multi&&((k=O.settings)==null?void 0:k.show_textarea)}));const v=O=>Array.isArray(t.modelValue)?t.modelValue.includes(O.value):t.modelValue?(typeof t.modelValue=="string"?t.modelValue.split(",").map(B=>B.trim()):[t.modelValue]).includes(O.value):!1,g=O=>O.preview||(O.image_path?`/${O.image_path}`:O);xe(()=>t.notes,O=>{c.value=O});const T=()=>{j.value=t.modelValue||"",S.value=c.value,I.value=[...$.value],w.value=[...$.value],h.value=!0},K=()=>{S.value="",I.value=[],j.value="",h.value=!1},E=O=>{I.value=O,$.value=[...O],C("update:images",[...O]),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:t.modelValue,notes:c.value,images:[...O]})},G=()=>{j.value!==t.modelValue&&C("update:modelValue",j.value),c.value=S.value,C("update:notes",S.value),$.value=[...I.value],C("update:images",[...I.value]),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:j.value,notes:S.value,images:I.value}),h.value=!1},Z=O=>{j.value="",S.value="",I.value=[],c.value="",$.value=[],C("update:modelValue",""),C("update:notes",""),C("update:images",[]),C("hapus",O),h.value=!1};return(O,k)=>{var B,de,_;return n(),i("div",ci,[!a.modelValue&&$.value.length===0&&!c.value?(n(),i("div",gi,[e("div",{class:"relative w-28 h-28 border-2 border-dashed rounded-lg flex items-center justify-center cursor-pointer overflow-hidden",onClick:T},k[4]||(k[4]=[e("div",{class:"flex flex-col items-center text-gray-400"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs font-medium"},"Tambah")],-1)]))])):(n(),i("div",pi,[e("div",{class:"flex justify-between items-start"},[k[5]||(k[5]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail :",-1)),e("button",{onClick:T,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),$.value.length>0?(n(),i("div",mi,[e("div",vi,[(n(!0),i(Ne,null,Pe($.value,(f,s)=>(n(),i("div",{key:s,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:g(f),class:"w-full h-full object-cover rounded"},null,8,fi),s===3&&$.value.length>4?(n(),i("span",hi," +"+q($.value.length-4),1)):d("",!0)]))),128))])])):d("",!0),e("div",{class:re(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(n(!0),i(Ne,null,Pe(a.options,(f,s)=>(n(),i("label",{key:s,class:"cursor-pointer"},[e("input",{type:f.multi?"checkbox":"radio",name:f.multi?`checkbox-${a.pointId}`:`radio-${a.pointId}`,value:f.value,checked:v(f),disabled:!0,class:"hidden peer"},null,8,bi),e("div",{class:re(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":v(f),"border-gray-300 text-gray-700 hover:bg-gray-50":!v(f)}])},q(f.label),3)]))),128))],2),c.value&&((de=(B=D.value)==null?void 0:B.settings)!=null&&de.show_textarea||Q.value)?(n(),i("div",yi,[e("p",xi,q(c.value),1)])):d("",!0)])),h.value?(n(),De(Ot,{key:(_=a.selectedPoint)==null?void 0:_.id,show:h.value,title:a.pointName||"Detail",subtitle:a.subtitle||"",name:"modal-radio-"+a.pointId,options:a.options,"selected-value":j.value,"notes-value":S.value,"images-value":I.value,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,"selected-point":a.selectedPoint,"onUpdate:selectedValue":k[0]||(k[0]=f=>j.value=f),"onUpdate:notesValue":k[1]||(k[1]=f=>S.value=f),"onUpdate:imagesValue":k[2]||(k[2]=f=>E(f)),onClose:K,onSave:G,onHapus:k[3]||(k[3]=f=>Z(a.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point"])):d("",!0),a.error?(n(),i("p",wi,q(a.error),1)):d("",!0)])}}},Ii={class:"text-base font-semibold text-indigo-700"},_i={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Si={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ci={class:"text-base font-semibold text-indigo-700"},$i={class:"p-4 space-y-4"},Ai={key:0,class:"flex justify-end py-1"},Vi=["onClick"],Ti={key:1,class:"space-y-2"},Mi={class:"flex items-start justify-between"},Ei={class:"flex-1"},Ni={class:"block text-sm font-medium text-gray-900"},Ui={class:"font-bold"},Di={key:0,class:"text-red-500"},Pi={key:1,class:"italic text-xs text-gray-400 ml-2"},Li={key:0,class:"mt-1"},Ri={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800"},ji={key:0},Bi={key:1},Fi={key:2},Oi={key:3},zi={key:4},qi={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"},Ki={key:9,class:"p-3 bg-gray-100 rounded text-sm text-gray-600"},Hi={class:"text-xs mt-1 list-disc list-inside"},Gi={key:0},Wi={key:1},Yi={key:2},Zi={key:3},Ji={key:4},Xi={key:0,class:"text-center py-8 text-gray-500"},Qi={key:0,class:"text-xs text-gray-400"},el={__name:"CategorySection",props:{category:Object,form:Object,head:Object,inspectionId:String,selectedPoint:Object,car:Object},emits:["updateResult","removeImage","hapusPoint"],setup(a,{emit:ae}){const t=a,C=ae,c=Lt("vehicleFeatures",y(null));c.value=JSON.parse(localStorage.getItem("vehicle_features")||"{}"),Dt("vehicleFeatures",c);const $=y(!1),h=y([]),S=y(!0),I=y(null),j=xa(),w={MT:"Manual Transmission (MT)",AT:"Automatic Transmission (AT)",CVT:"Continuously Variable Transmission (CVT)","e-CVT":"Electronic CVT (e-CVT)",DCT:"Dual Clutch Transmission (DCT)",AMT:"Automated Manual Transmission (AMT)",IVT:"Intelligent Variable Transmission (IVT)",SSG:"Seamless Shift Gearbox (SSG)",AGS:"Auto Gear Shift (AGS)",DHT:"Dedicated Hybrid Transmission (DHT)"};st(()=>{const _=new IntersectionObserver(([f])=>{S.value=f.isIntersecting},{threshold:.1});I.value&&_.observe(I.value),wt(()=>{I.value&&_.unobserve(I.value)})});const D=()=>{$.value=!$.value,$.value||(h.value=[])},M=te(()=>(t.category.points||[]).some(_=>_.is_default===!1)),Q=_=>!_||!Array.isArray(_)?[]:_.map(f=>w[f]||f),v=_=>{var z,ue;const f=_.settings;if(!g(_))return!0;const s=(z=t.car)==null?void 0:z.transmission,x=(ue=t.car)==null?void 0:ue.fuel_type;return!(f.transmission&&Array.isArray(f.transmission)&&f.transmission.length>0&&s&&!f.transmission.includes(s)||f.fuel_type&&f.fuel_type.trim()!==""&&x&&f.fuel_type!==x||f.rear_door&&(!c.value||!c.value.rear_door)||f.pick_up&&(!c.value||!c.value.pick_up)||f.box&&(!c.value||!c.value.box))},g=_=>{const f=_.settings;return!!(f!=null&&f.transmission&&Array.isArray(f.transmission)&&f.transmission.length>0||f!=null&&f.fuel_type&&f.fuel_type.trim()!==""||f!=null&&f.rear_door||f!=null&&f.pick_up||f!=null&&f.box)},T=_=>g(_)&&($.value||v(_)),K=te(()=>{const _=t.category.points||[],f=[];let s=[];return $.value?t.category.isDamageMenu?_.filter(x=>{var z;return x.is_default||G((z=x.inspection_point)==null?void 0:z.id)||$.value}):_:t.category.isDamageMenu?_.filter(x=>{var ue;const z=(ue=x.inspection_point)==null?void 0:ue.id;return G(z)||x.is_default||h.value.includes(z)}):(_.forEach(x=>{var U;const z=(U=x.inspection_point)==null?void 0:U.id,ue=G(z),Y=h.value.includes(z),ie=!g(x)||v(x);(x.is_default||ue||Y)&&ie?(s.length>0&&(f.push({is_link:!0,count:s.length,hiddenIds:s.map(N=>N.inspection_point.id)}),s.forEach(N=>{h.value.includes(N.inspection_point.id)&&f.push(N)}),s=[]),f.push(x)):(!g(x)||v(x))&&s.push(x)}),s.length>0&&(f.push({is_link:!0,count:s.length,hiddenIds:s.map(x=>x.inspection_point.id)}),s.forEach(x=>{h.value.includes(x.inspection_point.id)&&f.push(x)})),f.filter(x=>{var z,ue;return x.is_link||x.is_default||G((z=x.inspection_point)==null?void 0:z.id)||h.value.includes((ue=x.inspection_point)==null?void 0:ue.id)}))});te(()=>K.value.filter(_=>!_.is_link));const E=_=>{$.value=!1,_.forEach(f=>{h.value.includes(f)||h.value.push(f)})},G=_=>{if(!_)return!1;const f=j.props.existingResults[_]!==void 0,s=j.props.existingImages[_]&&j.props.existingImages[_].length>0,x=t.form.results[_]&&(t.form.results[_].status||t.form.results[_].note),z=t.form.images[_]&&t.form.images[_].length>0;return f||s||x||z},Z=[{value:"good",label:"Good"},{value:"bad",label:"Bad"},{value:"na",label:"N/A"}],O=_=>{var x,z,ue,Y,W,ie,ge,U,N;const f=t.form.results[(x=_.inspection_point)==null?void 0:x.id],s=t.form.images[(z=_.inspection_point)==null?void 0:z.id];if(!f)return!1;switch(_.input_type){case"text":case"number":case"date":case"account":case"textarea":return!!f.note;case"select":case"radio":if(!f.status)return!1;const R=(Y=(ue=_.settings)==null?void 0:ue.radios)==null?void 0:Y.find(X=>X.value===f.status);return!(R!=null&&R.settings&&(R.settings.show_textarea&&!((W=f.note)!=null&&W.trim())||R.settings.show_image_upload&&(s==null?void 0:s.length)===0));case"imageTOradio":if((s==null?void 0:s.length)===0||!f.status)return!1;const H=(ge=(ie=_.settings)==null?void 0:ie.radios)==null?void 0:ge.find(X=>X.value===f.status);return!(H!=null&&H.settings&&H.settings.show_textarea&&!((U=f.note)!=null&&U.trim()));case"image":return(s==null?void 0:s.length)>0;default:return!!f.status||!!((N=f.note)!=null&&N.trim())}},k=(_,f,s)=>{C("updateResult",{pointId:_,type:s,value:f})},B=_=>{console.log("Save result for point:",_)},de=_=>{C("hapusPoint",_)};return xe(()=>t.form.results,_=>{},{deep:!0}),xe(()=>t.form.images,_=>{},{deep:!0}),xe(()=>t.car,_=>{console.log("Car data updated:",_)},{deep:!0}),xe(c,_=>{console.log("Vehicle features updated:",_)},{deep:!0}),(_,f)=>(n(),i(Ne,null,[t.head==="vertical"?(n(),i("div",{key:0,class:re(["px-6 py-2 border-b flex items-center justify-between bg-indigo-200","fixed top-0 left-0 right-0 z-20"])},[e("h4",Ii,q(a.category.name),1),M.value?(n(),i("button",{key:0,onClick:D,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},q($.value?"Sembunyikan Semua":"Tampilkan Point Lain"),1)):d("",!0)])):d("",!0),e("div",{class:re(["bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100",t.head==="vertical"?"pt-6":""])},[!S.value&&M.value?(n(),i("button",{key:0,onClick:D,class:"fixed top-3 right-2 z-10 bg-indigo-600 text-white p-2 rounded-full shadow-lg"},[$.value?(n(),i("svg",_i,f[0]||(f[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(n(),i("svg",Si,f[1]||(f[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.006-3.362M9.88 9.88a3 3 0 104.24 4.24M6.1 6.1l11.8 11.8"},null,-1)])))])):d("",!0),t.head==="horizontal"?(n(),i("div",{key:1,ref_key:"categoryHeader",ref:I,class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",Ci,q(a.category.name),1),M.value?(n(),i("button",{key:0,onClick:D,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},q($.value?"Sembunyikan":"Tampilkan Point Lain"),1)):d("",!0)],512)):d("",!0),e("div",$i,[(n(!0),i(Ne,null,Pe(K.value,(s,x)=>{var z,ue,Y,W,ie,ge,U,N,R,H,X,se,ve,pe,Me,Ie,be,Ce,$e,ke,Ee,l,b,u,P,L,he,me,fe,p,m,ne,A,oe,Ae,Ve,_e,He,pt,kt,Ze,mt,vt,ft,It,nt,ht,bt,ot,je,Ge,Oe,it,_t,lt,Je,rt,Xe,Qe,St,Ct,$t,et,At,Vt,Tt,Mt,Et,Nt;return n(),i("div",{key:x,class:re(["space-y-2 last:border-0 last:pb-0",s.is_link?"pb-0":"pb-2 border-b border-gray-100"])},[s.is_link?(n(),i("div",Ai,[e("button",{onClick:J=>E(s.hiddenIds),class:"text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline focus:outline-none"}," Tampilkan "+q(s.count)+" Point Tersembunyi ",9,Vi)])):(n(),i("div",Ti,[e("div",Mi,[e("div",Ei,[e("label",Ni,[e("span",Ui,q((z=s.inspection_point)==null?void 0:z.name),1),(ue=s.settings)!=null&&ue.is_required?(n(),i("span",Di,"*")):d("",!0),!s.is_default&&!G((Y=s.inspection_point)==null?void 0:Y.id)?(n(),i("span",Pi," (opsional) ")):d("",!0)]),T(s)?(n(),i("div",Li,[g(s)?(n(),i("div",Ri,[(W=s.settings)!=null&&W.transmission?(n(),i("div",ji,q(s.settings.transmission.join(", ")),1)):d("",!0),(ie=s.settings)!=null&&ie.fuel_type?(n(),i("div",Bi,q(s.settings.fuel_type),1)):d("",!0),(ge=s.settings)!=null&&ge.rear_door?(n(),i("div",Fi," Pintu Belakang ")):d("",!0),(U=s.settings)!=null&&U.pick_up?(n(),i("div",Oi," Tipe Pick Up ")):d("",!0),(N=s.settings)!=null&&N.box?(n(),i("div",zi," Memiliki Box ")):d("",!0)])):d("",!0)])):d("",!0)]),O(s)?(n(),i("span",qi," ✓ ")):d("",!0)]),s.input_type==="text"&&v(s)?(n(),De(ua,{key:0,modelValue:a.form.results[(R=s.inspection_point)==null?void 0:R.id].note,"onUpdate:modelValue":[J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].note=J},J=>{var V;return k((V=s.inspection_point)==null?void 0:V.id,J,"note")}],required:(H=s.settings)==null?void 0:H.is_required,"min-length":(X=s.settings)==null?void 0:X.min_length,"max-length":(se=s.settings)==null?void 0:se.max_length,allowSpace:(ve=s.settings)==null?void 0:ve.allow_space,textTransform:(pe=s.settings)==null?void 0:pe.text_transform,placeholder:((Me=s.settings)==null?void 0:Me.placeholder)||"Masukan text",error:a.form.errors[`results.${(Ie=s.inspection_point)==null?void 0:Ie.id}.note`],onSave:J=>{var V;return B((V=s.inspection_point)==null?void 0:V.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","allowSpace","textTransform","placeholder","error","onSave"])):d("",!0),s.input_type==="number"&&v(s)?(n(),De(ra,{key:1,modelValue:a.form.results[(be=s.inspection_point)==null?void 0:be.id].note,"onUpdate:modelValue":[J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].note=J},J=>{var V;return k((V=s.inspection_point)==null?void 0:V.id,J,"note")}],required:(Ce=s.settings)==null?void 0:Ce.is_required,min:($e=s.settings)==null?void 0:$e.min,max:(ke=s.settings)==null?void 0:ke.max,step:((Ee=s.settings)==null?void 0:Ee.step)||1,placeholder:((l=s.settings)==null?void 0:l.placeholder)||"Masukan number",error:a.form.errors[`results.${(b=s.inspection_point)==null?void 0:b.id}.note`],onSave:J=>{var V;return B((V=s.inspection_point)==null?void 0:V.id)}},null,8,["modelValue","onUpdate:modelValue","required","min","max","step","placeholder","error","onSave"])):d("",!0),s.input_type==="account"&&v(s)?(n(),De(ca,{key:2,modelValue:a.form.results[(u=s.inspection_point)==null?void 0:u.id].note,"onUpdate:modelValue":[J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].note=J},J=>{var V;return k((V=s.inspection_point)==null?void 0:V.id,J,"note")}],required:(P=s.settings)==null?void 0:P.is_required,placeholder:((L=s.settings)==null?void 0:L.placeholder)||"Masukkan nilai",error:a.form.errors[`results.${(he=s.inspection_point)==null?void 0:he.id}.note`],"point-id":(me=s.inspection_point)==null?void 0:me.id,settings:s.settings,onSave:J=>{var V;return B((V=s.inspection_point)==null?void 0:V.id)}},null,8,["modelValue","onUpdate:modelValue","required","placeholder","error","point-id","settings","onSave"])):d("",!0),s.input_type==="date"&&v(s)?(n(),De(da,{key:3,modelValue:a.form.results[(fe=s.inspection_point)==null?void 0:fe.id].note,"onUpdate:modelValue":[J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].note=J},J=>{var V;return k((V=s.inspection_point)==null?void 0:V.id,J,"note")}],required:(p=s.settings)==null?void 0:p.is_required,"min-date":(m=s.settings)==null?void 0:m.min_date,"max-date":(ne=s.settings)==null?void 0:ne.max_date,error:a.form.errors[`results.${(A=s.inspection_point)==null?void 0:A.id}.note`],onSave:J=>{var V;return B((V=s.inspection_point)==null?void 0:V.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-date","max-date","error","onSave"])):d("",!0),s.input_type==="textarea"&&v(s)?(n(),De(ga,{key:4,modelValue:a.form.results[(oe=s.inspection_point)==null?void 0:oe.id].note,"onUpdate:modelValue":[J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].note=J},J=>{var V;return k((V=s.inspection_point)==null?void 0:V.id,J,"note")}],required:(Ae=s.settings)==null?void 0:Ae.is_required,"min-length":(Ve=s.settings)==null?void 0:Ve.min_length,"max-length":(_e=s.settings)==null?void 0:_e.max_length,placeholder:((He=s.settings)==null?void 0:He.placeholder)||"Masukkan teks di sini",settings:s.settings,error:a.form.errors[`results.${(pt=s.inspection_point)==null?void 0:pt.id}.note`],onSave:J=>{var V;return B((V=s.inspection_point)==null?void 0:V.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","placeholder","settings","error","onSave"])):d("",!0),s.input_type==="radio"&&v(s)?(n(),De(di,{key:5,modelValue:a.form.results[(kt=s.inspection_point)==null?void 0:kt.id].status,"onUpdate:modelValue":[J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].status=J},J=>{var V;return k((V=s.inspection_point)==null?void 0:V.id,J,"status")}],notes:a.form.results[(Ze=s.inspection_point)==null?void 0:Ze.id].note,images:a.form.images[(mt=s.inspection_point)==null?void 0:mt.id],required:(vt=s.settings)==null?void 0:vt.is_required,"point-id":(ft=s.inspection_point)==null?void 0:ft.id,point:s.inspection_point,"inspection-id":a.inspectionId,settings:s.settings,"point-name":(It=s.inspection_point)==null?void 0:It.name,subtitle:(nt=s.inspection_point)==null?void 0:nt.description,"selected-point":s.inspection_point??null,options:((ht=s.settings)==null?void 0:ht.radios)||Z,error:a.form.errors[`results.${(bt=s.inspection_point)==null?void 0:bt.id}.status`],"onUpdate:notes":J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].note=J},"onUpdate:images":J=>{var V;return a.form.images[(V=s.inspection_point)==null?void 0:V.id]=J},onSave:J=>{var V;return B((V=s.inspection_point)==null?void 0:V.id)},onHapus:J=>{var V;return de((V=s.inspection_point)==null?void 0:V.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","point","inspection-id","settings","point-name","subtitle","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):d("",!0),s.input_type==="imageTOradio"&&v(s)?(n(),De(ki,{key:6,modelValue:a.form.results[(ot=s.inspection_point)==null?void 0:ot.id].status,"onUpdate:modelValue":[J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].status=J},J=>{var V;return k((V=s.inspection_point)==null?void 0:V.id,J,"status")}],notes:a.form.results[(je=s.inspection_point)==null?void 0:je.id].note,images:a.form.images[(Ge=s.inspection_point)==null?void 0:Ge.id],required:(Oe=s.settings)==null?void 0:Oe.is_required,"point-id":(it=s.inspection_point)==null?void 0:it.id,"inspection-id":a.inspectionId,settings:s.settings,"point-name":(_t=s.inspection_point)==null?void 0:_t.name,subtitle:(lt=s.inspection_point)==null?void 0:lt.description,point:s,"selected-point":s.inspection_point??null,options:((Je=s.settings)==null?void 0:Je.radios)||Z,error:a.form.errors[`results.${(rt=s.inspection_point)==null?void 0:rt.id}.status`],"onUpdate:notes":J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].note=J},"onUpdate:images":J=>{var V;return a.form.images[(V=s.inspection_point)==null?void 0:V.id]=J},onSave:J=>{var V;return B((V=s.inspection_point)==null?void 0:V.id)},onHapus:J=>{var V;return de((V=s.inspection_point)==null?void 0:V.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","inspection-id","settings","point-name","subtitle","point","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):d("",!0),s.input_type==="image"&&v(s)?(n(),De(Ft,{key:7,modelValue:a.form.images[(Xe=s.inspection_point)==null?void 0:Xe.id],"onUpdate:modelValue":J=>{var V;return a.form.images[(V=s.inspection_point)==null?void 0:V.id]=J},error:a.form.errors[`images.${(Qe=s.inspection_point)==null?void 0:Qe.id}`],"inspection-id":a.inspectionId,"point-id":(St=s.inspection_point)==null?void 0:St.id,point:s.inspection_point,"point-name":(Ct=s.inspection_point)==null?void 0:Ct.name,settings:s.settings,"onUpdate:notes":J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].note=J},"onUpdate:status":J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].status=J}},null,8,["modelValue","onUpdate:modelValue","error","inspection-id","point-id","point","point-name","settings","onUpdate:notes","onUpdate:status"])):d("",!0),s.input_type==="select"&&v(s)?(n(),De(js,{key:8,modelValue:a.form.results[($t=s.inspection_point)==null?void 0:$t.id].status,"onUpdate:modelValue":[J=>{var V;return a.form.results[(V=s.inspection_point)==null?void 0:V.id].status=J},J=>{var V;return k((V=s.inspection_point)==null?void 0:V.id,J,"status")}],required:(et=s.settings)==null?void 0:et.is_required,error:a.form.errors[`results.${(At=s.inspection_point)==null?void 0:At.id}.status`],onSave:J=>{var V;return B((V=s.inspection_point)==null?void 0:V.id)}},null,8,["modelValue","onUpdate:modelValue","required","error","onSave"])):d("",!0),!v(s)&&g(s)?(n(),i("div",Ki,[f[2]||(f[2]=e("p",{class:"font-medium"},"Tidak tersedia untuk kendaraan ini",-1)),f[3]||(f[3]=e("p",{class:"text-xs mt-1"},"Point ini hanya tersedia untuk:",-1)),e("ul",Hi,[(Vt=s.settings)!=null&&Vt.transmission?(n(),i("li",Gi," Transmisi: "+q(Q(s.settings.transmission).join(", ")),1)):d("",!0),(Tt=s.settings)!=null&&Tt.fuel_type?(n(),i("li",Wi," Bahan bakar: "+q(s.settings.fuel_type),1)):d("",!0),(Mt=s.settings)!=null&&Mt.rear_door?(n(),i("li",Yi,"Kendaraan dengan pintu belakang")):d("",!0),(Et=s.settings)!=null&&Et.pick_up?(n(),i("li",Zi,"Tipe pick up")):d("",!0),(Nt=s.settings)!=null&&Nt.box?(n(),i("li",Ji,"Kendaraan dengan box")):d("",!0)])])):d("",!0)]))],2)}),128)),K.value.filter(s=>!s.is_link).length===0?(n(),i("div",Xi,[f[4]||(f[4]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),f[5]||(f[5]=e("p",{class:"mt-2 text-sm"},"Tidak ada data untuk ditampilkan",-1)),a.category.isDamageMenu?(n(),i("p",Qi,' Tambahkan data melalui tombol "+" di pojok kanan bawah ')):d("",!0)])):d("",!0)])],2)],64))}},tl=Ke(el,[["__scopeId","data-v-704b9892"]]),al={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},sl={class:"p-4 space-y-4-6"},nl={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},ol=["value"],il={class:"p-4 space-y-4-6"},ll={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},rl=["value"],ul={key:0,class:"p-4 space-y-4 bg-blue-50 rounded-lg border border-blue-200"},dl={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},cl=["value"],gl={class:"p-4 space-y-2"},pl={class:"flex items-center justify-between mb-2"},ml={key:0,class:"mb-4 p-4 bg-white border border-gray-200 rounded-lg shadow-lg"},vl={class:"flex items-center justify-between mb-3"},fl={class:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-60 overflow-y-auto"},hl=["onClick"],bl={class:"text-sm font-medium text-gray-800 mb-1"},yl={class:"text-xs text-gray-600 line-clamp-2"},xl={class:"flex flex-wrap gap-1 mb-2 p-2 bg-gray-100 rounded-md"},wl={key:0,class:"text-xs text-gray-500 mb-2 bg-gray-50 p-2 rounded border"},kl={key:0,class:"font-bold mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Il={key:1,class:"italic mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},_l={key:2,class:"underline mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Sl={__name:"ConclusionSection",props:{inspectionId:{type:Number,required:!0},inspection:{type:Object,required:!0},form:{type:Object,required:!0}},emits:["updateConclusion"],setup(a,{emit:ae}){const t=a,C=ae,c=y(null),$=y(!1),h=y(!1),S=sa({bold:!1,italic:!1,underline:!1}),I=sa({flooded:"",collision:"",collision_severity:"",notes:""}),j=y([{id:1,name:"Kendaraan Normal",description:"Template untuk kendaraan dalam kondisi normal tanpa masalah signifikan (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi kendaraan secara umum: <b>BAIK</b><br>
- Tidak ditemukan indikasi kerusakan signifikan<br>
- Semua sistem berfungsi dengan normal<br>`},{id:2,name:"Kendaraan Bekas Tabrakan Ringan",description:"Template untuk kendaraan dengan riwayat tabrakan ringan (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat tabrakan dengan tingkat kerusakan: <b>RINGAN</b><br>
- Area yang terdampak: PERLU DIISI<br>
- Perbaikan yang dilakukan: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`},{id:3,name:"Kendaraan Bekas Banjir",description:"Template untuk kendaraan dengan riwayat terkena banjir (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat terkena banjir<br>
- Tingkat paparan air: PERLU DIISI<br>
- Komponen yang terdampak: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`},{id:4,name:"Kendaraan dengan Multiple Issues",description:"Template untuk kendaraan dengan beberapa masalah umum (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi umum kendaraan: PERLU DIISI<br>
- Masalah utama yang ditemukan: PERLU DIISI<br>
- Komponen yang perlu perhatian: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`},{id:5,name:"Template Singkat",description:"Template ringkas untuk kesimpulan cepat (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Status Keseluruhan Kendaraan: PERLU DIISI<br>
- Catatan Utama: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI`},{id:6,name:"Template Teknis Detail",description:"Template detail untuk laporan teknis lengkap (Lengkap A, C, B)",content:`<p><strong>A. LAPORAN HASIL INSPEKSI TEKNIS:</strong></p>
- Tanggal Inspeksi: PERLU DIISI<br>
- Kondisi Mesin: PERLU DIISI<br>
- Kondisi Transmisi: PERLU DIISI<br>
- Kondisi Suspensi: PERLU DIISI<br>
- Kondisi Rem: PERLU DIISI<br>
- Kondisi Body: PERLU DIISI<br>
- Kondisi Interior: PERLU DIISI<br>
- Kesimpulan Akhir: PERLU DIISI

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`}]);y(["{PLATE_NUMBER}","{CAR_NAME}","{INSPECTION_DATE}","{DAMAGED_AREA}","{REPAIR_DETAILS}","{WATER_LEVEL}","{AFFECTED_COMPONENTS}","{OVERALL_CONDITION}","{MAIN_ISSUES}","{ATTENTION_NEEDED}","{REPAIR_COST_ESTIMATE}","{RECOMMENDATION}","{OVERALL_STATUS}","{ADDITIONAL_NOTES}","{ENGINE_CONDITION}","{TRANSMISSION_CONDITION}","{SUSPENSION_CONDITION}","{BRAKE_CONDITION}","{BODY_CONDITION}","{INTERIOR_CONDITION}","{FINAL_CONCLUSION}"]);const w=s=>{if(!s)return{};if(typeof s=="string")try{return JSON.parse(s)||{}}catch(x){return console.error("Error parsing settings JSON:",x),{}}return typeof s=="object"&&s!==null?s:{}};te(()=>w(t.inspection.settings).conclusion||{});const D=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],M=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],Q=[{value:"light",label:"Ringan"},{value:"heavy",label:"Berat"}];st(()=>{g(),Pt(()=>{v(),E()})});const v=()=>{c.value&&I.notes&&(c.value.innerHTML=I.notes)},g=()=>{const x=w(t.inspection.settings).conclusion||{},z=t.form.conclusion||{};I.flooded=z.flooded||x.flooded||"",I.collision=z.collision||x.collision||"",I.collision_severity=z.collision_severity||x.collision_severity||"",I.notes=z.notes||t.inspection.notes||""},T=s=>{if(!c.value)return;let x=s.content;x=x.replace(/{PLATE_NUMBER}/g,t.inspection.plate_number||"[NOMOR_PLAT]").replace(/{CAR_NAME}/g,t.inspection.car_name||"[NAMA_MOBIL]").replace(/{INSPECTION_DATE}/g,new Date().toLocaleDateString("id-ID")).replace(/{FLOOD_STATUS}/g,I.flooded==="yes"?"Pernah terkena banjir":"Tidak pernah terkena banjir").replace(/{COLLISION_STATUS}/g,I.collision==="yes"?"Pernah mengalami tabrakan":"Tidak pernah mengalami tabrakan"),c.value.innerHTML=x,I.notes=x,h.value=!1,Pt(()=>{c.value.focus(),f()})},K=()=>{c.value&&(c.value.innerHTML="",I.notes="",f())},E=()=>{if(!c.value)return;const s=window.getSelection();s.rangeCount===0||s.isCollapsed||(S.bold=document.queryCommandState("bold"),S.italic=document.queryCommandState("italic"),S.underline=document.queryCommandState("underline"))},G=s=>{if(!c.value)return;c.value.focus();const x=S[s];switch(s){case"bold":document.execCommand("bold",!1,!x);break;case"italic":document.execCommand("italic",!1,!x);break;case"underline":document.execCommand("underline",!1,!x);break}setTimeout(()=>{E(),Z()},10)},Z=la.debounce(()=>{c.value&&(I.notes=c.value.innerHTML,f())},200),O=s=>{s.preventDefault(),document.execCommand("insertParagraph",!1,null)},k=s=>{s.preventDefault();const x=(s.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,x)},B=()=>{$.value=!0},de=()=>{$.value=!1,c.value&&(I.notes=c.value.innerHTML,f())},_=()=>{f()},f=()=>{const s={flooded:I.flooded,collision:I.collision,collision_severity:I.collision==="yes"?I.collision_severity:null,notes:I.notes};C("updateConclusion",s)};return xe(()=>t.form.conclusion,s=>{s&&(I.flooded=s.flooded!==void 0?s.flooded:I.flooded,I.collision=s.collision!==void 0?s.collision:I.collision,I.collision_severity=s.collision_severity!==void 0?s.collision_severity:I.collision_severity,I.notes=s.notes!==void 0?s.notes:I.notes,c.value&&s.notes!==void 0&&c.value.innerHTML!==s.notes&&(c.value.innerHTML=s.notes))},{deep:!0,immediate:!0}),xe([()=>I.flooded,()=>I.collision,()=>I.collision_severity,()=>I.notes],()=>{f()},{deep:!0}),(s,x)=>(n(),i("div",al,[x[21]||(x[21]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),e("div",sl,[x[10]||(x[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[Ue(" Apakah kendaraan pernah terkena banjir? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",nl,[(n(),i(Ne,null,Pe(D,z=>e("label",{key:z.value,class:"cursor-pointer"},[Le(e("input",{type:"radio","onUpdate:modelValue":x[0]||(x[0]=ue=>I.flooded=ue),value:z.value,class:"hidden peer",onChange:_},null,40,ol),[[at,I.flooded]]),e("div",{class:re(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":I.flooded===z.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":I.flooded!==z.value}])},q(z.label),3)])),64))])]),e("div",il,[x[12]||(x[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[Ue(" Apakah kendaraan pernah mengalami tabrakan? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",ll,[(n(),i(Ne,null,Pe(M,z=>e("label",{key:z.value,class:"cursor-pointer"},[Le(e("input",{type:"radio","onUpdate:modelValue":x[1]||(x[1]=ue=>I.collision=ue),value:z.value,class:"hidden peer",onChange:_},null,40,rl),[[at,I.collision]]),e("div",{class:re(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":I.collision===z.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":I.collision!==z.value}])},q(z.label),3)])),64))]),Te(gt,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform -translate-y-2","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-2"},{default:Fe(()=>[I.collision==="yes"?(n(),i("div",ul,[x[11]||(x[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[Ue("Tingkat kerusakan: "),e("span",{class:"text-red-500"},"*")],-1)),e("div",dl,[(n(),i(Ne,null,Pe(Q,z=>e("label",{key:z.value,class:"cursor-pointer"},[Le(e("input",{type:"radio","onUpdate:modelValue":x[2]||(x[2]=ue=>I.collision_severity=ue),value:z.value,class:"hidden peer",onChange:_},null,40,cl),[[at,I.collision_severity]]),e("div",{class:re(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-blue-500 bg-blue-100 text-blue-700 shadow-sm scale-[0.98]":I.collision_severity===z.value,"border-gray-300 text-gray-700 hover:bg-white hover:border-gray-400":I.collision_severity!==z.value}])},q(z.label),3)])),64))])])):d("",!0)]),_:1})]),e("div",gl,[e("div",pl,[x[14]||(x[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Catatan Kesimpulan",-1)),e("button",{type:"button",onClick:x[3]||(x[3]=z=>h.value=!h.value),class:"flex items-center gap-2 px-3 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all duration-200"},x[13]||(x[13]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),Ue(" Template ")]))]),Te(gt,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:Fe(()=>[h.value?(n(),i("div",ml,[e("div",vl,[x[16]||(x[16]=e("h5",{class:"text-sm font-semibold text-gray-700"},"Pilih Template Kesimpulan",-1)),e("button",{onClick:x[4]||(x[4]=z=>h.value=!1),class:"text-gray-400 hover:text-gray-600"},x[15]||(x[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",fl,[(n(!0),i(Ne,null,Pe(j.value,z=>(n(),i("button",{key:z.id,onClick:ue=>T(z),class:"p-3 text-left border border-gray-200 rounded-lg hover:border-indigo-300 hover:bg-indigo-50 transition-all duration-150"},[e("div",bl,q(z.name),1),e("div",yl,q(z.description),1)],8,hl))),128))])])):d("",!0)]),_:1}),e("div",xl,[e("button",{type:"button",onClick:x[5]||(x[5]=z=>G("bold")),class:re(["p-2 rounded transition-all duration-150 ease-in-out font-medium",S.bold?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Bold"},x[17]||(x[17]=[e("strong",null,"B",-1)]),2),e("button",{type:"button",onClick:x[6]||(x[6]=z=>G("italic")),class:re(["p-2 rounded transition-all duration-150 ease-in-out font-medium",S.italic?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Italic"},x[18]||(x[18]=[e("em",null,"I",-1)]),2),e("button",{type:"button",onClick:x[7]||(x[7]=z=>G("underline")),class:re(["p-2 rounded transition-all duration-150 ease-in-out font-medium",S.underline?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Underline"},x[19]||(x[19]=[e("u",null,"U",-1)]),2),e("button",{type:"button",onClick:x[8]||(x[8]=z=>K()),class:"p-2 rounded transition-all duration-150 ease-in-out hover:bg-gray-200 hover:shadow-sm ml-2",title:"Clear Template"}," 🗑️ Clear ")]),Te(gt,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform -translate-y-1","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-1"},{default:Fe(()=>[Object.values(S).some(z=>z)?(n(),i("div",wl,[x[20]||(x[20]=Ue(" Format aktif: ")),S.bold?(n(),i("span",kl,"Bold")):d("",!0),S.italic?(n(),i("span",Il,"Italic")):d("",!0),S.underline?(n(),i("span",_l,"Underline")):d("",!0)])):d("",!0)]),_:1}),e("div",{ref_key:"editorRef",ref:c,contenteditable:"true",class:re(["w-full min-h-[120px] p-3 rounded-md border border-gray-300 shadow-sm transition-all duration-200 ease-in-out prose max-w-none",{"bg-white border-gray-300":!$.value,"bg-blue-50 border-indigo-500 ring-2 ring-indigo-200":$.value}]),onInput:x[9]||(x[9]=(...z)=>ee(Z)&&ee(Z)(...z)),onBlur:de,onFocus:B,onKeydown:wa(O,["enter"]),onPaste:k,onMouseup:E,onKeyup:E,placeholder:"Tambahkan catatan kesimpulan inspeksi di sini..."},null,34)])]))}},Cl=Ke(Sl,[["__scopeId","data-v-6b429a8f"]]);function na(a,ae){const t=y({x:ae.x,y:ae.y}),C=y(!1),c=y(null),$=y(!1),h=y({x:0,y:0});st(()=>{const M=localStorage.getItem(a);if(M)try{t.value=JSON.parse(M)}catch(Q){console.error("Error parsing saved position:",Q)}});const S=M=>{M.type.includes("touch")?(h.value.x=M.touches[0].clientX,h.value.y=M.touches[0].clientY):(h.value.x=M.clientX,h.value.y=M.clientY),c.value=setTimeout(()=>{$.value=!0,C.value=!0,console.log("Long press activated - drag mode ON")},900)},I=()=>{c.value&&(clearTimeout(c.value),c.value=null),$.value=!1};return{pos:t,dragging:C,startLongPress:S,cancelLongPress:I,onDrag:M=>{if(!C.value||!$.value)return;M.preventDefault();let Q,v;M.type.includes("touch")?(Q=M.touches[0].clientX,v=M.touches[0].clientY):(Q=M.clientX,v=M.clientY),t.value.x=Q-24,t.value.y=v-24},stopDrag:()=>{if(C.value&&$.value){console.log("Drag stopped - saving position"),C.value=!1,$.value=!1;try{localStorage.setItem(a,JSON.stringify(t.value))}catch(M){console.error("Error saving position:",M)}}I()},handleClick:M=>!C.value&&!$.value?(console.log("Regular click detected"),!0):(console.log("Click ignored - part of drag operation"),!1)}}const $l={class:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100"},Al={key:0,class:"fixed inset-0 bg-black bg-opacity-40 z-30 pointer-events-none transition-opacity duration-200"},Vl={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor","stroke-width":"2"},Tl={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor","stroke-width":"2"},Ml={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},El=["onClick","data-category"],Nl={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},Ul={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},Dl={key:3,class:"fixed inset-0 z-30"},Pl={class:"mt-2 space-y-2"},Ll={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},Rl=["onClick"],jl={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},Bl={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},Fl={key:0,class:"fixed top-4 left-1/2 transform -translate-x-1/2 bg-green-400 text-white px-4 py-2 rounded shadow-lg z-50"},Ol={class:"relative overflow-hidden"},zl={key:"vehicle"},ql={key:"conclusion"},Kl={key:1},Hl=["disabled"],Gl={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Wl={class:"space-y-4"},Yl={class:"relative"},Zl={class:"max-h-64 overflow-y-auto"},Jl={key:0,class:"text-center py-4 text-gray-500"},Xl=["onClick"],Ql={class:"font-medium text-gray-900"},er={class:"text-sm text-gray-500"},tr={class:"text-xs text-gray-400 mt-1"},ar={key:0,class:"text-xs text-green-600 mt-1"},sr={key:3,class:"fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg z-50 text-center"},nr={class:"p-4 space-y-6"},or={class:"flex items-center justify-between"},ir=["aria-checked"],lr={class:"space-y-2"},rr={class:"space-y-2"},ur={class:"space-y-2"},dr={class:"flex space-x-4"},cr={class:"flex items-center"},gr={class:"flex items-center"},pr={key:0,class:"space-y-2"},mr={class:"flex space-x-4"},vr={class:"flex items-center"},fr={class:"flex items-center"},hr={key:1,class:"space-y-2"},br={__name:"IndexLocal",props:{inspection:Object,inspectionId:Object,category:Object,car:Object,appMenus:Array,damagePoints:Array,existingResults:Object,existingImages:Object,CarDetail:Array,allInspections:Array},setup(a){var Kt,Ht,Gt,Wt,Yt,Zt,Jt,Xt,Qt,ea;const ae=r=>{if(!r)return{};if(typeof r=="string")try{return JSON.parse(r)||{}}catch(o){return console.error("Error parsing settings JSON:",o),{}}return typeof r=="object"&&r!==null?r:{}},t=a,C=te(()=>`inspection_data_${t.inspection.id}`),c=te(()=>`swipe_toggle_${t.inspection.id}`),$=te(()=>`image_source_${t.inspection.id}`),h=te(()=>`active_category_${t.inspection.id}`),S=()=>{try{const r=localStorage.getItem(C.value);return r?JSON.parse(r):{}}catch(r){return console.error("Error reading local storage:",r),{}}},I=r=>{try{localStorage.setItem(C.value,JSON.stringify(r))}catch(o){console.error("Error writing to local storage:",o)}},j=()=>{try{localStorage.removeItem(C.value),localStorage.removeItem(c.value),localStorage.removeItem($.value),localStorage.removeItem(h.value)}catch(r){console.error("Error clearing local storage:",r)}},w=()=>{try{const r=localStorage.getItem(c.value);return r?JSON.parse(r):!0}catch(r){return console.error("Error reading swipe toggle state:",r),!0}},D=r=>{try{localStorage.setItem(c.value,JSON.stringify(r))}catch(o){console.error("Error writing swipe toggle state:",o)}},M=()=>{try{return localStorage.getItem($.value)||"all"}catch(r){return console.error("Error reading image source setting:",r),"all"}},Q=r=>{try{localStorage.setItem($.value,r)}catch(o){console.error("Error writing image source setting:",o)}},v=te(()=>`camera_quality_${t.inspection.id}`),g=()=>{try{return localStorage.getItem(v.value)||"HD_Std"}catch(r){return console.error("Error reading camera quality setting:",r),"HD_Std"}},T=r=>{try{localStorage.setItem(v.value,r)}catch(o){console.error("Error writing camera quality setting:",o)}},K=()=>{try{return localStorage.getItem(h.value)||P.value[0]}catch(r){return console.error("Error reading active category:",r),P.value[0]}},E=r=>{try{localStorage.setItem(h.value,r)}catch(o){console.error("Error writing active category:",o)}},G=y(((Ht=(Kt=t.category)==null?void 0:Kt.settings)==null?void 0:Ht.menu_model)||"horizontal"),Z=y(((Wt=(Gt=t.category)==null?void 0:Gt.settings)==null?void 0:Wt.position)||"top"),O=y(!1),k=y(!1),{pos:B,dragging:de,startLongPress:_,cancelLongPress:f,onDrag:s,stopDrag:x,handleClick:z}=na("toggleMenuButtonPos",{x:window.innerWidth-80,y:20}),ue=r=>{z(r)&&Y()},Y=()=>{O.value=!O.value},W=()=>{O.value=!1},ie=r=>r?"bg-gradient-to-r from-indigo-700 to-sky-600 text-white":"bg-gray-50 hover:bg-gray-100 text-gray-700",{pos:ge,dragging:U,startLongPress:N,cancelLongPress:R,onDrag:H,stopDrag:X,handleClick:se}=na("damageButtonPos",{x:window.innerWidth-80,y:window.innerHeight-80}),ve=r=>{se(r)&&(pe.value=!0)},pe=y(!1),Me=y(!1),Ie=y(""),be=y(null),Ce=y(""),$e=y(""),ke=y(""),Ee=y(!1),l=y(null),b=(r,o)=>{Ee.value=!0,l.value=o,Ut.visit(r,{onFinish:()=>{Ee.value=!1,l.value=null}})},u=te(()=>t.appMenus.some(r=>r.input_type==="damage")),P=te(()=>["vehicle",...t.appMenus.map(r=>String(r.id)),"conclusion"]),L=y(P.value[0]),he=y(0),me=te(()=>{if(L.value==="vehicle"||L.value==="conclusion")return null;const r=t.appMenus.find(o=>String(o.id)===L.value);return r?{...r,points:fe(r.menu_point,r.input_type==="damage")}:null}),fe=(r,o)=>o?(r||[]).filter(ce=>{const le=ce.inspection_point_id;return vt(le)}):r||[],p=y({plate_number:t.inspection.plate_number,car_id:t.inspection.car_id,car_name:t.inspection.car_name}),m=y({notes:t.inspection.overall_note||"",flooded:((Zt=(Yt=ae(t.inspection.settings))==null?void 0:Yt.conclusion)==null?void 0:Zt.flooded)||null,collision:((Xt=(Jt=ae(t.inspection.settings))==null?void 0:Jt.conclusion)==null?void 0:Xt.collision)||null,collision_severity:((ea=(Qt=ae(t.inspection.settings))==null?void 0:Qt.conclusion)==null?void 0:ea.collision_severity)||null}),A=oa((()=>{const r=[...t.appMenus.flatMap(We=>We.menu_point||[]),...t.damagePoints||[]],o={},ce={};r.forEach(We=>{const ze=We.inspection_point_id,Be=t.existingResults[ze];o[ze]={status:(Be==null?void 0:Be.status)||"",note:(Be==null?void 0:Be.note)||""},ce[ze]=t.existingImages[ze]||[]});const le=S(),ye={...o,...le.results||{}},we={...ce,...le.images||{}},Re={...p.value,...le.vehicleDetails||{}},Se=le.overall_note!==void 0?le.overall_note:t.inspection.overall_note||"";return{inspection_id:t.inspection.id,results:ye,images:we,overall_note:Se,plate_number:Re.plate_number,car_id:Re.car_id,car_name:Re.car_name}})());xe(A,r=>{I({results:r.results,images:r.images,overall_note:r.overall_note,vehicleDetails:p.value,conclusion:m.value})},{deep:!0}),xe(p,r=>{A.plate_number=r.plate_number,A.car_id=r.car_id,A.car_name=r.car_name},{deep:!0}),xe(m,r=>{A.overall_note=r.notes},{deep:!0});const oe=Lt("vehicleFeatures",y(null));oe.value=JSON.parse(localStorage.getItem("vehicle_features")||"{}"),Dt("vehicleFeatures",oe);const Ae=r=>{var ye,we;const o=r.settings;if(!Ve(r))return!0;const ce=(ye=t.car)==null?void 0:ye.transmission,le=(we=t.car)==null?void 0:we.fuel_type;return!(o.transmission&&Array.isArray(o.transmission)&&o.transmission.length>0&&ce&&!o.transmission.includes(ce)||o.fuel_type&&o.fuel_type.trim()!==""&&le&&o.fuel_type!==le||o.rear_door&&(!oe.value||!oe.value.rear_door)||o.pick_up&&(!oe.value||!oe.value.pick_up)||o.box&&(!oe.value||!oe.value.box))},Ve=r=>{const o=r.settings;return!!(o!=null&&o.transmission&&Array.isArray(o.transmission)&&o.transmission.length>0||o!=null&&o.fuel_type&&o.fuel_type.trim()!==""||o!=null&&o.rear_door||o!=null&&o.pick_up||o!=null&&o.box)},_e=y(!1),He=r=>{_e.value=r},pt=y(!1),kt=r=>{pt.value=r},Ze=te(()=>{var ye;const r=p.value.plate_number&&/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test(p.value.plate_number),o=!!((ye=p.value.car_name)!=null&&ye.trim()),ce=!pt.value,le=!_e.value;return r&&o&&ce&&le}),mt=te(()=>{if(!Ie.value.trim())return t.damagePoints||[];const r=Ie.value.toLowerCase().trim();return(t.damagePoints||[]).filter(o=>{var ce,le,ye,we,Re;return((le=(ce=o.inspection_point)==null?void 0:ce.name)==null?void 0:le.toLowerCase().includes(r))||((we=(ye=o.inspection_point)==null?void 0:ye.description)==null?void 0:we.toLowerCase().includes(r))||((Re=ft(o))==null?void 0:Re.toLowerCase().includes(r))})}),vt=r=>{const o=A.results[r]&&(A.results[r].status||A.results[r].note),ce=A.images[r]&&A.images[r].length>0;return o||ce},ft=r=>{var o;return((o=r.inspection_point.component)==null?void 0:o.name)||"Komponen Tidak Diketahui"},It=r=>A.results[r]||null,nt=()=>{var we;const r=m.value,o=!!r.flooded,ce=!!r.collision,le=r.collision==="yes"?!!r.collision_severity:!0,ye=!!((we=r.notes)!=null&&we.trim());return o&&ce&&le&&ye},ht=te(()=>({flooded:m.value.flooded||null,collision:m.value.collision||null,collision_severity:m.value.collision_severity||null,note:m.value.notes||null,isComplete:nt()})),bt=te(()=>{const r=Ze.value,o=t.appMenus.every(le=>ot(le)),ce=nt();return r&&o&&ce}),ot=r=>r.input_type==="damage"?!0:r.id==="conclusion"?nt():r.id==="vehicle"?Ze.value:(fe(r.menu_point,!1)||[]).filter(le=>le.is_default&&Ae(le)).every(le=>{var Se,We,ze,Be,yt,xt;const ye=A.results[le.inspection_point_id],we=A.images[le.inspection_point_id];if(!ye)return!1;const Re=ae(le.settings);switch(le.input_type){case"text":case"number":case"date":case"account":case"textarea":return!!((Se=ye.note)!=null&&Se.trim());case"select":case"radio":if(!ye.status)return!1;const Ye=(We=Re.radios)==null?void 0:We.find(tt=>tt.value===ye.status);return!(Ye!=null&&Ye.settings&&(Ye.settings.show_textarea&&!((ze=ye.note)!=null&&ze.trim())||Ye.settings.show_image_upload&&(we==null?void 0:we.length)===0));case"imageTOradio":if((we==null?void 0:we.length)===0||!ye.status)return!1;const F=(Be=Re.radios)==null?void 0:Be.find(tt=>tt.value===ye.status);return!(F!=null&&F.settings&&F.settings.show_textarea&&F.settings.required&&!((yt=ye.note)!=null&&yt.trim()));case"image":return(we==null?void 0:we.length)>0;default:return!!ye.status||!!((xt=ye.note)!=null&&xt.trim())}}),je=y(!0),Ge=y(M()),Oe=y(g()),it=y(!1),_t=()=>{console.log("Opening settings modal"),it.value=!0},lt=()=>{console.log("Closing settings modal"),it.value=!1},Je=y(null),rt=y([]),Xe=y(0),Qe=y(!1);Dt("imageSourceSetting",Ge),Dt("cameraQualitySetting",Oe);const St=()=>{je.value=!je.value,D(je.value)},Ct=()=>{Q(Ge.value),console.log("Image source setting updated to:",Ge.value)},$t=()=>{T(Oe.value),console.log("Camera quality setting updated to:",Oe.value)},et=()=>{Je.value&&Pt(()=>{const r=Je.value.querySelector(`[data-category="${L.value}"]`);if(!r)return;const o=Je.value,ce=o.clientWidth,le=r.offsetLeft,ye=r.clientWidth,we=le-ce/2+ye/2;o.scrollTo({left:we,behavior:"smooth"})})},At=()=>Xe.value===0?(Xe.value=1,Qe.value=!0,setTimeout(()=>{Xe.value=0,Qe.value=!1},2e3),window.history.pushState(null,null,window.location.href),!1):(Xe.value=0,Qe.value=!1,Ut.visit(route("job.index")),!0),Vt=()=>{window.history.state===null&&window.history.replaceState({isBackButtonControlled:!0},""),window.history.pushState({isBackButtonControlled:!0},""),window.addEventListener("popstate",r=>{r.state&&r.state.isBackButtonControlled&&(r.preventDefault(),At())})},Tt=r=>{be.value=r;const o=r.inspection_point_id,ce=A.results[o]||{};Ce.value=ce.status||"",$e.value=ce.note||"",pe.value=!1,Me.value=!0},Mt=r=>{be.value&&(A.images[be.value.inspection_point_id]=r)},Et=()=>{if(be.value){const r=be.value.inspection_point_id;A.results[r]={...A.results[r],status:Ce.value,note:$e.value},ke.value="Data berhasil disimpan di lokal!",setTimeout(()=>ke.value="",1e3)}Rt()},Nt=({pointId:r,type:o,value:ce})=>{var le;(le=A.results[r])!=null&&le.hasOwnProperty(o)&&(A.results[r][o]=ce)},J=async r=>{if(r&&confirm("Apakah kamu yakin ingin menghapus data ini?")){try{await Ut.post(route("inspections.delete-result"),{inspection_id:t.inspection.id,point_id:r},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{A.results[r]&&(A.results[r]={status:"",note:""}),A.images[r]&&(A.images[r]=[]),ke.value="Data berhasil dihapus!",setTimeout(()=>ke.value="",1e3)},onError:o=>{console.error("Error menghapus hasil:",o)}})}catch(o){console.error("Error menghapus hasil:",o)}Rt()}},V=r=>{Object.assign(p.value,r),He(!0)},ma=r=>{console.log("Save car details locally:",r)},va=r=>{console.log("Received conclusion data from child:",r),m.value={...m.value,...r},A.overall_note=r.notes||"",console.log("Conclusion state updated:",m.value)},fa=()=>{if(!bt.value){alert("Harap lengkapi semua menu inspeksi termasuk kesimpulan sebelum submit final");return}if(!confirm("Apakah Anda yakin ingin mengirim semua data inspeksi? Data lokal akan dihapus setelah berhasil dikirim."))return;k.value=!0;const r={...A.data(),overall_note:m.value.notes,conclusion:{notes:m.value.notes,flooded:m.value.flooded,collision:m.value.collision,collision_severity:m.value.collision_severity}};Ut.post(route("inspections.final-submit-local",{id:t.inspection.id}),r,{preserveScroll:!0,onSuccess:()=>{j()},onError:o=>{console.error("Kesalahan pengiriman:",o),k.value=!1}})},ha=({pointId:r,imageId:o})=>{A.images[r]&&(A.images[r]=A.images[r].filter(ce=>ce.id!==o))},zt=()=>{pe.value=!1,Ie.value=""},Rt=()=>{Me.value=!1,be.value=null,Ce.value="",$e.value=""},ba=()=>{},ut=r=>{L.value=r,E(r),et()},qt=r=>{let o=he.value+r;o>=0&&o<P.value.length&&(L.value=P.value[o],et())},ya=()=>{let r=0,o=0,ce=null;const le=Se=>{je.value&&(r=Se.changedTouches[0].screenX)},ye=Se=>{je.value&&(o=Se.changedTouches[0].screenX,we())},we=()=>{if(!je.value)return;const Se=250;o<r-Se?qt(1):o>r+Se&&qt(-1)},Re=()=>{const Se=document.querySelector(".relative.overflow-hidden");return Se&&(Se.addEventListener("touchstart",le,{passive:!0}),Se.addEventListener("touchend",ye,{passive:!0})),()=>{Se&&(Se.removeEventListener("touchstart",le),Se.removeEventListener("touchend",ye))}};return ce=Re(),xe(je,Se=>{ce&&ce(),Se&&(ce=Re())}),()=>{ce&&ce()}};return xe(L,(r,o)=>{et()}),xe(L,r=>{he.value=P.value.indexOf(r)}),xe(Oe,r=>{$t()}),st(()=>{const r=S();if(je.value=w(),Ge.value=M(),Oe.value=g(),r.vehicleDetails&&(Object.assign(p.value,r.vehicleDetails),A.plate_number=r.vehicleDetails.plate_number,A.car_id=r.vehicleDetails.car_id,A.car_name=r.vehicleDetails.car_name),r.conclusion)console.log("Loading conclusion from localStorage:",r.conclusion),Object.assign(m.value,r.conclusion),A.overall_note=r.conclusion.notes||"";else{const le=ae(t.inspection.settings).conclusion||{};m.value={notes:t.inspection.notes||"",flooded:le.flooded||"",collision:le.collision||"",collision_severity:le.collision_severity||""},A.overall_note=t.inspection.notes||""}r.results&&Object.assign(A.results,r.results),r.images&&Object.assign(A.images,r.images);const o=K();P.value.includes(o)?L.value=o:(L.value=P.value[0],E(P.value[0])),ya(),Vt(),setTimeout(()=>{et()},100)}),(r,o)=>{var ce,le,ye,we,Re,Se,We,ze,Be,yt,xt,Ye;return n(),i("div",$l,[ee(U)||ee(de)?(n(),i("div",Al)):d("",!0),G.value==="vertical"?(n(),i("button",{key:1,onMousedown:o[0]||(o[0]=(...F)=>ee(_)&&ee(_)(...F)),onMouseup:o[1]||(o[1]=(...F)=>ee(x)&&ee(x)(...F)),onMouseleave:o[2]||(o[2]=(...F)=>ee(f)&&ee(f)(...F)),onMousemove:o[3]||(o[3]=(...F)=>ee(s)&&ee(s)(...F)),onTouchstart:o[4]||(o[4]=(...F)=>ee(_)&&ee(_)(...F)),onTouchend:o[5]||(o[5]=(...F)=>ee(x)&&ee(x)(...F)),onTouchmove:o[6]||(o[6]=(...F)=>ee(s)&&ee(s)(...F)),onClick:ue,class:"fixed z-40 p-4 bg-gradient-to-r from-indigo-700 to-sky-600 text-white border shadow-lg rounded-full hover:shadow-xl transition",style:qe({left:ee(B).x+"px",top:ee(B).y+"px"}),"aria-label":"Toggle vertical menu"},[O.value?(n(),i("svg",Tl,o[31]||(o[31]=[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]))):(n(),i("svg",Vl,o[30]||(o[30]=[e("path",{"fill-rule":"evenodd",d:"M3 5h14v2H3V5zm0 4h10v2H3V9zm0 4h6v2H3v-2z","clip-rule":"evenodd"},null,-1)])))],36)):d("",!0),G.value==="horizontal"?(n(),i("div",{key:2,class:re(["z-10 bg-white shadow-sm",{"sticky top-0 mb-2":Z.value==="top","fixed bottom-0 left-0 right-0":Z.value==="bottom"}])},[e("div",{ref_key:"menuContainer",ref:Je,class:"flex overflow-x-auto scrollbar-hide py-3 px-4 space-x-2 menu-container",onScroll:ba},[e("button",{onClick:_t,class:"flex-shrink-0 p-2 rounded-full text-gray-600 hover:text-gray-800 hover:bg-gray-100 transition-colors duration-200",title:"Pengaturan"},o[32]||(o[32]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])),e("button",{ref_key:"menuItems",ref:rt,onClick:o[7]||(o[7]=F=>ut("vehicle")),class:re(["flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors duration-200 menu-item",{"bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white":L.value==="vehicle","bg-gray-100 text-gray-700 hover:bg-gray-200":L.value!=="vehicle"}]),"data-category":"vehicle"},[o[33]||(o[33]=Ue(" Detail Kendaraan ")),Ze.value?(n(),i("span",Ml," ✓ ")):d("",!0)],2),(n(!0),i(Ne,null,Pe(a.appMenus,F=>(n(),i("button",{key:F.id,ref_for:!0,ref_key:"menuItems",ref:rt,onClick:tt=>ut(String(F.id)),class:re(["flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors duration-200 menu-item",{"bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white":L.value===String(F.id),"bg-gray-100 text-gray-700 hover:bg-gray-200":L.value!==String(F.id)}]),"data-category":String(F.id)},[Ue(q(F.name)+" ",1),ot(F)?(n(),i("span",Nl," ✓ ")):d("",!0)],10,El))),128)),e("button",{ref_key:"menuItems",ref:rt,onClick:o[8]||(o[8]=F=>ut("conclusion")),class:re(["flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors duration-200 menu-item",{"bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white":L.value==="conclusion","bg-gray-100 text-gray-700 hover:bg-gray-200":L.value!=="conclusion"}]),"data-category":"conclusion"},[o[34]||(o[34]=Ue(" Kesimpulan ")),ht.value.isComplete?(n(),i("span",Ul," ✓ ")):d("",!0)],2)],544)],2)):d("",!0),G.value==="vertical"&&O.value?(n(),i("div",Dl,[e("div",{class:"absolute inset-0 bg-black bg-opacity-30",onClick:W}),e("div",{class:re(["absolute z-40 w-60 bg-white rounded-xl shadow-xl p-2 max-h-[75vh] overflow-y-auto",{"top-16 right-4":Z.value==="top-right","top-16 left-4":Z.value==="top-left","bottom-16 right-4":Z.value==="bottom-right","bottom-16 left-4":Z.value==="bottom-left"}])},[e("div",{class:"flex items-center justify-between px-2 py-1 border-b"},[o[35]||(o[35]=e("div",{class:"text-sm font-semibold"},"Pilih Menu",-1)),e("button",{onClick:W,class:"text-xs text-gray-500 hover:text-gray-700"},"Tutup")]),e("div",Pl,[e("button",{onClick:o[9]||(o[9]=F=>{ut("vehicle"),W()}),class:re([ie(L.value==="vehicle"),"w-full flex items-center justify-between px-3 py-2 rounded-md text-sm"])},[o[36]||(o[36]=e("span",null,"Detail Kendaraan",-1)),Ze.value?(n(),i("span",Ll,"✓")):d("",!0)],2),(n(!0),i(Ne,null,Pe(a.appMenus,F=>(n(),i("button",{key:`vmenu-${F.id}`,onClick:()=>{ut(String(F.id)),W()},class:re([ie(L.value===String(F.id)),"w-full flex items-center justify-between px-3 py-2 rounded-md text-sm"])},[e("span",null,q(F.name),1),ot(F)?(n(),i("span",jl,"✓")):d("",!0)],10,Rl))),128)),e("button",{onClick:o[10]||(o[10]=F=>{ut("conclusion"),W()}),class:re([ie(L.value==="conclusion"),"w-full flex items-center justify-between px-3 py-2 rounded-md text-sm"])},[o[37]||(o[37]=e("span",null,"Kesimpulan",-1)),ht.value.isComplete?(n(),i("span",Bl,"✓")):d("",!0)],2)])],2)])):d("",!0),e("div",{class:re(["max-w-7xl mx-auto px-2 sm:px-4 lg:px-6 py-1",{"pb-4 pt-1":Z.value==="top","pb-20 pt-4":Z.value==="bottom","pb-4 pt-4":G.value==="vertical"}])},[Te(gt,{name:"fade"},{default:Fe(()=>[ke.value?(n(),i("div",Fl,q(ke.value),1)):d("",!0)]),_:1}),e("div",Ol,[Te(gt,{name:"category-slide",mode:"out-in"},{default:Fe(()=>[L.value==="vehicle"?(n(),i("div",zl,[Te(hs,{inspection:a.inspection,CarDetail:a.CarDetail,allInspections:t.allInspections,onUpdateVehicle:V,onSaveCarDetails:ma,"onUpdate:validation":kt,"onUpdate:hasUnsavedChanges":He},null,8,["inspection","CarDetail","allInspections"])])):me.value&&L.value!=="conclusion"?(n(),i("div",{key:me.value.id},[Te(tl,{category:me.value,"inspection-id":a.inspection.id,car:t.car,form:ee(A),head:G.value,onUpdateResult:Nt,onHapusPoint:J,onRemoveImage:ha},null,8,["category","inspection-id","car","form","head"])])):L.value==="conclusion"?(n(),i("div",ql,[Te(Cl,{form:{conclusion:m.value},"inspection-id":a.inspection.id,inspection:a.inspection,settings:a.inspection.settings||{},onUpdateConclusion:va},null,8,["form","inspection-id","inspection","settings"])])):d("",!0)]),_:1})]),L.value==="conclusion"?(n(),i("div",{key:0,class:re(["flex justify-end gap-4 mt-2 p-4 bg-white rounded-xl shadow-md",{"mb-4":Z.value==="top","mb-20":Z.value==="bottom"}])},[Te(ee(ka),{href:r.route("inspections.pending",a.inspectionId),as:"button",type:"button",disabled:Ee.value&&l.value==="pending",onClick:o[11]||(o[11]=ct(F=>b(r.route("inspections.pending",a.inspectionId),"pending"),["prevent"])),class:"inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md shadow-sm bg-yellow-500 text-white hover:bg-yellow-600 transition disabled:opacity-50 disabled:cursor-not-allowed"},{default:Fe(()=>[Ee.value&&l.value==="pending"?(n(),i(Ne,{key:0},[o[38]||(o[38]=e("svg",{class:"animate-spin h-4 w-4 text-white mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),o[39]||(o[39]=e("span",null,"Memproses...",-1))],64)):(n(),i("span",Kl,"Tunda"))]),_:1},8,["href","disabled"]),e("button",{type:"button",onClick:fa,disabled:!bt.value||k.value,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"},[k.value?(n(),i("svg",Gl,o[40]||(o[40]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):d("",!0),e("span",null,q(k.value?"Mengirim...":"Final Kirim Inspeksi"),1)],8,Hl)],2)):d("",!0),u.value?(n(),i("button",{key:1,onMousedown:o[12]||(o[12]=(...F)=>ee(N)&&ee(N)(...F)),onMouseup:o[13]||(o[13]=(...F)=>ee(X)&&ee(X)(...F)),onMouseleave:o[14]||(o[14]=(...F)=>ee(R)&&ee(R)(...F)),onMousemove:o[15]||(o[15]=(...F)=>ee(H)&&ee(H)(...F)),onTouchstart:o[16]||(o[16]=(...F)=>ee(N)&&ee(N)(...F)),onTouchend:o[17]||(o[17]=(...F)=>ee(X)&&ee(X)(...F)),onTouchmove:o[18]||(o[18]=(...F)=>ee(H)&&ee(H)(...F)),onClick:ve,class:"fixed z-5 p-4 bg-gradient-to-r from-indigo-700 to-sky-600 text-white rounded-full shadow-lg",style:qe({left:ee(ge).x+"px",top:ee(ge).y+"px"})},o[41]||(o[41]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1)]),36)):d("",!0),Te(pa,{show:pe.value,title:"Cari Point Inspeksi",subtitle:"Pilih point inspeksi untuk ditambahkan",onClose:zt},{default:Fe(()=>[e("button",{onClick:zt,class:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors z-10"},o[42]||(o[42]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),e("div",Wl,[e("div",Yl,[Le(e("input",{"onUpdate:modelValue":o[19]||(o[19]=F=>Ie.value=F),type:"text",placeholder:"Cari point inspeksi...",class:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[dt,Ie.value]]),o[43]||(o[43]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),e("div",Zl,[mt.value.length===0?(n(),i("div",Jl," Tidak ada point yang ditemukan ")):d("",!0),(n(!0),i(Ne,null,Pe(mt.value,F=>{var tt,ta;return n(),i("button",{key:F.id,onClick:yr=>Tt(F),class:"w-full text-left p-3 border-b border-gray-200 hover:bg-gray-50 transition-colors"},[e("div",Ql,q((tt=F.inspection_point)==null?void 0:tt.name),1),e("div",er,q((ta=F.inspection_point)==null?void 0:ta.description),1),e("div",tr,q(ft(F)),1),vt(F.inspection_point_id)?(n(),i("div",ar," ✓ Sudah ada data ")):d("",!0)],8,Xl)}),128))])])]),_:1},8,["show"]),Me.value?(n(),De(Ot,{key:(ce=be.value)==null?void 0:ce.id,show:Me.value,title:((ye=(le=be.value)==null?void 0:le.inspection_point)==null?void 0:ye.name)||"Detail Point",subtitle:(Re=(we=be.value)==null?void 0:we.inspection_point)==null?void 0:Re.description,name:`point-${(Se=be.value)==null?void 0:Se.id}`,"inspection-id":a.inspection.id,"point-id":(We=be.value)==null?void 0:We.inspection_point_id,settings:((ze=be.value)==null?void 0:ze.settings)||{},options:((yt=(Be=be.value)==null?void 0:Be.settings)==null?void 0:yt.radios)||[],"selected-Point":be.value,"selected-value":Ce.value,"images-value":ee(A).images[(xt=be.value)==null?void 0:xt.inspection_point_id],"notes-value":$e.value,point:be.value,"existing-data":It((Ye=be.value)==null?void 0:Ye.inspection_point_id),"onUpdate:selectedValue":o[20]||(o[20]=F=>Ce.value=F),"onUpdate:notesValue":o[21]||(o[21]=F=>$e.value=F),"onUpdate:imagesValue":Mt,onSave:Et,onClose:Rt,onHapus:J},null,8,["show","title","subtitle","name","inspection-id","point-id","settings","options","selected-Point","selected-value","images-value","notes-value","point","existing-data"])):d("",!0),Qe.value?(n(),i("div",sr,o[44]||(o[44]=[e("p",{class:"text-sm"},"Tekan sekali lagi untuk keluar dari inspeksi",-1),e("p",{class:"text-xs text-gray-300 mt-1"},"Data inspeksi telah disimpan secara lokal",-1)]))):d("",!0),it.value?(n(),i("div",{key:4,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:lt},[e("div",{class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto",onClick:o[29]||(o[29]=ct(()=>{},["stop"]))},[e("div",{class:"flex items-center justify-between p-4 border-b"},[o[46]||(o[46]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Pengaturan Inspeksi",-1)),e("button",{onClick:lt,class:"text-gray-400 hover:text-gray-600 transition-colors"},o[45]||(o[45]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",nr,[e("div",or,[o[47]||(o[47]=e("div",null,[e("label",{class:"text-sm font-medium text-gray-700"},"Swipe Gesture"),e("p",{class:"text-xs text-gray-500"},"Aktifkan navigasi dengan geser")],-1)),e("button",{onClick:St,type:"button",class:re(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",je.value?"bg-indigo-600":"bg-gray-200"]),role:"switch","aria-checked":je.value},[e("span",{"aria-hidden":"true",class:re(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",je.value?"translate-x-5":"translate-x-0"])},null,2)],10,ir)]),e("div",lr,[o[49]||(o[49]=e("label",{class:"text-sm font-medium text-gray-700"},"Sumber Gambar",-1)),Le(e("select",{"onUpdate:modelValue":o[22]||(o[22]=F=>Ge.value=F),onChange:Ct,class:"w-full text-sm border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},o[48]||(o[48]=[e("option",{value:"all"},"Tanya",-1),e("option",{value:"camera"},"Kamera",-1),e("option",{value:"gallery"},"Galeri",-1)]),544),[[Bt,Ge.value]])]),e("div",rr,[o[51]||(o[51]=e("label",{class:"text-sm font-medium text-gray-700"},"Kualitas Kamera",-1)),Le(e("select",{"onUpdate:modelValue":o[23]||(o[23]=F=>Oe.value=F),class:"w-full text-sm border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},o[50]||(o[50]=[ia('<option value="HD_Std" data-v-a52f0c5f>HD Std</option><option value="Native" data-v-a52f0c5f>Native</option><option value="4K" data-v-a52f0c5f>4K Rtc</option><option value="HD" data-v-a52f0c5f>HD Rtc</option><option value="SD" data-v-a52f0c5f>SD Rtc</option>',5)]),512),[[Bt,Oe.value]])]),e("div",ur,[o[54]||(o[54]=e("label",{class:"text-sm font-medium text-gray-700"},"Mode Menu",-1)),e("div",dr,[e("label",cr,[Le(e("input",{type:"radio","onUpdate:modelValue":o[24]||(o[24]=F=>G.value=F),value:"horizontal",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[at,G.value]]),o[52]||(o[52]=e("span",{class:"ml-2 text-sm text-gray-700"},"Scroll samping",-1))]),e("label",gr,[Le(e("input",{type:"radio","onUpdate:modelValue":o[25]||(o[25]=F=>G.value=F),value:"vertical",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[at,G.value]]),o[53]||(o[53]=e("span",{class:"ml-2 text-sm text-gray-700"},"Menu Ngambang",-1))])])]),G.value==="horizontal"?(n(),i("div",pr,[o[57]||(o[57]=e("label",{class:"text-sm font-medium text-gray-700"},"Posisi Menu",-1)),e("div",mr,[e("label",vr,[Le(e("input",{type:"radio","onUpdate:modelValue":o[26]||(o[26]=F=>Z.value=F),value:"top",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[at,Z.value]]),o[55]||(o[55]=e("span",{class:"ml-2 text-sm text-gray-700"},"Atas",-1))]),e("label",fr,[Le(e("input",{type:"radio","onUpdate:modelValue":o[27]||(o[27]=F=>Z.value=F),value:"bottom",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[at,Z.value]]),o[56]||(o[56]=e("span",{class:"ml-2 text-sm text-gray-700"},"Bawah",-1))])])])):d("",!0),G.value==="vertical"?(n(),i("div",hr,[o[59]||(o[59]=e("label",{class:"text-sm font-medium text-gray-700"},"Posisi Menu Vertikal",-1)),Le(e("select",{"onUpdate:modelValue":o[28]||(o[28]=F=>Z.value=F),class:"w-full text-sm border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},o[58]||(o[58]=[e("option",{value:"top-right"},"Atas Kanan",-1),e("option",{value:"top-left"},"Atas Kiri",-1),e("option",{value:"bottom-right"},"Bawah Kanan",-1),e("option",{value:"bottom-left"},"Bawah Kiri",-1)]),512),[[Bt,Z.value]])])):d("",!0)]),e("div",{class:"flex justify-end p-4 border-t bg-gray-50"},[e("button",{onClick:lt,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"}," Tutup ")])])])):d("",!0)],2)])}}},$r=Ke(br,[["__scopeId","data-v-a52f0c5f"]]);export{$r as default};
