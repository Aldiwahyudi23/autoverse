import{p as R,x as q,r as I,q as y,G as L,j as $,o as i,w as E,k as H,d as t,u as a,v as G,f as c,t as l,y as O,c as u,b as m,n as p,z as x,A as v,I as z,W as Q}from"./vendor-g77w9U1W.js";import{A as J}from"./AppLayout-BBsEjudI.js";import"./app-C0uzOd7-.js";const X={class:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-md"},Y={class:"bg-blue-50 p-4 rounded-lg mb-4"},Z={key:0,class:"mb-4 relative"},ee={key:0},te={key:1},se=["href"],ae={key:1,class:"space-y-4"},ne={key:0,class:"text-red-500 text-sm mt-1"},re={key:0,class:"text-red-500 text-sm mt-1"},oe={key:0,class:"text-red-500 text-sm mt-1"},ie={key:0,class:"text-red-500 text-sm mt-1"},le={key:0,class:"mb-4"},ue={class:"grid grid-cols-2 gap-2"},me={key:0},de={key:1},pe={key:1,class:"space-y-4"},ce={key:0,class:"text-purple-700 mb-4"},be={key:1,class:"text-yellow-600 mb-4"},ge={key:0,class:"text-red-500 text-sm mt-1"},fe={key:0,class:"text-red-500 text-sm mt-1"},ye={key:0,class:"text-center"},xe=["disabled"],ke={class:"bg-gray-50 p-4 rounded-lg mb-2 mt-2"},ve={class:"bg-white p-4 rounded border border-gray-200 whitespace-pre-wrap text-sm font-mono"},he={class:"text-xs text-gray-500 mt-2"},we={class:"text-center"},Ie=["href"],Ae={key:0,class:"text-red-500 text-sm mt-2"},Pe={__name:"Whatsapp",props:{inspection:Object,IdInspection:Object,transaction:Object,notesForWhatsApp:String},setup(d){var S,N,P,_,C,W,M;const r=d;R();const V={pending:"Menunggu Pembayaran",paid:"Sudah di bayar",failed:"Gagal",refunded:"Dikembalikan",expired:"Kadaluarsa"},s=q({customer_name:((S=r.inspection.customer)==null?void 0:S.name)||"",customer_phone:((N=r.inspection.customer)==null?void 0:N.phone)||"",customer_email:((P=r.inspection.customer)==null?void 0:P.email)||"",customer_address:((_=r.inspection.customer)==null?void 0:_.address)||"",amount:((C=r.transaction)==null?void 0:C.amount)||"",payment_method:((W=r.transaction)==null?void 0:W.payment_method)||"",status:((M=r.transaction)==null?void 0:M.status)||"pending"});I(!1),I("");const b=y(()=>r.inspection.customer_id!==null),f=y(()=>r.transaction!==null),g=y(()=>{var o;return((o=r.transaction)==null?void 0:o.status)==="paid"}),h=I(""),A=o=>{if(!o)return"";const e=String(o).replace(/\D/g,""),n=parseInt(e,10);return isNaN(n)?"":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(n)},K=o=>{const e=o.target.value.replace(/\D/g,"");s.amount=e,h.value=A(e)};L(()=>s.amount,o=>{if(o){const e=String(o).replace(/\D/g,"");h.value=A(e)}else h.value=""},{immediate:!0});const D=y(()=>b.value&&f.value&&g.value),T=y(()=>b.value&&f.value&&g.value),F=y(()=>s.processing?"Menyimpan...":!b.value&&!f.value?"Simpan Data":b.value&&!f.value?"Simpan Pembayaran":!b.value&&f.value?"Tambahkan Data Customer":"Simpan Data"),B=()=>{const o=parseInt(s.amount,10);if(isNaN(o)){alert("Nominal pembayaran tidak valid.");return}s.status="paid",s.amount=o,s.post(route("inspections.updateUnified",r.IdInspection),{preserveScroll:!0,onSuccess:()=>{Q.reload()}})},U=y(()=>r.inspection.notes?`*HASIL INSPEKSI KENDARAAN*

*ID Inspeksi*: ${r.inspection.code}
*Plat Nomor*: ${r.inspection.plate_number}
*Kendaraan*: ${r.inspection.car_name}

*HASIL:*
${r.notesForWhatsApp}

Terima kasih telah menggunakan layanan kami.

_Catatan: Mohon gunakan ID Inspeksi untuk mengakses file, sebagai upaya kami melindungi data kendaraan._`:`Hasil inspeksi kendaraan dengan ID ${r.inspection.code} sudah tersedia.`),w=o=>{if(!o)return"";let e=(""+o).replace(/\D/g,"");e.startsWith("0")&&(e="62"+e.substring(1)),e.startsWith("+")||(e="+"+e);let n=e.replace(/^\+62/,""),k=[];return n.length>0&&k.push(n.substring(0,2)),n.length>2&&k.push(n.substring(2,5)),n.length>5&&k.push(n.substring(5,8)),n.length>8&&k.push(n.substring(8)),"+62"+k.filter(Boolean).join("-")},j=o=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o);return(o,e)=>(i(),$(J,null,{default:E(()=>[H(a(G),{title:"Kirim WhatsApp"}),t("div",X,[e[30]||(e[30]=t("h1",{class:"text-xl font-bold text-gray-800 mb-4"},"Kirim Hasil Inspeksi via WhatsApp",-1)),t("div",Y,[e[10]||(e[10]=t("h2",{class:"text-lg font-semibold text-blue-800 mb-2"},"Informasi Inspeksi",-1)),t("p",null,[e[7]||(e[7]=t("span",{class:"font-medium"},"ID:",-1)),c(" "+l(d.inspection.code),1)]),t("p",null,[e[8]||(e[8]=t("span",{class:"font-medium"},"Plat Nomor:",-1)),c(" "+l(d.inspection.plate_number),1)]),t("p",null,[e[9]||(e[9]=t("span",{class:"font-medium"},"Mobil:",-1)),c(" "+l(d.inspection.car_name),1)])]),t("form",{onSubmit:O(B,["prevent"]),class:"space-y-6"},[t("div",{class:p(["p-4 rounded-lg",b.value?"bg-green-50":"bg-yellow-50"])},[t("h2",{class:p(["text-lg font-semibold mb-4",b.value?"text-green-800":"text-yellow-800"])}," Informasi Customer ",2),b.value?(i(),u("div",Z,[t("p",null,[e[11]||(e[11]=t("span",{class:"font-medium"},"Nama:",-1)),c(" "+l(d.inspection.customer.name),1)]),t("p",null,[e[12]||(e[12]=t("span",{class:"font-medium"},"WhatsApp:",-1)),c(" "+l(w(d.inspection.customer.phone)),1)]),d.inspection.customer.email?(i(),u("p",ee,[e[13]||(e[13]=t("span",{class:"font-medium"},"Email:",-1)),c(" "+l(d.inspection.customer.email),1)])):m("",!0),d.inspection.customer.address?(i(),u("p",te,[e[14]||(e[14]=t("span",{class:"font-medium"},"Alamat:",-1)),c(" "+l(d.inspection.customer.address),1)])):m("",!0),d.inspection.customer.phone?(i(),u("a",{key:2,href:`https://wa.me/${d.inspection.customer.phone.replace(/^0/,"62")}`,target:"_blank",class:"botton-2 right-6 inline-flex items-center px-4 py-1 bg-green-600 text-white rounded-md hover:bg-green-700"},e[15]||(e[15]=[t("svg",{class:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.864 3.488"})],-1)]),8,se)):m("",!0)])):(i(),u("div",ae,[e[21]||(e[21]=t("p",{class:"text-yellow-700 mb-4"},"Data customer belum tersedia. Silakan isi informasi customer.",-1)),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nama Customer *",-1)),x(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>a(s).customer_name=n),type:"text",required:"",class:p(["w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":a(s).errors.customer_name}])},null,2),[[v,a(s).customer_name]]),a(s).errors.customer_name?(i(),u("p",ne,l(a(s).errors.customer_name),1)):m("",!0)]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nomor WhatsApp *",-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>a(s).customer_phone=n),type:"tel",required:"",placeholder:"Contoh: 628123456789",class:p(["w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":a(s).errors.customer_phone}])},null,2),[[v,a(s).customer_phone]]),e[18]||(e[18]=t("p",{class:"text-xs text-gray-500 mt-1"},"Gunakan format internasional (62 bukan 0)",-1)),a(s).errors.customer_phone?(i(),u("p",re,l(a(s).errors.customer_phone),1)):m("",!0)]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email",-1)),x(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>a(s).customer_email=n),type:"email",class:p(["w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":a(s).errors.customer_email}])},null,2),[[v,a(s).customer_email]]),a(s).errors.customer_email?(i(),u("p",oe,l(a(s).errors.customer_email),1)):m("",!0)]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Alamat",-1)),x(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=n=>a(s).customer_address=n),rows:"3",class:p(["w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":a(s).errors.customer_address}])},null,2),[[v,a(s).customer_address]]),a(s).errors.customer_address?(i(),u("p",ie,l(a(s).errors.customer_address),1)):m("",!0)])]))],2),t("div",{class:p(["p-4 rounded-lg",g.value?"bg-green-50":"bg-purple-50"])},[t("h2",{class:p(["text-lg font-semibold mb-4",g.value?"text-green-800":"text-purple-800"])}," Informasi Pembayaran ",2),f.value&&g.value?(i(),u("div",le,[t("div",ue,[e[23]||(e[23]=t("p",null,[t("span",{class:"font-medium"},"Status:")],-1)),t("span",{class:p(["font-semibold",{"text-green-600":g.value,"text-yellow-600":!g.value}])},l(V[r.transaction.status]),3),e[24]||(e[24]=t("p",null,[t("span",{class:"font-medium"},"Nominal:")],-1)),t("p",null,l(j(r.transaction.amount)),1),r.transaction.payment_method?(i(),u("p",me,e[22]||(e[22]=[t("span",{class:"font-medium"},"Metode:",-1)]))):m("",!0),r.transaction.payment_method?(i(),u("p",de,l(r.transaction.payment_method),1)):m("",!0)])])):(i(),u("div",pe,[f.value?g.value?m("",!0):(i(),u("p",be,"Transaksi sudah ada, namun belum terbayar. Silakan lengkapi data pembayaran di bawah ini.")):(i(),u("p",ce,"Data transaksi belum tersedia. Silakan isi informasi pembayaran.")),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nominal Pembayaran *",-1)),x(t("input",{"onUpdate:modelValue":e[4]||(e[4]=n=>h.value=n),onInput:K,type:"text",required:"",placeholder:"Contoh: Rp 250.000",class:p(["w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":a(s).errors.amount}])},null,34),[[v,h.value]]),a(s).errors.amount?(i(),u("p",ge,l(a(s).errors.amount),1)):m("",!0)]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Metode Pembayaran *",-1)),x(t("select",{"onUpdate:modelValue":e[5]||(e[5]=n=>a(s).payment_method=n),required:"",class:p(["w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":a(s).errors.payment_method}])},e[26]||(e[26]=[t("option",{value:""},"Pilih Metode",-1),t("option",{value:"cash"},"Cash",-1),t("option",{value:"transfer"},"Transfer",-1),t("option",{value:"debit_card"},"Kartu Debit",-1),t("option",{value:"credit_card"},"Kartu Kredit",-1),t("option",{value:"qris"},"QRIS",-1)]),2),[[z,a(s).payment_method]]),a(s).errors.payment_method?(i(),u("p",fe,l(a(s).errors.payment_method),1)):m("",!0)]),x(t("input",{type:"hidden","onUpdate:modelValue":e[6]||(e[6]=n=>a(s).status=n)},null,512),[[v,a(s).status]])]))],2),T.value?m("",!0):(i(),u("div",ye,[t("button",{type:"submit",disabled:a(s).processing,class:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"},l(F.value),9,xe)]))],32),t("div",ke,[e[28]||(e[28]=t("h2",{class:"text-lg font-semibold text-gray-800 mb-2"},"Pratinjau Pesan WhatsApp",-1)),t("div",ve,l(U.value),1),t("p",he,"Pesan akan dikirim ke: "+l(b.value?w(d.inspection.customer.phone):w(a(s).customer_phone)),1)]),t("div",we,[t("a",{href:o.route("inspections.whatsapp.send",r.IdInspection),target:"_blank",class:p(["inline-flex items-center px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 text-center",{"opacity-50 pointer-events-none":!D.value}])},e[29]||(e[29]=[t("svg",{class:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.864 3.488"})],-1),c(" Kirim via WhatsApp ")]),10,Ie),D.value?m("",!0):(i(),u("p",Ae," Transaksi di perlukan (Customer, Pembayaran, dan Status Terbayar harus lengkap) "))]),e[31]||(e[31]=t("div",{class:"mt-6 p-4 bg-yellow-50 rounded-lg"},[t("h3",{class:"font-semibold text-yellow-800 mb-2"},"Catatan Penting:"),t("ul",{class:"list-disc list-inside text-yellow-700 text-sm space-y-1"},[t("li",null,"Pastikan data customer dan pembayaran sudah benar sebelum mengirim"),t("li",null,"Setelah pembayaran selesai, file Report PDF akan otomatis tersimpan di Berkas"),t("li",null,[c("Ketika menekan tombol "),t("b",null,"Kirim ke WhatsApp"),c(", pesan akan dibuka di aplikasi WhatsApp dan file Report PDF yang baru tersimpan ke berkas harus dilampirkan sebelum di kirim ")]),t("li",null,[c("Tombol WhatsApp hanya aktif jika semua data lengkap dan status pembayaran sudah "),t("b",null,"Lunas")]),t("li",null,"Pastikan perangkat Anda telah terinstal WhatsApp")])],-1))])]),_:1}))}};export{Pe as default};
