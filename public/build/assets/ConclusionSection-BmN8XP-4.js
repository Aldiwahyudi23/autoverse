import{x as Tt,r as N,g as Ee,q as Y,E as Re,G as ce,c as i,o as s,d as t,b as d,k as he,z as Ne,A as Pe,n as ae,t as D,u as Te,e as Nt,F as be,m as ye,f as fe,y as De,w as Ve,N as Le,D as Fe,L as wt,a as Be,j as xe,l as xt,T as Me,M as Ut,p as Et,O as kt,J as je,B as Pt}from"./vendor-g77w9U1W.js";import{l as It}from"./lodash-CGXsUT3p.js";import{_ as Dt}from"./PrimaryButton-CrKKsBb9.js";import{_ as Mt}from"./ActionMessage-C9w22vKV.js";import{_ as Ce}from"./app-BVNQeIN5.js";const Lt={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},Rt={key:0,class:"p-4 space-y-2"},Bt={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},jt={class:"flex items-center space-x-2"},Ft={key:0,class:"text-xs text-red-500 font-normal ml-2"},qt={key:1,class:"text-xs text-red-500 font-normal ml-2"},Kt={key:2,class:"text-xs text-green-500 font-normal ml-2"},Ot={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Ht={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},Gt={class:"col-span-2 flex space-x-3"},zt={class:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},Wt={class:"flex items-start"},Jt={class:"text-sm text-blue-700"},Zt={class:"mt-1"},Yt={key:0,class:"inline-flex items-center px-2 py-1 rounded bg-blue-100 text-blue-800 text-xs font-medium mr-2"},Xt={key:1,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium mr-2"},Qt={key:2,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium"},ea={key:3,class:"text-blue-600"},ta={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},aa={class:"relative"},na={key:0,class:"absolute right-3 top-3"},sa={key:1,class:"text-xs text-red-500 font-normal ml-2"},oa={key:2,class:"mt-1 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},ia={key:3,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},la={key:0},ra=["onMousedown"],ua={class:"font-medium text-gray-900"},da={class:"text-sm text-gray-500"},ca={key:1,class:"p-4 text-sm text-gray-500 text-center"},pa={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},ga={key:0,class:"mb-4"},ma=["innerHTML"],va={key:1},fa={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},ha=["onClick"],ba=["src","alt"],ya={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},xa={class:"text-white text-xs text-center"},ka={key:2,class:"text-center py-4 text-gray-500 text-sm"},wa={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},Ia=["src","alt"],_a={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},Aa={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},Sa={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},$a={__name:"VehicleDetails",props:{inspection:{type:Object,default:null},CarDetail:Array,allInspections:{type:Array,default:()=>[]}},emits:["update-vehicle","update:validation","update:hasUnsavedChanges","update:vehicle-type"],setup(a,{emit:G}){var k,Z,W,Q,H,le;const e=a,A=G,g=Tt({plate_number:((k=e.inspection)==null?void 0:k.plate_number)||"",car_id:((Z=e.inspection)==null?void 0:Z.car_id)||null,car_name:((W=e.inspection)==null?void 0:W.car_name)||""}),I=N(((Q=e.inspection)==null?void 0:Q.plate_number)||""),v=N(((H=e.inspection)==null?void 0:H.car_id)||null),P=N(((le=e.inspection)==null?void 0:le.car_name)||""),f=N(""),S=N(""),T=N(""),$=N(null),B=N({rear_door:!1}),K=N(!1),c=N(""),l=N(""),C=N(g.car_name),M=N(!1),U=N(!1),z=N([]),ne=N(null),_=N([]),x=N(!1),L=N(0);Ee(()=>{var w,h,te,F,oe;if(E((w=e.inspection)==null?void 0:w.plate_number),(h=e.inspection)!=null&&h.car_id&&((te=e.CarDetail)==null?void 0:te.length)>0){const de=e.CarDetail.find(ve=>ve.id===e.inspection.car_id);de&&me(de)}else!((F=e.inspection)!=null&&F.car_id)&&((oe=e.inspection)!=null&&oe.car_name)&&(C.value=e.inspection.car_name,g.car_id=null);window.addEventListener("keydown",r),O(),A("update:hasUnsavedChanges",ee.value),A("update:validation",ie.value)}),Re(()=>{window.removeEventListener("keydown",r)});const O=()=>{try{const w=localStorage.getItem("vehicle_features");if(w){const h=JSON.parse(w);B.value.rear_door=h.rear_door||!1,h.pick_up?$.value="pick_up":h.box?$.value="box":$.value=null}else B.value.rear_door=!1,$.value=null;m()}catch(w){console.error("Error loading vehicle type from localStorage:",w),B.value.rear_door=!1,$.value=null,m()}},b=()=>{B.value.rear_door=!B.value.rear_door,n()},p=w=>{$.value===w?$.value=null:$.value=w,n()},n=()=>{try{const w={rear_door:B.value.rear_door,pick_up:$.value==="pick_up",box:$.value==="box"};localStorage.setItem("vehicle_features",JSON.stringify(w)),m(),console.log("Vehicle features saved to localStorage:",w)}catch(w){console.error("Error saving vehicle type to localStorage:",w)}},m=()=>{const w={rear_door:B.value.rear_door,pick_up:$.value==="pick_up",box:$.value==="box"};A("update:vehicle-type",w)},E=w=>{if(!w){f.value="",S.value="",T.value="";return}const h=w.toUpperCase().trim(),te=h.match(/^([A-Z]{1,2})?([0-9]{1,4})?([A-Z]{1,3})?$/);if(te)f.value=te[1]||"",S.value=te[2]||"",T.value=te[3]||"";else{let F="area",oe="",de="",ve="";for(const ge of h)F==="area"&&/[A-Z]/.test(ge)?oe+=ge:F==="area"&&/[0-9]/.test(ge)?(F="number",de+=ge):F==="number"&&/[0-9]/.test(ge)?de+=ge:F==="number"&&/[A-Z]/.test(ge)?(F="suffix",ve+=ge):F==="suffix"&&/[A-Z]/.test(ge)&&(ve+=ge);f.value=oe,S.value=de,T.value=ve}X()},X=()=>{const w=`${f.value}${S.value}${T.value}`;g.plate_number=w,u()},j=w=>{w==="area"?f.value=f.value.toUpperCase().replace(/[^A-Z]/g,""):w==="number"?S.value=S.value.replace(/[^0-9]/g,""):w==="suffix"&&(T.value=T.value.toUpperCase().replace(/[^A-Z]/g,"")),X()},q=Y(()=>{const w=g.plate_number;return/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test(w)}),J=Y(()=>!C.value||C.value.trim()===""),se=Y(()=>g.plate_number.length>0&&!q.value?"Format plat nomor tidak valid.":null),ie=Y(()=>{const w=!g.plate_number||g.plate_number.trim()==="",h=!C.value||C.value.trim()==="";return w||h||!q.value||K.value}),ee=Y(()=>{const w=g.plate_number!==I.value,h=g.car_id!==v.value||C.value!==P.value;return w||h}),re=Y(()=>ee.value&&!ie.value),ue=w=>{var te,F,oe;if(!w)return"";const h=[];return(te=w.brand)!=null&&te.name&&h.push(w.brand.name),(F=w.model)!=null&&F.name&&h.push(w.model.name),(oe=w.type)!=null&&oe.name&&h.push(w.type.name),w.cc&&h.push((w.cc/1e3).toFixed(1)),w.transmission&&h.push(w.transmission),w.year&&h.push(w.year.toString()),w.fuel_type&&h.push(w.fuel_type),w.production_period&&h.push(`(${w.production_period})`),h.join(" ")},pe=()=>{g.car_id&&(g.car_id=null,ne.value=null,_.value=[]),Ae()},Ae=It.debounce(()=>{if(!C.value.trim()){z.value=[],M.value=!1;return}U.value=!0;try{const w=C.value.toLowerCase().trim();z.value=e.CarDetail.filter(h=>ue(h).toLowerCase().includes(w)),M.value=!0}finally{U.value=!1}},300),ke=()=>{setTimeout(()=>{M.value=!1,g.car_name=C.value,u()},200)},me=async w=>{ne.value=w,C.value=ue(w),g.car_id=w.id,g.car_name=ue(w),M.value=!1,await $e(w.id),u(),A("update:hasUnsavedChanges",ee.value),A("update:validation",ie.value)},we=w=>!w||!w.file_path?"":`/storage/${w.file_path}`,$e=async w=>{try{const h=await fetch(`/api/cars/${w}/images`);if(h.ok){const te=await h.json();_.value=Array.isArray(te)?te:[]}else _.value=[]}catch(h){console.error("Error loading car images:",h),_.value=[]}},Se=w=>{L.value=w,x.value=!0,document.body.style.overflow="hidden"},Ie=()=>{x.value=!1,document.body.style.overflow=""},_e=()=>{L.value=(L.value+1)%_.value.length},o=()=>{L.value=(L.value-1+_.value.length)%_.value.length},r=w=>{if(x.value)switch(w.key){case"Escape":Ie();break;case"ArrowRight":_e();break;case"ArrowLeft":o();break}},u=()=>{const w={plate_number:g.plate_number,car_id:g.car_id,car_name:g.car_name};A("update-vehicle",w)},V=()=>{e.inspection&&g.post(route("inspections.updateVehicleDetails",{inspection:e.inspection.id}),{preserveScroll:!0,onSuccess:()=>{I.value=g.plate_number,v.value=g.car_id,P.value=g.car_name,A("update:hasUnsavedChanges",!1),console.log("Data berhasil disimpan!")},onError:w=>{console.error("Gagal menyimpan data:",w)}})};return ce([()=>g.plate_number,()=>g.car_name],w=>{c.value="",K.value=!1,l.value="";const h=w[0];if(h&&h.length>=6){const te=e.allInspections.filter(F=>{var oe;return F.plate_number===h&&F.id!==((oe=e.inspection)==null?void 0:oe.id)});if(te.length>0){const F=["draft","in_progress","pending","pending_review","revision"],oe=te.find(de=>F.includes(de.status));if(oe)K.value=!0,c.value=`Nomor plat ini sedang dalam proses inspeksi dengan status: ${oe.status.replace(/_/g," ").toUpperCase()}.`;else{const de=te.filter(ve=>["approved","rejected","completed","cancelled"].includes(ve.status));if(de.length>0){de.sort((ge,Ue)=>new Date(Ue.created_at)-new Date(ge.created_at));const ve=de[0];if(ve.car_id){const ge=e.CarDetail.find(Ue=>Ue.id===ve.car_id);ge&&me(ge)}else ve.car_name&&(C.value=ve.car_name,g.car_name=ve.car_name,g.car_id=null);l.value=`Nomor plat ini sudah pernah diperiksa ${de.length} kali sebelumnya.`}}}}A("update:hasUnsavedChanges",ee.value),A("update:validation",ie.value)},{deep:!0}),ce([()=>B.value.rear_door,()=>$.value],()=>{n()}),(w,h)=>{var te;return s(),i("div",Lt,[h[27]||(h[27]=t("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[t("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),a.inspection?(s(),i("div",Rt,[t("div",Bt,[h[11]||(h[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nomor Plat Kendaraan ",-1)),t("div",jt,[Ne(t("input",{"onUpdate:modelValue":h[0]||(h[0]=F=>f.value=F),type:"text",placeholder:"Contoh: B",class:ae(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!q.value||K.value}]),onInput:h[1]||(h[1]=F=>j("area")),maxlength:"2"},null,34),[[Pe,f.value]]),Ne(t("input",{"onUpdate:modelValue":h[2]||(h[2]=F=>S.value=F),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:ae(["w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!q.value||K.value}]),onInput:h[3]||(h[3]=F=>j("number")),maxlength:"4"},null,34),[[Pe,S.value]]),Ne(t("input",{"onUpdate:modelValue":h[4]||(h[4]=F=>T.value=F),type:"text",placeholder:"ABC",class:ae(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!q.value||K.value}]),onInput:h[5]||(h[5]=F=>j("suffix")),maxlength:"3"},null,34),[[Pe,T.value]])]),se.value?(s(),i("span",Ft,D(se.value),1)):d("",!0),c.value?(s(),i("span",qt,D(c.value),1)):d("",!0),l.value?(s(),i("span",Kt,D(l.value),1)):d("",!0)]),t("div",Ot,[h[15]||(h[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Jenis Kendaraan ",-1)),t("div",Ht,[t("div",{class:ae(["w-full px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":B.value.rear_door,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":!B.value.rear_door}]),onClick:b},h[12]||(h[12]=[t("span",null,"Pintu Belakang",-1)]),2),t("div",Gt,[t("div",{class:ae(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":$.value==="pick_up","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":$.value!=="pick_up"}]),onClick:h[6]||(h[6]=F=>p("pick_up"))}," Pick Up ",2),t("div",{class:ae(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":$.value==="box","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":$.value!=="box"}]),onClick:h[7]||(h[7]=F=>p("box"))}," Box ",2)])]),t("div",zt,[t("div",Wt,[h[14]||(h[14]=t("svg",{class:"w-4 h-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),t("div",Jt,[h[13]||(h[13]=t("p",{class:"font-medium"},"Status Kendaraan:",-1)),t("p",Zt,[B.value.rear_door?(s(),i("span",Yt," ‚úì Mobil Pada Umum nya yang memiliki Pintu Belakang ")):d("",!0),$.value==="pick_up"?(s(),i("span",Xt," ‚úì Pick Up ")):d("",!0),$.value==="box"?(s(),i("span",Qt," ‚úì Box ")):d("",!0),!B.value.rear_door&&!$.value?(s(),i("span",ea," Pilih jenis kendaraan agar point bisa menyesuaikan dengan tipe kendaraan anda ")):d("",!0)])])])])]),t("div",ta,[h[19]||(h[19]=t("label",{class:"block text-sm font-medium text-gray-700"}," Nama Mobil ",-1)),t("div",aa,[Ne(t("input",{"onUpdate:modelValue":h[8]||(h[8]=F=>C.value=F),type:"text",placeholder:"Cari atau ketik nama mobil...",class:ae(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{"border-red-500 focus:border-red-500":J.value}]),onInput:pe,onFocus:h[9]||(h[9]=F=>M.value=!0),onBlur:ke},null,34),[[Pe,C.value]]),U.value?(s(),i("div",na,h[16]||(h[16]=[t("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):d("",!0),J.value?(s(),i("span",sa,"Nama mobil tidak boleh kosong.")):d("",!0),!Te(g).car_id&&C.value?(s(),i("div",oa,h[17]||(h[17]=[Nt('<div class="flex items-start" data-v-93565d5f><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-600 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-93565d5f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-93565d5f></path></svg><div data-v-93565d5f><p class="text-yellow-800 font-medium mb-1" data-v-93565d5f>Informasi Penting</p><p class="text-yellow-700 text-sm mb-2" data-v-93565d5f> Anda memasukkan nama mobil secara manual. Data detail mobil (spesifikasi, gambar, deskripsi) <span class="font-semibold" data-v-93565d5f>tidak akan tersedia</span> dalam laporan inspeksi. </p><p class="text-yellow-700 text-sm mb-2" data-v-93565d5f> Untuk laporan yang lengkap dengan semua detail mobil, silakan pilih mobil dari hasil pencarian. </p><p class="text-yellow-700 text-sm" data-v-93565d5f> Jika tidak ingin mengubah data mobil dan anda tidak sengaja sudah menghapus atau edit, <span class="font-semibold" data-v-93565d5f>jangan klik tombol &quot;Perbarui Detail Kendaraan&quot;</span>. Sebagai gantinya, <span class="font-semibold" data-v-93565d5f>refresh halaman</span> untuk kembali ke data awal. </p></div></div>',1)]))):d("",!0),M.value?(s(),i("div",ia,[z.value.length>0?(s(),i("div",la,[(s(!0),i(be,null,ye(z.value,F=>(s(),i("div",{key:F.id,class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:oe=>me(F)},[t("div",ua,D(ue(F)),1),t("div",da,D(F.year)+" ‚Ä¢ "+D(F.cc)+"cc ‚Ä¢ "+D(F.transmission)+" ‚Ä¢ "+D(F.fuel_type),1)],40,ra))),128))])):(s(),i("div",ca,h[18]||(h[18]=[fe(" Tidak ada data mobil yang cocok. "),t("br",null,null,-1),fe(" Silakan input manual dengan format: "),t("br",null,null,-1),t("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):d("",!0)])]),Te(g).car_id&&ne.value?(s(),i("div",pa,[ne.value.description?(s(),i("div",ga,[h[20]||(h[20]=t("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),t("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:ne.value.description},null,8,ma)])):d("",!0),_.value.length>0?(s(),i("div",va,[h[21]||(h[21]=t("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),t("div",fa,[(s(!0),i(be,null,ye(_.value,(F,oe)=>(s(),i("div",{key:F.id||oe,class:"relative group cursor-pointer",onClick:de=>Se(oe)},[t("img",{src:we(F),alt:F.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,ba),F.note?(s(),i("div",ya,[t("p",xa,D(F.note),1)])):d("",!0)],8,ha))),128))])])):(s(),i("div",ka," Tidak ada gambar tersedia untuk mobil ini "))])):d("",!0),x.value?(s(),i("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:Ie},[t("div",wa,[t("button",{onClick:Ie,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},h[22]||(h[22]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),_.value.length>1?(s(),i("button",{key:0,onClick:De(o,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},h[23]||(h[23]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):d("",!0),_.value.length>1?(s(),i("button",{key:1,onClick:De(_e,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},h[24]||(h[24]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):d("",!0),t("img",{src:we(_.value[L.value]),alt:"Car Image "+(L.value+1),class:"max-w-full max-h-full object-contain",onClick:h[10]||(h[10]=De(()=>{},["stop"]))},null,8,Ia),_.value.length>1?(s(),i("div",_a,D(L.value+1)+" / "+D(_.value.length),1)):d("",!0),(te=_.value[L.value])!=null&&te.note?(s(),i("div",Aa,D(_.value[L.value].note),1)):d("",!0)])])):d("",!0),he(Dt,{type:"button",onClick:V,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed",disabled:!re.value},{default:Ve(()=>[Te(g).processing?(s(),i("svg",Sa,h[25]||(h[25]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):d("",!0),t("span",null,D(Te(g).processing?"Mengirim...":"Perbarui Detail Kendaraan"),1),he(Mt,{on:Te(g).recentlySuccessful,class:"me-3 text-sm text-green-600 font-medium"},{default:Ve(()=>h[26]||(h[26]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),fe(" Tersimpan. ")])),_:1,__:[26]},8,["on"])]),_:1},8,["disabled"])])):d("",!0)])}}},xi=Ce($a,[["__scopeId","data-v-93565d5f"]]),Va={class:"mt-1"},Ca=["value","required","minlength","maxlength","allowSpace","placeholder"],Ta={key:0,class:"mt-2 text-sm text-red-600"},_t={__name:"InputText",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],pattern:String,placeholder:String,error:String,pointId:[String,Number],textTransform:{type:String,default:"none"},allowSpace:{type:Boolean,default:!0}},emits:["update:modelValue","save"],setup(a,{emit:G}){const e=a,A=G,g=Y(()=>{if(!e.modelValue)return"";let v=e.modelValue;switch(e.allowSpace||(v=v.replace(/\s+/g,"")),e.textTransform){case"uppercase":return v.toUpperCase();case"lowercase":return v.toLowerCase();case"capitalize":return v.replace(/\b\w/g,P=>P.toUpperCase());default:return v}}),I=v=>{let P=v.target.value;switch(e.allowSpace||(P=P.replace(/\s+/g,"")),e.textTransform){case"uppercase":P=P.toUpperCase();break;case"lowercase":P=P.toLowerCase();break;case"capitalize":P=P.replace(/\b\w/g,f=>f.toUpperCase());break}A("update:modelValue",P),A("save",e.pointId)};return(v,P)=>(s(),i("div",Va,[t("input",{value:g.value,onInput:I,type:"text",required:a.required,minlength:a.minLength,maxlength:a.maxLength,allowSpace:a.allowSpace,placeholder:a.placeholder,class:ae(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{uppercase:a.textTransform==="uppercase",lowercase:a.textTransform==="lowercase",capitalize:a.textTransform==="capitalize"}])},null,42,Ca),a.error?(s(),i("p",Ta,D(a.error),1)):d("",!0)]))}},Na={class:"mt-1"},Ua=["value","required","min","max","step","placeholder"],Ea={key:0,class:"mt-2 text-sm text-red-600"},At={__name:"InputNumber",props:{modelValue:[String,Number],required:Boolean,min:[String,Number],max:[String,Number],step:[String,Number],placeholder:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(a,{emit:G}){const e=a,A=G,g=I=>{const v=I.target.value;A("update:modelValue",v),A("save",e.pointId)};return(I,v)=>(s(),i("div",Na,[t("input",{value:a.modelValue,onInput:g,type:"number",required:a.required,min:a.min,max:a.max,step:a.step,placeholder:a.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Ua),a.error?(s(),i("p",Ea,D(a.error),1)):d("",!0)]))}},Pa={class:"mt-1"},Da=["value","required","min","max"],Ma={key:0,class:"mt-2 text-sm text-red-600"},St={__name:"InputDate",props:{modelValue:String,required:Boolean,minDate:String,maxDate:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(a,{emit:G}){const e=a,A=G,g=I=>{A("update:modelValue",I.target.value),A("save",e.pointId)};return(I,v)=>(s(),i("div",Pa,[t("input",{value:a.modelValue,onChange:g,type:"date",required:a.required,min:a.minDate,max:a.maxDate,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Da),a.error?(s(),i("p",Ma,D(a.error),1)):d("",!0)]))}},La={class:"mt-1"},Ra=["value","required","placeholder"],Ba={key:0,class:"mt-2 text-sm text-red-600"},$t={__name:"InputAccount",props:{modelValue:[String,Number],required:Boolean,placeholder:String,error:String,pointId:[String,Number],settings:{type:Object,default:()=>({currency_symbol:"Rp",thousands_separator:",",min_value:0,max_value:1e9})}},emits:["update:modelValue","save"],setup(a,{emit:G}){const e=a,A=G,g=N(""),I=Y(()=>{var T,$,B,K;return{currency_symbol:((T=e.settings)==null?void 0:T.currency_symbol)||"Rp",thousands_separator:(($=e.settings)==null?void 0:$.thousands_separator)||",",min_value:((B=e.settings)==null?void 0:B.min_value)!==void 0?Number(e.settings.min_value):0,max_value:((K=e.settings)==null?void 0:K.max_value)!==void 0?Number(e.settings.max_value):1e9}}),v=T=>{if(T==null||T==="")return"";const $=Number(T);if(isNaN($))return"";let B=$.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return I.value.thousands_separator!==","&&(B=B.replace(/,/g,I.value.thousands_separator)),B},P=T=>T?T.replace(/[^\d]/g,""):"",f=Y(()=>g.value?`${I.value.currency_symbol} ${v(g.value)}`:""),S=T=>{let $=P(T.target.value),B=Number($);I.value.min_value!==void 0&&B<I.value.min_value&&($=I.value.min_value.toString()),I.value.max_value!==void 0&&B>I.value.max_value&&($=I.value.max_value.toString()),g.value=$,A("update:modelValue",$),A("save",e.pointId)};return ce(()=>e.modelValue,T=>{T!=null&&(g.value=T.toString())},{immediate:!0}),(T,$)=>(s(),i("div",La,[t("input",{value:f.value,onInput:S,type:"text",required:a.required,placeholder:a.placeholder,class:ae(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",a.error?"border-red-300":"border-gray-300"])},null,42,Ra),a.error?(s(),i("p",Ba,D(a.error),1)):d("",!0)]))}},ja={class:"mt-1 space-y-3"},Fa={key:0,class:"space-y-2"},qa={class:"flex flex-wrap gap-2"},Ka=["onClick"],Oa=["value","required","minlength","maxlength","placeholder"],Ha={class:"flex justify-between items-center mt-1"},Ga={class:"text-xs text-gray-500"},za={key:0,class:"text-xs text-red-600"},Vt={__name:"InputTextarea",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],placeholder:String,error:String,pointId:[String,Number],inspectionId:[String,Number],settings:Object},emits:["update:modelValue","save"],setup(a,{emit:G}){const e=a,A=G,g=N([]),I=N(""),v=T=>g.value.some($=>$.value===T),P=T=>{v(T.value)?g.value=g.value.filter(c=>c.value!==T.value):g.value.push(T);const B=[...g.value.map(c=>c.value)];I.value.trim()&&B.push(I.value.trim());const K=B.join(", ");A("update:modelValue",K),A("save",{pointId:e.pointId,inspectionId:e.inspectionId,notes:K})},f=T=>{const $=T.target.value;A("update:modelValue",$),A("save",{pointId:e.pointId,inspectionId:e.inspectionId,notes:$}),S($)},S=T=>{var c,l,C,M;if(!T){g.value=[],I.value="";return}const $=T.split(",").map(U=>U.trim()).filter(U=>U),B=((l=(c=e.settings)==null?void 0:c.damage_options)==null?void 0:l.map(U=>U.value))||[];g.value=((M=(C=e.settings)==null?void 0:C.damage_options)==null?void 0:M.filter(U=>$.includes(U.value)))||[];const K=$.filter(U=>!B.includes(U));I.value=K.join(", ")};return ce(()=>e.modelValue,T=>{T!=null&&S(T)},{immediate:!0}),(T,$)=>{var B,K,c;return s(),i("div",ja,[(B=a.settings)!=null&&B.enable_damage&&((K=a.settings)!=null&&K.damage_options)?(s(),i("div",Fa,[$[0]||($[0]=t("h4",{class:"text-sm font-medium text-gray-700"},"Pilih Kerusakan:",-1)),t("div",qa,[(s(!0),i(be,null,ye(a.settings.damage_options,(l,C)=>(s(),i("button",{key:C,type:"button",onClick:M=>P(l),class:ae(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors border",{"border-indigo-500 bg-indigo-100 text-indigo-700":v(l.value),"border-gray-300 bg-white text-gray-700 hover:bg-gray-50":!v(l.value)}])},D(l.label),11,Ka))),128))])])):d("",!0),t("div",null,[t("textarea",{value:a.modelValue,onInput:f,required:a.required,minlength:a.minLength,maxlength:a.maxLength,placeholder:a.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",rows:"4"},null,40,Oa),t("div",Ha,[t("span",Ga,D(((c=a.modelValue)==null?void 0:c.length)||0)+"/"+D(a.maxLength||400),1),a.error?(s(),i("p",za,D(a.error),1)):d("",!0)])])])}}},Wa={class:"mt-1"},Ja=["value","required"],Za={key:0,class:"mt-2 text-sm text-red-600"},Ya={__name:"InputSelect",props:{modelValue:String,required:Boolean,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(a,{emit:G}){const e=a,A=G,g=I=>{A("update:modelValue",I.target.value),A("save",e.pointId)};return(I,v)=>(s(),i("div",Wa,[t("select",{value:a.modelValue,onChange:g,required:a.required,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},v[0]||(v[0]=[t("option",{value:"",disabled:""},"Select status",-1),t("option",{value:"good"},"Good",-1),t("option",{value:"bad"},"Bad",-1),t("option",{value:"na"},"N/A",-1)]),40,Ja),a.error?(s(),i("p",Za,D(a.error),1)):d("",!0)]))}},Xa=Ce(Ya,[["__scopeId","data-v-1b6c0201"]]),Qa={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},en={class:"bg-white rounded-xl p-8 w-full max-w-sm mx-auto shadow-2xl transform transition-all duration-300 scale-100 opacity-100"},tn={class:"text-xs text-gray-500 mt-2 text-center"},an={class:"flex flex-row space-x-4 mb-6"},nn={class:"mt-4 text-right"},sn={__name:"ImageSourceOptionsModal",props:{show:{type:Boolean,default:!1},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})}},emits:["close","open-webcam","trigger-gallery"],setup(a){return(G,e)=>a.show?(s(),i("div",Qa,[t("div",en,[e[7]||(e[7]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2 text-center"},"Pilih Sumber Gambar",-1)),t("p",tn,[e[3]||(e[3]=fe("Ambil Foto Maksimal: ")),t("b",null,D(a.settings.max_files),1),e[4]||(e[4]=fe(" Dengan Rasio & Ukuran: ")),t("b",null,D(a.settings.camera_aspect_ratio),1)]),t("div",an,[t("button",{onClick:e[0]||(e[0]=A=>G.$emit("open-webcam")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},e[5]||(e[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),t("span",{class:"text-sm font-medium"},"Kamera",-1)])),t("button",{onClick:e[1]||(e[1]=A=>G.$emit("trigger-gallery")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},e[6]||(e[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),t("span",{class:"text-sm font-medium"},"Galeri",-1)]))]),t("div",nn,[t("button",{onClick:e[2]||(e[2]=A=>G.$emit("close")),class:"px-5 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-colors duration-200 ease-in-out"}," Batal ")])])])):d("",!0)}},on={key:0,class:"fixed inset-0 bg-black bg-opacity-95 z-50 flex flex-col items-center justify-center"},ln={class:"w-full h-full flex flex-col"},rn={class:"flex justify-between items-center p-4 bg-black bg-opacity-70 text-white shadow-md"},un=["disabled"],dn={class:"text-lg font-semibold"},cn={class:"flex items-center gap-2"},pn=["disabled"],gn=["disabled"],mn={class:"flex-1 flex items-center justify-center overflow-hidden relative"},vn=["src"],fn={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},hn={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},bn=["disabled"],yn=["disabled"],xn=["disabled"],kn={class:"flex flex-col gap-3 p-4 bg-black bg-opacity-70 shadow-inner"},wn={class:"flex justify-between items-center w-full"},In=["disabled"],_n={key:1,class:"flex-1"},An=["disabled"],Sn={class:"flex gap-3 w-full"},$n={key:1,class:"flex-1 px-4 py-3 bg-gradient-to-r from-indigo-700 to-sky-600 rounded-lg cursor-not-allowed flex items-center justify-center font-medium opacity-75",disabled:""},Vn={class:"flex items-center gap-2"},Cn={key:0,class:"text-center"},Tn={__name:"PreviewModal",props:{show:Boolean,images:{type:Array,default:()=>[]},initialIndex:{type:Number,default:0},allowMultiple:Boolean,maxFiles:Number,isUploading:Boolean,aspectRatio:Number,point:Object,uploadProgress:{type:Number,default:0},currentUpload:{type:Number,default:0},totalUpload:{type:Number,default:0}},emits:["close","saveImages","removePreviewImage","triggerAddMorePhotos","update:images","retryImage"],setup(a,{emit:G}){const e=a,A=G,g=N(0),I=N([]),v=Y(()=>I.value.length>0?I.value[g.value]:null);ce(()=>e.images,M=>{I.value=M.map(U=>({...U,rotation:U.rotation||0})),M.length===0&&e.show&&B()},{deep:!0,immediate:!0}),ce(()=>e.show,M=>{M&&e.images.length>0&&(g.value=e.initialIndex)}),ce(()=>e.uploadProgress,M=>{M===100&&console.log("Upload completed")});const P=M=>M.preview||(M.image_path?`/${M.image_path}`:""),f=()=>{if(v.value&&!e.isUploading){const M=(v.value.rotation+90)%360;I.value[g.value].rotation=M,A("update:images",I.value)}},S=()=>{e.isUploading||(g.value=g.value<I.value.length-1?g.value+1:0)},T=()=>{e.isUploading||(g.value=g.value>0?g.value-1:I.value.length-1)},$=()=>{e.isUploading||A("saveImages",I.value)},B=()=>{e.isUploading||A("close")},K=()=>{if(v.value&&!e.isUploading){const M=v.value,U=I.value.findIndex(z=>z.isNew&&M.isNew&&z.preview===M.preview||!z.isNew&&!M.isNew&&z.id===M.id);U!==-1&&(A("removePreviewImage",M),I.value.splice(U,1),A("update:images",I.value)),g.value>=I.value.length&&(g.value=Math.max(0,I.value.length-1)),I.value.length===0&&A("close")}},c=()=>{e.isUploading||A("triggerAddMorePhotos")},l=()=>{v.value&&!e.isUploading&&A("retryImage",v.value)},C=M=>{M.key==="Escape"&&!e.isUploading&&B()};return Ee(()=>{document.addEventListener("keydown",C)}),Re(()=>{document.removeEventListener("keydown",C)}),(M,U)=>{var z;return a.show?(s(),i("div",on,[t("div",ln,[t("div",rn,[t("button",{onClick:B,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:a.isUploading},U[0]||(U[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,un),t("div",dn,D(((z=a.point)==null?void 0:z.name)||"Preview")+" ("+D(g.value+1)+"/"+D(I.value.length)+") ",1),t("div",cn,[v.value&&v.value.isNew?(s(),i("button",{key:0,onClick:K,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors","aria-label":"Remove new image",disabled:a.isUploading},U[1]||(U[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]),8,pn)):d("",!0),v.value&&v.value.isNew?(s(),i("button",{key:1,onClick:f,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:a.isUploading},U[2]||(U[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]),8,gn)):d("",!0)])]),t("div",mn,[t("div",{class:"relative w-full max-w-full",style:Le({paddingTop:a.aspectRatio?100/a.aspectRatio+"%":"75%"})},[v.value?(s(),i("img",{key:0,src:P(v.value),class:"absolute inset-0 w-full h-full object-contain transition-transform duration-300 ease-in-out bg-black",style:Le({transform:`rotate(${v.value.rotation}deg)`})},null,12,vn)):d("",!0),v.value&&v.value.isUploading?(s(),i("div",fn,U[3]||(U[3]=[t("div",{class:"text-center text-white"},[t("div",{class:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto mb-2"}),t("p",{class:"text-sm"},"Mengupload...")],-1)]))):d("",!0),v.value&&v.value.isFailed?(s(),i("div",hn,[U[4]||(U[4]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),U[5]||(U[5]=t("p",{class:"text-lg font-medium mb-2"},"Upload Gagal",-1)),t("button",{onClick:l,class:"px-4 py-2 bg-white text-red-600 rounded-lg font-medium hover:bg-gray-100 transition-colors",disabled:a.isUploading}," Coba Lagi ",8,bn)])):d("",!0)],4),I.value.length>1&&!a.isUploading?(s(),i("button",{key:0,onClick:T,class:"absolute left-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:a.isUploading},U[6]||(U[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]),8,yn)):d("",!0),I.value.length>1&&!a.isUploading?(s(),i("button",{key:1,onClick:S,class:"absolute right-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:a.isUploading},U[7]||(U[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,xn)):d("",!0)]),t("div",kn,[t("div",wn,[v.value&&!v.value.isNew?(s(),i("button",{key:0,onClick:K,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-red-400",disabled:a.isUploading},U[8]||(U[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),fe(" Hapus Foto ")]),8,In)):(s(),i("div",_n)),a.allowMultiple&&I.value.length<a.maxFiles&&!a.isUploading?(s(),i("button",{key:2,onClick:c,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-indigo-400",disabled:a.isUploading},U[9]||(U[9]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),fe(" Tambah Foto ")]),8,An)):d("",!0)]),t("div",Sn,[a.isUploading?(s(),i("button",$n,[t("div",Vn,[U[10]||(U[10]=t("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)),t("span",null,"Mengupload... "+D(a.uploadProgress)+"%",1)])])):(s(),i("button",{key:0,onClick:$,class:"flex-1 px-4 py-3 rounded-lg bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white transition-colors font-medium hover:from-indigo-600 hover:to-sky-500"}," Simpan & Upload "))]),a.isUploading?(s(),i("div",Cn,U[11]||(U[11]=[t("p",{class:"text-xs text-blue-300"}," Modal akan tertutup otomatis. Upload terus berjalan di background. ",-1)]))):d("",!0)])])])):d("",!0)}}},Nn=Ce(Tn,[["__scopeId","data-v-d8723645"]]),Un={key:0,class:"fixed inset-0 z-40 p-0 webcam-modal-container"},En={class:"webcam-content-box"},Pn={class:"webcam-header"},Dn={class:"inspection-point-name"},Mn={key:1,class:"auto-focus-indicator"},Ln={key:2,class:"loading-overlay"},Rn={key:3,class:"error-overlay"},Bn={class:"error-content"},jn={class:"error-message"},Fn={class:"webcam-footer"},qn={class:"camera-controls"},Kn=["disabled"],On={class:"camera-icon-container"},Hn={key:0,class:"camera-spinner"},Gn={key:1,class:"camera-shutter"},zn=["disabled"],Wn={__name:"WebCamRTC",props:{show:Boolean,aspectRatio:Number,settings:Object,point:Object},emits:["close","photoCaptured"],setup(a,{emit:G}){const e=a,A=G,g=N(null),I=N(null);let v=null,P=null;const f=N("environment"),S=N(null),T=N([]),$=N(!1),B=N(!1),K=N(!1),c=N(!1),l=N(!1),C=N(null),M=N(!1),U=N(!0),z=N({});Y(()=>{var j;return((j=e.settings)==null?void 0:j.max_size)||2048});const ne=Y(()=>e.aspectRatio?{aspectRatio:`${e.aspectRatio} / 1`,maxWidth:"100%",maxHeight:"70vh",margin:"0 auto"}:{}),_=async()=>{v&&v.getTracks().forEach(j=>j.stop()),C.value=null;try{const j={facingMode:{ideal:"environment"},width:{ideal:1920},height:{ideal:1080}};v=await navigator.mediaDevices.getUserMedia({video:j,audio:!1}),P=v.getVideoTracks()[0],g.value.srcObject=v,await g.value.play(),setTimeout(async()=>{try{await L(),await b(),x()}catch(q){console.warn("Background camera setup failed:",q)}},100)}catch(j){console.error("Error accessing camera: ",j),C.value=O(j),l.value=!1}},x=()=>{let j=!0;const q=()=>{v&&(U.value=j,j=!j,setTimeout(q,j?2e3:500))};q()},L=async()=>{try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(J=>J.stop());const q=await navigator.mediaDevices.enumerateDevices();if(T.value=q.filter(J=>J.kind==="videoinput"),$.value=T.value.length>1,!S.value&&T.value.length>0){const J=T.value.find(se=>se.label.toLowerCase().includes("back")||se.label.toLowerCase().includes("rear")||se.label.toLowerCase().includes("environment"));S.value=J?J.deviceId:T.value[0].deviceId}}catch(j){console.error("Error getting camera devices:",j)}},O=j=>{switch(j.name){case"NotAllowedError":return"Izin akses kamera ditolak. Silakan izinkan akses kamera di pengaturan browser.";case"NotFoundError":return"Tidak ada kamera yang ditemukan.";case"NotSupportedError":return"Browser tidak mendukung akses kamera.";case"NotReadableError":return"Kamera sedang digunakan oleh aplikasi lain.";default:return`Tidak dapat mengakses kamera: ${j.message}`}},b=async()=>{if(P)try{const j=P.getCapabilities();B.value=!!j.torch}catch(j){console.error("Error checking camera capabilities:",j)}},p=async()=>{if(!(!P||!B.value))try{f.value==="user"||await P.applyConstraints({advanced:[{torch:!K.value}]}),K.value=!K.value}catch(j){console.error("Flash toggle failed:",j)}},n=async()=>{if(!$.value||l.value)return;l.value=!0,v&&v.getTracks().forEach(se=>se.stop());const q=(T.value.findIndex(se=>se.deviceId===S.value)+1)%T.value.length;S.value=T.value[q].deviceId;const J=T.value[q];f.value=J.label.toLowerCase().includes("front")?"user":"environment",await _()},m=async()=>{var j;if(!(c.value||!g.value||!I.value)){c.value=!0;try{const q=g.value,J=I.value,se=q.videoWidth,ie=q.videoHeight;let ee,re,ue,pe;se/ie>e.aspectRatio?(re=ie,ee=ie*e.aspectRatio,ue=(se-ee)/2,pe=0):(ee=se,re=se/e.aspectRatio,ue=0,pe=(ie-re)/2),J.width=ee,J.height=re,J.getContext("2d").drawImage(q,ue,pe,ee,re,0,0,ee,re);const ke=await new Promise(me=>{J.toBlob(me,"image/jpeg",.92)});if(ke){const me=`inspeksi_${((j=e.point)==null?void 0:j.name)||"foto"}_${Date.now()}.jpg`,we=new File([ke],me,{type:"image/jpeg",lastModified:Date.now()});A("photoCaptured",we)}}catch(q){console.error("Error capturing photo:",q)}finally{c.value=!1}}},E=()=>{v&&v.getTracks().forEach(j=>j.stop()),A("close")},X=async()=>{C.value=null,await _()};return ce(()=>e.show,async j=>{j?(await Fe(),await _()):E()}),Re(()=>{v&&v.getTracks().forEach(j=>j.stop())}),(j,q)=>{var J;return a.show?(s(),i("div",Un,[t("div",En,[t("div",Pn,[t("div",Dn,D(((J=a.point)==null?void 0:J.name)||"Camera"),1),t("button",{onClick:E,class:"p-2 rounded-full text-white hover:bg-gray-700 transition-colors"},q[0]||(q[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",{class:"webcam-video-container",style:Le(ne.value)},[t("video",{ref_key:"webcamVideo",ref:g,autoplay:"",playsinline:"",class:"webcam-video"},null,512),t("canvas",{ref_key:"webcamCanvas",ref:I,class:"hidden"},null,512),M.value?(s(),i("div",{key:0,class:"focus-indicator",style:Le(z.value)},q[1]||(q[1]=[t("div",{class:"focus-ring"},null,-1)]),4)):d("",!0),U.value?(s(),i("div",Mn,q[2]||(q[2]=[t("div",{class:"auto-focus-ring"},null,-1)]))):d("",!0),l.value?(s(),i("div",Ln,q[3]||(q[3]=[t("div",{class:"loading-spinner"},null,-1),t("p",{class:"loading-text"},"Menyiapkan kamera...",-1)]))):d("",!0),C.value?(s(),i("div",Rn,[t("div",Bn,[q[4]||(q[4]=t("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),q[5]||(q[5]=t("h3",{class:"error-title"},"Gagal Mengakses Kamera",-1)),t("p",jn,D(C.value),1),t("button",{onClick:X,class:"retry-button"}," Coba Lagi ")])])):d("",!0)],4),t("div",Fn,[t("div",qn,[a.settings.enable_flash&&B.value?(s(),i("button",{key:0,onClick:p,class:ae(["control-button",{active:K.value}])},q[6]||(q[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2)):d("",!0),t("button",{onClick:m,class:"capture-button",disabled:c.value||l.value},[t("div",On,[c.value?(s(),i("div",Hn)):(s(),i("div",Gn))])],8,Kn),a.settings.enable_camera_switch&&$.value?(s(),i("button",{key:1,onClick:n,class:"control-button",disabled:l.value},q[7]||(q[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]),8,zn)):d("",!0)])])])])):d("",!0)}}},Jn=Ce(Wn,[["__scopeId","data-v-536ade25"]]),Zn=["accept","multiple","disabled"],Yn={class:"text-xs text-gray-500 mb-2"},Xn=["disabled"],Qn={class:"h-full flex flex-col items-center justify-center p-4 text-center"},es={class:"text-xs text-gray-400 mt-1"},ts={key:0,class:"flex items-center gap-4"},as=["src"],ns={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},ss=["disabled"],os={key:1,class:"flex space-x-2 overflow-x-auto pb-2 scrollbar-hide"},is=["disabled"],ls=["onClick"],rs=["src","onError"],us={key:0,class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center text-white text-xs font-bold"},ds={key:0},cs={key:1,class:"ml-1"},ps={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},gs={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},ms={key:2,class:"mt-1 text-xs text-red-600"},vs={__name:"InputImage",props:{modelValue:{type:Array,default:()=>[]},error:String,inspectionId:{type:[String,Number],required:!0},pointId:{type:[String,Number],required:!0},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object},emits:["update:modelValue","save","removeImage","uploaded","uploadProgress"],setup(a,{emit:G}){const e=a,A=G,g=N(null),I=N(null),v=N(!1),P=N(!1),f=N(!1),S=N([]),T=N(0),$=N(!1),B=N(!1),K=N(0),c=N(0),l=N(0),C=wt("imageSourceSetting",N("all")),M=`inspection-${e.inspectionId}-point-${e.pointId}-backup`,U=Y(()=>Number(e.settings.max_files)>1),z=Y(()=>e.settings.allowed_types.map(o=>`.${o}`).join(", ")),ne=Y(()=>{const o=e.settings.camera_aspect_ratio.split(":");if(o.length===2){const r=parseFloat(o[0]),u=parseFloat(o[1]);if(!isNaN(r)&&!isNaN(u)&&u!==0)return r/u}return 3/4}),_=Y(()=>{console.log("üîÑ allImages computed called");const o=[],r=new Set;for(const u of e.modelValue){if(!u||typeof u!="object"||u.id&&r.has(u.id))continue;u.id&&r.add(u.id),console.log("üì• Database image:",u),console.log("üì• Type of preview:",typeof u.preview),console.log("üì• Type of public_url:",typeof u.public_url);const V=x(u);o.push({...V,rotation:V.rotation||0,isNew:!1,isUploaded:!0,isUploading:!1,isFailed:!1})}for(const u of S.value)u.id&&r.add(u.id),o.push({...u,isUploading:u.isUploading||!1,isFailed:u.isFailed||!1});return console.log("‚úÖ Final allImages:",o),o}),x=o=>{if(!o||typeof o!="object")return{};const r={...o};return["preview","public_url","original_url","optimized_url"].forEach(V=>{r[V]&&(r[V]=L(r[V]))}),r.image_path&&(r.image_path=r.image_path.replace(/^storage\//,"")),r},L=o=>{if(!o||typeof o!="string")return o;let r=o.replace(/\/storage\/storage\//g,"/storage/");return r=r.replace(/\/\/storage\/storage\//g,"/storage/"),r.startsWith("storage/")&&(r=`/${r}`),!r.startsWith("/")&&!r.startsWith("http")&&(r=`/storage/${r}`),r},O=o=>{if(!o||typeof o!="object")return console.warn("‚ùå safeImageSrc: image is not object",o),"";const r=b(o);return typeof r!="string"?(console.error("üö® CRITICAL: getImageSrc returned non-string:",typeof r,r),""):(r&&console.log("‚úÖ safeImageSrc result:",r),r)},b=o=>{if(!o||typeof o!="object")return"";if(console.log("üîç getImageSrc called with:",o),console.log("üîç Available fields:",Object.keys(o)),o.preview&&typeof o.preview=="string"){const r=L(o.preview);return console.log("‚úÖ Using preview URL:",r),r}if(o.public_url&&typeof o.public_url=="string"){const r=L(o.public_url);return console.log("‚úÖ Using public_url:",r),r}if(o.original_url&&typeof o.original_url=="string"){const r=L(o.original_url);return console.log("‚úÖ Using original_url:",r),r}if(o.optimized_url&&typeof o.optimized_url=="string"){const r=L(o.optimized_url);return console.log("‚úÖ Using optimized_url:",r),r}if(o.image_path&&typeof o.image_path=="string"){const u=`/storage/${o.image_path.replace(/^\/?storage\//,"")}`;return console.log("‚úÖ Generated from image_path:",u),u}if(o.path&&typeof o.path=="string"){const u=`/storage/${o.path.replace(/^\/?storage\//,"")}`;return console.log("‚úÖ Generated from path:",u),u}return console.warn("‚ö†Ô∏è No valid image source found for:",o),""},p=o=>{console.error("‚ùå Image load error for:",o),console.error("‚ùå Attempted URL:",O(o)),B.value=!0;const r=n(o);if(r&&r!==O(o)){console.log("üîÑ Trying fallback URL:",r);const u=event==null?void 0:event.target;u&&(u.src=r)}},n=o=>{if(!o||typeof o!="object")return"";const r=["original_url","optimized_url","public_url","preview"];for(const u of r)if(o[u]&&typeof o[u]=="string")return L(o[u]);return""},m=()=>{f.value&&(f.value=!1),C.value==="camera"?X():C.value==="gallery"?E():v.value=!0},E=()=>{v.value=!1,g.value.click()},X=()=>{v.value=!1,P.value=!0},j=()=>{v.value=!1,_.value.length>0&&(f.value=!0)},q=()=>{P.value=!1,_.value.length>0&&(f.value=!0)},J=()=>{f.value=!1,$.value||(S.value.forEach(o=>{o.preview&&o.preview.startsWith("blob:")&&URL.revokeObjectURL(o.preview)}),S.value=[])};ce(()=>e.modelValue,o=>{var r;console.log("üîÑ modelValue updated:",o),o&&o.length>0&&(console.log("üìä First image structure:",JSON.stringify(o[0],null,2)),console.log("üîç Type of preview:",typeof((r=o[0])==null?void 0:r.preview)))},{deep:!0});const se=o=>new Promise(r=>{const u=new FileReader;u.onload=V=>{const k=new Image;k.onload=()=>{r({file:o,preview:URL.createObjectURL(o),rotation:0,width:k.naturalWidth,height:k.naturalHeight,isNew:!0})},k.onerror=()=>{console.error("Failed to load image for dimensions:",o.name),r({file:o,preview:URL.createObjectURL(o),rotation:0,width:0,height:0,isNew:!0})},k.src=V.target.result},u.readAsDataURL(o)}),ie=o=>{const r=o.name.split(".").pop().toLowerCase();return e.settings.allowed_types.includes(r)},ee=async o=>{const u=(e.settings.max_size||2048)*1024;return new Promise(V=>{const k=new Image,Z=new FileReader;Z.onload=W=>{k.onload=()=>{const Q=document.createElement("canvas"),H=Q.getContext("2d"),le=Math.max(k.width,k.height);Q.width=le,Q.height=le,H.fillStyle="white",H.fillRect(0,0,le,le);const w=(le-k.width)/2,h=(le-k.height)/2;H.drawImage(k,w,h,k.width,k.height);let te=.9;const F=()=>{Q.toBlob(oe=>{if(oe.size>u&&te>.1)te-=.1,F();else{const de=new File([oe],o.name,{type:"image/jpeg",lastModified:Date.now()});V(de)}},"image/jpeg",te)};F()},k.src=W.target.result},Z.readAsDataURL(o)})},re=async o=>{const r=Array.from(o.target.files);if(!r.length){v.value=!1,_.value.length>0&&(f.value=!0);return}try{const u=r.filter(H=>!ie(H));if(u.length>0){const H=u.map(le=>le.name.split(".").pop()).join(", ");alert(`File type not allowed: ${H}. Allowed types: ${e.settings.allowed_types.join(", ")}`),o.target.value="";return}const V=_.value.length,k=e.settings.max_files-V,Z=await Promise.all(r.slice(0,k).map(async H=>await ee(H))),W=await Promise.all(Z.map(se)),Q=U.value?W:W.slice(0,1);U.value?S.value.push(...Q):(S.value.forEach(H=>{H.preview&&H.preview.startsWith("blob:")&&URL.revokeObjectURL(H.preview)}),S.value=Q),v.value=!1,Q.length>0?(T.value=Math.max(0,_.value.length-Q.length),f.value=!0):_.value.length>0&&(f.value=!0),o.target.value=""}catch(u){console.error("Error processing selected images:",u),alert("Failed to process selected images. Please try again."),v.value=!1,_.value.length>0&&(f.value=!0)}},ue=async o=>{const r=_.value.length;if(!U.value||r<e.settings.max_files)try{const u=await ee(o),V=new Image;V.onload=()=>{const k={file:u,preview:URL.createObjectURL(u),rotation:0,width:V.naturalWidth,height:V.naturalHeight,isNew:!0};U.value?S.value.push(k):(S.value.forEach(Z=>{Z.preview&&Z.preview.startsWith("blob:")&&URL.revokeObjectURL(Z.preview)}),S.value=[k]),P.value=!1,v.value=!1,T.value=_.value.length-1,f.value=!0},V.src=URL.createObjectURL(u)}catch(u){console.error("Error processing captured image:",u),alert("Failed to process captured image. Please try again.")}else alert(`Maximum ${e.settings.max_files} files allowed.`),P.value=!1,v.value=!1,_.value.length>0&&(f.value=!0)},pe=(o=0)=>{T.value=o,f.value=!0},Ae=o=>new Promise(r=>{if(o.rotation===0||!I.value){if(!o.isNew&&!o.file){r({file:null,width:o.width,height:o.height,isOriginal:!0});return}r({file:o.file,width:o.width,height:o.height});return}const u=new Image;u.onload=async()=>{try{const V=I.value,k=V.getContext("2d"),Z=u.width,W=u.height;let Q,H;o.rotation===90||o.rotation===270?(Q=W,H=Z):(Q=Z,H=W),V.width=Q,V.height=H,k.clearRect(0,0,V.width,V.height),k.translate(V.width/2,V.height/2),k.rotate(o.rotation*Math.PI/180),k.drawImage(u,-Z/2,-W/2,Z,W),k.setTransform(1,0,0,1,0,0);const le=await new Promise(te=>{V.toBlob(te,"image/jpeg",.9)}),w=new File([le],o.file?o.file.name:`rotated_image_${Date.now()}.jpg`,{type:"image/jpeg"}),h=await ee(w);r({file:h,width:Q,height:H})}catch(V){console.error("Error processing rotated image:",V),r({file:o.file,width:o.width,height:o.height})}},u.onerror=()=>{console.error("Failed to load image for rotation processing:",o.preview),r({file:o.file,width:o.width,height:o.height})},u.src=o.preview}),ke=o=>{try{const r={images:o.map(u=>{var V;return{fileName:((V=u.file)==null?void 0:V.name)||`image-${Date.now()}.jpg`,rotation:u.rotation||0,width:u.width||0,height:u.height||0,timestamp:Date.now()}}),inspectionId:e.inspectionId,pointId:e.pointId};localStorage.setItem(M,JSON.stringify(r))}catch(r){console.error("Error saving backup:",r)}},me=()=>{localStorage.removeItem(M)},we=async o=>{$.value=!0;const r=[],u=[];if(!e.pointId){alert("Error: Point ID is missing. Cannot upload image."),$.value=!1;return}try{ke(o);for(const V of o){if(!V.isNew&&V.rotation===0&&V.id&&V.image_path){r.push({id:V.id,image_path:V.image_path,width:V.width,height:V.height,rotation:0,preview:V.preview,isUploaded:!0});continue}const{file:k,width:Z,height:W,isOriginal:Q}=await Ae(V);if(Q&&!V.isNew){r.push({id:V.id,image_path:V.image_path,width:V.width,height:V.height,rotation:V.rotation||0,preview:V.preview,isUploaded:!0});continue}k&&u.push({file:k,width:Z,height:W,rotation:V.rotation||0,originalImage:V})}J(),u.length>0?await $e(u,r):(A("update:modelValue",r),A("save",e.pointId))}catch(V){console.error("Error during image processing:",V),alert("Terjadi error saat memproses gambar. Data tersimpan secara lokal.")}finally{$.value=!1}},$e=async(o,r)=>{l.value=o.length,c.value=0,K.value=0;const u=[...r];let V=0;try{for(let k=0;k<o.length;k++){const Z=o[k],W=new FormData;W.append("inspection_id",e.inspectionId),W.append("point_id",e.pointId),W.append("images[]",Z.file);const Q=S.value.findIndex(H=>{var le;return H.preview===((le=Z.originalImage)==null?void 0:le.preview)});Q!==-1&&(S.value[Q].isUploading=!0,S.value[Q].isFailed=!1);try{const le=(await Be.post(route("inspections.upload-image"),W,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:w=>{if(w.total){const h=Math.round(w.loaded*100/w.total);K.value=Math.round((k+w.loaded/w.total)/o.length*100),c.value=k+1}}})).data.images;if(le&&le.length>0){const w=le[0];if(u.push({id:w.image_id,image_path:w.path,width:w.width||Z.width||0,height:w.height||Z.height||0,rotation:Z.rotation||0,preview:w.public_url,isUploaded:!0}),Q!==-1){const h=S.value.splice(Q,1)[0];h.preview&&h.preview.startsWith("blob:")&&URL.revokeObjectURL(h.preview)}V++}}catch(H){console.error(`Error uploading image ${k+1}:`,H),Q!==-1&&(S.value[Q].isUploading=!1,S.value[Q].isFailed=!0)}}V>0&&(A("update:modelValue",u),A("save",e.pointId),A("uploaded",{pointId:e.pointId,images:u,newImagesCount:V})),V===o.length&&me(),console.log(`‚úÖ Successfully uploaded ${V}/${o.length} images`)}catch(k){console.error("Error in upload process:",k),o.forEach(Z=>{const W=S.value.findIndex(Q=>{var H;return Q.preview===((H=Z.originalImage)==null?void 0:H.preview)});W!==-1&&(S.value[W].isUploading=!1,S.value[W].isFailed=!0)})}finally{K.value=0,c.value=0,l.value=0,$.value=!1}},Se=async o=>{if(!o||!o.file){console.error("No file to retry upload");return}$.value=!0;const r=[...e.modelValue];try{const u=new FormData;u.append("inspection_id",e.inspectionId),u.append("point_id",e.pointId),u.append("images[]",o.file);const V=S.value.findIndex(W=>W.preview===o.preview);V!==-1&&(S.value[V].isUploading=!0,S.value[V].isFailed=!1);const Z=(await Be.post(route("inspections.upload-image"),u,{headers:{"Content-Type":"multipart/form-data"}})).data.images;if(Z&&Z.length>0){const W=Z[0];if(r.push({id:W.image_id,image_path:W.path,width:W.width||o.width||0,height:W.height||o.height||0,rotation:o.rotation||0,preview:W.public_url,isUploaded:!0}),V!==-1){const H=S.value.splice(V,1)[0];H.preview&&H.preview.startsWith("blob:")&&URL.revokeObjectURL(H.preview)}A("update:modelValue",r),A("save",e.pointId),A("uploaded",{pointId:e.pointId,images:r,newImagesCount:1}),S.value.some(H=>H.isFailed)||me(),console.log("‚úÖ Successfully retried upload for 1 image")}}catch(u){console.error("Error retrying upload:",u),previewIndex!==-1&&(S.value[previewIndex].isUploading=!1,S.value[previewIndex].isFailed=!0)}finally{$.value=!1}},Ie=o=>{if(o){if(o.id&&!o.isNew)_e(o);else{const r=S.value.findIndex(u=>u.preview&&u.preview===o.preview&&u.isNew||u.id&&u.id===o.id);if(r!==-1){const u=S.value.splice(r,1)[0];u.preview&&u.preview.startsWith("blob:")&&URL.revokeObjectURL(u.preview)}A("update:modelValue",e.modelValue.filter(u=>!(u.id&&u.id===o.id)&&!(u.preview&&u.preview===o.preview)))}T.value>=_.value.length&&(T.value=Math.max(0,_.value.length-1)),_.value.length===0&&J()}},_e=async o=>{var u,V;if(o.id||o.image_path)try{await Be.delete(route("inspections.delete-image"),{data:{image_id:o.id,image_path:o.image_path}})}catch(k){console.error("Error deleting image from server:",k),(V=(u=k.response)==null?void 0:u.data)!=null&&V.message?alert(`Failed to delete image from server: ${k.response.data.message}`):alert(`Failed to delete image from server: ${k.message}`);return}o.preview&&o.preview.startsWith("blob:")&&URL.revokeObjectURL(o.preview);const r=e.modelValue.filter(k=>k.id!==o.id);A("update:modelValue",r),S.value=S.value.filter(k=>k.isNew&&o.isNew?k.preview!==o.preview:k.id!==o.id),A("removeImage",{image:o}),f.value&&_.value.length===0?J():f.value&&T.value>=_.value.length&&(T.value=Math.max(0,_.value.length-1))};return Ee(()=>{try{localStorage.getItem(M)&&console.log("Found backup images, ready for recovery if needed")}catch(o){console.error("Error loading backup:",o)}}),(o,r)=>(s(),i("div",null,[t("input",{ref_key:"galleryInput",ref:g,type:"file",accept:z.value,class:"hidden",onChange:re,multiple:U.value,disabled:$.value},null,40,Zn),t("canvas",{ref_key:"processingCanvas",ref:I,class:"hidden"},null,512),t("p",Yn,"Foto Maksimal: "+D(a.settings.max_files)+" | Rasio: "+D(a.settings.camera_aspect_ratio),1),_.value.length===0?(s(),i("label",{key:0,onClick:m,class:ae(["block w-full border-2 border-dashed rounded-lg cursor-pointer transition-colors duration-200 h-28",{"border-gray-300 hover:border-indigo-400 bg-gray-50":!0}]),disabled:$.value},[t("div",Qn,[r[3]||(r[3]=t("svg",{class:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),r[4]||(r[4]=t("p",{class:"text-sm text-gray-600 font-medium"},"Upload Image",-1)),t("p",es,"Tipe: "+D(z.value),1)])],8,Xn)):(s(),i("div",{key:1,class:ae(["block w-full rounded-lg transition-colors duration-200 p-2",{"border-2 border-dashed border-indigo-200 bg-indigo-50 h-auto p-2":a.settings.max_files==1,"bg-transparent":a.settings.max_files>1}]),"aria-label":"Image gallery"},[a.settings.max_files===1?(s(),i("div",ts,[t("div",{class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:r[1]||(r[1]=u=>pe(0))},[t("img",{src:O(_.value[0]),onError:r[0]||(r[0]=u=>p(_.value[0])),class:"w-full h-full object-cover"},null,40,as),_.value[0].isUploading?(s(),i("div",ns,r[5]||(r[5]=[t("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):d("",!0)]),t("button",{onClick:r[2]||(r[2]=De(u=>_e(_.value[0]),["stop"])),type:"button",class:"flex items-center gap-1 text-red-600 font-medium hover:text-red-800 transition-colors",disabled:$.value},r[6]||(r[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),fe(" Hapus Foto ")]),8,ss)])):(s(),i("div",os,[U.value&&_.value.length<a.settings.max_files?(s(),i("div",{key:0,class:"flex-shrink-0 flex flex-col items-center justify-center p-2 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 transition-colors w-24 h-24",onClick:m,disabled:$.value},r[7]||(r[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),t("p",{class:"mt-1 text-xs text-gray-600"},"Tambah",-1)]),8,is)):d("",!0),(s(!0),i(be,null,ye(_.value,(u,V)=>(s(),i("div",{key:u.id||u.preview||V,class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:k=>u.isFailed?Se(u):pe(V)},[t("img",{src:O(u),onError:k=>p(u),class:"w-full h-full object-cover"},null,40,rs),u.isNew||u.rotation!==0?(s(),i("div",us,[u.isNew?(s(),i("span",ds,"BARU")):d("",!0),u.rotation!==0?(s(),i("span",cs,"ROTASI")):d("",!0)])):d("",!0),u.isUploading?(s(),i("div",ps,r[8]||(r[8]=[t("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):d("",!0),u.isFailed?(s(),i("div",gs,r[9]||(r[9]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),t("span",{class:"text-xs font-medium"},"Retry",-1)]))):d("",!0)],8,ls))),128))]))],2)),a.error?(s(),i("p",ms,D(a.error),1)):d("",!0),he(sn,{show:v.value,settings:a.settings,onClose:j,onOpenWebcam:X,onTriggerGallery:E},null,8,["show","settings"]),he(Jn,{show:P.value,"aspect-ratio":ne.value,settings:a.settings,point:a.point,onClose:q,onPhotoCaptured:ue},null,8,["show","aspect-ratio","settings","point"]),he(Nn,{show:f.value,images:_.value,point:a.point,"initial-index":T.value,"allow-multiple":U.value,"max-files":a.settings.max_files,"is-uploading":$.value,"aspect-ratio":ne.value,"upload-progress":K.value,"current-upload":c.value,"total-upload":l.value,onClose:J,onSaveImages:we,onRemovePreviewImage:Ie,onTriggerAddMorePhotos:m,onRetryImage:Se},null,8,["show","images","point","initial-index","allow-multiple","max-files","is-uploading","aspect-ratio","upload-progress","current-upload","total-upload"])]))}},qe=Ce(vs,[["__scopeId","data-v-7d105018"]]),fs={key:0,class:"fixed inset-0 z-50 overflow-hidden"},hs={class:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[85vh] overflow-hidden flex flex-col"},bs={class:"px-4 pb-2 border-b border-gray-200"},ys={class:"text-lg font-semibold text-gray-900"},xs={key:0,class:"text-sm text-gray-500 mt-1"},ks={class:"flex-1 overflow-y-auto p-4"},ws={key:0,class:"border-t border-gray-200 p-4 bg-gray-50"},Is={__name:"BottomSheetModal",props:{show:Boolean,title:String,subtitle:String},setup(a){return(G,e)=>(s(),xe(Me,{name:"bottom-sheet"},{default:Ve(()=>[a.show?(s(),i("div",fs,[e[1]||(e[1]=t("div",{class:"absolute inset-0 bg-black bg-opacity-50"},null,-1)),t("div",hs,[e[0]||(e[0]=t("div",{class:"flex justify-center py-3"},[t("div",{class:"w-12 h-1.5 bg-gray-300 rounded-full"})],-1)),t("div",bs,[t("h3",ys,D(a.title),1),a.subtitle?(s(),i("p",xs,D(a.subtitle),1)):d("",!0)]),t("div",ks,[xt(G.$slots,"default",{},void 0,!0)]),G.$slots.footer?(s(),i("div",ws,[xt(G.$slots,"footer",{},void 0,!0)])):d("",!0)])])):d("",!0)]),_:3}))}},_s=Ce(Is,[["__scopeId","data-v-fd942535"]]),As={class:"space-y-4"},Ss={key:0,class:"mt-2"},$s={key:1,class:"mt-2"},Vs={key:2,class:"mt-2"},Cs={key:3,class:"mt-2"},Ts={key:4,class:"mt-2"},Ns={class:"text-sm font-medium text-gray-700 mb-2"},Us={key:0,class:"text-red-500"},Es={key:0,class:"text-xs text-red-500"},Ps=["type","name","value","checked","onChange"],Ds={key:6,class:"space-y-2"},Ms={key:0,class:"text-red-500"},Ls={key:1,class:"text-xs text-red-500"},Rs={key:7,class:"mt-4"},Bs={class:"text-sm font-medium text-gray-700 mb-2"},js={key:0,class:"text-red-500"},Fs={key:0,class:"text-xs text-red-500"},qs={class:"flex gap-2"},Ks=["disabled"],Ct={__name:"RadioOptionModal",props:{show:Boolean,title:String,subtitle:String,name:String,options:{type:Array,default:()=>[]},selectedValue:[String,Array],notesValue:String,imagesValue:{type:Array,default:()=>[]},pointId:[String,Number],inspectionId:[String,Number],showTextarea:{type:Boolean,default:!0},showImageUpload:{type:Boolean,default:!0},selectedPoint:Object,point:Object},emits:["update:selectedValue","update:notesValue","update:imagesValue","close","save","hapus","saveTextarea","saveImage","saveText","saveNumber","saveAccount","saveDate"],setup(a,{emit:G}){const e=a,A=G,g=c=>A("hapus",c),I=Y(()=>Array.isArray(e.selectedValue)?e.options.find(c=>e.selectedValue.includes(c.value)):e.options.find(c=>c.value===e.selectedValue)),v=Y(()=>{if(Array.isArray(e.selectedValue))return e.options.filter(c=>e.selectedValue.includes(c.value));if(e.selectedValue){const c=typeof e.selectedValue=="string"?e.selectedValue.split(",").map(l=>l.trim()):[e.selectedValue];return e.options.filter(l=>c.includes(l.value))}return[]}),P=Y(()=>{var c;if(Array.isArray(e.selectedValue))return v.value.some(l=>{var C;return l.multi&&((C=l.settings)==null?void 0:C.show_textarea)});{const l=e.options.find(C=>C.value===e.selectedValue);return(c=l==null?void 0:l.settings)==null?void 0:c.show_textarea}}),f=Y(()=>{var c;if(Array.isArray(e.selectedValue))return v.value.some(l=>{var C;return l.multi&&((C=l.settings)==null?void 0:C.show_image_upload)});{const l=e.options.find(C=>C.value===e.selectedValue);return(c=l==null?void 0:l.settings)==null?void 0:c.show_image_upload}}),S=Y(()=>{var c;if(Array.isArray(e.selectedValue))return v.value.find(l=>{var C;return l.multi&&((C=l.settings)==null?void 0:C.show_textarea)});{const l=e.options.find(C=>C.value===e.selectedValue);return(c=l==null?void 0:l.settings)!=null&&c.show_textarea?l:null}}),T=Y(()=>{var c;if(Array.isArray(e.selectedValue))return v.value.find(l=>{var C;return l.multi&&((C=l.settings)==null?void 0:C.show_image_upload)});{const l=e.options.find(C=>C.value===e.selectedValue);return(c=l==null?void 0:l.settings)!=null&&c.show_image_upload?l:null}});Y(()=>v.value.find(c=>{var l;return c.multi&&((l=c.settings)==null?void 0:l.show_textarea)})),Y(()=>v.value.find(c=>{var l;return c.multi&&((l=c.settings)==null?void 0:l.show_image_upload)}));const $=c=>Array.isArray(e.selectedValue)?e.selectedValue.includes(c.value):e.selectedValue?(typeof e.selectedValue=="string"?e.selectedValue.split(",").map(C=>C.trim()):[e.selectedValue]).includes(c.value):!1,B=(c,l)=>{let C;if(c.multi){const M=Array.isArray(e.selectedValue)?e.selectedValue:[];l.target.checked?C=[...M,c.value]:C=M.filter(U=>U!==c.value)}else C=c.value;A("update:selectedValue",C)},K=Y(()=>{var l,C,M,U,z,ne,_;if(e.point.input_type==="text"&&(!((l=e.notesValue)!=null&&l.trim())||e.point.settings.min_length&&e.notesValue.length<e.point.settings.min_length||e.point.settings.max_length&&e.notesValue.length>e.point.settings.max_length)||e.point.input_type==="number"&&(!((C=e.notesValue)!=null&&C.trim())||e.point.settings.min&&e.notesValue.length<e.point.settings.min||e.point.settings.max&&e.notesValue.length>e.point.settings.max)||e.point.input_type==="account"&&(!((M=e.notesValue)!=null&&M.trim())||e.point.settings.min_value&&e.notesValue.length<e.point.settings.min_value||e.point.settings.max_value&&e.notesValue.length>e.point.settings.max_value)||e.point.input_type==="date"&&(!((U=e.notesValue)!=null&&U.trim())||e.point.settings.min_date&&e.notesValue.length<e.point.settings.min_date||e.point.settings.max_date&&e.notesValue.length>e.point.settings.max_date))return!1;if(e.point.input_type==="imageTOradio"){if(e.imagesValue.length===0)return!1;const x=e.imagesValue.some(O=>O.status==="error"),L=e.imagesValue.some(O=>O.status==="uploading");if(x||L)return!1}if(e.options.length&&(!e.selectedValue||Array.isArray(e.selectedValue)&&e.selectedValue.length===0))return!1;const c=I.value;if(e.showTextarea&&((z=c==null?void 0:c.settings)!=null&&z.show_textarea)&&(!((ne=e.notesValue)!=null&&ne.trim())||c.settings.min_length&&e.notesValue.length<c.settings.min_length||c.settings.max_length&&e.notesValue.length>c.settings.max_length))return!1;if(e.showImageUpload&&((_=c==null?void 0:c.settings)!=null&&_.show_image_upload)){if(e.imagesValue.length===0||c.settings.max_files&&e.imagesValue.length>c.settings.max_files)return!1;const x=e.imagesValue.some(O=>O.status==="error"),L=e.imagesValue.some(O=>O.status==="uploading");if(x||L)return!1}return!0});return(c,l)=>(s(),xe(_s,{show:a.show,title:a.title,subtitle:a.subtitle,onClose:l[17]||(l[17]=C=>c.$emit("close"))},{footer:Ve(()=>[a.selectedPoint?(s(),i("button",{key:0,onClick:l[14]||(l[14]=C=>g(a.pointId)),class:"flex items-center justify-center text-red-600 hover:text-red-800 mb-3"},l[19]||(l[19]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7h6m2-3H7m5 0v3"})],-1),fe(" Hapus Data ")]))):d("",!0),t("div",qs,[t("button",{type:"button",onClick:l[15]||(l[15]=C=>c.$emit("close")),class:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),t("button",{type:"button",onClick:l[16]||(l[16]=C=>c.$emit("save")),disabled:!K.value,class:"flex-1 px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-white hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Simpan ",8,Ks)])]),default:Ve(()=>{var C,M,U,z,ne,_,x,L,O,b,p,n,m,E,X,j,q,J,se,ie,ee,re,ue,pe,Ae,ke,me,we,$e,Se,Ie,_e,o,r,u,V;return[t("div",As,[a.point.input_type==="text"?(s(),i("div",Ss,[he(_t,{"model-value":a.notesValue,required:(C=a.point.settings)==null?void 0:C.is_required,"min-length":(M=a.point.settings)==null?void 0:M.min_length,"max-length":(U=a.point.settings)==null?void 0:U.max_length,allowSpace:(z=a.point.settings)==null?void 0:z.allow_space,textTransform:(ne=a.point.settings)==null?void 0:ne.text_transform,placeholder:((_=a.point.settings)==null?void 0:_.placeholder)||"Masukan text",error:c.error,"onUpdate:modelValue":l[0]||(l[0]=k=>c.$emit("update:notesValue",k)),onSave:l[1]||(l[1]=k=>c.$emit("saveText",k))},null,8,["model-value","required","min-length","max-length","allowSpace","textTransform","placeholder","error"])])):d("",!0),a.point.input_type==="number"?(s(),i("div",$s,[he(At,{"model-value":a.notesValue,required:(x=a.point.settings)==null?void 0:x.is_required,min:(L=a.point.settings)==null?void 0:L.min,max:(O=a.point.settings)==null?void 0:O.max,step:((b=a.point.settings)==null?void 0:b.step)||1,placeholder:((p=a.point.settings)==null?void 0:p.placeholder)||"Masukan number",error:c.error,"onUpdate:modelValue":l[2]||(l[2]=k=>c.$emit("update:notesValue",k)),onSave:l[3]||(l[3]=k=>c.$emit("saveNumber",k))},null,8,["model-value","required","min","max","step","placeholder","error"])])):d("",!0),a.point.input_type==="account"?(s(),i("div",Vs,[he($t,{"model-value":a.notesValue,required:(n=a.point.settings)==null?void 0:n.is_required,placeholder:((m=a.point.settings)==null?void 0:m.placeholder)||"Masukkan nilai",error:c.error,"point-id":a.pointId,settings:a.point.settings,"onUpdate:modelValue":l[4]||(l[4]=k=>c.$emit("update:notesValue",k)),onSave:l[5]||(l[5]=k=>c.$emit("saveAccount",k))},null,8,["model-value","required","placeholder","error","point-id","settings"])])):d("",!0),a.point.input_type==="date"?(s(),i("div",Cs,[he(St,{"model-value":a.notesValue,required:(E=a.point.settings)==null?void 0:E.is_required,"min-date":(X=a.point.settings)==null?void 0:X.min_date,"max-date":(j=a.point.settings)==null?void 0:j.max_date,error:c.error,"onUpdate:modelValue":l[6]||(l[6]=k=>c.$emit("update:notesValue",k)),onSave:l[7]||(l[7]=k=>c.$emit("saveDate",k))},null,8,["model-value","required","min-date","max-date","error"])])):d("",!0),a.point.input_type==="imageTOradio"?(s(),i("div",Ts,[t("h4",Ns,[(q=a.point.settings)!=null&&q.required?(s(),i("span",Us,"*")):d("",!0)]),he(qe,{"model-value":a.imagesValue,"point-id":a.pointId,point:a.point.inspection_point,"inspection-id":a.inspectionId,settings:a.point.settings,"onUpdate:modelValue":l[8]||(l[8]=k=>c.$emit("update:imagesValue",k)),onSave:l[9]||(l[9]=k=>c.$emit("saveImage",k))},null,8,["model-value","point-id","point","inspection-id","settings"]),(J=a.point.settings)!=null&&J.required&&a.imagesValue.length===0?(s(),i("p",Es," Foto wajib diupload ")):d("",!0)])):d("",!0),a.options.length?(s(),i("div",{key:5,class:ae(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(s(!0),i(be,null,ye(a.options,(k,Z)=>(s(),i("label",{key:Z,class:"cursor-pointer"},[t("input",{type:k.multi?"checkbox":"radio",name:k.multi?`checkbox-${a.name}`:a.name,value:k.value,checked:$(k),onChange:W=>B(k,W),class:"hidden peer"},null,40,Ps),t("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":$(k),"border-gray-300 text-gray-700 hover:bg-gray-50":!$(k)}])},D(k.label),3)]))),128))],2)):d("",!0),P.value?(s(),i("div",Ds,[(ie=(se=S.value)==null?void 0:se.settings)!=null&&ie.required?(s(),i("span",Ms,"*")):d("",!0),he(Vt,{"model-value":a.notesValue,"point-id":a.pointId,"inspection-id":a.inspectionId,settings:(ee=S.value)==null?void 0:ee.settings,required:(ue=(re=S.value)==null?void 0:re.settings)==null?void 0:ue.required,"min-length":(Ae=(pe=S.value)==null?void 0:pe.settings)==null?void 0:Ae.min_length,"max-length":(me=(ke=S.value)==null?void 0:ke.settings)==null?void 0:me.max_length,placeholder:(($e=(we=S.value)==null?void 0:we.settings)==null?void 0:$e.placeholder)||"Tambahkan keterangan...","onUpdate:modelValue":l[10]||(l[10]=k=>c.$emit("update:notesValue",k)),onSave:l[11]||(l[11]=k=>c.$emit("saveTextarea",k))},null,8,["model-value","point-id","inspection-id","settings","required","min-length","max-length","placeholder"]),(Ie=(Se=S.value)==null?void 0:Se.settings)!=null&&Ie.required&&!a.notesValue?(s(),i("p",Ls," Keterangan wajib diisi ")):d("",!0)])):d("",!0),f.value?(s(),i("div",Rs,[t("h4",Bs,[l[18]||(l[18]=fe(" Upload Foto ")),(o=(_e=T.value)==null?void 0:_e.settings)!=null&&o.required?(s(),i("span",js,"*")):d("",!0)]),he(qe,{"model-value":a.imagesValue,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,settings:(r=T.value)==null?void 0:r.settings,"onUpdate:modelValue":l[12]||(l[12]=k=>c.$emit("update:imagesValue",k)),onSave:l[13]||(l[13]=k=>c.$emit("saveImage",k))},null,8,["model-value","point-id","point","inspection-id","settings"]),(V=(u=T.value)==null?void 0:u.settings)!=null&&V.required&&a.imagesValue.length===0?(s(),i("p",Fs," Foto wajib diupload ")):d("",!0)])):d("",!0)])]}),_:1},8,["show","title","subtitle"]))}},Os={class:"mt-2 space-y-2"},Hs=["type","name","value","checked","onChange","required"],Gs={key:0,class:"p-2 rounded-lg bg-gray-50"},zs={key:0,class:"mt-2"},Ws={class:"flex gap-2 overflow-x-auto",style:{"scrollbar-width":"none"}},Js=["src"],Zs={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},Ys={key:1,class:"mt-2"},Xs={class:"text-sm text-gray-600"},Qs={key:2,class:"mt-2 text-sm text-red-600"},eo={__name:"InputRadio",props:{modelValue:[String,Array],required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(a,{emit:G}){const e=a,A=G,g=N(e.notes),I=N([...e.images]),v=N(!1),P=N(""),f=N([]),S=N(""),T=N([]);Y(()=>e.options.find(x=>x.value===e.modelValue));const $=Y(()=>Array.isArray(e.modelValue)?e.options.filter(x=>e.modelValue.includes(x.value)):e.modelValue?[e.options.find(x=>x.value===e.modelValue)].filter(Boolean):[]),B=x=>Array.isArray(e.modelValue)?e.modelValue.includes(x.value):e.modelValue?(typeof e.modelValue=="string"?e.modelValue.split(",").map(O=>O.trim()):[e.modelValue]).includes(x.value):!1,K=x=>x.settings&&(x.settings.show_textarea||x.settings.show_image_upload);ce(()=>e.notes,x=>{g.value=x}),ce(()=>e.images,x=>{I.value=[...x]}),ce(()=>e.modelValue,x=>{x?S.value=Array.isArray(x)?[...x]:x:S.value=""});const c=(x,L)=>{let O;if(x.multi){const b=Array.isArray(e.modelValue)?e.modelValue:[];L.target.checked?O=[...b,x.value]:O=b.filter(p=>p!==x.value)}else O=x.value;A("update:modelValue",O),K(x)?C():A("save",{pointId:e.pointId,inspectionId:e.inspectionId,value:O,notes:"",images:[]})},l=x=>x.preview||(x.image_path?`/${x.image_path}`:x),C=()=>{S.value=e.modelValue,P.value=g.value,f.value=[...I.value],T.value=[...I.value],v.value=!0},M=()=>{P.value="",f.value=[],S.value=Array.isArray(e.modelValue)?[...e.modelValue]:e.modelValue,v.value=!1},U=x=>{f.value=x,I.value=[...x],A("update:images",[...x]),A("save",{pointId:e.pointId,inspectionId:e.inspectionId,value:e.modelValue,notes:g.value,images:[...x]})},z=x=>{},ne=()=>{S.value!==e.modelValue&&A("update:modelValue",S.value),g.value=P.value,A("update:notes",P.value),I.value=[...f.value],A("update:images",[...f.value]),A("save",{pointId:e.pointId,inspectionId:e.inspectionId,value:S.value,notes:P.value,images:f.value}),v.value=!1},_=x=>{S.value="",P.value="",f.value=[],g.value="",I.value=[],A("update:modelValue",""),A("update:notes",""),A("update:images",[]),A("hapus",x),v.value=!1};return(x,L)=>{var O;return s(),i("div",Os,[t("div",{class:ae(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(s(!0),i(be,null,ye(a.options,(b,p)=>(s(),i("label",{key:p,class:"cursor-pointer"},[t("input",{type:b.multi?"checkbox":"radio",name:b.multi?`checkbox-${a.pointId}`:"radio-"+a.pointId,value:b.value,checked:B(b),onChange:n=>c(b,n),class:"hidden peer",required:a.required&&!b.multi},null,40,Hs),t("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":B(b),"border-gray-300 text-gray-700 hover:bg-gray-50":!B(b)}])},D(b.label),3)]))),128))],2),a.modelValue&&$.value.length>0&&$.value.some(b=>K(b))?(s(),i("div",Gs,[t("div",{class:"flex justify-between items-start"},[L[4]||(L[4]=t("h4",{class:"text-sm font-medium text-gray-700"},"Detail : ",-1)),t("button",{onClick:C,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),a.images.length>0&&$.value.some(b=>{var p;return(p=b.settings)==null?void 0:p.show_image_upload})?(s(),i("div",zs,[t("div",Ws,[(s(!0),i(be,null,ye(a.images,(b,p)=>(s(),i("div",{key:p,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[t("img",{src:l(b),class:"w-full h-full object-cover rounded"},null,8,Js),p===3&&a.images.length>4?(s(),i("span",Zs," +"+D(a.images.length-4),1)):d("",!0)]))),128))])])):d("",!0),a.notes&&$.value.some(b=>{var p;return(p=b.settings)==null?void 0:p.show_textarea})?(s(),i("div",Ys,[t("p",Xs,D(a.notes),1)])):d("",!0)])):d("",!0),v.value?(s(),xe(Ct,{key:(O=a.selectedPoint)==null?void 0:O.id,show:v.value,title:a.pointName||"Detail",subtitle:a.subtitle||"",name:"modal-radio-"+a.pointId,options:a.options,"selected-value":S.value,"notes-value":P.value,"images-value":f.value,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,"selected-point":a.selectedPoint,"onUpdate:selectedValue":L[0]||(L[0]=b=>S.value=b),"onUpdate:notesValue":L[1]||(L[1]=b=>P.value=b),"onUpdate:imagesValue":L[2]||(L[2]=b=>U(b)),onClose:M,onSave:ne,onSaveTextarea:x.handleTextareaSave,onSaveImage:z,onHapus:L[3]||(L[3]=b=>_(a.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point","onSaveTextarea"])):d("",!0),a.error?(s(),i("p",Qs,D(a.error),1)):d("",!0)])}}},to={class:"mt-2 space-y-2"},ao={key:0,class:"flex flex-wrap gap-3"},no={key:1,class:"p-2"},so={key:0,class:"mt-2"},oo={class:"flex gap-2 overflow-x-auto scrollbar-hide"},io=["src"],lo={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},ro=["type","name","value","checked"],uo={key:1,class:"mt-2"},co={class:"text-sm text-gray-600"},po={key:3,class:"mt-2 text-sm text-red-600"},go={__name:"InputImageToRadio",props:{modelValue:[String,Array],required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(a,{emit:G}){const e=a,A=G,g=N(e.notes),I=N([...e.images]),v=N(!1),P=N(""),f=N([]),S=N(""),T=N([]),$=Y(()=>{if(Array.isArray(e.modelValue))return e.options.find(_=>e.modelValue.includes(_.value));if(e.modelValue){const _=typeof e.modelValue=="string"?e.modelValue.split(",").map(x=>x.trim()):[e.modelValue];return e.options.find(x=>_.includes(x.value))}return null}),B=Y(()=>{if(Array.isArray(e.modelValue))return e.options.filter(_=>e.modelValue.includes(_.value));if(e.modelValue){const _=typeof e.modelValue=="string"?e.modelValue.split(",").map(x=>x.trim()):[e.modelValue];return e.options.filter(x=>_.includes(x.value))}return[]}),K=Y(()=>B.value.some(_=>{var x;return _.multi&&((x=_.settings)==null?void 0:x.show_textarea)}));Y(()=>B.value.find(_=>{var x;return _.multi&&((x=_.settings)==null?void 0:x.show_textarea)}));const c=_=>Array.isArray(e.modelValue)?e.modelValue.includes(_.value):e.modelValue?(typeof e.modelValue=="string"?e.modelValue.split(",").map(L=>L.trim()):[e.modelValue]).includes(_.value):!1,l=_=>_.preview||(_.image_path?`/${_.image_path}`:_);ce(()=>e.notes,_=>{g.value=_});const C=()=>{S.value=e.modelValue||"",P.value=g.value,f.value=[...I.value],T.value=[...I.value],v.value=!0},M=()=>{P.value="",f.value=[],S.value="",v.value=!1},U=_=>{f.value=_,I.value=[..._],A("update:images",[..._]),A("save",{pointId:e.pointId,inspectionId:e.inspectionId,value:e.modelValue,notes:g.value,images:[..._]})},z=()=>{S.value!==e.modelValue&&A("update:modelValue",S.value),g.value=P.value,A("update:notes",P.value),I.value=[...f.value],A("update:images",[...f.value]),A("save",{pointId:e.pointId,inspectionId:e.inspectionId,value:S.value,notes:P.value,images:f.value}),v.value=!1},ne=_=>{S.value="",P.value="",f.value=[],g.value="",I.value=[],A("update:modelValue",""),A("update:notes",""),A("update:images",[]),A("hapus",_),v.value=!1};return(_,x)=>{var L,O,b;return s(),i("div",to,[!a.modelValue&&I.value.length===0&&!g.value?(s(),i("div",ao,[t("div",{class:"relative w-28 h-28 border-2 border-dashed rounded-lg flex items-center justify-center cursor-pointer overflow-hidden",onClick:C},x[4]||(x[4]=[t("div",{class:"flex flex-col items-center text-gray-400"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),t("span",{class:"text-xs font-medium"},"Tambah")],-1)]))])):(s(),i("div",no,[t("div",{class:"flex justify-between items-start"},[x[5]||(x[5]=t("h4",{class:"text-sm font-medium text-gray-700"},"Detail :",-1)),t("button",{onClick:C,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),I.value.length>0?(s(),i("div",so,[t("div",oo,[(s(!0),i(be,null,ye(I.value,(p,n)=>(s(),i("div",{key:n,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[t("img",{src:l(p),class:"w-full h-full object-cover rounded"},null,8,io),n===3&&I.value.length>4?(s(),i("span",lo," +"+D(I.value.length-4),1)):d("",!0)]))),128))])])):d("",!0),t("div",{class:ae(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(s(!0),i(be,null,ye(a.options,(p,n)=>(s(),i("label",{key:n,class:"cursor-pointer"},[t("input",{type:p.multi?"checkbox":"radio",name:p.multi?`checkbox-${a.pointId}`:`radio-${a.pointId}`,value:p.value,checked:c(p),disabled:!0,class:"hidden peer"},null,8,ro),t("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":c(p),"border-gray-300 text-gray-700 hover:bg-gray-50":!c(p)}])},D(p.label),3)]))),128))],2),g.value&&((O=(L=$.value)==null?void 0:L.settings)!=null&&O.show_textarea||K.value)?(s(),i("div",uo,[t("p",co,D(g.value),1)])):d("",!0)])),v.value?(s(),xe(Ct,{key:(b=a.selectedPoint)==null?void 0:b.id,show:v.value,title:a.pointName||"Detail",subtitle:a.subtitle||"",name:"modal-radio-"+a.pointId,options:a.options,"selected-value":S.value,"notes-value":P.value,"images-value":f.value,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,"selected-point":a.selectedPoint,"onUpdate:selectedValue":x[0]||(x[0]=p=>S.value=p),"onUpdate:notesValue":x[1]||(x[1]=p=>P.value=p),"onUpdate:imagesValue":x[2]||(x[2]=p=>U(p)),onClose:M,onSave:z,onHapus:x[3]||(x[3]=p=>ne(a.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point"])):d("",!0),a.error?(s(),i("p",po,D(a.error),1)):d("",!0)])}}},mo={class:"text-base font-semibold text-indigo-700"},vo={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},fo={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ho={class:"text-base font-semibold text-indigo-700"},bo={class:"p-4 space-y-4"},yo={key:0,class:"flex justify-end py-1"},xo=["onClick"],ko={key:1,class:"space-y-2"},wo={class:"flex items-start justify-between"},Io={class:"flex-1"},_o={class:"block text-sm font-medium text-gray-700"},Ao={key:0,class:"text-red-500"},So={key:1,class:"italic text-xs text-gray-400 ml-2"},$o={key:0,class:"mt-1"},Vo={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800"},Co={key:0},To={key:1},No={key:2},Uo={key:3},Eo={key:4},Po={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"},Do={key:9,class:"p-3 bg-gray-100 rounded text-sm text-gray-600"},Mo={class:"text-xs mt-1 list-disc list-inside"},Lo={key:0},Ro={key:1},Bo={key:2},jo={key:3},Fo={key:4},qo={key:0,class:"text-center py-8 text-gray-500"},Ko={key:0,class:"text-xs text-gray-400"},Oo={__name:"CategorySection",props:{category:Object,form:Object,head:Object,inspectionId:String,selectedPoint:Object,car:Object},emits:["updateResult","removeImage","hapusPoint"],setup(a,{emit:G}){const e=a,A=G,g=wt("vehicleFeatures",N(null));g.value=JSON.parse(localStorage.getItem("vehicle_features")||"{}"),Ut("vehicleFeatures",g);const I=N(!1),v=N([]),P=N(!0),f=N(null),S=Et(),T={MT:"Manual Transmission (MT)",AT:"Automatic Transmission (AT)",CVT:"Continuously Variable Transmission (CVT)","e-CVT":"Electronic CVT (e-CVT)",DCT:"Dual Clutch Transmission (DCT)",AMT:"Automated Manual Transmission (AMT)",IVT:"Intelligent Variable Transmission (IVT)",SSG:"Seamless Shift Gearbox (SSG)",AGS:"Auto Gear Shift (AGS)",DHT:"Dedicated Hybrid Transmission (DHT)"};Ee(()=>{const b=new IntersectionObserver(([p])=>{P.value=p.isIntersecting},{threshold:.1});f.value&&b.observe(f.value),Re(()=>{f.value&&b.unobserve(f.value)})});const $=()=>{I.value=!I.value,I.value||(v.value=[])},B=Y(()=>(e.category.points||[]).some(b=>b.is_default===!1)),K=b=>!b||!Array.isArray(b)?[]:b.map(p=>T[p]||p),c=b=>{var E,X;const p=b.settings;if(!l(b))return!0;const n=(E=e.car)==null?void 0:E.transmission,m=(X=e.car)==null?void 0:X.fuel_type;return!(p.transmission&&Array.isArray(p.transmission)&&p.transmission.length>0&&n&&!p.transmission.includes(n)||p.fuel_type&&p.fuel_type.trim()!==""&&m&&p.fuel_type!==m||p.rear_door&&(!g.value||!g.value.rear_door)||p.pick_up&&(!g.value||!g.value.pick_up)||p.box&&(!g.value||!g.value.box))},l=b=>{const p=b.settings;return!!(p!=null&&p.transmission&&Array.isArray(p.transmission)&&p.transmission.length>0||p!=null&&p.fuel_type&&p.fuel_type.trim()!==""||p!=null&&p.rear_door||p!=null&&p.pick_up||p!=null&&p.box)},C=b=>l(b)&&(I.value||c(b)),M=Y(()=>{const b=e.category.points||[],p=[];let n=[];return I.value?e.category.isDamageMenu?b.filter(m=>{var E;return m.is_default||z((E=m.inspection_point)==null?void 0:E.id)||I.value}):b:e.category.isDamageMenu?b.filter(m=>{var X;const E=(X=m.inspection_point)==null?void 0:X.id;return z(E)||m.is_default||v.value.includes(E)}):(b.forEach(m=>{var ie;const E=(ie=m.inspection_point)==null?void 0:ie.id,X=z(E),j=v.value.includes(E),J=!l(m)||c(m);(m.is_default||X||j)&&J?(n.length>0&&(p.push({is_link:!0,count:n.length,hiddenIds:n.map(ee=>ee.inspection_point.id)}),n.forEach(ee=>{v.value.includes(ee.inspection_point.id)&&p.push(ee)}),n=[]),p.push(m)):(!l(m)||c(m))&&n.push(m)}),n.length>0&&(p.push({is_link:!0,count:n.length,hiddenIds:n.map(m=>m.inspection_point.id)}),n.forEach(m=>{v.value.includes(m.inspection_point.id)&&p.push(m)})),p.filter(m=>{var E,X;return m.is_link||m.is_default||z((E=m.inspection_point)==null?void 0:E.id)||v.value.includes((X=m.inspection_point)==null?void 0:X.id)}))});Y(()=>M.value.filter(b=>!b.is_link));const U=b=>{I.value=!1,b.forEach(p=>{v.value.includes(p)||v.value.push(p)})},z=b=>{if(!b)return!1;const p=S.props.existingResults[b]!==void 0,n=S.props.existingImages[b]&&S.props.existingImages[b].length>0,m=e.form.results[b]&&(e.form.results[b].status||e.form.results[b].note),E=e.form.images[b]&&e.form.images[b].length>0;return p||n||m||E},ne=[{value:"good",label:"Good"},{value:"bad",label:"Bad"},{value:"na",label:"N/A"}],_=b=>{var m,E,X,j,q,J,se,ie,ee;const p=e.form.results[(m=b.inspection_point)==null?void 0:m.id],n=e.form.images[(E=b.inspection_point)==null?void 0:E.id];if(!p)return!1;switch(b.input_type){case"text":case"number":case"date":case"account":case"textarea":return!!p.note;case"select":case"radio":if(!p.status)return!1;const re=(j=(X=b.settings)==null?void 0:X.radios)==null?void 0:j.find(pe=>pe.value===p.status);return!(re!=null&&re.settings&&(re.settings.show_textarea&&!((q=p.note)!=null&&q.trim())||re.settings.show_image_upload&&(n==null?void 0:n.length)===0));case"imageTOradio":if((n==null?void 0:n.length)===0||!p.status)return!1;const ue=(se=(J=b.settings)==null?void 0:J.radios)==null?void 0:se.find(pe=>pe.value===p.status);return!(ue!=null&&ue.settings&&ue.settings.show_textarea&&!((ie=p.note)!=null&&ie.trim()));case"image":return(n==null?void 0:n.length)>0;default:return!!p.status||!!((ee=p.note)!=null&&ee.trim())}},x=(b,p,n)=>{A("updateResult",{pointId:b,type:n,value:p})},L=b=>{console.log("Save result for point:",b)},O=b=>{A("hapusPoint",b)};return ce(()=>e.form.results,b=>{},{deep:!0}),ce(()=>e.form.images,b=>{},{deep:!0}),ce(()=>e.car,b=>{console.log("Car data updated:",b)},{deep:!0}),ce(g,b=>{console.log("Vehicle features updated:",b)},{deep:!0}),(b,p)=>(s(),i(be,null,[e.head==="vertical"?(s(),i("div",{key:0,class:ae(["px-6 py-2 border-b flex items-center justify-between bg-indigo-200","fixed top-0 left-0 right-0 z-20"])},[t("h4",mo,D(a.category.name),1),B.value?(s(),i("button",{key:0,onClick:$,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},D(I.value?"Sembunyikan Semua":"Tampilkan Point Lain"),1)):d("",!0)])):d("",!0),t("div",{class:ae(["bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100",e.head==="vertical"?"pt-6":""])},[!P.value&&B.value?(s(),i("button",{key:0,onClick:$,class:"fixed top-3 right-2 z-10 bg-indigo-600 text-white p-2 rounded-full shadow-lg"},[I.value?(s(),i("svg",vo,p[0]||(p[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(s(),i("svg",fo,p[1]||(p[1]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.006-3.362M9.88 9.88a3 3 0 104.24 4.24M6.1 6.1l11.8 11.8"},null,-1)])))])):d("",!0),e.head==="horizontal"?(s(),i("div",{key:1,ref_key:"categoryHeader",ref:f,class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[t("h4",ho,D(a.category.name),1),B.value?(s(),i("button",{key:0,onClick:$,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},D(I.value?"Sembunyikan":"Tampilkan Point Lain"),1)):d("",!0)],512)):d("",!0),t("div",bo,[(s(!0),i(be,null,ye(M.value,(n,m)=>{var E,X,j,q,J,se,ie,ee,re,ue,pe,Ae,ke,me,we,$e,Se,Ie,_e,o,r,u,V,k,Z,W,Q,H,le,w,h,te,F,oe,de,ve,ge,Ue,Ke,Oe,He,Ge,ze,We,Je,Ze,Ye,Xe,Qe,et,tt,at,nt,st,ot,it,lt,rt,ut,dt,ct,pt,gt,mt,vt,ft,ht,bt,yt;return s(),i("div",{key:m,class:ae(["space-y-2 last:border-0 last:pb-0",n.is_link?"pb-0":"pb-2 border-b border-gray-100"])},[n.is_link?(s(),i("div",yo,[t("button",{onClick:R=>U(n.hiddenIds),class:"text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline focus:outline-none"}," Tampilkan "+D(n.count)+" Point Tersembunyi ",9,xo)])):(s(),i("div",ko,[t("div",wo,[t("div",Io,[t("label",_o,[fe(D((E=n.inspection_point)==null?void 0:E.name)+" ",1),(X=n.settings)!=null&&X.is_required?(s(),i("span",Ao,"*")):d("",!0),!n.is_default&&!z((j=n.inspection_point)==null?void 0:j.id)?(s(),i("span",So," (opsional) ")):d("",!0)]),C(n)?(s(),i("div",$o,[l(n)?(s(),i("div",Vo,[(q=n.settings)!=null&&q.transmission?(s(),i("div",Co,D(n.settings.transmission.join(", ")),1)):d("",!0),(J=n.settings)!=null&&J.fuel_type?(s(),i("div",To,D(n.settings.fuel_type),1)):d("",!0),(se=n.settings)!=null&&se.rear_door?(s(),i("div",No," Pintu Belakang ")):d("",!0),(ie=n.settings)!=null&&ie.pick_up?(s(),i("div",Uo," Tipe Pick Up ")):d("",!0),(ee=n.settings)!=null&&ee.box?(s(),i("div",Eo," Memiliki Box ")):d("",!0)])):d("",!0)])):d("",!0)]),_(n)?(s(),i("span",Po," ‚úì ")):d("",!0)]),n.input_type==="text"&&c(n)?(s(),xe(_t,{key:0,modelValue:a.form.results[(re=n.inspection_point)==null?void 0:re.id].note,"onUpdate:modelValue":[R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},R=>{var y;return x((y=n.inspection_point)==null?void 0:y.id,R,"note")}],required:(ue=n.settings)==null?void 0:ue.is_required,"min-length":(pe=n.settings)==null?void 0:pe.min_length,"max-length":(Ae=n.settings)==null?void 0:Ae.max_length,allowSpace:(ke=n.settings)==null?void 0:ke.allow_space,textTransform:(me=n.settings)==null?void 0:me.text_transform,placeholder:((we=n.settings)==null?void 0:we.placeholder)||"Masukan text",error:a.form.errors[`results.${($e=n.inspection_point)==null?void 0:$e.id}.note`],onSave:R=>{var y;return L((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","allowSpace","textTransform","placeholder","error","onSave"])):d("",!0),n.input_type==="number"&&c(n)?(s(),xe(At,{key:1,modelValue:a.form.results[(Se=n.inspection_point)==null?void 0:Se.id].note,"onUpdate:modelValue":[R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},R=>{var y;return x((y=n.inspection_point)==null?void 0:y.id,R,"note")}],required:(Ie=n.settings)==null?void 0:Ie.is_required,min:(_e=n.settings)==null?void 0:_e.min,max:(o=n.settings)==null?void 0:o.max,step:((r=n.settings)==null?void 0:r.step)||1,placeholder:((u=n.settings)==null?void 0:u.placeholder)||"Masukan number",error:a.form.errors[`results.${(V=n.inspection_point)==null?void 0:V.id}.note`],onSave:R=>{var y;return L((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","min","max","step","placeholder","error","onSave"])):d("",!0),n.input_type==="account"&&c(n)?(s(),xe($t,{key:2,modelValue:a.form.results[(k=n.inspection_point)==null?void 0:k.id].note,"onUpdate:modelValue":[R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},R=>{var y;return x((y=n.inspection_point)==null?void 0:y.id,R,"note")}],required:(Z=n.settings)==null?void 0:Z.is_required,placeholder:((W=n.settings)==null?void 0:W.placeholder)||"Masukkan nilai",error:a.form.errors[`results.${(Q=n.inspection_point)==null?void 0:Q.id}.note`],"point-id":(H=n.inspection_point)==null?void 0:H.id,settings:n.settings,onSave:R=>{var y;return L((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","placeholder","error","point-id","settings","onSave"])):d("",!0),n.input_type==="date"&&c(n)?(s(),xe(St,{key:3,modelValue:a.form.results[(le=n.inspection_point)==null?void 0:le.id].note,"onUpdate:modelValue":[R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},R=>{var y;return x((y=n.inspection_point)==null?void 0:y.id,R,"note")}],required:(w=n.settings)==null?void 0:w.is_required,"min-date":(h=n.settings)==null?void 0:h.min_date,"max-date":(te=n.settings)==null?void 0:te.max_date,error:a.form.errors[`results.${(F=n.inspection_point)==null?void 0:F.id}.note`],onSave:R=>{var y;return L((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-date","max-date","error","onSave"])):d("",!0),n.input_type==="textarea"&&c(n)?(s(),xe(Vt,{key:4,modelValue:a.form.results[(oe=n.inspection_point)==null?void 0:oe.id].note,"onUpdate:modelValue":[R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},R=>{var y;return x((y=n.inspection_point)==null?void 0:y.id,R,"note")}],required:(de=n.settings)==null?void 0:de.is_required,"min-length":(ve=n.settings)==null?void 0:ve.min_length,"max-length":(ge=n.settings)==null?void 0:ge.max_length,placeholder:((Ue=n.settings)==null?void 0:Ue.placeholder)||"Masukkan teks di sini",settings:n.settings,error:a.form.errors[`results.${(Ke=n.inspection_point)==null?void 0:Ke.id}.note`],onSave:R=>{var y;return L((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","placeholder","settings","error","onSave"])):d("",!0),n.input_type==="radio"&&c(n)?(s(),xe(eo,{key:5,modelValue:a.form.results[(Oe=n.inspection_point)==null?void 0:Oe.id].status,"onUpdate:modelValue":[R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].status=R},R=>{var y;return x((y=n.inspection_point)==null?void 0:y.id,R,"status")}],notes:a.form.results[(He=n.inspection_point)==null?void 0:He.id].note,images:a.form.images[(Ge=n.inspection_point)==null?void 0:Ge.id],required:(ze=n.settings)==null?void 0:ze.is_required,"point-id":(We=n.inspection_point)==null?void 0:We.id,point:n.inspection_point,"inspection-id":a.inspectionId,settings:n.settings,"point-name":(Je=n.inspection_point)==null?void 0:Je.name,subtitle:(Ze=n.inspection_point)==null?void 0:Ze.description,"selected-point":n.inspection_point??null,options:((Ye=n.settings)==null?void 0:Ye.radios)||ne,error:a.form.errors[`results.${(Xe=n.inspection_point)==null?void 0:Xe.id}.status`],"onUpdate:notes":R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},"onUpdate:images":R=>{var y;return a.form.images[(y=n.inspection_point)==null?void 0:y.id]=R},onSave:R=>{var y;return L((y=n.inspection_point)==null?void 0:y.id)},onHapus:R=>{var y;return O((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","point","inspection-id","settings","point-name","subtitle","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):d("",!0),n.input_type==="imageTOradio"&&c(n)?(s(),xe(go,{key:6,modelValue:a.form.results[(Qe=n.inspection_point)==null?void 0:Qe.id].status,"onUpdate:modelValue":[R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].status=R},R=>{var y;return x((y=n.inspection_point)==null?void 0:y.id,R,"status")}],notes:a.form.results[(et=n.inspection_point)==null?void 0:et.id].note,images:a.form.images[(tt=n.inspection_point)==null?void 0:tt.id],required:(at=n.settings)==null?void 0:at.is_required,"point-id":(nt=n.inspection_point)==null?void 0:nt.id,"inspection-id":a.inspectionId,settings:n.settings,"point-name":(st=n.inspection_point)==null?void 0:st.name,subtitle:(ot=n.inspection_point)==null?void 0:ot.description,point:n,"selected-point":n.inspection_point??null,options:((it=n.settings)==null?void 0:it.radios)||ne,error:a.form.errors[`results.${(lt=n.inspection_point)==null?void 0:lt.id}.status`],"onUpdate:notes":R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},"onUpdate:images":R=>{var y;return a.form.images[(y=n.inspection_point)==null?void 0:y.id]=R},onSave:R=>{var y;return L((y=n.inspection_point)==null?void 0:y.id)},onHapus:R=>{var y;return O((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","inspection-id","settings","point-name","subtitle","point","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):d("",!0),n.input_type==="image"&&c(n)?(s(),xe(qe,{key:7,modelValue:a.form.images[(rt=n.inspection_point)==null?void 0:rt.id],"onUpdate:modelValue":R=>{var y;return a.form.images[(y=n.inspection_point)==null?void 0:y.id]=R},error:a.form.errors[`images.${(ut=n.inspection_point)==null?void 0:ut.id}`],"inspection-id":a.inspectionId,"point-id":(dt=n.inspection_point)==null?void 0:dt.id,point:n.inspection_point,"point-name":(ct=n.inspection_point)==null?void 0:ct.name,settings:n.settings,"onUpdate:notes":R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].note=R},"onUpdate:status":R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].status=R}},null,8,["modelValue","onUpdate:modelValue","error","inspection-id","point-id","point","point-name","settings","onUpdate:notes","onUpdate:status"])):d("",!0),n.input_type==="select"&&c(n)?(s(),xe(Xa,{key:8,modelValue:a.form.results[(pt=n.inspection_point)==null?void 0:pt.id].status,"onUpdate:modelValue":[R=>{var y;return a.form.results[(y=n.inspection_point)==null?void 0:y.id].status=R},R=>{var y;return x((y=n.inspection_point)==null?void 0:y.id,R,"status")}],required:(gt=n.settings)==null?void 0:gt.is_required,error:a.form.errors[`results.${(mt=n.inspection_point)==null?void 0:mt.id}.status`],onSave:R=>{var y;return L((y=n.inspection_point)==null?void 0:y.id)}},null,8,["modelValue","onUpdate:modelValue","required","error","onSave"])):d("",!0),!c(n)&&l(n)?(s(),i("div",Do,[p[2]||(p[2]=t("p",{class:"font-medium"},"Tidak tersedia untuk kendaraan ini",-1)),p[3]||(p[3]=t("p",{class:"text-xs mt-1"},"Point ini hanya tersedia untuk:",-1)),t("ul",Mo,[(vt=n.settings)!=null&&vt.transmission?(s(),i("li",Lo," Transmisi: "+D(K(n.settings.transmission).join(", ")),1)):d("",!0),(ft=n.settings)!=null&&ft.fuel_type?(s(),i("li",Ro," Bahan bakar: "+D(n.settings.fuel_type),1)):d("",!0),(ht=n.settings)!=null&&ht.rear_door?(s(),i("li",Bo,"Kendaraan dengan pintu belakang")):d("",!0),(bt=n.settings)!=null&&bt.pick_up?(s(),i("li",jo,"Tipe pick up")):d("",!0),(yt=n.settings)!=null&&yt.box?(s(),i("li",Fo,"Kendaraan dengan box")):d("",!0)])])):d("",!0)]))],2)}),128)),M.value.filter(n=>!n.is_link).length===0?(s(),i("div",qo,[p[4]||(p[4]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),p[5]||(p[5]=t("p",{class:"mt-2 text-sm"},"Tidak ada data untuk ditampilkan",-1)),a.category.isDamageMenu?(s(),i("p",Ko,' Tambahkan data melalui tombol "+" di pojok kanan bawah ')):d("",!0)])):d("",!0)])],2)],64))}},ki=Ce(Oo,[["__scopeId","data-v-21688412"]]),Ho={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},Go={class:"p-4 space-y-4-6"},zo={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},Wo=["value"],Jo={class:"p-4 space-y-4-6"},Zo={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},Yo=["value"],Xo={key:0,class:"p-4 space-y-4 bg-blue-50 rounded-lg border border-blue-200"},Qo={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},ei=["value"],ti={class:"p-4 space-y-2"},ai={class:"flex items-center justify-between mb-2"},ni={key:0,class:"mb-4 p-4 bg-white border border-gray-200 rounded-lg shadow-lg"},si={class:"flex items-center justify-between mb-3"},oi={class:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-60 overflow-y-auto"},ii=["onClick"],li={class:"text-sm font-medium text-gray-800 mb-1"},ri={class:"text-xs text-gray-600 line-clamp-2"},ui={class:"flex flex-wrap gap-1 mb-2 p-2 bg-gray-100 rounded-md"},di={key:0,class:"text-xs text-gray-500 mb-2 bg-gray-50 p-2 rounded border"},ci={key:0,class:"font-bold mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},pi={key:1,class:"italic mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},gi={key:2,class:"underline mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},mi={__name:"ConclusionSection",props:{inspectionId:{type:Number,required:!0},inspection:{type:Object,required:!0},form:{type:Object,required:!0}},emits:["updateConclusion"],setup(a,{emit:G}){const e=a,A=G,g=N(null),I=N(!1),v=N(!1),P=kt({bold:!1,italic:!1,underline:!1}),f=kt({flooded:"",collision:"",collision_severity:"",notes:""}),S=N([{id:1,name:"Kendaraan Normal",description:"Template untuk kendaraan dalam kondisi normal tanpa masalah signifikan (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi kendaraan secara umum: <b>BAIK</b><br>
- Tidak ditemukan indikasi kerusakan signifikan<br>
- Semua sistem berfungsi dengan normal<br>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:2,name:"Kendaraan Bekas Tabrakan Ringan",description:"Template untuk kendaraan dengan riwayat tabrakan ringan (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat tabrakan dengan tingkat kerusakan: <b>RINGAN</b><br>
- Area yang terdampak: PERLU DIISI<br>
- Perbaikan yang dilakukan: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:3,name:"Kendaraan Bekas Banjir",description:"Template untuk kendaraan dengan riwayat terkena banjir (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat terkena banjir<br>
- Tingkat paparan air: PERLU DIISI<br>
- Komponen yang terdampak: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:4,name:"Kendaraan dengan Multiple Issues",description:"Template untuk kendaraan dengan beberapa masalah umum (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi umum kendaraan: PERLU DIISI<br>
- Masalah utama yang ditemukan: PERLU DIISI<br>
- Komponen yang perlu perhatian: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:5,name:"Template Singkat",description:"Template ringkas untuk kesimpulan cepat (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Status Keseluruhan Kendaraan: PERLU DIISI<br>
- Catatan Utama: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`},{id:6,name:"Template Teknis Detail",description:"Template detail untuk laporan teknis lengkap (Lengkap A, C, B)",content:`<p><strong>A. LAPORAN HASIL INSPEKSI TEKNIS:</strong></p>
- Tanggal Inspeksi: PERLU DIISI<br>
- Kondisi Mesin: PERLU DIISI<br>
- Kondisi Transmisi: PERLU DIISI<br>
- Kondisi Suspensi: PERLU DIISI<br>
- Kondisi Rem: PERLU DIISI<br>
- Kondisi Body: PERLU DIISI<br>
- Kondisi Interior: PERLU DIISI<br>
- Kesimpulan Akhir: PERLU DIISI

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>

<p><strong>B. HAL PENTING SEBELUM PEMBAYARAN:</strong></p>
- Untuk menghindari kemungkinan yang terjadi di luar inspeksi (misalnya bunyi tidak wajar, fungsi elektrikal, lampu indikator, dan fitur penunjang ADAS/Cruise Control/dll.), <b>DIWAJIBKAN</b> untuk melakukan <b>Test Drive Terlebih Dahulu</b> sebelum pembayaran/transaksi.<br>
- Pastikan knalpot <b>Tidak Berasap</b> (khusus untuk mobil bensin).`}]);N(["{PLATE_NUMBER}","{CAR_NAME}","{INSPECTION_DATE}","{DAMAGED_AREA}","{REPAIR_DETAILS}","{WATER_LEVEL}","{AFFECTED_COMPONENTS}","{OVERALL_CONDITION}","{MAIN_ISSUES}","{ATTENTION_NEEDED}","{REPAIR_COST_ESTIMATE}","{RECOMMENDATION}","{OVERALL_STATUS}","{ADDITIONAL_NOTES}","{ENGINE_CONDITION}","{TRANSMISSION_CONDITION}","{SUSPENSION_CONDITION}","{BRAKE_CONDITION}","{BODY_CONDITION}","{INTERIOR_CONDITION}","{FINAL_CONCLUSION}"]);const T=n=>{if(!n)return{};if(typeof n=="string")try{return JSON.parse(n)||{}}catch(m){return console.error("Error parsing settings JSON:",m),{}}return typeof n=="object"&&n!==null?n:{}};Y(()=>T(e.inspection.settings).conclusion||{});const $=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],B=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],K=[{value:"light",label:"Ringan"},{value:"heavy",label:"Berat"}];Ee(()=>{l(),Fe(()=>{c(),U()})});const c=()=>{g.value&&f.notes&&(g.value.innerHTML=f.notes)},l=()=>{const m=T(e.inspection.settings).conclusion||{},E=e.form.conclusion||{};f.flooded=E.flooded||m.flooded||"",f.collision=E.collision||m.collision||"",f.collision_severity=E.collision_severity||m.collision_severity||"",f.notes=E.notes||e.inspection.notes||""},C=n=>{if(!g.value)return;let m=n.content;m=m.replace(/{PLATE_NUMBER}/g,e.inspection.plate_number||"[NOMOR_PLAT]").replace(/{CAR_NAME}/g,e.inspection.car_name||"[NAMA_MOBIL]").replace(/{INSPECTION_DATE}/g,new Date().toLocaleDateString("id-ID")).replace(/{FLOOD_STATUS}/g,f.flooded==="yes"?"Pernah terkena banjir":"Tidak pernah terkena banjir").replace(/{COLLISION_STATUS}/g,f.collision==="yes"?"Pernah mengalami tabrakan":"Tidak pernah mengalami tabrakan"),g.value.innerHTML=m,f.notes=m,v.value=!1,Fe(()=>{g.value.focus(),p()})},M=()=>{g.value&&(g.value.innerHTML="",f.notes="",p())},U=()=>{if(!g.value)return;const n=window.getSelection();n.rangeCount===0||n.isCollapsed||(P.bold=document.queryCommandState("bold"),P.italic=document.queryCommandState("italic"),P.underline=document.queryCommandState("underline"))},z=n=>{if(!g.value)return;g.value.focus();const m=P[n];switch(n){case"bold":document.execCommand("bold",!1,!m);break;case"italic":document.execCommand("italic",!1,!m);break;case"underline":document.execCommand("underline",!1,!m);break}setTimeout(()=>{U(),ne()},10)},ne=It.debounce(()=>{g.value&&(f.notes=g.value.innerHTML,p())},200),_=n=>{n.preventDefault(),document.execCommand("insertParagraph",!1,null)},x=n=>{n.preventDefault();const m=(n.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,m)},L=()=>{I.value=!0},O=()=>{I.value=!1,g.value&&(f.notes=g.value.innerHTML,p())},b=()=>{p()},p=()=>{const n={flooded:f.flooded,collision:f.collision,collision_severity:f.collision==="yes"?f.collision_severity:null,notes:f.notes};A("updateConclusion",n)};return ce(()=>e.form.conclusion,n=>{n&&(f.flooded=n.flooded!==void 0?n.flooded:f.flooded,f.collision=n.collision!==void 0?n.collision:f.collision,f.collision_severity=n.collision_severity!==void 0?n.collision_severity:f.collision_severity,f.notes=n.notes!==void 0?n.notes:f.notes,g.value&&n.notes!==void 0&&g.value.innerHTML!==n.notes&&(g.value.innerHTML=n.notes))},{deep:!0,immediate:!0}),ce([()=>f.flooded,()=>f.collision,()=>f.collision_severity,()=>f.notes],()=>{p()},{deep:!0}),(n,m)=>(s(),i("div",Ho,[m[21]||(m[21]=t("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[t("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),t("div",Go,[m[10]||(m[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[fe(" Apakah kendaraan pernah terkena banjir? "),t("span",{class:"text-red-500"},"*")],-1)),t("div",zo,[(s(),i(be,null,ye($,E=>t("label",{key:E.value,class:"cursor-pointer"},[Ne(t("input",{type:"radio","onUpdate:modelValue":m[0]||(m[0]=X=>f.flooded=X),value:E.value,class:"hidden peer",onChange:b},null,40,Wo),[[je,f.flooded]]),t("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":f.flooded===E.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":f.flooded!==E.value}])},D(E.label),3)])),64))])]),t("div",Jo,[m[12]||(m[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[fe(" Apakah kendaraan pernah mengalami tabrakan? "),t("span",{class:"text-red-500"},"*")],-1)),t("div",Zo,[(s(),i(be,null,ye(B,E=>t("label",{key:E.value,class:"cursor-pointer"},[Ne(t("input",{type:"radio","onUpdate:modelValue":m[1]||(m[1]=X=>f.collision=X),value:E.value,class:"hidden peer",onChange:b},null,40,Yo),[[je,f.collision]]),t("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":f.collision===E.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":f.collision!==E.value}])},D(E.label),3)])),64))]),he(Me,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform -translate-y-2","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-2"},{default:Ve(()=>[f.collision==="yes"?(s(),i("div",Xo,[m[11]||(m[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[fe("Tingkat kerusakan: "),t("span",{class:"text-red-500"},"*")],-1)),t("div",Qo,[(s(),i(be,null,ye(K,E=>t("label",{key:E.value,class:"cursor-pointer"},[Ne(t("input",{type:"radio","onUpdate:modelValue":m[2]||(m[2]=X=>f.collision_severity=X),value:E.value,class:"hidden peer",onChange:b},null,40,ei),[[je,f.collision_severity]]),t("div",{class:ae(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-blue-500 bg-blue-100 text-blue-700 shadow-sm scale-[0.98]":f.collision_severity===E.value,"border-gray-300 text-gray-700 hover:bg-white hover:border-gray-400":f.collision_severity!==E.value}])},D(E.label),3)])),64))])])):d("",!0)]),_:1})]),t("div",ti,[t("div",ai,[m[14]||(m[14]=t("label",{class:"block text-sm font-medium text-gray-700"},"Catatan Kesimpulan",-1)),t("button",{type:"button",onClick:m[3]||(m[3]=E=>v.value=!v.value),class:"flex items-center gap-2 px-3 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all duration-200"},m[13]||(m[13]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),fe(" Template ")]))]),he(Me,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:Ve(()=>[v.value?(s(),i("div",ni,[t("div",si,[m[16]||(m[16]=t("h5",{class:"text-sm font-semibold text-gray-700"},"Pilih Template Kesimpulan",-1)),t("button",{onClick:m[4]||(m[4]=E=>v.value=!1),class:"text-gray-400 hover:text-gray-600"},m[15]||(m[15]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",oi,[(s(!0),i(be,null,ye(S.value,E=>(s(),i("button",{key:E.id,onClick:X=>C(E),class:"p-3 text-left border border-gray-200 rounded-lg hover:border-indigo-300 hover:bg-indigo-50 transition-all duration-150"},[t("div",li,D(E.name),1),t("div",ri,D(E.description),1)],8,ii))),128))])])):d("",!0)]),_:1}),t("div",ui,[t("button",{type:"button",onClick:m[5]||(m[5]=E=>z("bold")),class:ae(["p-2 rounded transition-all duration-150 ease-in-out font-medium",P.bold?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Bold"},m[17]||(m[17]=[t("strong",null,"B",-1)]),2),t("button",{type:"button",onClick:m[6]||(m[6]=E=>z("italic")),class:ae(["p-2 rounded transition-all duration-150 ease-in-out font-medium",P.italic?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Italic"},m[18]||(m[18]=[t("em",null,"I",-1)]),2),t("button",{type:"button",onClick:m[7]||(m[7]=E=>z("underline")),class:ae(["p-2 rounded transition-all duration-150 ease-in-out font-medium",P.underline?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Underline"},m[19]||(m[19]=[t("u",null,"U",-1)]),2),t("button",{type:"button",onClick:m[8]||(m[8]=E=>M()),class:"p-2 rounded transition-all duration-150 ease-in-out hover:bg-gray-200 hover:shadow-sm ml-2",title:"Clear Template"}," üóëÔ∏è Clear ")]),he(Me,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform -translate-y-1","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-1"},{default:Ve(()=>[Object.values(P).some(E=>E)?(s(),i("div",di,[m[20]||(m[20]=fe(" Format aktif: ")),P.bold?(s(),i("span",ci,"Bold")):d("",!0),P.italic?(s(),i("span",pi,"Italic")):d("",!0),P.underline?(s(),i("span",gi,"Underline")):d("",!0)])):d("",!0)]),_:1}),t("div",{ref_key:"editorRef",ref:g,contenteditable:"true",class:ae(["w-full min-h-[120px] p-3 rounded-md border border-gray-300 shadow-sm transition-all duration-200 ease-in-out prose max-w-none",{"bg-white border-gray-300":!I.value,"bg-blue-50 border-indigo-500 ring-2 ring-indigo-200":I.value}]),onInput:m[9]||(m[9]=(...E)=>Te(ne)&&Te(ne)(...E)),onBlur:O,onFocus:L,onKeydown:Pt(_,["enter"]),onPaste:x,onMouseup:U,onKeyup:U,placeholder:"Tambahkan catatan kesimpulan inspeksi di sini..."},null,34)])]))}},wi=Ce(mi,[["__scopeId","data-v-e09db1bd"]]);export{_s as B,ki as C,xi as V,Ct as _,wi as a};
