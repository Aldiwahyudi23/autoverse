import{x as Tt,r as T,g as Pe,q as ne,E as De,G as me,c as o,o as n,d as t,b as u,k as $e,z as Te,A as Ee,n as pe,t as L,F as _e,m as Se,f as Ie,u as Ae,e as Nt,y as Re,w as Ne,N as Me,D as Fe,L as qe,j as ke,a as je,l as wt,T as Le,M as Mt,p as Ut,O as kt,J as Be,B as Et}from"./vendor-g77w9U1W.js";import{l as It}from"./lodash-CGXsUT3p.js";import{_ as Pt}from"./PrimaryButton-CrKKsBb9.js";import{_ as Dt}from"./ActionMessage-C9w22vKV.js";import{F as Rt}from"./fuse-Ch1WBRTM.js";import{_ as Ve}from"./app-DfnQvrPw.js";const Lt={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},jt={key:0,class:"p-4 space-y-2"},Bt={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Ft={class:"flex items-center space-x-2"},qt={key:0,class:"text-xs text-red-500 font-normal ml-2"},Ot={key:1,class:"text-xs text-red-500 font-normal ml-2"},Kt={key:2,class:"text-xs text-green-500 font-normal ml-2"},zt={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Ht={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},Gt={class:"col-span-2 flex space-x-3"},Wt={class:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},Zt={class:"flex items-start"},Jt={class:"text-sm text-blue-700"},Xt={class:"mt-1"},Yt={key:0,class:"inline-flex items-center px-2 py-1 rounded bg-blue-100 text-blue-800 text-xs font-medium mr-2"},Qt={key:1,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium mr-2"},ea={key:2,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium"},ta={key:3,class:"text-blue-600"},aa={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},sa={class:"relative"},na={key:0,class:"absolute right-3 top-3"},oa={key:1,class:"mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},ia={key:0},la=["onMousedown"],ra={class:"font-medium text-gray-900"},ua={class:"text-sm text-gray-500"},da={key:1,class:"p-4 text-sm text-gray-500 text-center"},ca={key:0,class:"text-xs text-red-500 font-normal ml-2"},pa={key:0,class:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},ma={key:1,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},ga={key:0,class:"mb-4"},va=["innerHTML"],fa={key:1},ha={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},ba=["onClick"],ya=["src","alt"],xa={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},wa={class:"text-white text-xs text-center"},ka={key:2,class:"text-center py-4 text-gray-500 text-sm"},Ia={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},_a=["src","alt"],$a={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},Sa={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},Ca={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Aa={__name:"VehicleDetails",props:{inspection:{type:Object,default:null},CarDetail:Array,allInspections:{type:Array,default:()=>[]}},emits:["update-vehicle","update:validation","update:hasUnsavedChanges","update:vehicle-type"],setup(a,{emit:Q}){var f,K,ie,re,ue,te;const e=a,_=Q,l=Tt({plate_number:((f=e.inspection)==null?void 0:f.plate_number)||"",car_id:((K=e.inspection)==null?void 0:K.car_id)||null,car_name:((ie=e.inspection)==null?void 0:ie.car_name)||""}),I=T(((re=e.inspection)==null?void 0:re.plate_number)||""),m=T(((ue=e.inspection)==null?void 0:ue.car_id)||null),A=T(((te=e.inspection)==null?void 0:te.car_name)||""),y=T(""),N=T(""),M=T(""),S=T(null),B=T({rear_door:!1}),Z=T(!1),p=T(""),r=T(""),$=T(l.car_name),D=T(!1),V=T(!1),q=T([]),Y=T(null),R=T([]),d=T(!1),G=T(0);Pe(()=>{var b,h,oe,z,ce;if(P((b=e.inspection)==null?void 0:b.plate_number),(h=e.inspection)!=null&&h.car_id&&((oe=e.CarDetail)==null?void 0:oe.length)>0){const ge=e.CarDetail.find(fe=>fe.id===e.inspection.car_id);ge&&de(ge)}else!((z=e.inspection)!=null&&z.car_id)&&((ce=e.inspection)!=null&&ce.car_name)&&($.value=e.inspection.car_name,l.car_id=null);window.addEventListener("keydown",i),J(),_("update:hasUnsavedChanges",C.value),_("update:validation",U.value)}),De(()=>{window.removeEventListener("keydown",i)});const J=()=>{try{const b=localStorage.getItem("vehicle_features");if(b){const h=JSON.parse(b);B.value.rear_door=h.rear_door||!1,h.pick_up?S.value="pick_up":h.box?S.value="box":S.value=null}else B.value.rear_door=!1,S.value=null;x()}catch(b){console.error("Error loading vehicle type from localStorage:",b),B.value.rear_door=!1,S.value=null,x()}},w=()=>{B.value.rear_door=!B.value.rear_door,s()},g=b=>{S.value===b?S.value=null:S.value=b,s()},s=()=>{try{const b={rear_door:B.value.rear_door,pick_up:S.value==="pick_up",box:S.value==="box"};localStorage.setItem("vehicle_features",JSON.stringify(b)),x(),console.log("Vehicle features saved to localStorage:",b)}catch(b){console.error("Error saving vehicle type to localStorage:",b)}},x=()=>{const b={rear_door:B.value.rear_door,pick_up:S.value==="pick_up",box:S.value==="box"};_("update:vehicle-type",b)},P=b=>{if(!b){y.value="",N.value="",M.value="";return}const h=b.toUpperCase().trim(),oe=h.match(/^([A-Z]{1,2})?([0-9]{1,4})?([A-Z]{1,3})?$/);if(oe)y.value=oe[1]||"",N.value=oe[2]||"",M.value=oe[3]||"";else{let z="area",ce="",ge="",fe="";for(const he of h)z==="area"&&/[A-Z]/.test(he)?ce+=he:z==="area"&&/[0-9]/.test(he)?(z="number",ge+=he):z==="number"&&/[0-9]/.test(he)?ge+=he:z==="number"&&/[A-Z]/.test(he)?(z="suffix",fe+=he):z==="suffix"&&/[A-Z]/.test(he)&&(fe+=he);y.value=ce,N.value=ge,M.value=fe}ae()},ae=()=>{const b=`${y.value}${N.value}${M.value}`;l.plate_number=b,c()},j=b=>{b==="area"?y.value=y.value.toUpperCase().replace(/[^A-Z]/g,""):b==="number"?N.value=N.value.replace(/[^0-9]/g,""):b==="suffix"&&(M.value=M.value.toUpperCase().replace(/[^A-Z]/g,"")),ae()},O=ne(()=>{const b=l.plate_number;return/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test(b)}),ee=ne(()=>!$.value||$.value.trim()===""),se=ne(()=>l.plate_number.length>0&&!O.value?"Format plat nomor tidak valid.":null),U=ne(()=>{const b=!l.plate_number||l.plate_number.trim()==="",h=!$.value||$.value.trim()==="";return b||h||!O.value||Z.value}),C=ne(()=>{const b=l.plate_number!==I.value,h=l.car_id!==m.value||$.value!==A.value;return b||h}),E=ne(()=>C.value&&!U.value),F=b=>{var oe,z,ce;if(!b)return"";const h=[];return(oe=b.brand)!=null&&oe.name&&h.push(b.brand.name),(z=b.model)!=null&&z.name&&h.push(b.model.name),(ce=b.type)!=null&&ce.name&&h.push(b.type.name),b.cc&&h.push((b.cc/1e3).toFixed(1)),b.transmission&&h.push(b.transmission),b.year&&h.push(b.year.toString()),b.fuel_type&&h.push(b.fuel_type),b.production_period&&h.push(`(${b.production_period})`),h.join(" ")},W=It.debounce(()=>{if(!$.value.trim()){q.value=[],D.value=!1;return}V.value=!0;try{const b=$.value.trim();if(e.CarDetail&&e.CarDetail.length>0){const h=e.CarDetail.map(ce=>({...ce,formattedName:F(ce)})),z=new Rt(h,{keys:["formattedName","brand.name","model.name","type.name"],threshold:.6,findAllMatches:!0,includeScore:!0,shouldSort:!0}).search(b).slice(0,10);q.value=z.map(ce=>ce.item)}else q.value=[];D.value=!0}finally{V.value=!1}},300),X=()=>{if(l.car_id&&(l.car_id=null,Y.value=null,R.value=[]),!$.value.trim()){q.value=[],D.value=!1;return}W()},le=()=>{setTimeout(()=>{D.value=!1,!l.car_id&&$.value&&(l.car_name=$.value,c())},200)},de=async b=>{Y.value=b,$.value=F(b),l.car_id=b.id,l.car_name=F(b),D.value=!1,W.cancel(),await be(b.id),c(),_("update:hasUnsavedChanges",C.value),_("update:validation",U.value)},xe=b=>!b||!b.file_path?"":`/storage/${b.file_path}`,be=async b=>{try{const h=await fetch(`/api/cars/${b}/images`);if(h.ok){const oe=await h.json();R.value=Array.isArray(oe)?oe:[]}else R.value=[]}catch(h){console.error("Error loading car images:",h),R.value=[]}},Ce=b=>{G.value=b,d.value=!0,document.body.style.overflow="hidden"},ye=()=>{d.value=!1,document.body.style.overflow=""},we=()=>{G.value=(G.value+1)%R.value.length},ve=()=>{G.value=(G.value-1+R.value.length)%R.value.length},i=b=>{if(d.value)switch(b.key){case"Escape":ye();break;case"ArrowRight":we();break;case"ArrowLeft":ve();break}},c=()=>{const b={plate_number:l.plate_number,car_id:l.car_id,car_name:l.car_name};_("update-vehicle",b)},v=()=>{e.inspection&&l.post(route("inspections.updateVehicleDetails",{inspection:e.inspection.id}),{preserveScroll:!0,onSuccess:()=>{I.value=l.plate_number,m.value=l.car_id,A.value=l.car_name,_("update:hasUnsavedChanges",!1),console.log("Data berhasil disimpan!")},onError:b=>{console.error("Gagal menyimpan data:",b)}})};return me([()=>l.plate_number,()=>l.car_name],b=>{p.value="",Z.value=!1,r.value="";const h=b[0];if(h&&h.length>=6){const oe=e.allInspections.filter(z=>{var ce;return z.plate_number===h&&z.id!==((ce=e.inspection)==null?void 0:ce.id)});if(oe.length>0){const z=["draft","in_progress","pending","pending_review","revision"],ce=oe.find(ge=>z.includes(ge.status));if(ce)Z.value=!0,p.value=`Nomor plat ini sedang dalam proses inspeksi dengan status: ${ce.status.replace(/_/g," ").toUpperCase()}.`;else{const ge=oe.filter(fe=>["approved","rejected","completed","cancelled"].includes(fe.status));if(ge.length>0){ge.sort((he,Ue)=>new Date(Ue.created_at)-new Date(he.created_at));const fe=ge[0];if(fe.car_id){const he=e.CarDetail.find(Ue=>Ue.id===fe.car_id);he&&de(he)}else fe.car_name&&($.value=fe.car_name,l.car_name=fe.car_name,l.car_id=null);r.value=`Nomor plat ini sudah pernah diperiksa ${ge.length} kali sebelumnya.`}}}}_("update:hasUnsavedChanges",C.value),_("update:validation",U.value)},{deep:!0}),me([()=>B.value.rear_door,()=>S.value],()=>{s()}),me(()=>{var b;return(b=e.inspection)==null?void 0:b.car_id},b=>{var h,oe;if(b!==l.car_id)if(l.car_id=b,b&&((h=e.CarDetail)==null?void 0:h.length)>0){const z=e.CarDetail.find(ce=>ce.id===b);z&&de(z)}else!b&&((oe=e.inspection)!=null&&oe.car_name)&&($.value=e.inspection.car_name,l.car_name=e.inspection.car_name,l.car_id=null)}),me(()=>{var b;return(b=e.inspection)==null?void 0:b.car_name},b=>{b&&b!==$.value&&($.value=b)}),(b,h)=>{var oe;return n(),o("div",Lt,[h[27]||(h[27]=t("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[t("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),a.inspection?(n(),o("div",jt,[t("div",Bt,[h[11]||(h[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nomor Plat Kendaraan ",-1)),t("div",Ft,[Te(t("input",{"onUpdate:modelValue":h[0]||(h[0]=z=>y.value=z),type:"text",placeholder:"Contoh: B",class:pe(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!O.value||Z.value}]),onInput:h[1]||(h[1]=z=>j("area")),maxlength:"2"},null,34),[[Ee,y.value]]),Te(t("input",{"onUpdate:modelValue":h[2]||(h[2]=z=>N.value=z),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:pe(["w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!O.value||Z.value}]),onInput:h[3]||(h[3]=z=>j("number")),maxlength:"4"},null,34),[[Ee,N.value]]),Te(t("input",{"onUpdate:modelValue":h[4]||(h[4]=z=>M.value=z),type:"text",placeholder:"ABC",class:pe(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!O.value||Z.value}]),onInput:h[5]||(h[5]=z=>j("suffix")),maxlength:"3"},null,34),[[Ee,M.value]])]),se.value?(n(),o("span",qt,L(se.value),1)):u("",!0),p.value?(n(),o("span",Ot,L(p.value),1)):u("",!0),r.value?(n(),o("span",Kt,L(r.value),1)):u("",!0)]),t("div",zt,[h[15]||(h[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Jenis Kendaraan ",-1)),t("div",Ht,[t("div",{class:pe(["w-full px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":B.value.rear_door,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":!B.value.rear_door}]),onClick:w},h[12]||(h[12]=[t("span",null,"Pintu Belakang",-1)]),2),t("div",Gt,[t("div",{class:pe(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":S.value==="pick_up","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":S.value!=="pick_up"}]),onClick:h[6]||(h[6]=z=>g("pick_up"))}," Pick Up ",2),t("div",{class:pe(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":S.value==="box","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":S.value!=="box"}]),onClick:h[7]||(h[7]=z=>g("box"))}," Box ",2)])]),t("div",Wt,[t("div",Zt,[h[14]||(h[14]=t("svg",{class:"w-4 h-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),t("div",Jt,[h[13]||(h[13]=t("p",{class:"font-medium"},"Status Kendaraan:",-1)),t("p",Xt,[B.value.rear_door?(n(),o("span",Yt," ✓ Mobil Pada Umum nya yang memiliki Pintu Belakang ")):u("",!0),S.value==="pick_up"?(n(),o("span",Qt," ✓ Pick Up ")):u("",!0),S.value==="box"?(n(),o("span",ea," ✓ Box ")):u("",!0),!B.value.rear_door&&!S.value?(n(),o("span",ta," Pilih jenis kendaraan agar point bisa menyesuaikan dengan tipe kendaraan anda ")):u("",!0)])])])])]),t("div",aa,[h[18]||(h[18]=t("label",{class:"block text-sm font-medium text-gray-700"}," Nama Mobil ",-1)),t("div",sa,[Te(t("input",{"onUpdate:modelValue":h[8]||(h[8]=z=>$.value=z),type:"text",placeholder:"Cari atau ketik nama mobil...",class:pe(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{"border-red-500 focus:border-red-500":ee.value}]),onInput:X,onFocus:h[9]||(h[9]=z=>D.value=!0),onBlur:le},null,34),[[Ee,$.value]]),V.value?(n(),o("div",na,h[16]||(h[16]=[t("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):u("",!0),D.value?(n(),o("div",oa,[q.value.length>0?(n(),o("div",ia,[(n(!0),o(_e,null,Se(q.value,z=>(n(),o("div",{key:z.id,class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:ce=>de(z)},[t("div",ra,L(F(z)),1),t("div",ua,L(z.year)+" • "+L(z.cc)+"cc • "+L(z.transmission)+" • "+L(z.fuel_type),1)],40,la))),128))])):(n(),o("div",da,h[17]||(h[17]=[Ie(" Tidak ada data mobil yang cocok. "),t("br",null,null,-1),Ie(" Silakan input manual dengan format: "),t("br",null,null,-1),t("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):u("",!0)]),ee.value?(n(),o("span",ca,"Nama mobil tidak boleh kosong.")):u("",!0)]),!Ae(l).car_id&&$.value&&!D.value?(n(),o("div",pa,h[19]||(h[19]=[Nt('<div class="flex items-start" data-v-5761f943><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-600 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-5761f943><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-5761f943></path></svg><div data-v-5761f943><p class="text-yellow-800 font-medium mb-1" data-v-5761f943>Informasi Penting</p><p class="text-yellow-700 text-sm mb-2" data-v-5761f943> Anda memasukkan nama mobil secara manual. Data detail mobil (spesifikasi, gambar, deskripsi) <span class="font-semibold" data-v-5761f943>tidak akan tersedia</span> dalam laporan inspeksi. </p><p class="text-yellow-700 text-sm mb-2" data-v-5761f943> Untuk laporan yang lengkap dengan semua detail mobil, silakan pilih mobil dari hasil pencarian. </p><p class="text-yellow-700 text-sm" data-v-5761f943> Jika tidak ingin mengubah data mobil dan anda tidak sengaja sudah menghapus atau edit, <span class="font-semibold" data-v-5761f943>jangan klik tombol &quot;Perbarui Detail Kendaraan&quot;</span>. Sebagai gantinya, <span class="font-semibold" data-v-5761f943>refresh halaman</span> untuk kembali ke data awal. </p></div></div>',1)]))):u("",!0),Ae(l).car_id&&Y.value?(n(),o("div",ma,[Y.value.description?(n(),o("div",ga,[h[20]||(h[20]=t("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),t("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:Y.value.description},null,8,va)])):u("",!0),R.value.length>0?(n(),o("div",fa,[h[21]||(h[21]=t("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),t("div",ha,[(n(!0),o(_e,null,Se(R.value,(z,ce)=>(n(),o("div",{key:z.id||ce,class:"relative group cursor-pointer",onClick:ge=>Ce(ce)},[t("img",{src:xe(z),alt:z.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,ya),z.note?(n(),o("div",xa,[t("p",wa,L(z.note),1)])):u("",!0)],8,ba))),128))])])):(n(),o("div",ka," Tidak ada gambar tersedia untuk mobil ini "))])):u("",!0),d.value?(n(),o("div",{key:2,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:ye},[t("div",Ia,[t("button",{onClick:ye,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},h[22]||(h[22]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),R.value.length>1?(n(),o("button",{key:0,onClick:Re(ve,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},h[23]||(h[23]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):u("",!0),R.value.length>1?(n(),o("button",{key:1,onClick:Re(we,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},h[24]||(h[24]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):u("",!0),t("img",{src:xe(R.value[G.value]),alt:"Car Image "+(G.value+1),class:"max-w-full max-h-full object-contain",onClick:h[10]||(h[10]=Re(()=>{},["stop"]))},null,8,_a),R.value.length>1?(n(),o("div",$a,L(G.value+1)+" / "+L(R.value.length),1)):u("",!0),(oe=R.value[G.value])!=null&&oe.note?(n(),o("div",Sa,L(R.value[G.value].note),1)):u("",!0)])])):u("",!0),$e(Pt,{type:"button",onClick:v,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed",disabled:!E.value},{default:Ne(()=>[Ae(l).processing?(n(),o("svg",Ca,h[25]||(h[25]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):u("",!0),t("span",null,L(Ae(l).processing?"Mengirim...":"Perbarui Detail Kendaraan"),1),$e(Dt,{on:Ae(l).recentlySuccessful,class:"me-3 text-sm text-green-600 font-medium"},{default:Ne(()=>h[26]||(h[26]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),Ie(" Tersimpan. ")])),_:1,__:[26]},8,["on"])]),_:1},8,["disabled"])])):u("",!0)])}}},zi=Ve(Aa,[["__scopeId","data-v-5761f943"]]),Va={class:"mt-1"},Ta=["value","required","minlength","maxlength","allowSpace","placeholder"],Na={key:0,class:"mt-2 text-sm text-red-600"},_t={__name:"InputText",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],pattern:String,placeholder:String,error:String,pointId:[String,Number],textTransform:{type:String,default:"none"},allowSpace:{type:Boolean,default:!0}},emits:["update:modelValue","save"],setup(a,{emit:Q}){const e=a,_=Q,l=ne(()=>{if(!e.modelValue)return"";let m=e.modelValue;switch(e.allowSpace||(m=m.replace(/\s+/g,"")),e.textTransform){case"uppercase":return m.toUpperCase();case"lowercase":return m.toLowerCase();case"capitalize":return m.replace(/\b\w/g,A=>A.toUpperCase());default:return m}}),I=m=>{let A=m.target.value;switch(e.allowSpace||(A=A.replace(/\s+/g,"")),e.textTransform){case"uppercase":A=A.toUpperCase();break;case"lowercase":A=A.toLowerCase();break;case"capitalize":A=A.replace(/\b\w/g,y=>y.toUpperCase());break}_("update:modelValue",A),_("save",e.pointId)};return(m,A)=>(n(),o("div",Va,[t("input",{value:l.value,onInput:I,type:"text",required:a.required,minlength:a.minLength,maxlength:a.maxLength,allowSpace:a.allowSpace,placeholder:a.placeholder,class:pe(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{uppercase:a.textTransform==="uppercase",lowercase:a.textTransform==="lowercase",capitalize:a.textTransform==="capitalize"}])},null,42,Ta),a.error?(n(),o("p",Na,L(a.error),1)):u("",!0)]))}},Ma={class:"mt-1"},Ua=["value","required","min","max","step","placeholder"],Ea={key:0,class:"mt-2 text-sm text-red-600"},$t={__name:"InputNumber",props:{modelValue:[String,Number],required:Boolean,min:[String,Number],max:[String,Number],step:[String,Number],placeholder:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(a,{emit:Q}){const e=a,_=Q,l=I=>{const m=I.target.value;_("update:modelValue",m),_("save",e.pointId)};return(I,m)=>(n(),o("div",Ma,[t("input",{value:a.modelValue,onInput:l,type:"number",required:a.required,min:a.min,max:a.max,step:a.step,placeholder:a.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Ua),a.error?(n(),o("p",Ea,L(a.error),1)):u("",!0)]))}},Pa={class:"mt-1"},Da=["value","required","min","max"],Ra={key:0,class:"mt-2 text-sm text-red-600"},St={__name:"InputDate",props:{modelValue:String,required:Boolean,minDate:String,maxDate:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(a,{emit:Q}){const e=a,_=Q,l=I=>{_("update:modelValue",I.target.value),_("save",e.pointId)};return(I,m)=>(n(),o("div",Pa,[t("input",{value:a.modelValue,onChange:l,type:"date",required:a.required,min:a.minDate,max:a.maxDate,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Da),a.error?(n(),o("p",Ra,L(a.error),1)):u("",!0)]))}},La={class:"mt-1"},ja=["value","required","placeholder"],Ba={key:0,class:"mt-2 text-sm text-red-600"},Ct={__name:"InputAccount",props:{modelValue:[String,Number],required:Boolean,placeholder:String,error:String,pointId:[String,Number],settings:{type:Object,default:()=>({currency_symbol:"Rp",thousands_separator:",",min_value:0,max_value:1e9})}},emits:["update:modelValue","save"],setup(a,{emit:Q}){const e=a,_=Q,l=T(""),I=ne(()=>{var M,S,B,Z;return{currency_symbol:((M=e.settings)==null?void 0:M.currency_symbol)||"Rp",thousands_separator:((S=e.settings)==null?void 0:S.thousands_separator)||",",min_value:((B=e.settings)==null?void 0:B.min_value)!==void 0?Number(e.settings.min_value):0,max_value:((Z=e.settings)==null?void 0:Z.max_value)!==void 0?Number(e.settings.max_value):1e9}}),m=M=>{if(M==null||M==="")return"";const S=Number(M);if(isNaN(S))return"";let B=S.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return I.value.thousands_separator!==","&&(B=B.replace(/,/g,I.value.thousands_separator)),B},A=M=>M?M.replace(/[^\d]/g,""):"",y=ne(()=>l.value?`${I.value.currency_symbol} ${m(l.value)}`:""),N=M=>{let S=A(M.target.value),B=Number(S);I.value.min_value!==void 0&&B<I.value.min_value&&(S=I.value.min_value.toString()),I.value.max_value!==void 0&&B>I.value.max_value&&(S=I.value.max_value.toString()),l.value=S,_("update:modelValue",S),_("save",e.pointId)};return me(()=>e.modelValue,M=>{M!=null&&(l.value=M.toString())},{immediate:!0}),(M,S)=>(n(),o("div",La,[t("input",{value:y.value,onInput:N,type:"text",required:a.required,placeholder:a.placeholder,class:pe(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",a.error?"border-red-300":"border-gray-300"])},null,42,ja),a.error?(n(),o("p",Ba,L(a.error),1)):u("",!0)]))}},Fa={class:"mt-1 space-y-3"},qa={key:0,class:"space-y-2"},Oa={class:"flex flex-wrap gap-2"},Ka=["onClick"],za=["value","required","minlength","maxlength","placeholder"],Ha={class:"flex justify-between items-center mt-1"},Ga={class:"text-xs text-gray-500"},Wa={key:0,class:"text-xs text-red-600"},At={__name:"InputTextarea",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],placeholder:String,error:String,pointId:[String,Number],inspectionId:[String,Number],settings:Object},emits:["update:modelValue","save"],setup(a,{emit:Q}){const e=a,_=Q,l=T([]),I=T(""),m=M=>l.value.some(S=>S.value===M),A=M=>{m(M.value)?l.value=l.value.filter(p=>p.value!==M.value):l.value.push(M);const B=[...l.value.map(p=>p.value)];I.value.trim()&&B.push(I.value.trim());const Z=B.join(", ");_("update:modelValue",Z),_("save",{pointId:e.pointId,inspectionId:e.inspectionId,notes:Z})},y=M=>{const S=M.target.value;_("update:modelValue",S),_("save",{pointId:e.pointId,inspectionId:e.inspectionId,notes:S}),N(S)},N=M=>{var p,r,$,D;if(!M){l.value=[],I.value="";return}const S=M.split(",").map(V=>V.trim()).filter(V=>V),B=((r=(p=e.settings)==null?void 0:p.damage_options)==null?void 0:r.map(V=>V.value))||[];l.value=((D=($=e.settings)==null?void 0:$.damage_options)==null?void 0:D.filter(V=>S.includes(V.value)))||[];const Z=S.filter(V=>!B.includes(V));I.value=Z.join(", ")};return me(()=>e.modelValue,M=>{M!=null&&N(M)},{immediate:!0}),me(()=>{var M;return(M=e.settings)==null?void 0:M.damage_options},(M,S)=>{if(M!==S){const B=M?M.map($=>$.value):[];l.value=l.value.filter($=>B.includes($.value));const p=[...l.value.map($=>$.value)];I.value.trim()&&p.push(I.value.trim());const r=p.filter($=>$).join(", ");_("update:modelValue",r),_("save",{pointId:e.pointId,inspectionId:e.inspectionId,notes:r})}},{deep:!0,immediate:!1}),(M,S)=>{var B,Z,p;return n(),o("div",Fa,[(B=a.settings)!=null&&B.enable_damage&&((Z=a.settings)!=null&&Z.damage_options)?(n(),o("div",qa,[S[0]||(S[0]=t("h4",{class:"text-sm font-medium text-gray-700"},"Pilih Kerusakan:",-1)),t("div",Oa,[(n(!0),o(_e,null,Se(a.settings.damage_options,(r,$)=>(n(),o("button",{key:$,type:"button",onClick:D=>A(r),class:pe(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors border",{"border-indigo-500 bg-indigo-100 text-indigo-700":m(r.value),"border-gray-300 bg-white text-gray-700 hover:bg-gray-50":!m(r.value)}])},L(r.label),11,Ka))),128))])])):u("",!0),t("div",null,[t("textarea",{value:a.modelValue,onInput:y,required:a.required,minlength:a.minLength,maxlength:a.maxLength,placeholder:a.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",rows:"4"},null,40,za),t("div",Ha,[t("span",Ga,L(((p=a.modelValue)==null?void 0:p.length)||0)+"/"+L(a.maxLength||400),1),a.error?(n(),o("p",Wa,L(a.error),1)):u("",!0)])])])}}},Za={class:"mt-1"},Ja=["value","required"],Xa={key:0,class:"mt-2 text-sm text-red-600"},Ya={__name:"InputSelect",props:{modelValue:String,required:Boolean,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(a,{emit:Q}){const e=a,_=Q,l=I=>{_("update:modelValue",I.target.value),_("save",e.pointId)};return(I,m)=>(n(),o("div",Za,[t("select",{value:a.modelValue,onChange:l,required:a.required,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},m[0]||(m[0]=[t("option",{value:"",disabled:""},"Select status",-1),t("option",{value:"good"},"Good",-1),t("option",{value:"bad"},"Bad",-1),t("option",{value:"na"},"N/A",-1)]),40,Ja),a.error?(n(),o("p",Xa,L(a.error),1)):u("",!0)]))}},Qa=Ve(Ya,[["__scopeId","data-v-1b6c0201"]]),es={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},ts={class:"bg-white rounded-xl p-8 w-full max-w-sm mx-auto shadow-2xl transform transition-all duration-300 scale-100 opacity-100"},as={class:"text-xs text-gray-500 mt-2 text-center"},ss={class:"flex flex-row space-x-4 mb-6"},ns={class:"mt-4 text-right"},os={__name:"ImageSourceOptionsModal",props:{show:{type:Boolean,default:!1},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})}},emits:["close","open-webcam","trigger-gallery"],setup(a){return(Q,e)=>a.show?(n(),o("div",es,[t("div",ts,[e[7]||(e[7]=t("h3",{class:"text-xl font-bold text-gray-800 mb-2 text-center"},"Pilih Sumber Gambar",-1)),t("p",as,[e[3]||(e[3]=Ie("Ambil Foto Maksimal: ")),t("b",null,L(a.settings.max_files),1),e[4]||(e[4]=Ie(" Dengan Rasio & Ukuran: ")),t("b",null,L(a.settings.camera_aspect_ratio),1)]),t("div",ss,[t("button",{onClick:e[0]||(e[0]=_=>Q.$emit("open-webcam")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},e[5]||(e[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),t("span",{class:"text-sm font-medium"},"Kamera",-1)])),t("button",{onClick:e[1]||(e[1]=_=>Q.$emit("trigger-gallery")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},e[6]||(e[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),t("span",{class:"text-sm font-medium"},"Galeri",-1)]))]),t("div",ns,[t("button",{onClick:e[2]||(e[2]=_=>Q.$emit("close")),class:"px-5 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-colors duration-200 ease-in-out"}," Batal ")])])])):u("",!0)}},is={key:0,class:"fixed inset-0 bg-black bg-opacity-95 z-50 flex flex-col items-center justify-center"},ls={class:"w-full h-full flex flex-col"},rs={class:"flex justify-between items-center p-4 bg-black bg-opacity-70 text-white shadow-md"},us=["disabled"],ds={class:"text-lg font-semibold"},cs={class:"flex items-center gap-2"},ps=["disabled"],ms={key:0,class:"px-4 py-2 bg-indigo-900 text-white"},gs={class:"flex justify-between items-center text-sm"},vs={class:"w-full bg-gray-700 rounded-full h-2 mt-1"},fs={class:"flex-1 flex items-center justify-center overflow-hidden relative"},hs=["src"],bs={key:1,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-3"},ys=["disabled"],xs=["disabled"],ws={key:2,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},ks={key:3,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},Is=["disabled"],_s=["disabled"],$s=["disabled"],Ss={class:"flex flex-col gap-3 p-4 bg-black bg-opacity-70 shadow-inner"},Cs={class:"flex justify-between items-center w-full"},As=["disabled"],Vs={key:1,class:"flex-1"},Ts=["disabled"],Ns={class:"flex gap-3 w-full"},Ms={key:1,class:"flex-1 px-4 py-3 bg-gradient-to-r from-indigo-700 to-sky-600 rounded-lg cursor-not-allowed flex items-center justify-center font-medium opacity-75",disabled:""},Us={class:"flex items-center gap-2"},Es={key:0,class:"text-center"},Ps={__name:"PreviewModal",props:{show:Boolean,images:{type:Array,default:()=>[]},initialIndex:{type:Number,default:0},allowMultiple:Boolean,maxFiles:Number,isUploading:Boolean,aspectRatio:Number,point:Object,uploadProgress:{type:Number,default:0},currentUpload:{type:Number,default:0},totalUpload:{type:Number,default:0}},emits:["close","saveImages","removePreviewImage","triggerAddMorePhotos","update:images","retryImage"],setup(a,{emit:Q}){const e=a,_=Q,l=T(0),I=T([]),m=ne(()=>I.value.length>0?I.value[l.value]:null);me(()=>e.images,D=>{I.value=D.map(V=>({...V,rotation:V.isNew&&V.rotation||0})),D.length===0&&e.show&&B()},{deep:!0,immediate:!0}),me(()=>e.show,D=>{D&&e.images.length>0&&(l.value=e.initialIndex)}),me(()=>e.uploadProgress,D=>{D===100&&console.log("Upload completed")});const A=D=>D.preview||(D.image_path?`/${D.image_path}`:""),y=D=>{if(m.value&&m.value.isNew&&!e.isUploading){const V=m.value.rotation||0;let q;D==="left"?q=V-90:q=V+90,q=(q%360+360)%360,I.value[l.value].rotation=q,_("update:images",I.value)}},N=()=>{e.isUploading||(l.value=l.value<I.value.length-1?l.value+1:0)},M=()=>{e.isUploading||(l.value=l.value>0?l.value-1:I.value.length-1)},S=()=>{e.isUploading||_("saveImages",I.value)},B=()=>{e.isUploading||_("close")},Z=()=>{if(m.value&&!e.isUploading){const D=m.value,V=I.value.findIndex(q=>q.isNew&&D.isNew&&q.preview===D.preview||!q.isNew&&!D.isNew&&q.id===D.id);V!==-1&&(_("removePreviewImage",D),I.value.splice(V,1),_("update:images",I.value)),l.value>=I.value.length&&(l.value=Math.max(0,I.value.length-1)),I.value.length===0&&_("close")}},p=()=>{e.isUploading||_("triggerAddMorePhotos")},r=()=>{m.value&&!e.isUploading&&_("retryImage",m.value)},$=D=>{D.key==="Escape"&&!e.isUploading&&B()};return Pe(()=>{document.addEventListener("keydown",$)}),De(()=>{document.removeEventListener("keydown",$)}),(D,V)=>{var q;return a.show?(n(),o("div",is,[t("div",ls,[t("div",rs,[t("button",{onClick:B,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:a.isUploading},V[2]||(V[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,us),t("div",ds,L(((q=a.point)==null?void 0:q.name)||"Preview")+" ("+L(l.value+1)+"/"+L(I.value.length)+") ",1),t("div",cs,[m.value&&m.value.isNew?(n(),o("button",{key:0,onClick:Z,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors","aria-label":"Remove new image",disabled:a.isUploading},V[3]||(V[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]),8,ps)):u("",!0)])]),a.isUploading?(n(),o("div",ms,[t("div",gs,[t("span",null,"Mengupload: "+L(a.currentUpload)+"/"+L(a.totalUpload),1),t("span",null,L(a.uploadProgress)+"%",1)]),t("div",vs,[t("div",{class:"bg-gradient-to-r from-indigo-500 to-sky-400 h-2 rounded-full progress-bar",style:Me({width:a.uploadProgress+"%"})},null,4)])])):u("",!0),t("div",fs,[t("div",{class:"relative w-full max-w-full",style:Me({paddingTop:a.aspectRatio?100/a.aspectRatio+"%":"75%"})},[m.value?(n(),o("img",{key:0,src:A(m.value),class:"absolute inset-0 w-full h-full object-contain transition-transform duration-300 ease-in-out bg-black",style:Me({transform:`rotate(${m.value.rotation}deg)`})},null,12,hs)):u("",!0),m.value&&m.value.isNew&&!m.value.isUploading&&!m.value.isFailed?(n(),o("div",bs,[t("button",{onClick:V[0]||(V[0]=Y=>y("left")),class:"p-3 bg-black bg-opacity-60 text-white rounded-full hover:bg-opacity-80 transition-colors",disabled:a.isUploading,title:"Putar ke kiri"},V[4]||(V[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12a9 9 0 1018 0 9 9 0 00-18 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l3-3m0 0l3 3m-3-3v9",transform:"rotate(180 12 12)"})],-1)]),8,ys),t("button",{onClick:V[1]||(V[1]=Y=>y("right")),class:"p-3 bg-black bg-opacity-60 text-white rounded-full hover:bg-opacity-80 transition-colors",disabled:a.isUploading,title:"Putar ke kanan"},V[5]||(V[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12a9 9 0 1018 0 9 9 0 00-18 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l3-3m0 0l3 3m-3-3v9"})],-1)]),8,xs)])):u("",!0),m.value&&m.value.isUploading?(n(),o("div",ws,V[6]||(V[6]=[t("div",{class:"text-center text-white"},[t("div",{class:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto mb-2"}),t("p",{class:"text-sm"},"Mengupload...")],-1)]))):u("",!0),m.value&&m.value.isFailed?(n(),o("div",ks,[V[7]||(V[7]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),V[8]||(V[8]=t("p",{class:"text-lg font-medium mb-2"},"Upload Gagal",-1)),t("button",{onClick:r,class:"px-4 py-2 bg-white text-red-600 rounded-lg font-medium hover:bg-gray-100 transition-colors",disabled:a.isUploading}," Coba Lagi ",8,Is)])):u("",!0)],4),I.value.length>1&&!a.isUploading?(n(),o("button",{key:0,onClick:M,class:"absolute left-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:a.isUploading},V[9]||(V[9]=[t("svg",{xmlns:"http://www.w3.org2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]),8,_s)):u("",!0),I.value.length>1&&!a.isUploading?(n(),o("button",{key:1,onClick:N,class:"absolute right-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:a.isUploading},V[10]||(V[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,$s)):u("",!0)]),t("div",Ss,[t("div",Cs,[m.value&&!m.value.isNew?(n(),o("button",{key:0,onClick:Z,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-red-400",disabled:a.isUploading},V[11]||(V[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Ie(" Hapus Foto ")]),8,As)):(n(),o("div",Vs)),a.allowMultiple&&I.value.length<a.maxFiles&&!a.isUploading?(n(),o("button",{key:2,onClick:p,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-indigo-400",disabled:a.isUploading},V[12]||(V[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Ie(" Tambah Foto ")]),8,Ts)):u("",!0)]),t("div",Ns,[a.isUploading?(n(),o("button",Ms,[t("div",Us,[V[13]||(V[13]=t("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)),t("span",null,"Mengupload... "+L(a.uploadProgress)+"%",1)])])):(n(),o("button",{key:0,onClick:S,class:"flex-1 px-4 py-3 rounded-lg bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white transition-colors font-medium hover:from-indigo-600 hover:to-sky-500"}," Simpan & Upload "))]),a.isUploading?(n(),o("div",Es,V[14]||(V[14]=[t("p",{class:"text-xs text-blue-300"}," Modal akan tertutup otomatis. Upload terus berjalan di background. ",-1)]))):u("",!0)])])])):u("",!0)}}},Ds=Ve(Ps,[["__scopeId","data-v-0e4bb6d9"]]),Rs={key:0,class:"fixed inset-0 z-40 p-0 webcam-modal-container"},Ls={class:"webcam-content-box"},js={class:"webcam-header"},Bs={class:"inspection-point-name"},Fs={class:"camera-quality-indicator"},qs={class:"quality-badge"},Os={key:1,class:"auto-focus-indicator"},Ks={key:2,class:"error-overlay"},zs={class:"error-content"},Hs={class:"error-message"},Gs={class:"webcam-footer"},Ws={class:"camera-controls"},Zs=["disabled"],Js={class:"camera-icon-container"},Xs={key:0,class:"camera-spinner"},Ys={key:1,class:"camera-shutter"},Qs=["disabled"],en={__name:"WebCamRTC",props:{show:Boolean,aspectRatio:{type:Number,default:4/3},settings:{type:Object,default:()=>({enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object,cameraQuality:{type:String}},emits:["close","photoCaptured"],setup(a,{emit:Q}){const e=a,_=Q,l=T(null),I=T(null);let m=null,A=null;const y=T("environment"),N=T(null),M=T([]),S=T(!1),B=T(!1),Z=T(!1),p=T(!1),r=T(!1),$=T(null),D=T(null),V=T(!1),q=T(!0),Y=T({}),R=ne(()=>({aspectRatio:`${e.aspectRatio} / 1`,maxWidth:"100%",maxHeight:"70vh",margin:"0 auto"})),d=async()=>{m&&m.getTracks().forEach(U=>U.stop()),$.value=null,r.value=!0;try{const U=G();console.log("Mencoba inisialisasi kamera dengan:",U),m=await navigator.mediaDevices.getUserMedia({video:U,audio:!1}),A=m.getVideoTracks()[0],l.value.srcObject=m,await new Promise((C,E)=>{l.value.onloadedmetadata=C,l.value.onerror=E,setTimeout(C,1e3)}),await l.value.play(),await s(),J(),setTimeout(async()=>{try{await w()}catch(C){console.warn("Gagal mendapatkan daftar perangkat:",C)}},500),r.value=!1,console.log("Kamera berhasil diinisialisasi")}catch(U){if(console.error("Error mengakses kamera: ",U),!m)try{console.log("Mencoba fallback berdasarkan kualitas kamera...");let C,E,F,W;switch(e.cameraQuality){case"SD":C=1280,E=720,F=640,W=480;break;case"HD":C=1920,E=1080,F=1280,W=720;break;case"4K":C=3840,E=2160,F=1920,W=1080;break;default:C=1920,E=1080,F=1280,W=720}const X={video:{facingMode:y.value,width:{min:F,ideal:C},height:{min:W,ideal:E}}};m=await navigator.mediaDevices.getUserMedia(X),A=m.getVideoTracks()[0],l.value.srcObject=m,await l.value.play(),r.value=!1,console.log("Fallback berhasil dengan kualitas:",e.cameraQuality)}catch(C){console.error("Fallback juga gagal:",C),$.value=g(C),r.value=!1}}},G=()=>{let U,C,E,F,W,X;switch(e.cameraQuality){case"SD":U=1280,C=720,E=1280,F=720,W=640,X=480;break;case"HD":U=1920,C=1080,E=1920,F=1080,W=1280,X=720;break;case"4K":U=3840,C=2160,E=3840,F=2160,W=1920,X=1080;break;default:U=1920,C=1080,E=1920,F=1080,W=1280,X=720}return{facingMode:{ideal:"environment"},width:{ideal:U,max:E,min:W},height:{ideal:C,max:F,min:X},focusMode:{ideal:["continuous","single-shot","manual"]},exposureMode:{ideal:["continuous","manual"]},whiteBalanceMode:{ideal:["continuous","manual"]}}},J=async()=>{if(A)try{const U=A.getCapabilities();D.value=U;const C=U.focusMode&&(U.focusMode.includes("continuous")||U.focusMode.includes("single-shot")),E=U.exposureMode&&U.exposureMode.includes("continuous");if(C||E){const F={};C&&(F.focusMode="continuous"),E&&(F.exposureMode="continuous",F.exposureCompensation={ideal:0}),Object.keys(F).length>0&&(await A.applyConstraints({advanced:[F]}),console.log("Auto-focus/exposure diaktifkan"))}B.value=!!U.torch||!!U.fillLightMode}catch(U){console.warn("Tidak bisa mengatur auto-focus/exposure:",U)}},w=async()=>{try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(E=>E.stop());const C=await navigator.mediaDevices.enumerateDevices();if(M.value=C.filter(E=>E.kind==="videoinput"),S.value=M.value.length>1,!N.value&&M.value.length>0){const E=M.value.find(F=>F.label.toLowerCase().includes("back")||F.label.toLowerCase().includes("rear")||F.label.toLowerCase().includes("environment"));N.value=E?E.deviceId:M.value[0].deviceId}}catch(U){console.warn("Error getting camera devices:",U)}},g=U=>{switch(U.name){case"NotAllowedError":return"Izin akses kamera ditolak. Silakan izinkan akses kamera di pengaturan browser.";case"NotFoundError":return"Tidak ada kamera yang ditemukan.";case"NotSupportedError":return"Browser tidak mendukung akses kamera.";case"NotReadableError":return"Kamera sedang digunakan oleh aplikasi lain.";case"OverconstrainedError":return"Perangkat tidak mendukung pengaturan kamera yang diminta.";default:return`Tidak dapat mengakses kamera: ${U.message}`}},s=()=>{var U,C;if(A)try{const E=A.getCapabilities();D.value=E,B.value=!!E.torch||!!E.fillLightMode,console.log("Kamera mendukung:",{maxRes:`${((U=E.width)==null?void 0:U.max)||"N/A"}x${((C=E.height)==null?void 0:C.max)||"N/A"}`,torch:E.torch,focusModes:E.focusMode,exposureModes:E.exposureMode})}catch(E){console.warn("Tidak bisa mendapatkan kemampuan kamera:",E)}},x=async()=>{if(!(!A||!B.value))try{y.value==="environment"?(await A.applyConstraints({advanced:[{torch:!Z.value}]}),Z.value=!Z.value):(console.log("Flash tidak didukung untuk kamera depan"),Z.value=!1)}catch(U){console.error("Gagal mengontrol flash:",U),Z.value=!1}},P=async()=>{if(!S.value||r.value)return;r.value=!0,m&&m.getTracks().forEach(F=>F.stop());const C=(M.value.findIndex(F=>F.deviceId===N.value)+1)%M.value.length;N.value=M.value[C].deviceId;const E=M.value[C];y.value=E.label.toLowerCase().includes("front")?"user":"environment",await d()},ae=async U=>{if(!l.value||!A)return;const C=U.currentTarget.getBoundingClientRect(),E=U.type.includes("mouse")?U.clientX-C.left:U.touches[0].clientX-C.left,F=U.type.includes("mouse")?U.clientY-C.top:U.touches[0].clientY-C.top;V.value=!0,Y.value={left:`${E-40}px`,top:`${F-40}px`},setTimeout(()=>{V.value=!1},1e3);try{const W=A.getCapabilities();if(W.focusMode&&W.focusMode.includes("manual")){const X=E/C.width,le=F/C.height;W.focusDistance&&W.pan&&W.tilt&&await A.applyConstraints({advanced:[{focusMode:"manual",focusDistance:.3,pointsOfInterest:[{x:X,y:le}]}]})}else W.focusMode&&W.focusMode.includes("single-shot")&&await A.applyConstraints({advanced:[{focusMode:"single-shot"}]})}catch(W){console.warn("Penyesuaian fokus tidak didukung:",W)}},j=async()=>{var U,C;if(!(p.value||!l.value||!I.value)){p.value=!0;try{const E=l.value,F=I.value;await new Promise(ve=>setTimeout(ve,100));const W=E.videoWidth,X=E.videoHeight;let le,de,xe,be;W/X>e.aspectRatio?(de=X,le=X*e.aspectRatio,xe=(W-le)/2,be=0):(le=W,de=W/e.aspectRatio,xe=0,be=(X-de)/2),F.width=le,F.height=de,F.getContext("2d").drawImage(E,xe,be,le,de,0,0,le,de);const ye=Math.min(.95,.7+W*X/(3840*2160)*.25),we=await new Promise(ve=>{F.toBlob(ve,"image/jpeg",ye)});if(we)if(we.size/1024>e.settings.max_size){const ve=await O(we,e.settings.max_size),i=`inspeksi_${((U=e.point)==null?void 0:U.name)||"foto"}_${Date.now()}.jpg`,c=new File([ve],i,{type:"image/jpeg",lastModified:Date.now()});_("photoCaptured",c)}else{const ve=`inspeksi_${((C=e.point)==null?void 0:C.name)||"foto"}_${Date.now()}.jpg`,i=new File([we],ve,{type:"image/jpeg",lastModified:Date.now()});_("photoCaptured",i)}}catch(E){console.error("Error mengambil foto:",E)}finally{p.value=!1}}},O=async(U,C)=>new Promise(E=>{const F=new Image;F.onload=()=>{const W=document.createElement("canvas");let X=F.width,le=F.height;const de=1920;(X>de||le>de)&&(X>le?(le=le*de/X,X=de):(X=X*de/le,le=de)),W.width=X,W.height=le,W.getContext("2d").drawImage(F,0,0,X,le);let be=.9;const Ce=()=>{W.toBlob(ye=>{ye.size/1024<=C||be<=.3?E(ye):(be-=.1,Ce())},"image/jpeg",be)};Ce()},F.src=URL.createObjectURL(U)}),ee=()=>{m&&m.getTracks().forEach(U=>U.stop()),_("close")},se=async()=>{$.value=null,await d()};return me(()=>e.show,async U=>{U?(await Fe(),await d()):m&&m.getTracks().forEach(C=>C.stop())}),De(()=>{m&&m.getTracks().forEach(U=>U.stop())}),(U,C)=>{var E;return a.show?(n(),o("div",Rs,[t("div",Ls,[t("div",js,[t("div",Bs,L(((E=a.point)==null?void 0:E.name)||"Camera"),1),t("div",Fs,[t("span",qs,L(a.cameraQuality),1)]),t("button",{onClick:ee,class:"p-2 rounded-full text-white hover:bg-gray-700 transition-colors"},C[0]||(C[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",{class:"webcam-video-container",style:Me(R.value),onTouchstart:ae,onClick:ae},[t("video",{ref_key:"webcamVideo",ref:l,autoplay:"",playsinline:"",class:"webcam-video"},null,512),t("canvas",{ref_key:"webcamCanvas",ref:I,class:"hidden"},null,512),V.value?(n(),o("div",{key:0,class:"focus-indicator",style:Me(Y.value)},C[1]||(C[1]=[t("div",{class:"focus-ring"},null,-1)]),4)):u("",!0),q.value&&!V.value?(n(),o("div",Os,C[2]||(C[2]=[t("div",{class:"auto-focus-ring"},null,-1)]))):u("",!0),$.value?(n(),o("div",Ks,[t("div",zs,[C[3]||(C[3]=t("div",{class:"error-icon"},"⚠️",-1)),C[4]||(C[4]=t("h3",{class:"error-title"},"Gagal Mengakses Kamera",-1)),t("p",Hs,L($.value),1),t("button",{onClick:se,class:"retry-button"}," Coba Lagi ")])])):u("",!0)],36),t("div",Gs,[t("div",Ws,[a.settings.enable_flash&&B.value?(n(),o("button",{key:0,onClick:x,class:pe(["control-button flash-button",{active:Z.value}])},C[5]||(C[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2)):u("",!0),t("button",{onClick:j,class:"capture-button",disabled:p.value||r.value},[t("div",Js,[p.value?(n(),o("div",Xs)):(n(),o("div",Ys))])],8,Zs),a.settings.enable_camera_switch&&S.value?(n(),o("button",{key:1,onClick:P,class:"control-button switch-button",disabled:r.value},C[6]||(C[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]),8,Qs)):u("",!0)])])])])):u("",!0)}}},tn=Ve(en,[["__scopeId","data-v-472cc13f"]]),an={key:0,class:"fixed inset-0 z-40 p-0 webcam-modal-container"},sn={class:"webcam-content-box"},nn={class:"webcam-header"},on={class:"rounded-full text-white hover:bg-gray-700 transition-colors"},ln={class:"inspection-point-name"},rn={key:0,class:"screen-flash-overlay"},un={key:2,class:"zoom-controls"},dn=["max"],cn={class:"webcam-footer"},pn={class:"camera-controls"},mn=["disabled"],gn={class:"camera-icon-container"},vn={key:0,class:"camera-spinner"},fn={key:1,class:"camera-body"},hn={__name:"WebcamModal",props:{show:Boolean,aspectRatio:Number,settings:Object,point:Object},emits:["close","photoCaptured"],setup(a,{emit:Q}){const e=a,_=Q,l=T(null),I=T(null);let m=null,A=null;const y=T("environment"),N=T(!1),M=T(!1),S=T(!1),B=T(!1),Z=T(!1),p=T({}),r=T(!1),$=T(1),D=T(1),V=T(!1),q=ne(()=>{var j;return((j=e.settings)==null?void 0:j.max_size)||2048}),Y=ne(()=>e.aspectRatio?{aspectRatio:`${e.aspectRatio} / 1`,maxWidth:"100%",maxHeight:"70vh",margin:"0 auto"}:{}),R=ne(()=>{if(!e.aspectRatio)return{};const j=e.aspectRatio,O=j>1?80:60,ee=j>1?80/j:60*j;return{width:`${O}%`,height:`${ee}%`}}),d=async()=>{m&&m.getTracks().forEach(j=>j.stop());try{const j={facingMode:y.value,width:{ideal:4096},height:{ideal:2160},aspectRatio:{ideal:e.aspectRatio||1.3333333333333333},frameRate:{ideal:30},advanced:[{focusMode:"continuous"},{exposureMode:"continuous"},{whiteBalanceMode:"continuous"}]};m=await navigator.mediaDevices.getUserMedia({video:j,audio:!1}),A=m.getVideoTracks()[0],l.value.srcObject=m,l.value.onloadedmetadata=async()=>{await J(),await l.value.play()}}catch(j){console.error("Error accessing camera: ",j),alert("Failed to access camera. Please allow camera permission."),_("close")}},G=()=>{m&&m.getTracks().forEach(j=>j.stop()),_("close")},J=async()=>{if(A)try{const j=await navigator.mediaDevices.enumerateDevices();N.value=j.filter(ee=>ee.kind==="videoinput").length>1;const O=A.getCapabilities();O.zoom?(V.value=!0,D.value=O.zoom.max,console.log(`Zoom supported. Max zoom: ${D.value}`)):(V.value=!1,console.warn("Zoom is not supported by this camera.")),M.value=O.torch||O.fillLightMode&&O.fillLightMode.includes("torch")}catch(j){console.error("Error checking camera capabilities:",j)}},w=async j=>{if(!A)return;const O=l.value.getBoundingClientRect(),ee=j.clientX-O.left,se=j.clientY-O.top;Z.value=!0,p.value={left:`${ee}px`,top:`${se}px`,transform:"translate(-50%, -50%)"};try{if(A.getCapabilities().pointsOfInterest){const C=ee/O.width,E=se/O.height;await A.applyConstraints({advanced:[{focusMode:"manual",pointsOfInterest:[{x:C,y:E}]}]})}else console.warn("Manual focus with point of interest is not supported.")}catch(U){console.warn("Manual focus failed:",U)}setTimeout(()=>{Z.value=!1,A.getCapabilities().focusMode.includes("continuous")&&A.applyConstraints({advanced:[{focusMode:"continuous"}]})},1e3)},g=async j=>{if(!A||!V.value)return;const O=Math.min(Math.max(j,1),D.value);$.value=O;try{await A.applyConstraints({advanced:[{zoom:O}]})}catch(ee){console.error("Failed to set zoom:",ee)}},s=async()=>{if(!(!A||!M.value))try{y.value==="user"?(S.value=!S.value,B.value=S.value):(await A.applyConstraints({advanced:[{torch:!S.value}]}),S.value=!S.value)}catch(j){console.error("Flash toggle failed:",j)}},x=async()=>{N.value&&(y.value=y.value==="environment"?"user":"environment",m&&m.getTracks().forEach(j=>j.stop()),await d())},P=async j=>new Promise(O=>{const ee=q.value*1024;if(j.size<=ee){O(j);return}const se=new Image,U=new FileReader;U.onload=C=>{se.onload=()=>{const E=document.createElement("canvas"),F=E.getContext("2d"),W=Math.sqrt(ee/j.size);E.width=se.width*W,E.height=se.height*W,F.drawImage(se,0,0,E.width,E.height);let X=.9;const le=()=>{E.toBlob(de=>{de.size>ee&&X>.1?(X-=.1,le()):O(de)},"image/jpeg",X)};le()},se.src=C.target.result},U.readAsDataURL(j)}),ae=async()=>{if(!(r.value||!l.value||!I.value)){r.value=!0;try{const j=l.value,O=I.value,ee=j.videoWidth,se=j.videoHeight;let U,C,E,F;ee/se>e.aspectRatio?(C=se,U=se*e.aspectRatio,E=(ee-U)/2,F=0):(U=ee,C=ee/e.aspectRatio,E=0,F=(se-C)/2),O.width=U,O.height=C,O.getContext("2d").drawImage(j,E,F,U,C,0,0,U,C);const X=await new Promise(de=>{O.toBlob(de,"image/jpeg",1)}),le=await P(X);if(le){const de=new File([le],`capture_${Date.now()}.jpeg`,{type:"image/jpeg",lastModified:Date.now()});_("photoCaptured",de),B.value=!0,setTimeout(()=>{B.value=!1},100)}}catch(j){console.error("Error capturing photo:",j),alert("Failed to capture photo. Please try again.")}finally{r.value=!1}}};return me(()=>e.show,j=>{j?d():G()}),De(()=>{m&&m.getTracks().forEach(j=>j.stop())}),(j,O)=>{var ee;return a.show?(n(),o("div",an,[t("div",sn,[t("div",nn,[t("p",on,L(a.settings.camera_aspect_ratio),1),t("div",ln,L(((ee=a.point)==null?void 0:ee.name)||"Camera"),1),t("button",{onClick:G,class:"p-2 rounded-full text-white hover:bg-gray-700 transition-colors"},O[2]||(O[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",{class:"webcam-video-container",style:Me(Y.value),onClick:w,onTouchstart:w},[t("video",{ref_key:"webcamVideo",ref:l,autoplay:"",playsinline:"",class:"webcam-video"},null,512),t("canvas",{ref_key:"webcamCanvas",ref:I,class:"hidden"},null,512),B.value?(n(),o("div",rn)):u("",!0),t("div",{class:"aspect-ratio-guide",style:Me(R.value)},null,4),Z.value?(n(),o("div",{key:1,class:"focus-indicator",style:Me(p.value)},O[3]||(O[3]=[t("div",{class:"focus-ring"},null,-1)]),4)):u("",!0),O[4]||(O[4]=t("div",{class:"hd-badge"},[t("span",{class:"hd-text"},"HD")],-1)),V.value?(n(),o("div",un,[Te(t("input",{type:"range",min:"1",max:D.value,step:"0.1","onUpdate:modelValue":O[0]||(O[0]=se=>$.value=se),onInput:O[1]||(O[1]=se=>g(parseFloat(se.target.value))),class:"zoom-slider"},null,40,dn),[[Ee,$.value]])])):u("",!0)],36),t("div",cn,[t("div",pn,[a.settings.enable_flash&&M.value?(n(),o("button",{key:0,onClick:s,class:pe(["control-button",{active:S.value,disabled:!M.value}])},O[5]||(O[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)]),2)):u("",!0),t("button",{onClick:ae,class:"capture-button",disabled:r.value},[t("div",gn,[r.value?(n(),o("div",vn)):(n(),o("div",fn,O[6]||(O[6]=[t("div",{class:"camera-lens"},null,-1),t("div",{class:"camera-flash"},null,-1)])))])],8,mn),a.settings.enable_camera_switch&&N.value?(n(),o("button",{key:1,onClick:x,class:"control-button"},O[7]||(O[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)]))):u("",!0)])])])])):u("",!0)}}},bn=Ve(hn,[["__scopeId","data-v-d307c818"]]),yn=["accept","multiple","disabled"],xn={class:"text-xs text-gray-500 mb-2"},wn=["disabled"],kn={class:"h-full flex flex-col items-center justify-center p-4 text-center"},In={class:"text-xs text-gray-400 mt-1"},_n={key:0,class:"flex items-center gap-4"},$n=["src"],Sn={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},Cn=["disabled"],An={key:1,class:"flex space-x-2 overflow-x-auto pb-2 scrollbar-hide"},Vn=["disabled"],Tn=["onClick"],Nn=["src","onError"],Mn={key:0,class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center text-white text-xs font-bold"},Un={key:0},En={key:1,class:"ml-1"},Pn={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},Dn={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},Rn={key:2,class:"mt-1 text-xs text-red-600"},Ln={__name:"InputImage",props:{modelValue:{type:Array,default:()=>[]},error:String,inspectionId:{type:[String,Number],required:!0},pointId:{type:[String,Number],required:!0},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object},emits:["update:modelValue","save","removeImage","uploaded","uploadProgress"],setup(a,{emit:Q}){const e=a,_=Q,l=T(null),I=T(null),m=T(!1),A=T(!1),y=T(!1),N=T([]),M=T(0),S=T(!1),B=T(!1),Z=T(0),p=T(0),r=T(0),$=qe("imageSourceSetting",T("all")),D=qe("cameraQualitySetting",T("HD_Std")),V=`inspection-${e.inspectionId}-point-${e.pointId}-backup`,q=ne(()=>Number(e.settings.max_files)>1),Y=ne(()=>e.settings.allowed_types.map(i=>`.${i}`).join(", ")),R=ne(()=>{const i=e.settings.camera_aspect_ratio.split(":");if(i.length===2){const c=parseFloat(i[0]),v=parseFloat(i[1]);if(!isNaN(c)&&!isNaN(v)&&v!==0)return c/v}return 3/4}),d=ne(()=>{console.log("🔄 allImages computed called");const i=[],c=new Set;for(const v of e.modelValue){if(!v||typeof v!="object"||v.id&&c.has(v.id))continue;v.id&&c.add(v.id),console.log("📥 Database image:",v),console.log("📥 Type of preview:",typeof v.preview),console.log("📥 Type of public_url:",typeof v.public_url);const f=G(v);i.push({...f,rotation:f.rotation||0,isNew:!1,isUploaded:!0,isUploading:!1,isFailed:!1})}for(const v of N.value)v.id&&c.add(v.id),i.push({...v,isUploading:v.isUploading||!1,isFailed:v.isFailed||!1});return console.log("✅ Final allImages:",i),i}),G=i=>{if(!i||typeof i!="object")return{};const c={...i};return["preview","public_url","original_url","optimized_url"].forEach(f=>{c[f]&&(c[f]=J(c[f]))}),c.image_path&&(c.image_path=c.image_path.replace(/^storage\//,"")),c},J=i=>{if(!i||typeof i!="string")return i;let c=i.replace(/\/storage\/storage\//g,"/storage/");return c=c.replace(/\/\/storage\/storage\//g,"/storage/"),c.startsWith("storage/")&&(c=`/${c}`),!c.startsWith("/")&&!c.startsWith("http")&&(c=`/storage/${c}`),c},w=i=>{if(!i||typeof i!="object")return console.warn("❌ safeImageSrc: image is not object",i),"";const c=g(i);return typeof c!="string"?(console.error("🚨 CRITICAL: getImageSrc returned non-string:",typeof c,c),""):(c&&console.log("✅ safeImageSrc result:",c),c)},g=i=>{if(!i||typeof i!="object")return"";if(console.log("🔍 getImageSrc called with:",i),console.log("🔍 Available fields:",Object.keys(i)),i.preview&&typeof i.preview=="string"){const c=J(i.preview);return console.log("✅ Using preview URL:",c),c}if(i.public_url&&typeof i.public_url=="string"){const c=J(i.public_url);return console.log("✅ Using public_url:",c),c}if(i.original_url&&typeof i.original_url=="string"){const c=J(i.original_url);return console.log("✅ Using original_url:",c),c}if(i.optimized_url&&typeof i.optimized_url=="string"){const c=J(i.optimized_url);return console.log("✅ Using optimized_url:",c),c}if(i.image_path&&typeof i.image_path=="string"){const v=`/storage/${i.image_path.replace(/^\/?storage\//,"")}`;return console.log("✅ Generated from image_path:",v),v}if(i.path&&typeof i.path=="string"){const v=`/storage/${i.path.replace(/^\/?storage\//,"")}`;return console.log("✅ Generated from path:",v),v}return console.warn("⚠️ No valid image source found for:",i),""},s=i=>{console.error("❌ Image load error for:",i),console.error("❌ Attempted URL:",w(i)),B.value=!0;const c=x(i);if(c&&c!==w(i)){console.log("🔄 Trying fallback URL:",c);const v=event==null?void 0:event.target;v&&(v.src=c)}},x=i=>{if(!i||typeof i!="object")return"";const c=["original_url","optimized_url","public_url","preview"];for(const v of c)if(i[v]&&typeof i[v]=="string")return J(i[v]);return""},P=()=>{y.value&&(y.value=!1),$.value==="camera"?j():$.value==="gallery"?ae():m.value=!0},ae=()=>{m.value=!1,l.value.click()},j=()=>{m.value=!1,A.value=!0},O=()=>{m.value=!1,d.value.length>0&&(y.value=!0)},ee=()=>{A.value=!1,d.value.length>0&&(y.value=!0)},se=()=>{y.value=!1,S.value||(N.value.forEach(i=>{i.preview&&i.preview.startsWith("blob:")&&URL.revokeObjectURL(i.preview)}),N.value=[])};me(()=>e.modelValue,i=>{var c;console.log("🔄 modelValue updated:",i),i&&i.length>0&&(console.log("📊 First image structure:",JSON.stringify(i[0],null,2)),console.log("🔍 Type of preview:",typeof((c=i[0])==null?void 0:c.preview)))},{deep:!0});const U=i=>new Promise(c=>{const v=new FileReader;v.onload=f=>{const K=new Image;K.onload=()=>{c({file:i,preview:URL.createObjectURL(i),rotation:0,width:K.naturalWidth,height:K.naturalHeight,isNew:!0})},K.onerror=()=>{console.error("Failed to load image for dimensions:",i.name),c({file:i,preview:URL.createObjectURL(i),rotation:0,width:0,height:0,isNew:!0})},K.src=f.target.result},v.readAsDataURL(i)}),C=i=>{const c=i.name.split(".").pop().toLowerCase();return e.settings.allowed_types.includes(c)},E=async i=>{const v=(e.settings.max_size||2048)*1024;return new Promise(f=>{const K=new Image,ie=new FileReader;ie.onload=re=>{K.onload=()=>{const ue=document.createElement("canvas"),te=ue.getContext("2d"),b=Math.max(K.width,K.height);ue.width=b,ue.height=b,te.fillStyle="white",te.fillRect(0,0,b,b);const h=(b-K.width)/2,oe=(b-K.height)/2;te.drawImage(K,h,oe,K.width,K.height);let z=.9;const ce=()=>{ue.toBlob(ge=>{if(ge.size>v&&z>.1)z-=.1,ce();else{const fe=new File([ge],i.name,{type:"image/jpeg",lastModified:Date.now()});f(fe)}},"image/jpeg",z)};ce()},K.src=re.target.result},ie.readAsDataURL(i)})},F=async i=>{const c=Array.from(i.target.files);if(!c.length){m.value=!1,d.value.length>0&&(y.value=!0);return}try{const v=c.filter(te=>!C(te));if(v.length>0){const te=v.map(b=>b.name.split(".").pop()).join(", ");alert(`File type not allowed: ${te}. Allowed types: ${e.settings.allowed_types.join(", ")}`),i.target.value="";return}const f=d.value.length,K=e.settings.max_files-f,ie=await Promise.all(c.slice(0,K).map(async te=>await E(te))),re=await Promise.all(ie.map(U)),ue=q.value?re:re.slice(0,1);q.value?N.value.push(...ue):(N.value.forEach(te=>{te.preview&&te.preview.startsWith("blob:")&&URL.revokeObjectURL(te.preview)}),N.value=ue),m.value=!1,ue.length>0?(M.value=Math.max(0,d.value.length-ue.length),y.value=!0):d.value.length>0&&(y.value=!0),i.target.value=""}catch(v){console.error("Error processing selected images:",v),alert("Failed to process selected images. Please try again."),m.value=!1,d.value.length>0&&(y.value=!0)}},W=async i=>{const c=d.value.length;if(!q.value||c<e.settings.max_files)try{const v=await E(i),f=new Image;f.onload=()=>{const K={file:v,preview:URL.createObjectURL(v),rotation:0,width:f.naturalWidth,height:f.naturalHeight,isNew:!0};q.value?N.value.push(K):(N.value.forEach(ie=>{ie.preview&&ie.preview.startsWith("blob:")&&URL.revokeObjectURL(ie.preview)}),N.value=[K]),A.value=!1,m.value=!1,M.value=d.value.length-1,y.value=!0},f.src=URL.createObjectURL(v)}catch(v){console.error("Error processing captured image:",v),alert("Failed to process captured image. Please try again.")}else alert(`Maximum ${e.settings.max_files} files allowed.`),A.value=!1,m.value=!1,d.value.length>0&&(y.value=!0)},X=(i=0)=>{M.value=i,y.value=!0},le=i=>new Promise(c=>{if(i.rotation===0||!I.value){if(!i.isNew&&!i.file){c({file:null,width:i.width,height:i.height,isOriginal:!0});return}c({file:i.file,width:i.width,height:i.height});return}const v=new Image;v.onload=async()=>{try{const f=I.value,K=f.getContext("2d"),ie=v.width,re=v.height;let ue,te;i.rotation===90||i.rotation===270?(ue=re,te=ie):(ue=ie,te=re),f.width=ue,f.height=te,K.clearRect(0,0,f.width,f.height),K.translate(f.width/2,f.height/2),K.rotate(i.rotation*Math.PI/180),K.drawImage(v,-ie/2,-re/2,ie,re),K.setTransform(1,0,0,1,0,0);const b=await new Promise(z=>{f.toBlob(z,"image/jpeg",.9)}),h=new File([b],i.file?i.file.name:`rotated_image_${Date.now()}.jpg`,{type:"image/jpeg"}),oe=await E(h);c({file:oe,width:ue,height:te})}catch(f){console.error("Error processing rotated image:",f),c({file:i.file,width:i.width,height:i.height})}},v.onerror=()=>{console.error("Failed to load image for rotation processing:",i.preview),c({file:i.file,width:i.width,height:i.height})},v.src=i.preview}),de=i=>{try{const c={images:i.map(v=>{var f;return{fileName:((f=v.file)==null?void 0:f.name)||`image-${Date.now()}.jpg`,rotation:v.rotation||0,width:v.width||0,height:v.height||0,timestamp:Date.now()}}),inspectionId:e.inspectionId,pointId:e.pointId};localStorage.setItem(V,JSON.stringify(c))}catch(c){console.error("Error saving backup:",c)}},xe=()=>{localStorage.removeItem(V)},be=async i=>{S.value=!0;const c=[],v=[];if(!e.pointId){alert("Error: Point ID is missing. Cannot upload image."),S.value=!1;return}try{de(i);for(const f of i){if(!f.isNew&&f.rotation===0&&f.id&&f.image_path){c.push({id:f.id,image_path:f.image_path,width:f.width,height:f.height,rotation:0,preview:f.preview,isUploaded:!0});continue}const{file:K,width:ie,height:re,isOriginal:ue}=await le(f);if(ue&&!f.isNew){c.push({id:f.id,image_path:f.image_path,width:f.width,height:f.height,rotation:f.rotation||0,preview:f.preview,isUploaded:!0});continue}K&&v.push({file:K,width:ie,height:re,rotation:f.rotation||0,originalImage:f})}se(),v.length>0?await Ce(v,c):(_("update:modelValue",c),_("save",e.pointId))}catch(f){console.error("Error during image processing:",f),alert("Terjadi error saat memproses gambar. Data tersimpan secara lokal.")}finally{S.value=!1}},Ce=async(i,c)=>{r.value=i.length,p.value=0,Z.value=0;const v=[...c];let f=0;try{for(let K=0;K<i.length;K++){const ie=i[K],re=new FormData;re.append("inspection_id",e.inspectionId),re.append("point_id",e.pointId),re.append("images[]",ie.file);const ue=N.value.findIndex(te=>{var b;return te.preview===((b=ie.originalImage)==null?void 0:b.preview)});ue!==-1&&(N.value[ue].isUploading=!0,N.value[ue].isFailed=!1);try{const b=(await je.post(route("inspections.upload-image"),re,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:h=>{if(h.total){const oe=Math.round(h.loaded*100/h.total);Z.value=Math.round((K+h.loaded/h.total)/i.length*100),p.value=K+1}}})).data.images;if(b&&b.length>0){const h=b[0];if(v.push({id:h.image_id,image_path:h.path,width:h.width||ie.width||0,height:h.height||ie.height||0,rotation:ie.rotation||0,preview:h.public_url,isUploaded:!0}),ue!==-1){const oe=N.value.splice(ue,1)[0];oe.preview&&oe.preview.startsWith("blob:")&&URL.revokeObjectURL(oe.preview)}f++}}catch(te){console.error(`Error uploading image ${K+1}:`,te),ue!==-1&&(N.value[ue].isUploading=!1,N.value[ue].isFailed=!0)}}f>0&&(_("update:modelValue",v),_("save",e.pointId),_("uploaded",{pointId:e.pointId,images:v,newImagesCount:f})),f===i.length&&xe(),console.log(`✅ Successfully uploaded ${f}/${i.length} images`)}catch(K){console.error("Error in upload process:",K),i.forEach(ie=>{const re=N.value.findIndex(ue=>{var te;return ue.preview===((te=ie.originalImage)==null?void 0:te.preview)});re!==-1&&(N.value[re].isUploading=!1,N.value[re].isFailed=!0)})}finally{Z.value=0,p.value=0,r.value=0,S.value=!1}},ye=async i=>{if(!i||!i.file){console.error("No file to retry upload");return}S.value=!0;const c=[...e.modelValue];try{const v=new FormData;v.append("inspection_id",e.inspectionId),v.append("point_id",e.pointId),v.append("images[]",i.file);const f=N.value.findIndex(re=>re.preview===i.preview);f!==-1&&(N.value[f].isUploading=!0,N.value[f].isFailed=!1);const ie=(await je.post(route("inspections.upload-image"),v,{headers:{"Content-Type":"multipart/form-data"}})).data.images;if(ie&&ie.length>0){const re=ie[0];if(c.push({id:re.image_id,image_path:re.path,width:re.width||i.width||0,height:re.height||i.height||0,rotation:i.rotation||0,preview:re.public_url,isUploaded:!0}),f!==-1){const te=N.value.splice(f,1)[0];te.preview&&te.preview.startsWith("blob:")&&URL.revokeObjectURL(te.preview)}_("update:modelValue",c),_("save",e.pointId),_("uploaded",{pointId:e.pointId,images:c,newImagesCount:1}),N.value.some(te=>te.isFailed)||xe(),console.log("✅ Successfully retried upload for 1 image")}}catch(v){console.error("Error retrying upload:",v),previewIndex!==-1&&(N.value[previewIndex].isUploading=!1,N.value[previewIndex].isFailed=!0)}finally{S.value=!1}},we=i=>{if(i){if(i.id&&!i.isNew)ve(i);else{const c=N.value.findIndex(v=>v.preview&&v.preview===i.preview&&v.isNew||v.id&&v.id===i.id);if(c!==-1){const v=N.value.splice(c,1)[0];v.preview&&v.preview.startsWith("blob:")&&URL.revokeObjectURL(v.preview)}_("update:modelValue",e.modelValue.filter(v=>!(v.id&&v.id===i.id)&&!(v.preview&&v.preview===i.preview)))}M.value>=d.value.length&&(M.value=Math.max(0,d.value.length-1)),d.value.length===0&&se()}},ve=async i=>{var v,f;if(i.id||i.image_path)try{await je.delete(route("inspections.delete-image"),{data:{image_id:i.id,image_path:i.image_path}})}catch(K){console.error("Error deleting image from server:",K),(f=(v=K.response)==null?void 0:v.data)!=null&&f.message?alert(`Failed to delete image from server: ${K.response.data.message}`):alert(`Failed to delete image from server: ${K.message}`);return}i.preview&&i.preview.startsWith("blob:")&&URL.revokeObjectURL(i.preview);const c=e.modelValue.filter(K=>K.id!==i.id);_("update:modelValue",c),N.value=N.value.filter(K=>K.isNew&&i.isNew?K.preview!==i.preview:K.id!==i.id),_("removeImage",{image:i}),y.value&&d.value.length===0?se():y.value&&M.value>=d.value.length&&(M.value=Math.max(0,d.value.length-1))};return Pe(()=>{try{localStorage.getItem(V)&&console.log("Found backup images, ready for recovery if needed")}catch(i){console.error("Error loading backup:",i)}}),(i,c)=>(n(),o("div",null,[t("input",{ref_key:"galleryInput",ref:l,type:"file",accept:Y.value,class:"hidden",onChange:F,multiple:q.value,disabled:S.value},null,40,yn),t("canvas",{ref_key:"processingCanvas",ref:I,class:"hidden"},null,512),t("p",xn,"Foto Maksimal: "+L(a.settings.max_files)+" | Rasio: "+L(a.settings.camera_aspect_ratio),1),d.value.length===0?(n(),o("label",{key:0,onClick:P,class:pe(["block w-full border-2 border-dashed rounded-lg cursor-pointer transition-colors duration-200 h-28",{"border-gray-300 hover:border-indigo-400 bg-gray-50":!0}]),disabled:S.value},[t("div",kn,[c[3]||(c[3]=t("svg",{class:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),c[4]||(c[4]=t("p",{class:"text-sm text-gray-600 font-medium"},"Upload Image",-1)),t("p",In,"Tipe: "+L(Y.value),1)])],8,wn)):(n(),o("div",{key:1,class:pe(["block w-full rounded-lg transition-colors duration-200 p-2",{"border-2 border-dashed border-indigo-200 bg-indigo-50 h-auto p-2":a.settings.max_files==1,"bg-transparent":a.settings.max_files>1}]),"aria-label":"Image gallery"},[a.settings.max_files===1?(n(),o("div",_n,[t("div",{class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:c[1]||(c[1]=v=>X(0))},[t("img",{src:w(d.value[0]),onError:c[0]||(c[0]=v=>s(d.value[0])),class:"w-full h-full object-cover"},null,40,$n),d.value[0].isUploading?(n(),o("div",Sn,c[5]||(c[5]=[t("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):u("",!0)]),t("button",{onClick:c[2]||(c[2]=Re(v=>ve(d.value[0]),["stop"])),type:"button",class:"flex items-center gap-1 text-red-600 font-medium hover:text-red-800 transition-colors",disabled:S.value},c[6]||(c[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Ie(" Hapus Foto ")]),8,Cn)])):(n(),o("div",An,[q.value&&d.value.length<a.settings.max_files?(n(),o("div",{key:0,class:"flex-shrink-0 flex flex-col items-center justify-center p-2 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 transition-colors w-24 h-24",onClick:P,disabled:S.value},c[7]||(c[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),t("p",{class:"mt-1 text-xs text-gray-600"},"Tambah",-1)]),8,Vn)):u("",!0),(n(!0),o(_e,null,Se(d.value,(v,f)=>(n(),o("div",{key:v.id||v.preview||f,class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:K=>v.isFailed?ye(v):X(f)},[t("img",{src:w(v),onError:K=>s(v),class:"w-full h-full object-cover"},null,40,Nn),v.isNew||v.rotation!==0?(n(),o("div",Mn,[v.isNew?(n(),o("span",Un,"BARU")):u("",!0),v.rotation!==0?(n(),o("span",En,"ROTASI")):u("",!0)])):u("",!0),v.isUploading?(n(),o("div",Pn,c[8]||(c[8]=[t("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):u("",!0),v.isFailed?(n(),o("div",Dn,c[9]||(c[9]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),t("span",{class:"text-xs font-medium"},"Retry",-1)]))):u("",!0)],8,Tn))),128))]))],2)),a.error?(n(),o("p",Rn,L(a.error),1)):u("",!0),$e(os,{show:m.value,settings:a.settings,onClose:O,onOpenWebcam:j,onTriggerGallery:ae},null,8,["show","settings"]),Ae(D)!=="HD_Std"?(n(),ke(tn,{key:3,show:A.value,"aspect-ratio":R.value,settings:a.settings,point:a.point,"camera-quality":Ae(D),onClose:ee,onPhotoCaptured:W},null,8,["show","aspect-ratio","settings","point","camera-quality"])):u("",!0),Ae(D)==="HD_Std"?(n(),ke(bn,{key:4,show:A.value,"aspect-ratio":R.value,settings:a.settings,point:a.point,"camera-quality":Ae(D),onClose:ee,onPhotoCaptured:W},null,8,["show","aspect-ratio","settings","point","camera-quality"])):u("",!0),$e(Ds,{show:y.value,images:d.value,point:a.point,"initial-index":M.value,"allow-multiple":q.value,"max-files":a.settings.max_files,"is-uploading":S.value,"aspect-ratio":R.value,"upload-progress":Z.value,"current-upload":p.value,"total-upload":r.value,onClose:se,onSaveImages:be,onRemovePreviewImage:we,onTriggerAddMorePhotos:P,onRetryImage:ye},null,8,["show","images","point","initial-index","allow-multiple","max-files","is-uploading","aspect-ratio","upload-progress","current-upload","total-upload"])]))}},Oe=Ve(Ln,[["__scopeId","data-v-51470c95"]]),jn={key:0,class:"fixed inset-0 z-50 overflow-hidden"},Bn={class:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[85vh] overflow-hidden flex flex-col"},Fn={class:"px-4 pb-2 border-b border-gray-200"},qn={class:"text-lg font-semibold text-gray-900"},On={key:0,class:"text-sm text-gray-500 mt-1"},Kn={class:"flex-1 overflow-y-auto p-4"},zn={key:0,class:"border-t border-gray-200 p-4 bg-gray-50"},Hn={__name:"BottomSheetModal",props:{show:Boolean,title:String,subtitle:String},setup(a){return(Q,e)=>(n(),ke(Le,{name:"bottom-sheet"},{default:Ne(()=>[a.show?(n(),o("div",jn,[e[1]||(e[1]=t("div",{class:"absolute inset-0 bg-black bg-opacity-50"},null,-1)),t("div",Bn,[e[0]||(e[0]=t("div",{class:"flex justify-center py-3"},[t("div",{class:"w-12 h-1.5 bg-gray-300 rounded-full"})],-1)),t("div",Fn,[t("h3",qn,L(a.title),1),a.subtitle?(n(),o("p",On,L(a.subtitle),1)):u("",!0)]),t("div",Kn,[wt(Q.$slots,"default",{},void 0,!0)]),Q.$slots.footer?(n(),o("div",zn,[wt(Q.$slots,"footer",{},void 0,!0)])):u("",!0)])])):u("",!0)]),_:3}))}},Gn=Ve(Hn,[["__scopeId","data-v-fd942535"]]),Wn={class:"space-y-4"},Zn={key:0,class:"mt-2"},Jn={key:1,class:"mt-2"},Xn={key:2,class:"mt-2"},Yn={key:3,class:"mt-2"},Qn={key:4,class:"mt-2"},eo={class:"text-sm font-medium text-gray-700 mb-2"},to={key:0,class:"text-red-500"},ao={key:0,class:"text-xs text-red-500"},so=["type","name","value","checked","onChange"],no={key:6,class:"mt-4"},oo={class:"text-sm font-medium text-gray-700 mb-2"},io={key:0,class:"text-red-500"},lo={key:0,class:"text-xs text-red-500"},ro={key:7,class:"space-y-2"},uo={key:0,class:"text-red-500"},co={key:1,class:"text-xs text-red-500"},po={class:"flex gap-2"},mo=["disabled"],Vt={__name:"RadioOptionModal",props:{show:Boolean,title:String,subtitle:String,name:String,options:{type:Array,default:()=>[]},selectedValue:[String,Array],notesValue:String,imagesValue:{type:Array,default:()=>[]},pointId:[String,Number],inspectionId:[String,Number],showTextarea:{type:Boolean,default:!0},showImageUpload:{type:Boolean,default:!0},selectedPoint:Object,point:Object},emits:["update:selectedValue","update:notesValue","update:imagesValue","close","save","hapus","saveTextarea","saveImage","saveText","saveNumber","saveAccount","saveDate"],setup(a,{emit:Q}){const e=a,_=Q,l=p=>_("hapus",p),I=ne(()=>Array.isArray(e.selectedValue)?e.options.find(p=>e.selectedValue.includes(p.value)):e.options.find(p=>p.value===e.selectedValue)),m=ne(()=>{if(Array.isArray(e.selectedValue))return e.options.filter(p=>e.selectedValue.includes(p.value));if(e.selectedValue){const p=typeof e.selectedValue=="string"?e.selectedValue.split(",").map(r=>r.trim()):[e.selectedValue];return e.options.filter(r=>p.includes(r.value))}return[]}),A=ne(()=>{var p;if(Array.isArray(e.selectedValue))return m.value.some(r=>{var $;return r.multi&&(($=r.settings)==null?void 0:$.show_textarea)});{const r=e.options.find($=>$.value===e.selectedValue);return(p=r==null?void 0:r.settings)==null?void 0:p.show_textarea}}),y=ne(()=>{var p;if(Array.isArray(e.selectedValue))return m.value.some(r=>{var $;return r.multi&&(($=r.settings)==null?void 0:$.show_image_upload)});{const r=e.options.find($=>$.value===e.selectedValue);return(p=r==null?void 0:r.settings)==null?void 0:p.show_image_upload}}),N=ne(()=>{var p;if(Array.isArray(e.selectedValue)){const r=m.value.filter(q=>{var Y;return q.multi&&((Y=q.settings)==null?void 0:Y.show_textarea)});if(r.length===0)return null;const $={...r[0].settings},D=[];r.forEach(q=>{var Y;(Y=q.settings)!=null&&Y.damage_options&&D.push(...q.settings.damage_options)});const V=D.filter((q,Y,R)=>Y===R.findIndex(d=>d.value===q.value));return $.damage_options=V,{...r[0],settings:$}}else{const r=e.options.find($=>$.value===e.selectedValue);return(p=r==null?void 0:r.settings)!=null&&p.show_textarea?r:null}}),M=ne(()=>{var p;if(Array.isArray(e.selectedValue))return m.value.find(r=>{var $;return r.multi&&(($=r.settings)==null?void 0:$.show_image_upload)});{const r=e.options.find($=>$.value===e.selectedValue);return(p=r==null?void 0:r.settings)!=null&&p.show_image_upload?r:null}});ne(()=>m.value.find(p=>{var r;return p.multi&&((r=p.settings)==null?void 0:r.show_textarea)})),ne(()=>m.value.find(p=>{var r;return p.multi&&((r=p.settings)==null?void 0:r.show_image_upload)}));const S=p=>Array.isArray(e.selectedValue)?e.selectedValue.includes(p.value):e.selectedValue?(typeof e.selectedValue=="string"?e.selectedValue.split(",").map($=>$.trim()):[e.selectedValue]).includes(p.value):!1,B=(p,r)=>{let $;if(p.multi){const D=Array.isArray(e.selectedValue)?e.selectedValue:[];r.target.checked?$=[...D,p.value]:$=D.filter(V=>V!==p.value)}else $=p.value;_("update:selectedValue",$)},Z=ne(()=>{var r,$,D,V,q,Y,R;if(e.point.input_type==="text"&&(!((r=e.notesValue)!=null&&r.trim())||e.point.settings.min_length&&e.notesValue.length<e.point.settings.min_length||e.point.settings.max_length&&e.notesValue.length>e.point.settings.max_length)||e.point.input_type==="number"&&(!(($=e.notesValue)!=null&&$.trim())||e.point.settings.min&&e.notesValue.length<e.point.settings.min||e.point.settings.max&&e.notesValue.length>e.point.settings.max)||e.point.input_type==="account"&&(!((D=e.notesValue)!=null&&D.trim())||e.point.settings.min_value&&e.notesValue.length<e.point.settings.min_value||e.point.settings.max_value&&e.notesValue.length>e.point.settings.max_value)||e.point.input_type==="date"&&(!((V=e.notesValue)!=null&&V.trim())||e.point.settings.min_date&&e.notesValue.length<e.point.settings.min_date||e.point.settings.max_date&&e.notesValue.length>e.point.settings.max_date))return!1;if(e.point.input_type==="imageTOradio"){if(e.imagesValue.length===0)return!1;const d=e.imagesValue.some(J=>J.status==="error"),G=e.imagesValue.some(J=>J.status==="uploading");if(d||G)return!1}if(e.options.length&&(!e.selectedValue||Array.isArray(e.selectedValue)&&e.selectedValue.length===0))return!1;const p=I.value;if(e.showTextarea&&((q=p==null?void 0:p.settings)!=null&&q.show_textarea)&&(!((Y=e.notesValue)!=null&&Y.trim())||p.settings.min_length&&e.notesValue.length<p.settings.min_length||p.settings.max_length&&e.notesValue.length>p.settings.max_length))return!1;if(e.showImageUpload&&((R=p==null?void 0:p.settings)!=null&&R.show_image_upload)){if(e.imagesValue.length===0||p.settings.max_files&&e.imagesValue.length>p.settings.max_files)return!1;const d=e.imagesValue.some(J=>J.status==="error"),G=e.imagesValue.some(J=>J.status==="uploading");if(d||G)return!1}return!0});return(p,r)=>(n(),ke(Gn,{show:a.show,title:a.title,subtitle:a.subtitle,onClose:r[17]||(r[17]=$=>p.$emit("close"))},{footer:Ne(()=>[a.selectedPoint?(n(),o("button",{key:0,onClick:r[14]||(r[14]=$=>l(a.pointId)),class:"flex items-center justify-center text-red-600 hover:text-red-800 mb-3"},r[19]||(r[19]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7h6m2-3H7m5 0v3"})],-1),Ie(" Hapus Data ")]))):u("",!0),t("div",po,[t("button",{type:"button",onClick:r[15]||(r[15]=$=>p.$emit("close")),class:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),t("button",{type:"button",onClick:r[16]||(r[16]=$=>p.$emit("save")),disabled:!Z.value,class:"flex-1 px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-white hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Simpan ",8,mo)])]),default:Ne(()=>{var $,D,V,q,Y,R,d,G,J,w,g,s,x,P,ae,j,O,ee,se,U,C,E,F,W,X,le,de,xe,be,Ce,ye,we,ve,i,c,v;return[t("div",Wn,[a.point.input_type==="text"?(n(),o("div",Zn,[$e(_t,{"model-value":a.notesValue,required:($=a.point.settings)==null?void 0:$.is_required,"min-length":(D=a.point.settings)==null?void 0:D.min_length,"max-length":(V=a.point.settings)==null?void 0:V.max_length,allowSpace:(q=a.point.settings)==null?void 0:q.allow_space,textTransform:(Y=a.point.settings)==null?void 0:Y.text_transform,placeholder:((R=a.point.settings)==null?void 0:R.placeholder)||"Masukan text",error:p.error,"onUpdate:modelValue":r[0]||(r[0]=f=>p.$emit("update:notesValue",f)),onSave:r[1]||(r[1]=f=>p.$emit("saveText",f))},null,8,["model-value","required","min-length","max-length","allowSpace","textTransform","placeholder","error"])])):u("",!0),a.point.input_type==="number"?(n(),o("div",Jn,[$e($t,{"model-value":a.notesValue,required:(d=a.point.settings)==null?void 0:d.is_required,min:(G=a.point.settings)==null?void 0:G.min,max:(J=a.point.settings)==null?void 0:J.max,step:((w=a.point.settings)==null?void 0:w.step)||1,placeholder:((g=a.point.settings)==null?void 0:g.placeholder)||"Masukan number",error:p.error,"onUpdate:modelValue":r[2]||(r[2]=f=>p.$emit("update:notesValue",f)),onSave:r[3]||(r[3]=f=>p.$emit("saveNumber",f))},null,8,["model-value","required","min","max","step","placeholder","error"])])):u("",!0),a.point.input_type==="account"?(n(),o("div",Xn,[$e(Ct,{"model-value":a.notesValue,required:(s=a.point.settings)==null?void 0:s.is_required,placeholder:((x=a.point.settings)==null?void 0:x.placeholder)||"Masukkan nilai",error:p.error,"point-id":a.pointId,settings:a.point.settings,"onUpdate:modelValue":r[4]||(r[4]=f=>p.$emit("update:notesValue",f)),onSave:r[5]||(r[5]=f=>p.$emit("saveAccount",f))},null,8,["model-value","required","placeholder","error","point-id","settings"])])):u("",!0),a.point.input_type==="date"?(n(),o("div",Yn,[$e(St,{"model-value":a.notesValue,required:(P=a.point.settings)==null?void 0:P.is_required,"min-date":(ae=a.point.settings)==null?void 0:ae.min_date,"max-date":(j=a.point.settings)==null?void 0:j.max_date,error:p.error,"onUpdate:modelValue":r[6]||(r[6]=f=>p.$emit("update:notesValue",f)),onSave:r[7]||(r[7]=f=>p.$emit("saveDate",f))},null,8,["model-value","required","min-date","max-date","error"])])):u("",!0),a.point.input_type==="imageTOradio"?(n(),o("div",Qn,[t("h4",eo,[(O=a.point.settings)!=null&&O.required?(n(),o("span",to,"*")):u("",!0)]),$e(Oe,{"model-value":a.imagesValue,"point-id":a.pointId,point:a.point.inspection_point,"inspection-id":a.inspectionId,settings:a.point.settings,"onUpdate:modelValue":r[8]||(r[8]=f=>p.$emit("update:imagesValue",f)),onSave:r[9]||(r[9]=f=>p.$emit("saveImage",f))},null,8,["model-value","point-id","point","inspection-id","settings"]),(ee=a.point.settings)!=null&&ee.required&&a.imagesValue.length===0?(n(),o("p",ao," Foto wajib diupload ")):u("",!0)])):u("",!0),a.options.length?(n(),o("div",{key:5,class:pe(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(n(!0),o(_e,null,Se(a.options,(f,K)=>(n(),o("label",{key:K,class:"cursor-pointer"},[t("input",{type:f.multi?"checkbox":"radio",name:f.multi?`checkbox-${a.name}`:a.name,value:f.value,checked:S(f),onChange:ie=>B(f,ie),class:"hidden peer"},null,40,so),t("div",{class:pe(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":S(f),"border-gray-300 text-gray-700 hover:bg-gray-50":!S(f)}])},L(f.label),3)]))),128))],2)):u("",!0),y.value?(n(),o("div",no,[t("h4",oo,[r[18]||(r[18]=Ie(" Upload Foto ")),(U=(se=M.value)==null?void 0:se.settings)!=null&&U.required?(n(),o("span",io,"*")):u("",!0)]),$e(Oe,{"model-value":a.imagesValue,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,settings:(C=M.value)==null?void 0:C.settings,"onUpdate:modelValue":r[10]||(r[10]=f=>p.$emit("update:imagesValue",f)),onSave:r[11]||(r[11]=f=>p.$emit("saveImage",f))},null,8,["model-value","point-id","point","inspection-id","settings"]),(F=(E=M.value)==null?void 0:E.settings)!=null&&F.required&&a.imagesValue.length===0?(n(),o("p",lo," Foto wajib diupload ")):u("",!0)])):u("",!0),A.value?(n(),o("div",ro,[(X=(W=N.value)==null?void 0:W.settings)!=null&&X.required?(n(),o("span",uo,"*")):u("",!0),$e(At,{"model-value":a.notesValue,"point-id":a.pointId,"inspection-id":a.inspectionId,settings:(le=N.value)==null?void 0:le.settings,required:(xe=(de=N.value)==null?void 0:de.settings)==null?void 0:xe.required,"min-length":(Ce=(be=N.value)==null?void 0:be.settings)==null?void 0:Ce.min_length,"max-length":(we=(ye=N.value)==null?void 0:ye.settings)==null?void 0:we.max_length,placeholder:((i=(ve=N.value)==null?void 0:ve.settings)==null?void 0:i.placeholder)||"Tambahkan keterangan...","onUpdate:modelValue":r[12]||(r[12]=f=>p.$emit("update:notesValue",f)),onSave:r[13]||(r[13]=f=>p.$emit("saveTextarea",f))},null,8,["model-value","point-id","inspection-id","settings","required","min-length","max-length","placeholder"]),(v=(c=N.value)==null?void 0:c.settings)!=null&&v.required&&!a.notesValue?(n(),o("p",co," Keterangan wajib diisi ")):u("",!0)])):u("",!0)])]}),_:1},8,["show","title","subtitle"]))}},go={class:"mt-2 space-y-2"},vo=["type","name","value","checked","onChange","required"],fo={key:0,class:"p-2 rounded-lg bg-gray-50"},ho={key:0,class:"mt-2"},bo={class:"flex gap-2 overflow-x-auto",style:{"scrollbar-width":"none"}},yo=["src"],xo={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},wo={key:1,class:"mt-2"},ko={class:"text-sm text-gray-600"},Io={key:2,class:"mt-2 text-sm text-red-600"},_o={__name:"InputRadio",props:{modelValue:[String,Array],required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(a,{emit:Q}){const e=a,_=Q,l=T(e.notes),I=T([...e.images]),m=T(!1),A=T(""),y=T([]),N=T(""),M=T([]);ne(()=>e.options.find(d=>d.value===e.modelValue));const S=ne(()=>Array.isArray(e.modelValue)?e.options.filter(d=>e.modelValue.includes(d.value)):e.modelValue?[e.options.find(d=>d.value===e.modelValue)].filter(Boolean):[]),B=d=>Array.isArray(e.modelValue)?e.modelValue.includes(d.value):e.modelValue?(typeof e.modelValue=="string"?e.modelValue.split(",").map(J=>J.trim()):[e.modelValue]).includes(d.value):!1,Z=d=>d.settings&&(d.settings.show_textarea||d.settings.show_image_upload);me(()=>e.notes,d=>{l.value=d}),me(()=>e.images,d=>{I.value=[...d]}),me(()=>e.modelValue,d=>{d?N.value=Array.isArray(d)?[...d]:d:N.value=""});const p=(d,G)=>{let J;if(d.multi){const w=Array.isArray(e.modelValue)?e.modelValue:[];G.target.checked?J=[...w,d.value]:J=w.filter(g=>g!==d.value)}else J=d.value;_("update:modelValue",J),Z(d)?$():_("save",{pointId:e.pointId,inspectionId:e.inspectionId,value:J,notes:"",images:[]})},r=d=>d.preview||(d.image_path?`/${d.image_path}`:d),$=()=>{N.value=e.modelValue,A.value=l.value,y.value=[...I.value],M.value=[...I.value],m.value=!0},D=()=>{A.value="",y.value=[],N.value=Array.isArray(e.modelValue)?[...e.modelValue]:e.modelValue,m.value=!1},V=d=>{y.value=d,I.value=[...d],_("update:images",[...d]),_("save",{pointId:e.pointId,inspectionId:e.inspectionId,value:e.modelValue,notes:l.value,images:[...d]})},q=d=>{},Y=()=>{N.value!==e.modelValue&&_("update:modelValue",N.value),l.value=A.value,_("update:notes",A.value),I.value=[...y.value],_("update:images",[...y.value]),_("save",{pointId:e.pointId,inspectionId:e.inspectionId,value:N.value,notes:A.value,images:y.value}),m.value=!1},R=d=>{N.value="",A.value="",y.value=[],l.value="",I.value=[],_("update:modelValue",""),_("update:notes",""),_("update:images",[]),_("hapus",d),m.value=!1};return(d,G)=>{var J;return n(),o("div",go,[t("div",{class:pe(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(n(!0),o(_e,null,Se(a.options,(w,g)=>(n(),o("label",{key:g,class:"cursor-pointer"},[t("input",{type:w.multi?"checkbox":"radio",name:w.multi?`checkbox-${a.pointId}`:"radio-"+a.pointId,value:w.value,checked:B(w),onChange:s=>p(w,s),class:"hidden peer",required:a.required&&!w.multi},null,40,vo),t("div",{class:pe(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":B(w),"border-gray-300 text-gray-700 hover:bg-gray-50":!B(w)}])},L(w.label),3)]))),128))],2),a.modelValue&&S.value.length>0&&S.value.some(w=>Z(w))?(n(),o("div",fo,[t("div",{class:"flex justify-between items-start"},[G[4]||(G[4]=t("h4",{class:"text-sm font-medium text-gray-700"},"Detail : ",-1)),t("button",{onClick:$,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),a.images.length>0&&S.value.some(w=>{var g;return(g=w.settings)==null?void 0:g.show_image_upload})?(n(),o("div",ho,[t("div",bo,[(n(!0),o(_e,null,Se(a.images,(w,g)=>(n(),o("div",{key:g,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[t("img",{src:r(w),class:"w-full h-full object-cover rounded"},null,8,yo),g===3&&a.images.length>4?(n(),o("span",xo," +"+L(a.images.length-4),1)):u("",!0)]))),128))])])):u("",!0),a.notes&&S.value.some(w=>{var g;return(g=w.settings)==null?void 0:g.show_textarea})?(n(),o("div",wo,[t("p",ko,L(a.notes),1)])):u("",!0)])):u("",!0),m.value?(n(),ke(Vt,{key:(J=a.selectedPoint)==null?void 0:J.id,show:m.value,title:a.pointName||"Detail",subtitle:a.subtitle||"",name:"modal-radio-"+a.pointId,options:a.options,"selected-value":N.value,"notes-value":A.value,"images-value":y.value,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,"selected-point":a.selectedPoint,"onUpdate:selectedValue":G[0]||(G[0]=w=>N.value=w),"onUpdate:notesValue":G[1]||(G[1]=w=>A.value=w),"onUpdate:imagesValue":G[2]||(G[2]=w=>V(w)),onClose:D,onSave:Y,onSaveTextarea:d.handleTextareaSave,onSaveImage:q,onHapus:G[3]||(G[3]=w=>R(a.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point","onSaveTextarea"])):u("",!0),a.error?(n(),o("p",Io,L(a.error),1)):u("",!0)])}}},$o={class:"mt-2 space-y-2"},So={key:0,class:"flex flex-wrap gap-3"},Co={key:1,class:"p-2"},Ao={key:0,class:"mt-2"},Vo={class:"flex gap-2 overflow-x-auto scrollbar-hide"},To=["src"],No={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},Mo=["type","name","value","checked"],Uo={key:1,class:"mt-2"},Eo={class:"text-sm text-gray-600"},Po={key:3,class:"mt-2 text-sm text-red-600"},Do={__name:"InputImageToRadio",props:{modelValue:[String,Array],required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(a,{emit:Q}){const e=a,_=Q,l=T(e.notes),I=T([...e.images]),m=T(!1),A=T(""),y=T([]),N=T(""),M=T([]),S=ne(()=>{if(Array.isArray(e.modelValue))return e.options.find(R=>e.modelValue.includes(R.value));if(e.modelValue){const R=typeof e.modelValue=="string"?e.modelValue.split(",").map(d=>d.trim()):[e.modelValue];return e.options.find(d=>R.includes(d.value))}return null}),B=ne(()=>{if(Array.isArray(e.modelValue))return e.options.filter(R=>e.modelValue.includes(R.value));if(e.modelValue){const R=typeof e.modelValue=="string"?e.modelValue.split(",").map(d=>d.trim()):[e.modelValue];return e.options.filter(d=>R.includes(d.value))}return[]}),Z=ne(()=>B.value.some(R=>{var d;return R.multi&&((d=R.settings)==null?void 0:d.show_textarea)}));ne(()=>B.value.find(R=>{var d;return R.multi&&((d=R.settings)==null?void 0:d.show_textarea)}));const p=R=>Array.isArray(e.modelValue)?e.modelValue.includes(R.value):e.modelValue?(typeof e.modelValue=="string"?e.modelValue.split(",").map(G=>G.trim()):[e.modelValue]).includes(R.value):!1,r=R=>R.preview||(R.image_path?`/${R.image_path}`:R);me(()=>e.notes,R=>{l.value=R});const $=()=>{N.value=e.modelValue||"",A.value=l.value,y.value=[...I.value],M.value=[...I.value],m.value=!0},D=()=>{A.value="",y.value=[],N.value="",m.value=!1},V=R=>{y.value=R,I.value=[...R],_("update:images",[...R]),_("save",{pointId:e.pointId,inspectionId:e.inspectionId,value:e.modelValue,notes:l.value,images:[...R]})},q=()=>{N.value!==e.modelValue&&_("update:modelValue",N.value),l.value=A.value,_("update:notes",A.value),I.value=[...y.value],_("update:images",[...y.value]),_("save",{pointId:e.pointId,inspectionId:e.inspectionId,value:N.value,notes:A.value,images:y.value}),m.value=!1},Y=R=>{N.value="",A.value="",y.value=[],l.value="",I.value=[],_("update:modelValue",""),_("update:notes",""),_("update:images",[]),_("hapus",R),m.value=!1};return(R,d)=>{var G,J,w;return n(),o("div",$o,[!a.modelValue&&I.value.length===0&&!l.value?(n(),o("div",So,[t("div",{class:"relative w-28 h-28 border-2 border-dashed rounded-lg flex items-center justify-center cursor-pointer overflow-hidden",onClick:$},d[4]||(d[4]=[t("div",{class:"flex flex-col items-center text-gray-400"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),t("span",{class:"text-xs font-medium"},"Tambah")],-1)]))])):(n(),o("div",Co,[t("div",{class:"flex justify-between items-start"},[d[5]||(d[5]=t("h4",{class:"text-sm font-medium text-gray-700"},"Detail :",-1)),t("button",{onClick:$,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),I.value.length>0?(n(),o("div",Ao,[t("div",Vo,[(n(!0),o(_e,null,Se(I.value,(g,s)=>(n(),o("div",{key:s,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[t("img",{src:r(g),class:"w-full h-full object-cover rounded"},null,8,To),s===3&&I.value.length>4?(n(),o("span",No," +"+L(I.value.length-4),1)):u("",!0)]))),128))])])):u("",!0),t("div",{class:pe(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(a.options.length,3)}`])},[(n(!0),o(_e,null,Se(a.options,(g,s)=>(n(),o("label",{key:s,class:"cursor-pointer"},[t("input",{type:g.multi?"checkbox":"radio",name:g.multi?`checkbox-${a.pointId}`:`radio-${a.pointId}`,value:g.value,checked:p(g),disabled:!0,class:"hidden peer"},null,8,Mo),t("div",{class:pe(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":p(g),"border-gray-300 text-gray-700 hover:bg-gray-50":!p(g)}])},L(g.label),3)]))),128))],2),l.value&&((J=(G=S.value)==null?void 0:G.settings)!=null&&J.show_textarea||Z.value)?(n(),o("div",Uo,[t("p",Eo,L(l.value),1)])):u("",!0)])),m.value?(n(),ke(Vt,{key:(w=a.selectedPoint)==null?void 0:w.id,show:m.value,title:a.pointName||"Detail",subtitle:a.subtitle||"",name:"modal-radio-"+a.pointId,options:a.options,"selected-value":N.value,"notes-value":A.value,"images-value":y.value,"point-id":a.pointId,point:a.point,"inspection-id":a.inspectionId,"selected-point":a.selectedPoint,"onUpdate:selectedValue":d[0]||(d[0]=g=>N.value=g),"onUpdate:notesValue":d[1]||(d[1]=g=>A.value=g),"onUpdate:imagesValue":d[2]||(d[2]=g=>V(g)),onClose:D,onSave:q,onHapus:d[3]||(d[3]=g=>Y(a.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point"])):u("",!0),a.error?(n(),o("p",Po,L(a.error),1)):u("",!0)])}}},Ro={class:"text-base font-semibold text-indigo-700"},Lo={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},jo={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Bo={class:"text-base font-semibold text-indigo-700"},Fo={class:"p-4 space-y-4"},qo={key:0,class:"flex justify-end py-1"},Oo=["onClick"],Ko={key:1,class:"space-y-2"},zo={class:"flex items-start justify-between"},Ho={class:"flex-1"},Go={class:"block text-sm font-medium text-gray-900"},Wo={class:"font-bold"},Zo={key:0,class:"text-red-500"},Jo={key:1,class:"italic text-xs text-gray-400 ml-2"},Xo={key:0,class:"mt-1"},Yo={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800"},Qo={key:0},ei={key:1},ti={key:2},ai={key:3},si={key:4},ni={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"},oi={key:9,class:"p-3 bg-gray-100 rounded text-sm text-gray-600"},ii={class:"text-xs mt-1 list-disc list-inside"},li={key:0},ri={key:1},ui={key:2},di={key:3},ci={key:4},pi={key:0,class:"text-center py-8 text-gray-500"},mi={key:0,class:"text-xs text-gray-400"},gi={__name:"CategorySection",props:{category:Object,form:Object,head:Object,inspectionId:String,selectedPoint:Object,car:Object},emits:["updateResult","removeImage","hapusPoint"],setup(a,{emit:Q}){const e=a,_=Q,l=qe("vehicleFeatures",T(null));l.value=JSON.parse(localStorage.getItem("vehicle_features")||"{}"),Mt("vehicleFeatures",l);const I=T(!1),m=T([]),A=T(!0),y=T(null),N=Ut(),M={MT:"Manual Transmission (MT)",AT:"Automatic Transmission (AT)",CVT:"Continuously Variable Transmission (CVT)","e-CVT":"Electronic CVT (e-CVT)",DCT:"Dual Clutch Transmission (DCT)",AMT:"Automated Manual Transmission (AMT)",IVT:"Intelligent Variable Transmission (IVT)",SSG:"Seamless Shift Gearbox (SSG)",AGS:"Auto Gear Shift (AGS)",DHT:"Dedicated Hybrid Transmission (DHT)"};Pe(()=>{const w=new IntersectionObserver(([g])=>{A.value=g.isIntersecting},{threshold:.1});y.value&&w.observe(y.value),De(()=>{y.value&&w.unobserve(y.value)})});const S=()=>{I.value=!I.value,I.value||(m.value=[])},B=ne(()=>(e.category.points||[]).some(w=>w.is_default===!1)),Z=w=>!w||!Array.isArray(w)?[]:w.map(g=>M[g]||g),p=w=>{var P,ae;const g=w.settings;if(!r(w))return!0;const s=(P=e.car)==null?void 0:P.transmission,x=(ae=e.car)==null?void 0:ae.fuel_type;return!(g.transmission&&Array.isArray(g.transmission)&&g.transmission.length>0&&s&&!g.transmission.includes(s)||g.fuel_type&&g.fuel_type.trim()!==""&&x&&g.fuel_type!==x||g.rear_door&&(!l.value||!l.value.rear_door)||g.pick_up&&(!l.value||!l.value.pick_up)||g.box&&(!l.value||!l.value.box))},r=w=>{const g=w.settings;return!!(g!=null&&g.transmission&&Array.isArray(g.transmission)&&g.transmission.length>0||g!=null&&g.fuel_type&&g.fuel_type.trim()!==""||g!=null&&g.rear_door||g!=null&&g.pick_up||g!=null&&g.box)},$=w=>r(w)&&(I.value||p(w)),D=ne(()=>{const w=e.category.points||[],g=[];let s=[];return I.value?e.category.isDamageMenu?w.filter(x=>{var P;return x.is_default||q((P=x.inspection_point)==null?void 0:P.id)||I.value}):w:e.category.isDamageMenu?w.filter(x=>{var ae;const P=(ae=x.inspection_point)==null?void 0:ae.id;return q(P)||x.is_default||m.value.includes(P)}):(w.forEach(x=>{var U;const P=(U=x.inspection_point)==null?void 0:U.id,ae=q(P),j=m.value.includes(P),ee=!r(x)||p(x);(x.is_default||ae||j)&&ee?(s.length>0&&(g.push({is_link:!0,count:s.length,hiddenIds:s.map(C=>C.inspection_point.id)}),s.forEach(C=>{m.value.includes(C.inspection_point.id)&&g.push(C)}),s=[]),g.push(x)):(!r(x)||p(x))&&s.push(x)}),s.length>0&&(g.push({is_link:!0,count:s.length,hiddenIds:s.map(x=>x.inspection_point.id)}),s.forEach(x=>{m.value.includes(x.inspection_point.id)&&g.push(x)})),g.filter(x=>{var P,ae;return x.is_link||x.is_default||q((P=x.inspection_point)==null?void 0:P.id)||m.value.includes((ae=x.inspection_point)==null?void 0:ae.id)}))});ne(()=>D.value.filter(w=>!w.is_link));const V=w=>{I.value=!1,w.forEach(g=>{m.value.includes(g)||m.value.push(g)})},q=w=>{if(!w)return!1;const g=N.props.existingResults[w]!==void 0,s=N.props.existingImages[w]&&N.props.existingImages[w].length>0,x=e.form.results[w]&&(e.form.results[w].status||e.form.results[w].note),P=e.form.images[w]&&e.form.images[w].length>0;return g||s||x||P},Y=[{value:"good",label:"Good"},{value:"bad",label:"Bad"},{value:"na",label:"N/A"}],R=w=>{var x,P,ae,j,O,ee,se,U,C;const g=e.form.results[(x=w.inspection_point)==null?void 0:x.id],s=e.form.images[(P=w.inspection_point)==null?void 0:P.id];if(!g)return!1;switch(w.input_type){case"text":case"number":case"date":case"account":case"textarea":return!!g.note;case"select":case"radio":if(!g.status)return!1;const E=(j=(ae=w.settings)==null?void 0:ae.radios)==null?void 0:j.find(W=>W.value===g.status);return!(E!=null&&E.settings&&(E.settings.show_textarea&&!((O=g.note)!=null&&O.trim())||E.settings.show_image_upload&&(s==null?void 0:s.length)===0));case"imageTOradio":if((s==null?void 0:s.length)===0||!g.status)return!1;const F=(se=(ee=w.settings)==null?void 0:ee.radios)==null?void 0:se.find(W=>W.value===g.status);return!(F!=null&&F.settings&&F.settings.show_textarea&&!((U=g.note)!=null&&U.trim()));case"image":return(s==null?void 0:s.length)>0;default:return!!g.status||!!((C=g.note)!=null&&C.trim())}},d=(w,g,s)=>{_("updateResult",{pointId:w,type:s,value:g})},G=w=>{console.log("Save result for point:",w)},J=w=>{_("hapusPoint",w)};return me(()=>e.form.results,w=>{},{deep:!0}),me(()=>e.form.images,w=>{},{deep:!0}),me(()=>e.car,w=>{console.log("Car data updated:",w)},{deep:!0}),me(l,w=>{console.log("Vehicle features updated:",w)},{deep:!0}),(w,g)=>(n(),o(_e,null,[e.head==="vertical"?(n(),o("div",{key:0,class:pe(["px-6 py-2 border-b flex items-center justify-between bg-indigo-200","fixed top-0 left-0 right-0 z-20"])},[t("h4",Ro,L(a.category.name),1),B.value?(n(),o("button",{key:0,onClick:S,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},L(I.value?"Sembunyikan Semua":"Tampilkan Point Lain"),1)):u("",!0)])):u("",!0),t("div",{class:pe(["bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100",e.head==="vertical"?"pt-6":""])},[!A.value&&B.value?(n(),o("button",{key:0,onClick:S,class:"fixed top-3 right-2 z-10 bg-indigo-600 text-white p-2 rounded-full shadow-lg"},[I.value?(n(),o("svg",Lo,g[0]||(g[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(n(),o("svg",jo,g[1]||(g[1]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.006-3.362M9.88 9.88a3 3 0 104.24 4.24M6.1 6.1l11.8 11.8"},null,-1)])))])):u("",!0),e.head==="horizontal"?(n(),o("div",{key:1,ref_key:"categoryHeader",ref:y,class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[t("h4",Bo,L(a.category.name),1),B.value?(n(),o("button",{key:0,onClick:S,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},L(I.value?"Sembunyikan":"Tampilkan Point Lain"),1)):u("",!0)],512)):u("",!0),t("div",Fo,[(n(!0),o(_e,null,Se(D.value,(s,x)=>{var P,ae,j,O,ee,se,U,C,E,F,W,X,le,de,xe,be,Ce,ye,we,ve,i,c,v,f,K,ie,re,ue,te,b,h,oe,z,ce,ge,fe,he,Ue,Ke,ze,He,Ge,We,Ze,Je,Xe,Ye,Qe,et,tt,at,st,nt,ot,it,lt,rt,ut,dt,ct,pt,mt,gt,vt,ft,ht,bt,yt,xt;return n(),o("div",{key:x,class:pe(["space-y-2 last:border-0 last:pb-0",s.is_link?"pb-0":"pb-2 border-b border-gray-100"])},[s.is_link?(n(),o("div",qo,[t("button",{onClick:H=>V(s.hiddenIds),class:"text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline focus:outline-none"}," Tampilkan "+L(s.count)+" Point Tersembunyi ",9,Oo)])):(n(),o("div",Ko,[t("div",zo,[t("div",Ho,[t("label",Go,[t("span",Wo,L((P=s.inspection_point)==null?void 0:P.name),1),(ae=s.settings)!=null&&ae.is_required?(n(),o("span",Zo,"*")):u("",!0),!s.is_default&&!q((j=s.inspection_point)==null?void 0:j.id)?(n(),o("span",Jo," (opsional) ")):u("",!0)]),$(s)?(n(),o("div",Xo,[r(s)?(n(),o("div",Yo,[(O=s.settings)!=null&&O.transmission?(n(),o("div",Qo,L(s.settings.transmission.join(", ")),1)):u("",!0),(ee=s.settings)!=null&&ee.fuel_type?(n(),o("div",ei,L(s.settings.fuel_type),1)):u("",!0),(se=s.settings)!=null&&se.rear_door?(n(),o("div",ti," Pintu Belakang ")):u("",!0),(U=s.settings)!=null&&U.pick_up?(n(),o("div",ai," Tipe Pick Up ")):u("",!0),(C=s.settings)!=null&&C.box?(n(),o("div",si," Memiliki Box ")):u("",!0)])):u("",!0)])):u("",!0)]),R(s)?(n(),o("span",ni," ✓ ")):u("",!0)]),s.input_type==="text"&&p(s)?(n(),ke(_t,{key:0,modelValue:a.form.results[(E=s.inspection_point)==null?void 0:E.id].note,"onUpdate:modelValue":[H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].note=H},H=>{var k;return d((k=s.inspection_point)==null?void 0:k.id,H,"note")}],required:(F=s.settings)==null?void 0:F.is_required,"min-length":(W=s.settings)==null?void 0:W.min_length,"max-length":(X=s.settings)==null?void 0:X.max_length,allowSpace:(le=s.settings)==null?void 0:le.allow_space,textTransform:(de=s.settings)==null?void 0:de.text_transform,placeholder:((xe=s.settings)==null?void 0:xe.placeholder)||"Masukan text",error:a.form.errors[`results.${(be=s.inspection_point)==null?void 0:be.id}.note`],onSave:H=>{var k;return G((k=s.inspection_point)==null?void 0:k.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","allowSpace","textTransform","placeholder","error","onSave"])):u("",!0),s.input_type==="number"&&p(s)?(n(),ke($t,{key:1,modelValue:a.form.results[(Ce=s.inspection_point)==null?void 0:Ce.id].note,"onUpdate:modelValue":[H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].note=H},H=>{var k;return d((k=s.inspection_point)==null?void 0:k.id,H,"note")}],required:(ye=s.settings)==null?void 0:ye.is_required,min:(we=s.settings)==null?void 0:we.min,max:(ve=s.settings)==null?void 0:ve.max,step:((i=s.settings)==null?void 0:i.step)||1,placeholder:((c=s.settings)==null?void 0:c.placeholder)||"Masukan number",error:a.form.errors[`results.${(v=s.inspection_point)==null?void 0:v.id}.note`],onSave:H=>{var k;return G((k=s.inspection_point)==null?void 0:k.id)}},null,8,["modelValue","onUpdate:modelValue","required","min","max","step","placeholder","error","onSave"])):u("",!0),s.input_type==="account"&&p(s)?(n(),ke(Ct,{key:2,modelValue:a.form.results[(f=s.inspection_point)==null?void 0:f.id].note,"onUpdate:modelValue":[H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].note=H},H=>{var k;return d((k=s.inspection_point)==null?void 0:k.id,H,"note")}],required:(K=s.settings)==null?void 0:K.is_required,placeholder:((ie=s.settings)==null?void 0:ie.placeholder)||"Masukkan nilai",error:a.form.errors[`results.${(re=s.inspection_point)==null?void 0:re.id}.note`],"point-id":(ue=s.inspection_point)==null?void 0:ue.id,settings:s.settings,onSave:H=>{var k;return G((k=s.inspection_point)==null?void 0:k.id)}},null,8,["modelValue","onUpdate:modelValue","required","placeholder","error","point-id","settings","onSave"])):u("",!0),s.input_type==="date"&&p(s)?(n(),ke(St,{key:3,modelValue:a.form.results[(te=s.inspection_point)==null?void 0:te.id].note,"onUpdate:modelValue":[H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].note=H},H=>{var k;return d((k=s.inspection_point)==null?void 0:k.id,H,"note")}],required:(b=s.settings)==null?void 0:b.is_required,"min-date":(h=s.settings)==null?void 0:h.min_date,"max-date":(oe=s.settings)==null?void 0:oe.max_date,error:a.form.errors[`results.${(z=s.inspection_point)==null?void 0:z.id}.note`],onSave:H=>{var k;return G((k=s.inspection_point)==null?void 0:k.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-date","max-date","error","onSave"])):u("",!0),s.input_type==="textarea"&&p(s)?(n(),ke(At,{key:4,modelValue:a.form.results[(ce=s.inspection_point)==null?void 0:ce.id].note,"onUpdate:modelValue":[H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].note=H},H=>{var k;return d((k=s.inspection_point)==null?void 0:k.id,H,"note")}],required:(ge=s.settings)==null?void 0:ge.is_required,"min-length":(fe=s.settings)==null?void 0:fe.min_length,"max-length":(he=s.settings)==null?void 0:he.max_length,placeholder:((Ue=s.settings)==null?void 0:Ue.placeholder)||"Masukkan teks di sini",settings:s.settings,error:a.form.errors[`results.${(Ke=s.inspection_point)==null?void 0:Ke.id}.note`],onSave:H=>{var k;return G((k=s.inspection_point)==null?void 0:k.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","placeholder","settings","error","onSave"])):u("",!0),s.input_type==="radio"&&p(s)?(n(),ke(_o,{key:5,modelValue:a.form.results[(ze=s.inspection_point)==null?void 0:ze.id].status,"onUpdate:modelValue":[H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].status=H},H=>{var k;return d((k=s.inspection_point)==null?void 0:k.id,H,"status")}],notes:a.form.results[(He=s.inspection_point)==null?void 0:He.id].note,images:a.form.images[(Ge=s.inspection_point)==null?void 0:Ge.id],required:(We=s.settings)==null?void 0:We.is_required,"point-id":(Ze=s.inspection_point)==null?void 0:Ze.id,point:s.inspection_point,"inspection-id":a.inspectionId,settings:s.settings,"point-name":(Je=s.inspection_point)==null?void 0:Je.name,subtitle:(Xe=s.inspection_point)==null?void 0:Xe.description,"selected-point":s.inspection_point??null,options:((Ye=s.settings)==null?void 0:Ye.radios)||Y,error:a.form.errors[`results.${(Qe=s.inspection_point)==null?void 0:Qe.id}.status`],"onUpdate:notes":H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].note=H},"onUpdate:images":H=>{var k;return a.form.images[(k=s.inspection_point)==null?void 0:k.id]=H},onSave:H=>{var k;return G((k=s.inspection_point)==null?void 0:k.id)},onHapus:H=>{var k;return J((k=s.inspection_point)==null?void 0:k.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","point","inspection-id","settings","point-name","subtitle","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):u("",!0),s.input_type==="imageTOradio"&&p(s)?(n(),ke(Do,{key:6,modelValue:a.form.results[(et=s.inspection_point)==null?void 0:et.id].status,"onUpdate:modelValue":[H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].status=H},H=>{var k;return d((k=s.inspection_point)==null?void 0:k.id,H,"status")}],notes:a.form.results[(tt=s.inspection_point)==null?void 0:tt.id].note,images:a.form.images[(at=s.inspection_point)==null?void 0:at.id],required:(st=s.settings)==null?void 0:st.is_required,"point-id":(nt=s.inspection_point)==null?void 0:nt.id,"inspection-id":a.inspectionId,settings:s.settings,"point-name":(ot=s.inspection_point)==null?void 0:ot.name,subtitle:(it=s.inspection_point)==null?void 0:it.description,point:s,"selected-point":s.inspection_point??null,options:((lt=s.settings)==null?void 0:lt.radios)||Y,error:a.form.errors[`results.${(rt=s.inspection_point)==null?void 0:rt.id}.status`],"onUpdate:notes":H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].note=H},"onUpdate:images":H=>{var k;return a.form.images[(k=s.inspection_point)==null?void 0:k.id]=H},onSave:H=>{var k;return G((k=s.inspection_point)==null?void 0:k.id)},onHapus:H=>{var k;return J((k=s.inspection_point)==null?void 0:k.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","inspection-id","settings","point-name","subtitle","point","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):u("",!0),s.input_type==="image"&&p(s)?(n(),ke(Oe,{key:7,modelValue:a.form.images[(ut=s.inspection_point)==null?void 0:ut.id],"onUpdate:modelValue":H=>{var k;return a.form.images[(k=s.inspection_point)==null?void 0:k.id]=H},error:a.form.errors[`images.${(dt=s.inspection_point)==null?void 0:dt.id}`],"inspection-id":a.inspectionId,"point-id":(ct=s.inspection_point)==null?void 0:ct.id,point:s.inspection_point,"point-name":(pt=s.inspection_point)==null?void 0:pt.name,settings:s.settings,"onUpdate:notes":H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].note=H},"onUpdate:status":H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].status=H}},null,8,["modelValue","onUpdate:modelValue","error","inspection-id","point-id","point","point-name","settings","onUpdate:notes","onUpdate:status"])):u("",!0),s.input_type==="select"&&p(s)?(n(),ke(Qa,{key:8,modelValue:a.form.results[(mt=s.inspection_point)==null?void 0:mt.id].status,"onUpdate:modelValue":[H=>{var k;return a.form.results[(k=s.inspection_point)==null?void 0:k.id].status=H},H=>{var k;return d((k=s.inspection_point)==null?void 0:k.id,H,"status")}],required:(gt=s.settings)==null?void 0:gt.is_required,error:a.form.errors[`results.${(vt=s.inspection_point)==null?void 0:vt.id}.status`],onSave:H=>{var k;return G((k=s.inspection_point)==null?void 0:k.id)}},null,8,["modelValue","onUpdate:modelValue","required","error","onSave"])):u("",!0),!p(s)&&r(s)?(n(),o("div",oi,[g[2]||(g[2]=t("p",{class:"font-medium"},"Tidak tersedia untuk kendaraan ini",-1)),g[3]||(g[3]=t("p",{class:"text-xs mt-1"},"Point ini hanya tersedia untuk:",-1)),t("ul",ii,[(ft=s.settings)!=null&&ft.transmission?(n(),o("li",li," Transmisi: "+L(Z(s.settings.transmission).join(", ")),1)):u("",!0),(ht=s.settings)!=null&&ht.fuel_type?(n(),o("li",ri," Bahan bakar: "+L(s.settings.fuel_type),1)):u("",!0),(bt=s.settings)!=null&&bt.rear_door?(n(),o("li",ui,"Kendaraan dengan pintu belakang")):u("",!0),(yt=s.settings)!=null&&yt.pick_up?(n(),o("li",di,"Tipe pick up")):u("",!0),(xt=s.settings)!=null&&xt.box?(n(),o("li",ci,"Kendaraan dengan box")):u("",!0)])])):u("",!0)]))],2)}),128)),D.value.filter(s=>!s.is_link).length===0?(n(),o("div",pi,[g[4]||(g[4]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),g[5]||(g[5]=t("p",{class:"mt-2 text-sm"},"Tidak ada data untuk ditampilkan",-1)),a.category.isDamageMenu?(n(),o("p",mi,' Tambahkan data melalui tombol "+" di pojok kanan bawah ')):u("",!0)])):u("",!0)])],2)],64))}},Hi=Ve(gi,[["__scopeId","data-v-704b9892"]]),vi={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},fi={class:"p-4 space-y-4-6"},hi={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},bi=["value"],yi={class:"p-4 space-y-4-6"},xi={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},wi=["value"],ki={key:0,class:"p-4 space-y-4 bg-blue-50 rounded-lg border border-blue-200"},Ii={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},_i=["value"],$i={class:"p-4 space-y-2"},Si={class:"flex items-center justify-between mb-2"},Ci={key:0,class:"mb-4 p-4 bg-white border border-gray-200 rounded-lg shadow-lg"},Ai={class:"flex items-center justify-between mb-3"},Vi={class:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-60 overflow-y-auto"},Ti=["onClick"],Ni={class:"text-sm font-medium text-gray-800 mb-1"},Mi={class:"text-xs text-gray-600 line-clamp-2"},Ui={class:"flex flex-wrap gap-1 mb-2 p-2 bg-gray-100 rounded-md"},Ei={key:0,class:"text-xs text-gray-500 mb-2 bg-gray-50 p-2 rounded border"},Pi={key:0,class:"font-bold mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Di={key:1,class:"italic mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Ri={key:2,class:"underline mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Li={__name:"ConclusionSection",props:{inspectionId:{type:Number,required:!0},inspection:{type:Object,required:!0},form:{type:Object,required:!0}},emits:["updateConclusion"],setup(a,{emit:Q}){const e=a,_=Q,l=T(null),I=T(!1),m=T(!1),A=kt({bold:!1,italic:!1,underline:!1}),y=kt({flooded:"",collision:"",collision_severity:"",notes:""}),N=T([{id:1,name:"Kendaraan Normal",description:"Template untuk kendaraan dalam kondisi normal tanpa masalah signifikan (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi kendaraan secara umum: <b>BAIK</b><br>
- Tidak ditemukan indikasi kerusakan signifikan<br>
- Semua sistem berfungsi dengan normal<br>`},{id:2,name:"Kendaraan Bekas Tabrakan Ringan",description:"Template untuk kendaraan dengan riwayat tabrakan ringan (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat tabrakan dengan tingkat kerusakan: <b>RINGAN</b><br>
- Area yang terdampak: PERLU DIISI<br>
- Perbaikan yang dilakukan: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`},{id:3,name:"Kendaraan Bekas Banjir",description:"Template untuk kendaraan dengan riwayat terkena banjir (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat terkena banjir<br>
- Tingkat paparan air: PERLU DIISI<br>
- Komponen yang terdampak: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`},{id:4,name:"Kendaraan dengan Multiple Issues",description:"Template untuk kendaraan dengan beberapa masalah umum (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi umum kendaraan: PERLU DIISI<br>
- Masalah utama yang ditemukan: PERLU DIISI<br>
- Komponen yang perlu perhatian: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`},{id:5,name:"Template Singkat",description:"Template ringkas untuk kesimpulan cepat (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Status Keseluruhan Kendaraan: PERLU DIISI<br>
- Catatan Utama: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI`},{id:6,name:"Template Teknis Detail",description:"Template detail untuk laporan teknis lengkap (Lengkap A, C, B)",content:`<p><strong>A. LAPORAN HASIL INSPEKSI TEKNIS:</strong></p>
- Tanggal Inspeksi: PERLU DIISI<br>
- Kondisi Mesin: PERLU DIISI<br>
- Kondisi Transmisi: PERLU DIISI<br>
- Kondisi Suspensi: PERLU DIISI<br>
- Kondisi Rem: PERLU DIISI<br>
- Kondisi Body: PERLU DIISI<br>
- Kondisi Interior: PERLU DIISI<br>
- Kesimpulan Akhir: PERLU DIISI

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`}]);T(["{PLATE_NUMBER}","{CAR_NAME}","{INSPECTION_DATE}","{DAMAGED_AREA}","{REPAIR_DETAILS}","{WATER_LEVEL}","{AFFECTED_COMPONENTS}","{OVERALL_CONDITION}","{MAIN_ISSUES}","{ATTENTION_NEEDED}","{REPAIR_COST_ESTIMATE}","{RECOMMENDATION}","{OVERALL_STATUS}","{ADDITIONAL_NOTES}","{ENGINE_CONDITION}","{TRANSMISSION_CONDITION}","{SUSPENSION_CONDITION}","{BRAKE_CONDITION}","{BODY_CONDITION}","{INTERIOR_CONDITION}","{FINAL_CONCLUSION}"]);const M=s=>{if(!s)return{};if(typeof s=="string")try{return JSON.parse(s)||{}}catch(x){return console.error("Error parsing settings JSON:",x),{}}return typeof s=="object"&&s!==null?s:{}};ne(()=>M(e.inspection.settings).conclusion||{});const S=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],B=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],Z=[{value:"light",label:"Ringan"},{value:"heavy",label:"Berat"}];Pe(()=>{r(),Fe(()=>{p(),V()})});const p=()=>{l.value&&y.notes&&(l.value.innerHTML=y.notes)},r=()=>{const x=M(e.inspection.settings).conclusion||{},P=e.form.conclusion||{};y.flooded=P.flooded||x.flooded||"",y.collision=P.collision||x.collision||"",y.collision_severity=P.collision_severity||x.collision_severity||"",y.notes=P.notes||e.inspection.notes||""},$=s=>{if(!l.value)return;let x=s.content;x=x.replace(/{PLATE_NUMBER}/g,e.inspection.plate_number||"[NOMOR_PLAT]").replace(/{CAR_NAME}/g,e.inspection.car_name||"[NAMA_MOBIL]").replace(/{INSPECTION_DATE}/g,new Date().toLocaleDateString("id-ID")).replace(/{FLOOD_STATUS}/g,y.flooded==="yes"?"Pernah terkena banjir":"Tidak pernah terkena banjir").replace(/{COLLISION_STATUS}/g,y.collision==="yes"?"Pernah mengalami tabrakan":"Tidak pernah mengalami tabrakan"),l.value.innerHTML=x,y.notes=x,m.value=!1,Fe(()=>{l.value.focus(),g()})},D=()=>{l.value&&(l.value.innerHTML="",y.notes="",g())},V=()=>{if(!l.value)return;const s=window.getSelection();s.rangeCount===0||s.isCollapsed||(A.bold=document.queryCommandState("bold"),A.italic=document.queryCommandState("italic"),A.underline=document.queryCommandState("underline"))},q=s=>{if(!l.value)return;l.value.focus();const x=A[s];switch(s){case"bold":document.execCommand("bold",!1,!x);break;case"italic":document.execCommand("italic",!1,!x);break;case"underline":document.execCommand("underline",!1,!x);break}setTimeout(()=>{V(),Y()},10)},Y=It.debounce(()=>{l.value&&(y.notes=l.value.innerHTML,g())},200),R=s=>{s.preventDefault(),document.execCommand("insertParagraph",!1,null)},d=s=>{s.preventDefault();const x=(s.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,x)},G=()=>{I.value=!0},J=()=>{I.value=!1,l.value&&(y.notes=l.value.innerHTML,g())},w=()=>{g()},g=()=>{const s={flooded:y.flooded,collision:y.collision,collision_severity:y.collision==="yes"?y.collision_severity:null,notes:y.notes};_("updateConclusion",s)};return me(()=>e.form.conclusion,s=>{s&&(y.flooded=s.flooded!==void 0?s.flooded:y.flooded,y.collision=s.collision!==void 0?s.collision:y.collision,y.collision_severity=s.collision_severity!==void 0?s.collision_severity:y.collision_severity,y.notes=s.notes!==void 0?s.notes:y.notes,l.value&&s.notes!==void 0&&l.value.innerHTML!==s.notes&&(l.value.innerHTML=s.notes))},{deep:!0,immediate:!0}),me([()=>y.flooded,()=>y.collision,()=>y.collision_severity,()=>y.notes],()=>{g()},{deep:!0}),(s,x)=>(n(),o("div",vi,[x[21]||(x[21]=t("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[t("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),t("div",fi,[x[10]||(x[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[Ie(" Apakah kendaraan pernah terkena banjir? "),t("span",{class:"text-red-500"},"*")],-1)),t("div",hi,[(n(),o(_e,null,Se(S,P=>t("label",{key:P.value,class:"cursor-pointer"},[Te(t("input",{type:"radio","onUpdate:modelValue":x[0]||(x[0]=ae=>y.flooded=ae),value:P.value,class:"hidden peer",onChange:w},null,40,bi),[[Be,y.flooded]]),t("div",{class:pe(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":y.flooded===P.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":y.flooded!==P.value}])},L(P.label),3)])),64))])]),t("div",yi,[x[12]||(x[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[Ie(" Apakah kendaraan pernah mengalami tabrakan? "),t("span",{class:"text-red-500"},"*")],-1)),t("div",xi,[(n(),o(_e,null,Se(B,P=>t("label",{key:P.value,class:"cursor-pointer"},[Te(t("input",{type:"radio","onUpdate:modelValue":x[1]||(x[1]=ae=>y.collision=ae),value:P.value,class:"hidden peer",onChange:w},null,40,wi),[[Be,y.collision]]),t("div",{class:pe(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":y.collision===P.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":y.collision!==P.value}])},L(P.label),3)])),64))]),$e(Le,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform -translate-y-2","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-2"},{default:Ne(()=>[y.collision==="yes"?(n(),o("div",ki,[x[11]||(x[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[Ie("Tingkat kerusakan: "),t("span",{class:"text-red-500"},"*")],-1)),t("div",Ii,[(n(),o(_e,null,Se(Z,P=>t("label",{key:P.value,class:"cursor-pointer"},[Te(t("input",{type:"radio","onUpdate:modelValue":x[2]||(x[2]=ae=>y.collision_severity=ae),value:P.value,class:"hidden peer",onChange:w},null,40,_i),[[Be,y.collision_severity]]),t("div",{class:pe(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-blue-500 bg-blue-100 text-blue-700 shadow-sm scale-[0.98]":y.collision_severity===P.value,"border-gray-300 text-gray-700 hover:bg-white hover:border-gray-400":y.collision_severity!==P.value}])},L(P.label),3)])),64))])])):u("",!0)]),_:1})]),t("div",$i,[t("div",Si,[x[14]||(x[14]=t("label",{class:"block text-sm font-medium text-gray-700"},"Catatan Kesimpulan",-1)),t("button",{type:"button",onClick:x[3]||(x[3]=P=>m.value=!m.value),class:"flex items-center gap-2 px-3 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all duration-200"},x[13]||(x[13]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),Ie(" Template ")]))]),$e(Le,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:Ne(()=>[m.value?(n(),o("div",Ci,[t("div",Ai,[x[16]||(x[16]=t("h5",{class:"text-sm font-semibold text-gray-700"},"Pilih Template Kesimpulan",-1)),t("button",{onClick:x[4]||(x[4]=P=>m.value=!1),class:"text-gray-400 hover:text-gray-600"},x[15]||(x[15]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",Vi,[(n(!0),o(_e,null,Se(N.value,P=>(n(),o("button",{key:P.id,onClick:ae=>$(P),class:"p-3 text-left border border-gray-200 rounded-lg hover:border-indigo-300 hover:bg-indigo-50 transition-all duration-150"},[t("div",Ni,L(P.name),1),t("div",Mi,L(P.description),1)],8,Ti))),128))])])):u("",!0)]),_:1}),t("div",Ui,[t("button",{type:"button",onClick:x[5]||(x[5]=P=>q("bold")),class:pe(["p-2 rounded transition-all duration-150 ease-in-out font-medium",A.bold?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Bold"},x[17]||(x[17]=[t("strong",null,"B",-1)]),2),t("button",{type:"button",onClick:x[6]||(x[6]=P=>q("italic")),class:pe(["p-2 rounded transition-all duration-150 ease-in-out font-medium",A.italic?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Italic"},x[18]||(x[18]=[t("em",null,"I",-1)]),2),t("button",{type:"button",onClick:x[7]||(x[7]=P=>q("underline")),class:pe(["p-2 rounded transition-all duration-150 ease-in-out font-medium",A.underline?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Underline"},x[19]||(x[19]=[t("u",null,"U",-1)]),2),t("button",{type:"button",onClick:x[8]||(x[8]=P=>D()),class:"p-2 rounded transition-all duration-150 ease-in-out hover:bg-gray-200 hover:shadow-sm ml-2",title:"Clear Template"}," 🗑️ Clear ")]),$e(Le,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform -translate-y-1","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-1"},{default:Ne(()=>[Object.values(A).some(P=>P)?(n(),o("div",Ei,[x[20]||(x[20]=Ie(" Format aktif: ")),A.bold?(n(),o("span",Pi,"Bold")):u("",!0),A.italic?(n(),o("span",Di,"Italic")):u("",!0),A.underline?(n(),o("span",Ri,"Underline")):u("",!0)])):u("",!0)]),_:1}),t("div",{ref_key:"editorRef",ref:l,contenteditable:"true",class:pe(["w-full min-h-[120px] p-3 rounded-md border border-gray-300 shadow-sm transition-all duration-200 ease-in-out prose max-w-none",{"bg-white border-gray-300":!I.value,"bg-blue-50 border-indigo-500 ring-2 ring-indigo-200":I.value}]),onInput:x[9]||(x[9]=(...P)=>Ae(Y)&&Ae(Y)(...P)),onBlur:J,onFocus:G,onKeydown:Et(R,["enter"]),onPaste:d,onMouseup:V,onKeyup:V,placeholder:"Tambahkan catatan kesimpulan inspeksi di sini..."},null,34)])]))}},Gi=Ve(Li,[["__scopeId","data-v-6b429a8f"]]);export{Gn as B,Hi as C,zi as V,Vt as _,Gi as a};
