import{r as $,q as B,O as yt,c as r,o,b as x,d as t,t as d,y as dt,z as H,f as T,A as st,I as lt,F as j,a as at,G as ft,j as vt,m as V,n as Q,p as xt,g as kt,k as ht}from"./vendor-g77w9U1W.js";import{_ as _t}from"./app-BuDgqtH7.js";const wt={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},It={class:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4"},Ct={class:"flex items-center justify-between p-4 border-b"},$t={class:"text-lg font-bold"},Dt={class:"p-4"},Et={class:"space-y-4"},jt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Mt={class:"relative"},St={class:"flex justify-end space-x-3 mt-6 pt-4 border-t"},Ft=["disabled"],Tt=["disabled"],Bt={key:0},Pt={key:1},Nt={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},Rt={class:"bg-white rounded-lg shadow-xl w-96 mx-4"},At={class:"p-6"},Ut={class:"text-gray-700 mb-6"},Vt={class:"flex justify-end space-x-3"},Ot=["disabled"],qt={key:0},Lt={key:1},zt={__name:"RepairEstimationModal",props:{showModal:Boolean,estimationData:Object,inspectionId:[String,Number],encryptedIds:String},emits:["close","saved","deleted"],setup(k,{emit:w}){const v=k,h=w,b=$(!1),I=$(!1),D=B(()=>{var g;return!!((g=v.estimationData)!=null&&g.id)}),n=yt({part_name:"",repair_description:"",urgency:"segera",status:"perlu",estimated_cost:0,notes:""}),O=B({get:()=>n.estimated_cost?new Intl.NumberFormat("id-ID").format(n.estimated_cost):"",set:g=>{const a=g.replace(/[^\d]/g,"");n.estimated_cost=a?parseInt(a,10):0}}),K=()=>{n.part_name="",n.repair_description="",n.urgency="segera",n.status="perlu",n.estimated_cost=0,n.notes=""},R=g=>{const y=g.target.value.replace(/[^\d]/g,"");y?(n.estimated_cost=parseInt(y,10),g.target.value=new Intl.NumberFormat("id-ID").format(n.estimated_cost)):(n.estimated_cost=0,g.target.value="")},P=g=>{n.estimated_cost>0&&(g.target.value=new Intl.NumberFormat("id-ID").format(n.estimated_cost))};v.estimationData&&v.showModal&&Object.assign(n,v.estimationData);const N=async()=>{let g=null;D.value?h("saved",{...n,id:v.estimationData.id}):(g="temp-"+Date.now(),h("saved",{...n,id:g}));try{b.value=!0;const a=D.value?route("repair-estimations.update",{inspection:v.inspectionId,repair_estimation:v.estimationData.id}):route("repair-estimations.store",v.inspectionId),y=D.value?"put":"post",l=await at[y](a,n);h("saved",l.data),E()}catch(a){g&&h("error",g),console.error("Error saving estimation:",a),alert("Gagal menyimpan estimasi. Silakan coba lagi.")}finally{b.value=!1}},q=()=>{I.value=!0},u=async()=>{try{b.value=!0,await at.delete(route("repair-estimations.destroy",{inspection:v.inspectionId,repair_estimation:v.estimationData.id})),h("deleted",v.estimationData.id),I.value=!1,E()}catch(g){console.error("Error deleting estimation:",g),alert("Gagal menghapus estimasi. Silakan coba lagi.")}finally{b.value=!1}},E=()=>{K(),h("close")};return(g,a)=>(o(),r(j,null,[k.showModal?(o(),r("div",wt,[t("div",It,[t("div",Ct,[t("h3",$t,d(D.value?"Edit Estimasi Perbaikan":"Tambah Estimasi Perbaikan"),1),t("button",{onClick:E,class:"text-gray-400 hover:text-gray-600"},a[7]||(a[7]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",Dt,[t("form",{onSubmit:dt(N,["prevent"])},[t("div",Et,[t("div",null,[a[8]||(a[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[T(" Nama Part/Komponen "),t("span",{class:"text-red-500"},"*")],-1)),H(t("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=y=>n.part_name=y),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Contoh: Radiator, Rem Depan, dll"},null,512),[[st,n.part_name]])]),t("div",null,[a[9]||(a[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[T(" Deskripsi Perbaikan "),t("span",{class:"text-red-500"},"*")],-1)),H(t("textarea",{"onUpdate:modelValue":a[1]||(a[1]=y=>n.repair_description=y),required:"",rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Jelaskan jenis perbaikan yang diperlukan"},null,512),[[st,n.repair_description]])]),t("div",jt,[t("div",null,[a[11]||(a[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[T(" Urgensi "),t("span",{class:"text-red-500"},"*")],-1)),H(t("select",{"onUpdate:modelValue":a[2]||(a[2]=y=>n.urgency=y),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},a[10]||(a[10]=[t("option",{value:"segera"},"Segera",-1),t("option",{value:"jangka_panjang"},"Jangka Panjang",-1)]),512),[[lt,n.urgency]])]),t("div",null,[a[13]||(a[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[T(" Status "),t("span",{class:"text-red-500"},"*")],-1)),H(t("select",{"onUpdate:modelValue":a[3]||(a[3]=y=>n.status=y),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},a[12]||(a[12]=[t("option",{value:"perlu"},"Perlu",-1),t("option",{value:"disarankan"},"Disarankan",-1),t("option",{value:"opsional"},"Opsional",-1)]),512),[[lt,n.status]])])]),t("div",null,[a[15]||(a[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[T(" Estimasi Biaya (Rp) "),t("span",{class:"text-red-500"},"*")],-1)),t("div",Mt,[a[14]||(a[14]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("span",{class:"text-gray-500"},"Rp")],-1)),H(t("input",{type:"text","onUpdate:modelValue":a[4]||(a[4]=y=>O.value=y),onInput:R,onBlur:P,required:"",class:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"},null,544),[[st,O.value]])]),a[16]||(a[16]=t("p",{class:"text-xs text-gray-500 mt-1"}," Masukkan angka tanpa titik atau koma ",-1))]),t("div",null,[a[17]||(a[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Catatan Tambahan ",-1)),H(t("textarea",{"onUpdate:modelValue":a[5]||(a[5]=y=>n.notes=y),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Catatan khusus atau informasi tambahan"},null,512),[[st,n.notes]])])]),t("div",St,[t("button",{type:"button",onClick:E,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500"}," Batal "),D.value?(o(),r("button",{key:0,type:"button",onClick:q,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",disabled:b.value}," Hapus ",8,Ft)):x("",!0),t("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b.value},[b.value?(o(),r("span",Bt,a[18]||(a[18]=[t("svg",{class:"animate-spin h-5 w-5 inline-block",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),T(" Menyimpan... ")]))):(o(),r("span",Pt,d(D.value?"Update":"Simpan"),1))],8,Tt)])],32)])])])):x("",!0),I.value?(o(),r("div",Nt,[t("div",Rt,[t("div",At,[a[21]||(a[21]=t("h3",{class:"text-lg font-bold mb-4"},"Konfirmasi Hapus",-1)),t("p",Ut,[a[19]||(a[19]=T(' Apakah Anda yakin ingin menghapus estimasi perbaikan untuk "')),t("strong",null,d(n.part_name),1),a[20]||(a[20]=T('"? '))]),t("div",Vt,[t("button",{onClick:a[6]||(a[6]=y=>I.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),t("button",{onClick:u,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",disabled:b.value},[b.value?(o(),r("span",qt,"Menghapus...")):(o(),r("span",Lt,"Ya, Hapus"))],8,Ot)])])])])):x("",!0)],64))}},Ht={class:"mt-8 pt-6 border-t border-gray-300"},Kt={class:"flex justify-between items-center mb-4"},Gt={key:0,class:"overflow-x-auto"},Jt={class:"w-full border-collapse border border-gray-300 rounded-lg overflow-hidden"},Wt={class:"bg-gray-100"},Yt={key:0,class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},Qt={class:"p-3 border border-gray-300"},Xt={class:"p-3 border border-gray-300 font-medium"},Zt={class:"p-3 border border-gray-300"},te={class:"p-3 border border-gray-300"},ee={class:"flex flex-col gap-1"},se={class:"p-3 border border-gray-300 font-bold text-right"},oe={key:0,class:"p-3 border border-gray-300"},ae={class:"flex gap-2"},re=["onClick"],ne=["onClick"],ie={class:"bg-gray-100"},le=["colspan"],de={key:1,class:"text-center py-8 border border-dashed border-gray-300 rounded-lg"},ue={__name:"RepairEstimationSection",props:{estimations:{type:Array,default:()=>[]},inspectionId:{type:[String,Number],required:!0},encryptedIds:{type:String,required:!0},canEdit:{type:Boolean,default:!1}},emits:["update:estimations","update:totalCost"],setup(k,{emit:w}){const v=k,h=w,b=$(!1),I=$(null),D=B(()=>v.estimations.reduce((l,i)=>l+parseFloat(i.estimated_cost||0),0));ft(D,l=>{h("update:totalCost",l)});const n=l=>l?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(l):"Rp 0",O=l=>l==="segera"?"Segera":"Jangka Panjang",K=l=>({perlu:"Perlu",disarankan:"Disarankan",opsional:"Opsional"})[l]||l,R=l=>`inline-block px-2 py-1 rounded-full text-xs font-medium ${{segera:"bg-red-100 text-red-800",jangka_panjang:"bg-yellow-100 text-yellow-800"}[l]||"bg-gray-100 text-gray-800"}`,P=l=>`inline-block px-2 py-1 rounded-full text-xs font-medium ${{perlu:"bg-red-100 text-red-800",disarankan:"bg-yellow-100 text-yellow-800",opsional:"bg-blue-100 text-blue-800"}[l]||"bg-gray-100 text-gray-800"}`,N=()=>{I.value=null,b.value=!0},q=l=>{I.value=l,b.value=!0},u=l=>{I.value=l,b.value=!0},E=()=>{b.value=!1,I.value=null},g=l=>{const i=v.estimations.findIndex(f=>f.id===l.id);if(i!==-1){const f=[...v.estimations];f[i]=l,h("update:estimations",f)}else h("update:estimations",[...v.estimations,l]);E()},a=l=>{const i=v.estimations.filter(f=>f.id!==l);h("update:estimations",i),E()},y=l=>{const i=v.estimations.filter(f=>f.id!==l);h("update:estimations",i)};return(l,i)=>(o(),r("div",Ht,[t("div",Kt,[i[1]||(i[1]=t("h2",{class:"text-2xl font-bold text-gray-800"},"Estimasi Perbaikan",-1)),k.canEdit?(o(),r("button",{key:0,onClick:N,class:"bg-green-600 text-white px-4 py-2 rounded-lg shadow hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors duration-200 flex items-center gap-2"},i[0]||(i[0]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),T(" Tambah Estimasi ")]))):x("",!0)]),k.estimations.length>0?(o(),r("div",Gt,[t("table",Jt,[t("thead",Wt,[t("tr",null,[i[2]||(i[2]=t("th",{class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},"No",-1)),i[3]||(i[3]=t("th",{class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},"Part/Komponen",-1)),i[4]||(i[4]=t("th",{class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},"Deskripsi Perbaikan",-1)),i[5]||(i[5]=t("th",{class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},"Urgensi & Status",-1)),i[6]||(i[6]=t("th",{class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},"Estimasi Biaya",-1)),k.canEdit?(o(),r("th",Yt,"Aksi")):x("",!0)])]),t("tbody",null,[(o(!0),r(j,null,V(k.estimations,(f,X)=>(o(),r("tr",{key:f.id,class:Q(X%2===0?"bg-white":"bg-gray-50")},[t("td",Qt,d(X+1),1),t("td",Xt,d(f.part_name),1),t("td",Zt,d(f.repair_description),1),t("td",te,[t("div",ee,[t("span",{class:Q(R(f.urgency))},d(O(f.urgency)),3),t("span",{class:Q(P(f.status))},d(K(f.status)),3)])]),t("td",se,d(n(f.estimated_cost)),1),k.canEdit?(o(),r("td",oe,[t("div",ae,[t("button",{onClick:G=>q(f),class:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm"}," Edit ",8,re),t("button",{onClick:G=>u(f),class:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm"}," Hapus ",8,ne)])])):x("",!0)],2))),128))]),t("tfoot",ie,[t("tr",null,[i[7]||(i[7]=t("td",{colspan:"4",class:"p-3 border border-gray-300 text-right font-bold"}," Total Estimasi: ",-1)),t("td",{colspan:k.canEdit?2:1,class:"p-3 border border-gray-300 font-bold text-right text-green-700"},d(n(D.value)),9,le)])])])])):(o(),r("div",de,[i[8]||(i[8]=t("svg",{class:"w-12 h-12 text-gray-400 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),i[9]||(i[9]=t("p",{class:"text-gray-500"},"Belum ada estimasi perbaikan.",-1)),k.canEdit?(o(),r("button",{key:0,onClick:N,class:"mt-3 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700"}," Tambah Estimasi Pertama ")):x("",!0)])),b.value?(o(),vt(zt,{key:2,"show-modal":b.value,"estimation-data":I.value,"inspection-id":k.inspectionId,"encrypted-ids":k.encryptedIds,onClose:E,onSaved:g,onDeleted:a,onError:y},null,8,["show-modal","estimation-data","inspection-id","encrypted-ids"])):x("",!0)]))}},ce={class:"p-6 bg-white rounded-lg shadow-md"},ge={key:0,class:"mt-2 mb-6"},pe={key:1},me={class:"header flex flex-col gap-5 mb-6 mt-6"},be={class:"flex items-center gap-5"},ye=["src"],fe={key:1,class:"w-40 h-40 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-gray-400"},ve={class:"mt-8"},xe={class:"text-3xl font-bold m-0 text-gray-800"},ke={key:0,class:"car-info"},he={class:"w-full border-collapse border border-gray-300 rounded-lg overflow-hidden"},_e={class:"bg-gray-50"},we={class:"p-2 border border-gray-300 text-gray-600"},Ie={class:"bg-gray-50"},Ce={class:"p-2 border border-gray-300 text-gray-600"},$e={class:"p-2 border border-gray-300 text-gray-600"},De={class:"bg-gray-50"},Ee={class:"p-2 border border-gray-300 text-gray-600"},je={class:"p-2 border border-gray-300 text-gray-600"},Me={class:"bg-gray-50"},Se={class:"p-2 border border-gray-300 text-gray-600"},Fe={class:"p-2 border border-gray-300 text-gray-600"},Te={class:"bg-gray-50"},Be={class:"p-2 border border-gray-300 text-gray-600"},Pe={class:"p-2 border border-gray-300 text-gray-600"},Ne={class:"bg-gray-50"},Re={class:"p-2 border border-gray-300 text-gray-600"},Ae={class:"bg-gray-50"},Ue={class:"p-2 border border-gray-300 text-gray-600"},Ve={class:"bg-gray-50"},Oe={class:"p-2 border border-gray-300 text-gray-600"},qe={class:"bg-gray-50"},Le={class:"p-2 border border-gray-300 text-gray-600"},ze={class:"bg-gray-50"},He={class:"p-2 border border-gray-300 text-gray-600"},Ke={key:1,class:"conclusion p-4 bg-gray-50 border-l-4 border-gray-800 rounded-lg"},Ge={class:"m-0 text-gray-600"},Je=["innerHTML"],We={class:"component-title bg-gray-100 px-3 py-2 border-l-4 border-gray-800 font-bold rounded-l-lg"},Ye={key:0,class:"images flex flex-wrap gap-2 mt-4"},Qe=["src","onClick"],Xe={key:1,class:"w-28 h-28 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-xs text-gray-400"},Ze={class:"point-name inline-block min-w-[160px] font-bold align-top text-gray-700"},ts={class:"point-content inline-block w-[calc(100%-70px)] align-top"},es={key:0,class:"status-badges-container"},ss={key:1,class:"point-note italic text-gray-600 my-1"},os={key:0,class:"inspection-images flex flex-wrap gap-2 mt-4"},as=["src","onClick"],rs={key:1,class:"w-20 h-20 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-xs text-gray-400"},ns={key:1,class:"textarea-note italic text-gray-600 my-2"},is={key:2,class:"flex flex-col items-center justify-center h-96 text-center"},ls=["href"],ds={key:3,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},us={class:"bg-white p-6 rounded-lg shadow-xl w-96 max-w-sm"},cs={class:"flex justify-end space-x-4"},gs=["disabled"],ps={key:0},ms={key:1},bs={key:1,class:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors duration-200 cursor-not-allowed"},ys={class:"relative w-full h-full flex items-center justify-center p-4"},fs=["src"],vs={key:1,class:"text-white text-lg"},xs={__name:"ReviewPDF",props:{inspection:{type:Object,required:!0},menu_points:{type:Array,default:()=>[]},coverImage:{type:Object,default:null},encryptedIds:Object,repairEstimations:{type:Array,default:()=>[]},totalRepairCost:{type:Number,default:0}},setup(k){const w=k,v=xt(),h=$(!1),b=$(!1),I=$(w.repairEstimations),D=$(w.totalRepairCost),n=B(()=>{var s;return((s=v.props.global)==null?void 0:s.has_roles)||[]});B(()=>n.value.includes("quality_control")||n.value.includes("qc"));const O=B(()=>(n.value.includes("quality_control")||n.value.includes("qc"))&&u.value.status==="pending_review"),K=B(()=>(n.value.includes("quality_control")||n.value.includes("qc"))&&u.value.status==="pending_review"),R=$(!1),P=$(""),N=s=>{P.value=s,R.value=!0},q=()=>{R.value=!1,P.value=""},u=$(w.inspection),E=$(w.menu_points),g=$(w.coverImage),a=async()=>{if(u.value.status==="in_progress")try{const s=await at.get(route("inspections.detail",w.encryptedIds));u.value=s.data.inspection,E.value=s.data.menu_points,g.value=s.data.coverImage,I.value=s.data.repairEstimations||[],D.value=s.data.totalRepairCost||0}catch(s){console.error("Polling gagal:",s)}};kt(()=>{setInterval(a,5e3)});const y=s=>{I.value=s},l=s=>{D.value=s},i=B(()=>{if(!E.value)return[];const s=new Map;E.value.forEach(c=>{var C;const p=(C=c.inspection_point)==null?void 0:C.component,m=(p==null?void 0:p.id)||0;s.has(m)||s.set(m,{component:p||{id:0,name:"Tanpa Komponen",order:9999},points:[]}),s.get(m).points.push(c)});const e=Array.from(s.values()).sort((c,p)=>c.component.order===p.component.order?new Date(c.component.created_at)-new Date(p.component.created_at):(c.component.order||9999)-(p.component.order||9999));return e.forEach(c=>{c.points.sort((p,m)=>p.order===m.order?new Date(p.created_at)-new Date(m.created_at):(p.order||9999)-(m.order||9999))}),e}),f=()=>{b.value=!0,setTimeout(()=>{window.location.href=route("inspections.download.pdf",w.encryptedIds),b.value=!1,h.value=!1},2e3)},X=B(()=>{const s=w.menu_points.some(c=>J(c)||W(c)),e=w.coverImage&&w.coverImage.image_path;return s||e}),G=s=>s&&s.length>0,L=s=>`/${s}`,J=s=>{var e;return((e=s.inspection_point)==null?void 0:e.results)&&s.inspection_point.results.length>0},W=s=>{var e;return((e=s.inspection_point)==null?void 0:e.images)&&s.inspection_point.images.length>0},rt=s=>J(s)&&s.inspection_point.results[0].note,Z=s=>{var c,p;if(!J(s))return[];const e=(p=(c=s.inspection_point)==null?void 0:c.results[0])==null?void 0:p.status;return e?Array.isArray(e)?e:typeof e=="string"&&e.includes(",")?e.split(",").map(m=>m.trim()).filter(m=>m.length>0):[e]:[]},ut=s=>{const e=s.input_type||"",c=Z(s);return["radio","imageTOradio"].includes(e)&&c.length>0},ct=s=>{const e=s.input_type||"";return["text","number","date","textarea"].includes(e)&&rt(s)},gt=s=>{var p,m,C;const e=s.input_type||"",c=s.settings||{};if((p=s.inspection_point)!=null&&p.results[0],e==="image"&&W(s)||e==="imageTOradio"&&W(s))return!0;if(e==="radio"){const M=Z(s);for(const A of M)if((((C=(((m=c.radios)==null?void 0:m.find(et=>et.value===A))||{}).settings)==null?void 0:C.show_image_upload)||!1)&&W(s))return!0}return!1},pt=s=>{var p,m,C;const e=s.settings||{};(p=s.inspection_point)!=null&&p.results[0];const c=Z(s);for(const M of c)if((C=(((m=e.radios)==null?void 0:m.find(z=>z.value===M))||{}).settings)!=null&&C.show_textarea)return!0;return!1},mt=s=>{if(!s)return"status-warning";const e=String(s).toLowerCase().trim();return["normal","ada","baik","good","ok"].includes(e)?"status-good":["tidak normal","tidak ada","rusak","bad","not ok"].includes(e)?"status-bad":"status-warning"},bt=s=>{var m;const e=s.input_type||"",c=((m=s.inspection_point)==null?void 0:m.results[0])||{},p=s.settings||{};if(e==="account"&&c.note){const C=c.note.replace(/[^\d.-]/g,""),M=parseFloat(C);if(isNaN(M))return c.note;const A=p.currency_symbol||"Rp";return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:2}).format(M).replace("Rp",A)}return c.note};return(s,e)=>{var c,p,m,C,M,A,z,tt,et,nt,it;return o(),r("div",ce,[K.value?(o(),r("div",ge,[t("button",{onClick:e[0]||(e[0]=S=>h.value=!0),class:"bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200"}," Setujui Laporan "),e[4]||(e[4]=t("p",{class:"text-sm text-gray-500 mt-2 italic"}," Catatan: Halaman ini hanya simulasi dan mungkin berbeda dengan tampilan file PDF. Silakan periksa lebih detail untuk memastikan tidak ada kesalahan. Jika sudah yakin, silakan setujui untuk proses selanjutnya. ",-1))])):x("",!0),X.value?(o(),r("div",pe,[t("div",me,[t("div",be,[g.value&&G(g.value.image_path)?(o(),r("img",{key:0,src:L(g.value.image_path),alt:"Foto Utama",class:"w-40 h-40 object-cover rounded-lg border border-gray-300 cursor-pointer hover:opacity-90 transition-opacity",onClick:e[1]||(e[1]=S=>N(L(g.value.image_path)))},null,8,ye)):(o(),r("div",fe,e[5]||(e[5]=[t("span",null,"Gambar tidak tersedia",-1)]))),t("div",ve,[t("h2",xe,d(u.value.car_name),1)])]),u.value.car_id?(o(),r("div",ke,[t("table",he,[t("tr",_e,[e[6]||(e[6]=t("td",{class:"p-2 border border-gray-300 font-bold w-1/3 text-gray-700"},"ID Order",-1)),t("td",we,d(u.value.order_code),1)]),t("tr",Ie,[e[7]||(e[7]=t("td",{class:"p-2 border border-gray-300 font-bold w-1/3 text-gray-700"},"Nomor Polisi",-1)),t("td",Ce,d(u.value.plate_number),1)]),t("tr",null,[e[8]||(e[8]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Merek",-1)),t("td",$e,d((p=(c=u.value.car)==null?void 0:c.brand)==null?void 0:p.name),1)]),t("tr",De,[e[9]||(e[9]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Model",-1)),t("td",Ee,d((C=(m=u.value.car)==null?void 0:m.model)==null?void 0:C.name),1)]),t("tr",null,[e[10]||(e[10]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Tipe",-1)),t("td",je,d((A=(M=u.value.car)==null?void 0:M.type)==null?void 0:A.name),1)]),t("tr",Me,[e[11]||(e[11]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"CC",-1)),t("td",Se,d((z=u.value.car)==null?void 0:z.cc),1)]),t("tr",null,[e[12]||(e[12]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Bahan Bakar",-1)),t("td",Fe,d((tt=u.value.car)==null?void 0:tt.fuel_type),1)]),t("tr",Te,[e[13]||(e[13]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Transmisi",-1)),t("td",Be,d((et=u.value.car)==null?void 0:et.transmission),1)]),t("tr",null,[e[14]||(e[14]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Periode Model",-1)),t("td",Pe,d(((nt=u.value.car)==null?void 0:nt.production_period)||"-"),1)]),t("tr",Ne,[e[15]||(e[15]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Tahun Pembuatan",-1)),t("td",Re,d((it=u.value.car)==null?void 0:it.year),1)]),t("tr",Ae,[e[16]||(e[16]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Warna",-1)),t("td",Ue,d(u.value.color),1)]),t("tr",Ve,[e[17]||(e[17]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"No Rangka",-1)),t("td",Oe,d(u.value.noka),1)]),t("tr",qe,[e[18]||(e[18]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"No Mesin",-1)),t("td",Le,d(u.value.nosin),1)]),t("tr",ze,[e[19]||(e[19]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"KM",-1)),t("td",He,d(u.value.km),1)])])])):x("",!0),u.value.notes?(o(),r("div",Ke,[e[20]||(e[20]=t("h3",{class:"text-lg font-bold mb-2 text-gray-800"},"Kesimpulan Inspeksi:",-1)),t("p",Ge,[t("div",{innerHTML:u.value.notes||"-"},null,8,Je)])])):x("",!0)]),e[23]||(e[23]=t("h2",{class:"text-2xl font-bold border-b-2 border-gray-800 pb-2 mb-6"},"Hasil Inspeksi",-1)),(o(!0),r(j,null,V(i.value,S=>(o(),r("div",{key:S.component.id,class:Q(["section mb-6",S.component.name==="Foto Kendaraan"?"photo-component":""])},[t("div",We,d(S.component.name||"Tanpa Komponen"),1),S.component.name==="Foto Kendaraan"?(o(),r("div",Ye,[(o(!0),r(j,null,V(S.points,_=>{var Y;return o(),r("div",{key:_.id},[(o(!0),r(j,null,V((Y=_.inspection_point)==null?void 0:Y.images,(U,ot)=>(o(),r("div",{key:U.id,class:"image-container"},[G(U.image_path)?(o(),r("img",{key:0,src:L(U.image_path),alt:"Foto Kendaraan",class:"w-28 h-28 object-cover border border-gray-300 rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:F=>N(L(U.image_path))},null,8,Qe)):(o(),r("div",Xe,e[21]||(e[21]=[t("span",null,"Gambar tidak ditemukan",-1)])))]))),128))])}),128))])):(o(!0),r(j,{key:1},V(S.points,_=>{var Y,U,ot;return o(),r("div",{key:_.id,class:"point ml-4 py-3 border-b border-gray-100"},[J(_)||W(_)?(o(),r(j,{key:0},[t("span",Ze,d(((Y=_.inspection_point)==null?void 0:Y.name)||"-"),1),t("div",ts,[J(_)?(o(),r(j,{key:0},[ut(_)?(o(),r("div",es,[(o(!0),r(j,null,V(Z(_),F=>(o(),r("span",{key:F,class:Q(["status-badge",mt(F)])},d(F.trim()),3))),128))])):x("",!0),ct(_)?(o(),r("div",ss,d(bt(_)),1)):x("",!0)],64)):x("",!0)]),gt(_)?(o(),r("div",os,[(o(!0),r(j,null,V((U=_.inspection_point)==null?void 0:U.images,(F,ks)=>(o(),r("div",{key:F.id,class:"image-container"},[G(F.image_path)?(o(),r("img",{key:0,src:L(F.image_path),alt:"image",class:"w-20 h-20 object-cover border border-gray-300 rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:hs=>N(L(F.image_path))},null,8,as)):(o(),r("div",rs,e[22]||(e[22]=[t("span",null,"Gambar tidak ditemukan",-1)])))]))),128))])):x("",!0),pt(_)&&rt(_)?(o(),r("div",ns,d((ot=_.inspection_point)==null?void 0:ot.results[0].note),1)):x("",!0)],64)):x("",!0)])}),128))],2))),128)),ht(ue,{estimations:I.value,"inspection-id":u.value.id,"encrypted-ids":k.encryptedIds,"can-edit":O.value,"onUpdate:estimations":y,"onUpdate:totalCost":l},null,8,["estimations","inspection-id","encrypted-ids","can-edit"])])):(o(),r("div",is,[e[24]||(e[24]=t("p",{class:"text-lg font-semibold text-gray-700"}," Data sudah tidak ada, karena sudah dijadikan PDF. ",-1)),t("a",{href:s.route("inspections.download.approved.pdf",k.encryptedIds),class:"mt-4 inline-block bg-blue-600 text-white px-6 py-3 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}," Download PDF ",8,ls)])),h.value?(o(),r("div",ds,[t("div",us,[e[26]||(e[26]=t("h3",{class:"text-lg font-bold mb-4"},"Konfirmasi Laporan",-1)),e[27]||(e[27]=t("p",{class:"text-gray-700 mb-6"}," Apakah Anda yakin semua data sudah sesuai? Setelah disetujui, laporan akan diproses menjadi file PDF. ",-1)),t("div",cs,[t("button",{onClick:e[2]||(e[2]=S=>h.value=!1),class:"bg-gray-300 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-400"}," Batal "),u.value.file?(o(),r("button",bs,e[25]||(e[25]=[t("span",null,"Laporan sudah di buat",-1)]))):(o(),r("button",{key:0,onClick:f,class:"bg-sky-600 text-white px-4 py-2 rounded-lg hover:bg-sky-700 transition-colors duration-200",disabled:b.value},[b.value?(o(),r("span",ps,"Membuat file PDF...")):(o(),r("span",ms,"Setujui Laporan"))],8,gs))])])])):x("",!0),R.value?(o(),r("div",{key:4,class:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:q},[t("div",ys,[t("button",{onClick:q,class:"absolute top-4 right-4 z-10 bg-black bg-opacity-50 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-opacity-70 transition-all"},e[28]||(e[28]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),P.value?(o(),r("img",{key:0,src:P.value,alt:"Full size image",class:"max-w-[90vw] max-h-[90vh] w-auto h-auto object-contain",onClick:e[3]||(e[3]=dt(()=>{},["stop"]))},null,8,fs)):(o(),r("div",vs," Gambar tidak dapat dimuat "))])])):x("",!0)])}}},Is=_t(xs,[["__scopeId","data-v-974ba95a"]]);export{Is as default};
