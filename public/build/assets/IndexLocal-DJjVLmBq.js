import{x as an,r as $,g as ot,q as J,H as Pt,G as re,c as l,o as i,d as e,b as g,k as fe,z as De,A as xt,n as Q,t as O,F as ke,m as Ce,f as _e,u as Y,e as xn,y as ct,w as Be,L as wt,M as Dt,a as Rt,j as Le,l as nn,T as gt,N as Mt,p as wn,O as sn,D as Bt,J as st,B as kn,S as In,I as jt,W as Nt}from"./vendor-CUNG9NG6.js";import{l as ln}from"./lodash-CeUj5J-L.js";import{_ as _n}from"./PrimaryButton-h2qnLbgr.js";import{_ as Sn}from"./ActionMessage-C19FCsLq.js";import{F as $n}from"./fuse-Ch1WBRTM.js";import{_ as Ye}from"./app-cu8ZgYRt.js";import{_ as rn}from"./InputNumber-BM446ncS.js";const Cn={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},An={key:0,class:"p-4 space-y-2"},Vn={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Tn={class:"flex items-center space-x-2"},Un={key:0,class:"text-xs text-red-500 font-normal ml-2"},En={key:1,class:"text-xs text-red-500 font-normal ml-2"},Nn={key:2,class:"text-xs text-green-500 font-normal ml-2"},Mn={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Dn={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},Pn={class:"col-span-2 flex space-x-3"},Ln={class:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},Rn={class:"flex items-start"},jn={class:"text-sm text-blue-700"},Bn={class:"mt-1"},On={key:0,class:"inline-flex items-center px-2 py-1 rounded bg-blue-100 text-blue-800 text-xs font-medium mr-2"},Fn={key:1,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium mr-2"},Kn={key:2,class:"inline-flex items-center px-2 py-1 rounded bg-green-100 text-green-800 text-xs font-medium"},qn={key:3,class:"text-blue-600"},zn={class:"space-y-2 pb-2 border-b border-gray-100 last:border-0 last:pb-0"},Hn={class:"relative"},Gn={key:0,class:"absolute right-3 top-3"},Wn={key:1,class:"mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},Jn={key:0},Yn=["onMousedown"],Zn={class:"font-medium text-gray-900"},Xn={class:"text-sm text-gray-500"},Qn={key:1,class:"p-4 text-sm text-gray-500 text-center"},es={key:0,class:"text-xs text-red-500 font-normal ml-2"},ts={key:0,class:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},ns={key:1,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},ss={key:0,class:"mb-4"},os=["innerHTML"],as={key:1},is={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},ls=["onClick"],rs=["src","alt"],us={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},ds={class:"text-white text-xs text-center"},cs={key:2,class:"text-center py-4 text-gray-500 text-sm"},gs={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},ps=["src","alt"],ms={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},vs={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},fs={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},hs={__name:"VehicleDetails",props:{inspection:{type:Object,default:null},CarDetail:Array,allInspections:{type:Array,default:()=>[]}},emits:["update-vehicle","update:validation","update:hasUnsavedChanges","update:vehicle-type"],setup(n,{emit:Z}){var G,he,o,c,p,V;const t=n,C=Z,m=an({plate_number:((G=t.inspection)==null?void 0:G.plate_number)||"",car_id:((he=t.inspection)==null?void 0:he.car_id)||null,car_name:((o=t.inspection)==null?void 0:o.car_name)||""}),S=$(((c=t.inspection)==null?void 0:c.plate_number)||""),I=$(((p=t.inspection)==null?void 0:p.car_id)||null),M=$(((V=t.inspection)==null?void 0:V.car_name)||""),b=$(""),K=$(""),U=$(""),L=$(null),N=$({rear_door:!1}),W=$(!1),f=$(""),v=$(""),A=$(m.car_name),P=$(!1),T=$(!1),F=$([]),H=$(null),R=$([]),k=$(!1),D=$(0);ot(()=>{var u,d,q,y,j;if(B((u=t.inspection)==null?void 0:u.plate_number),(d=t.inspection)!=null&&d.car_id&&((q=t.CarDetail)==null?void 0:q.length)>0){const te=t.CarDetail.find(oe=>oe.id===t.inspection.car_id);te&&we(te)}else!((y=t.inspection)!=null&&y.car_id)&&((j=t.inspection)!=null&&j.car_name)&&(A.value=t.inspection.car_name,m.car_id=null);window.addEventListener("keydown",Ee),ne(),C("update:hasUnsavedChanges",ue.value),C("update:validation",ve.value)}),Pt(()=>{window.removeEventListener("keydown",Ee)});const ne=()=>{try{const u=localStorage.getItem("vehicle_features");if(u){const d=JSON.parse(u);N.value.rear_door=d.rear_door||!1,d.pick_up?L.value="pick_up":d.box?L.value="box":L.value=null}else N.value.rear_door=!1,L.value=null;x()}catch(u){console.error("Error loading vehicle type from localStorage:",u),N.value.rear_door=!1,L.value=null,x()}},w=()=>{N.value.rear_door=!N.value.rear_door,s()},h=u=>{L.value===u?L.value=null:L.value=u,s()},s=()=>{try{const u={rear_door:N.value.rear_door,pick_up:L.value==="pick_up",box:L.value==="box"};localStorage.setItem("vehicle_features",JSON.stringify(u)),x(),console.log("Vehicle features saved to localStorage:",u)}catch(u){console.error("Error saving vehicle type to localStorage:",u)}},x=()=>{const u={rear_door:N.value.rear_door,pick_up:L.value==="pick_up",box:L.value==="box"};C("update:vehicle-type",u)},B=u=>{if(!u){b.value="",K.value="",U.value="";return}const d=u.toUpperCase().trim(),q=d.match(/^([A-Z]{1,2})?([0-9]{1,4})?([A-Z]{1,3})?$/);if(q)b.value=q[1]||"",K.value=q[2]||"",U.value=q[3]||"";else{let y="area",j="",te="",oe="";for(const ie of d)y==="area"&&/[A-Z]/.test(ie)?j+=ie:y==="area"&&/[0-9]/.test(ie)?(y="number",te+=ie):y==="number"&&/[0-9]/.test(ie)?te+=ie:y==="number"&&/[A-Z]/.test(ie)?(y="suffix",oe+=ie):y==="suffix"&&/[A-Z]/.test(ie)&&(oe+=ie);b.value=j,K.value=te,U.value=oe}se()},se=()=>{const u=`${b.value}${K.value}${U.value}`;m.plate_number=u,Te()},be=u=>{u==="area"?b.value=b.value.toUpperCase().replace(/[^A-Z]/g,""):u==="number"?K.value=K.value.replace(/[^0-9]/g,""):u==="suffix"&&(U.value=U.value.toUpperCase().replace(/[^A-Z]/g,"")),se()},ce=J(()=>{const u=m.plate_number;return/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test(u)}),ye=J(()=>!A.value||A.value.trim()===""),Se=J(()=>m.plate_number.length>0&&!ce.value?"Format plat nomor tidak valid.":null),ve=J(()=>{const u=!m.plate_number||m.plate_number.trim()==="",d=!A.value||A.value.trim()==="";return u||d||!ce.value||W.value}),ue=J(()=>{const u=m.plate_number!==S.value,d=m.car_id!==I.value||A.value!==M.value;return u||d}),xe=J(()=>ue.value&&!ve.value),pe=u=>{var q,y,j;if(!u)return"";const d=[];return(q=u.brand)!=null&&q.name&&d.push(u.brand.name),(y=u.model)!=null&&y.name&&d.push(u.model.name),(j=u.type)!=null&&j.name&&d.push(u.type.name),u.cc&&d.push((u.cc/1e3).toFixed(1)),u.transmission&&d.push(u.transmission),u.year&&d.push(u.year.toString()),u.fuel_type&&d.push(u.fuel_type),u.production_period&&d.push(`(${u.production_period})`),d.join(" ")},me=ln.debounce(()=>{if(!A.value.trim()){F.value=[],P.value=!1;return}T.value=!0;try{const u=A.value.trim();if(t.CarDetail&&t.CarDetail.length>0){const d=t.CarDetail.map(j=>({...j,formattedName:pe(j)})),y=new $n(d,{keys:["formattedName","brand.name","model.name","type.name"],threshold:.6,findAllMatches:!0,includeScore:!0,shouldSort:!0}).search(u).slice(0,10);F.value=y.map(j=>j.item)}else F.value=[];P.value=!0}finally{T.value=!1}},300),Oe=()=>{if(m.car_id&&(m.car_id=null,H.value=null,R.value=[]),!A.value.trim()){F.value=[],P.value=!1;return}me()},Fe=()=>{setTimeout(()=>{P.value=!1,!m.car_id&&A.value&&(m.car_name=A.value,Te())},200)},we=async u=>{H.value=u,A.value=pe(u),m.car_id=u.id,m.car_name=pe(u),P.value=!1,me.cancel(),await Ae(u.id),Te(),C("update:hasUnsavedChanges",ue.value),C("update:validation",ve.value)},Ue=u=>!u||!u.file_path?"":`/storage/${u.file_path}`,Ae=async u=>{try{const d=await fetch(`/api/cars/${u}/images`);if(d.ok){const q=await d.json();R.value=Array.isArray(q)?q:[]}else R.value=[]}catch(d){console.error("Error loading car images:",d),R.value=[]}},le=u=>{D.value=u,k.value=!0,document.body.style.overflow="hidden"},$e=()=>{k.value=!1,document.body.style.overflow=""},Ve=()=>{D.value=(D.value+1)%R.value.length},Ie=()=>{D.value=(D.value-1+R.value.length)%R.value.length},Ee=u=>{if(k.value)switch(u.key){case"Escape":$e();break;case"ArrowRight":Ve();break;case"ArrowLeft":Ie();break}},Te=()=>{const u={plate_number:m.plate_number,car_id:m.car_id,car_name:m.car_name};C("update-vehicle",u)},Re=()=>{t.inspection&&m.post(route("inspections.updateVehicleDetails",{inspection:t.inspection.id}),{preserveScroll:!0,onSuccess:()=>{S.value=m.plate_number,I.value=m.car_id,M.value=m.car_name,C("update:hasUnsavedChanges",!1),console.log("Data berhasil disimpan!")},onError:u=>{console.error("Gagal menyimpan data:",u)}})};return re([()=>m.plate_number,()=>m.car_name],u=>{f.value="",W.value=!1,v.value="";const d=u[0];if(d&&d.length>=6){const q=t.allInspections.filter(y=>{var j;return y.plate_number===d&&y.id!==((j=t.inspection)==null?void 0:j.id)});if(q.length>0){const y=["draft","in_progress","pending","pending_review","revision"],j=q.find(te=>y.includes(te.status));if(j)W.value=!0,f.value=`Nomor plat ini sedang dalam proses inspeksi dengan status: ${j.status.replace(/_/g," ").toUpperCase()}.`;else{const te=q.filter(oe=>["approved","rejected","completed","cancelled"].includes(oe.status));if(te.length>0){te.sort((ie,Ne)=>new Date(Ne.created_at)-new Date(ie.created_at));const oe=te[0];if(oe.car_id){const ie=t.CarDetail.find(Ne=>Ne.id===oe.car_id);ie&&we(ie)}else oe.car_name&&(A.value=oe.car_name,m.car_name=oe.car_name,m.car_id=null);v.value=`Nomor plat ini sudah pernah diperiksa ${te.length} kali sebelumnya.`}}}}C("update:hasUnsavedChanges",ue.value),C("update:validation",ve.value)},{deep:!0}),re([()=>N.value.rear_door,()=>L.value],()=>{s()}),re(()=>{var u;return(u=t.inspection)==null?void 0:u.car_id},u=>{var d,q;if(u!==m.car_id)if(m.car_id=u,u&&((d=t.CarDetail)==null?void 0:d.length)>0){const y=t.CarDetail.find(j=>j.id===u);y&&we(y)}else!u&&((q=t.inspection)!=null&&q.car_name)&&(A.value=t.inspection.car_name,m.car_name=t.inspection.car_name,m.car_id=null)}),re(()=>{var u;return(u=t.inspection)==null?void 0:u.car_name},u=>{u&&u!==A.value&&(A.value=u)}),(u,d)=>{var q;return i(),l("div",Cn,[d[27]||(d[27]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),n.inspection?(i(),l("div",An,[e("div",Vn,[d[11]||(d[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nomor Plat Kendaraan ",-1)),e("div",Tn,[De(e("input",{"onUpdate:modelValue":d[0]||(d[0]=y=>b.value=y),type:"text",placeholder:"Contoh: B",class:Q(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!ce.value||W.value}]),onInput:d[1]||(d[1]=y=>be("area")),maxlength:"2"},null,34),[[xt,b.value]]),De(e("input",{"onUpdate:modelValue":d[2]||(d[2]=y=>K.value=y),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:Q(["w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!ce.value||W.value}]),onInput:d[3]||(d[3]=y=>be("number")),maxlength:"4"},null,34),[[xt,K.value]]),De(e("input",{"onUpdate:modelValue":d[4]||(d[4]=y=>U.value=y),type:"text",placeholder:"ABC",class:Q(["w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition duration-150",{"border-red-500 focus:border-red-500":!ce.value||W.value}]),onInput:d[5]||(d[5]=y=>be("suffix")),maxlength:"3"},null,34),[[xt,U.value]])]),Se.value?(i(),l("span",Un,O(Se.value),1)):g("",!0),f.value?(i(),l("span",En,O(f.value),1)):g("",!0),v.value?(i(),l("span",Nn,O(v.value),1)):g("",!0)]),e("div",Mn,[d[15]||(d[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," Jenis Kendaraan ",-1)),e("div",Dn,[e("div",{class:Q(["w-full px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":N.value.rear_door,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":!N.value.rear_door}]),onClick:w},d[12]||(d[12]=[e("span",null,"Pintu Belakang",-1)]),2),e("div",Pn,[e("div",{class:Q(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":L.value==="pick_up","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":L.value!=="pick_up"}]),onClick:d[6]||(d[6]=y=>h("pick_up"))}," Pick Up ",2),e("div",{class:Q(["flex-1 px-4 py-3 border-2 rounded-lg text-center transition-all duration-200 whitespace-nowrap text-sm font-medium cursor-pointer",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":L.value==="box","border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":L.value!=="box"}]),onClick:d[7]||(d[7]=y=>h("box"))}," Box ",2)])]),e("div",Ln,[e("div",Rn,[d[14]||(d[14]=e("svg",{class:"w-4 h-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),e("div",jn,[d[13]||(d[13]=e("p",{class:"font-medium"},"Status Kendaraan:",-1)),e("p",Bn,[N.value.rear_door?(i(),l("span",On," âœ“ Mobil Pada Umum nya yang memiliki Pintu Belakang ")):g("",!0),L.value==="pick_up"?(i(),l("span",Fn," âœ“ Pick Up ")):g("",!0),L.value==="box"?(i(),l("span",Kn," âœ“ Box ")):g("",!0),!N.value.rear_door&&!L.value?(i(),l("span",qn," Pilih jenis kendaraan agar point bisa menyesuaikan dengan tipe kendaraan anda ")):g("",!0)])])])])]),e("div",zn,[d[18]||(d[18]=e("label",{class:"block text-sm font-medium text-gray-700"}," Nama Mobil ",-1)),e("div",Hn,[De(e("input",{"onUpdate:modelValue":d[8]||(d[8]=y=>A.value=y),type:"text",placeholder:"Cari atau ketik nama mobil...",class:Q(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{"border-red-500 focus:border-red-500":ye.value}]),onInput:Oe,onFocus:d[9]||(d[9]=y=>P.value=!0),onBlur:Fe},null,34),[[xt,A.value]]),T.value?(i(),l("div",Gn,d[16]||(d[16]=[e("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):g("",!0),P.value?(i(),l("div",Wn,[F.value.length>0?(i(),l("div",Jn,[(i(!0),l(ke,null,Ce(F.value,y=>(i(),l("div",{key:y.id,class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:j=>we(y)},[e("div",Zn,O(pe(y)),1),e("div",Xn,O(y.year)+" â€¢ "+O(y.cc)+"cc â€¢ "+O(y.transmission)+" â€¢ "+O(y.fuel_type),1)],40,Yn))),128))])):(i(),l("div",Qn,d[17]||(d[17]=[_e(" Tidak ada data mobil yang cocok. "),e("br",null,null,-1),_e(" Silakan input manual dengan format: "),e("br",null,null,-1),e("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):g("",!0)]),ye.value?(i(),l("span",es,"Nama mobil tidak boleh kosong.")):g("",!0)]),!Y(m).car_id&&A.value&&!P.value?(i(),l("div",ts,d[19]||(d[19]=[xn('<div class="flex items-start" data-v-f5fe3b58><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-600 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-f5fe3b58><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-f5fe3b58></path></svg><div data-v-f5fe3b58><p class="text-yellow-800 font-medium mb-1" data-v-f5fe3b58>Informasi Penting</p><p class="text-yellow-700 text-sm mb-2" data-v-f5fe3b58> Anda memasukkan nama mobil secara manual. Data detail mobil (spesifikasi, gambar, deskripsi) <span class="font-semibold" data-v-f5fe3b58>tidak akan tersedia</span> dalam laporan inspeksi. </p><p class="text-yellow-700 text-sm mb-2" data-v-f5fe3b58> Untuk laporan yang lengkap dengan semua detail mobil, silakan pilih mobil dari hasil pencarian. </p><p class="text-yellow-700 text-sm" data-v-f5fe3b58> Jika tidak ingin mengubah data mobil dan anda tidak sengaja sudah menghapus atau edit, <span class="font-semibold" data-v-f5fe3b58>jangan klik tombol &quot;Perbarui Detail Kendaraan&quot;</span>. Sebagai gantinya, <span class="font-semibold" data-v-f5fe3b58>refresh halaman</span> untuk kembali ke data awal. </p></div></div>',1)]))):g("",!0),Y(m).car_id&&H.value?(i(),l("div",ns,[H.value.description?(i(),l("div",ss,[d[20]||(d[20]=e("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),e("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:H.value.description},null,8,os)])):g("",!0),R.value.length>0?(i(),l("div",as,[d[21]||(d[21]=e("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),e("div",is,[(i(!0),l(ke,null,Ce(R.value,(y,j)=>(i(),l("div",{key:y.id||j,class:"relative group cursor-pointer",onClick:te=>le(j)},[e("img",{src:Ue(y),alt:y.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,rs),y.note?(i(),l("div",us,[e("p",ds,O(y.note),1)])):g("",!0)],8,ls))),128))])])):(i(),l("div",cs," Tidak ada gambar tersedia untuk mobil ini "))])):g("",!0),k.value?(i(),l("div",{key:2,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:$e},[e("div",gs,[e("button",{onClick:$e,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},d[22]||(d[22]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),R.value.length>1?(i(),l("button",{key:0,onClick:ct(Ie,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},d[23]||(d[23]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):g("",!0),R.value.length>1?(i(),l("button",{key:1,onClick:ct(Ve,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},d[24]||(d[24]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):g("",!0),e("img",{src:Ue(R.value[D.value]),alt:"Car Image "+(D.value+1),class:"max-w-full max-h-full object-contain",onClick:d[10]||(d[10]=ct(()=>{},["stop"]))},null,8,ps),R.value.length>1?(i(),l("div",ms,O(D.value+1)+" / "+O(R.value.length),1)):g("",!0),(q=R.value[D.value])!=null&&q.note?(i(),l("div",vs,O(R.value[D.value].note),1)):g("",!0)])])):g("",!0),fe(_n,{type:"button",onClick:Re,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed",disabled:!xe.value},{default:Be(()=>[Y(m).processing?(i(),l("svg",fs,d[25]||(d[25]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):g("",!0),e("span",null,O(Y(m).processing?"Mengirim...":"Perbarui Detail Kendaraan"),1),fe(Sn,{on:Y(m).recentlySuccessful,class:"me-3 text-sm text-green-600 font-medium"},{default:Be(()=>d[26]||(d[26]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline-block mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),_e(" Tersimpan. ")])),_:1,__:[26]},8,["on"])]),_:1},8,["disabled"])])):g("",!0)])}}},bs=Ye(hs,[["__scopeId","data-v-f5fe3b58"]]),ys={class:"mt-1"},xs=["value","required","minlength","maxlength","allowSpace","placeholder"],ws={key:0,class:"mt-2 text-sm text-red-600"},un={__name:"InputText",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],pattern:String,placeholder:String,error:String,pointId:[String,Number],textTransform:{type:String,default:"none"},allowSpace:{type:Boolean,default:!0}},emits:["update:modelValue","save"],setup(n,{emit:Z}){const t=n,C=Z,m=J(()=>{if(!t.modelValue)return"";let I=t.modelValue;switch(t.allowSpace||(I=I.replace(/\s+/g,"")),t.textTransform){case"uppercase":return I.toUpperCase();case"lowercase":return I.toLowerCase();case"capitalize":return I.replace(/\b\w/g,M=>M.toUpperCase());default:return I}}),S=I=>{let M=I.target.value;switch(t.allowSpace||(M=M.replace(/\s+/g,"")),t.textTransform){case"uppercase":M=M.toUpperCase();break;case"lowercase":M=M.toLowerCase();break;case"capitalize":M=M.replace(/\b\w/g,b=>b.toUpperCase());break}C("update:modelValue",M),C("save",t.pointId)};return(I,M)=>(i(),l("div",ys,[e("input",{value:m.value,onInput:S,type:"text",required:n.required,minlength:n.minLength,maxlength:n.maxLength,allowSpace:n.allowSpace,placeholder:n.placeholder,class:Q(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",{uppercase:n.textTransform==="uppercase",lowercase:n.textTransform==="lowercase",capitalize:n.textTransform==="capitalize"}])},null,42,xs),n.error?(i(),l("p",ws,O(n.error),1)):g("",!0)]))}},ks={class:"mt-1"},Is=["value","required","min","max"],_s={key:0,class:"mt-2 text-sm text-red-600"},dn={__name:"InputDate",props:{modelValue:String,required:Boolean,minDate:String,maxDate:String,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(n,{emit:Z}){const t=n,C=Z,m=S=>{C("update:modelValue",S.target.value),C("save",t.pointId)};return(S,I)=>(i(),l("div",ks,[e("input",{value:n.modelValue,onChange:m,type:"date",required:n.required,min:n.minDate,max:n.maxDate,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},null,40,Is),n.error?(i(),l("p",_s,O(n.error),1)):g("",!0)]))}},Ss={class:"mt-1"},$s=["value","required","placeholder"],Cs={key:0,class:"mt-2 text-sm text-red-600"},cn={__name:"InputAccount",props:{modelValue:[String,Number],required:Boolean,placeholder:String,error:String,pointId:[String,Number],settings:{type:Object,default:()=>({currency_symbol:"Rp",thousands_separator:",",min_value:0,max_value:1e9})}},emits:["update:modelValue","save"],setup(n,{emit:Z}){const t=n,C=Z,m=$(""),S=J(()=>{var U,L,N,W;return{currency_symbol:((U=t.settings)==null?void 0:U.currency_symbol)||"Rp",thousands_separator:((L=t.settings)==null?void 0:L.thousands_separator)||",",min_value:((N=t.settings)==null?void 0:N.min_value)!==void 0?Number(t.settings.min_value):0,max_value:((W=t.settings)==null?void 0:W.max_value)!==void 0?Number(t.settings.max_value):1e9}}),I=U=>{if(U==null||U==="")return"";const L=Number(U);if(isNaN(L))return"";let N=L.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return S.value.thousands_separator!==","&&(N=N.replace(/,/g,S.value.thousands_separator)),N},M=U=>U?U.replace(/[^\d]/g,""):"",b=J(()=>m.value?`${S.value.currency_symbol} ${I(m.value)}`:""),K=U=>{let L=M(U.target.value),N=Number(L);S.value.min_value!==void 0&&N<S.value.min_value&&(L=S.value.min_value.toString()),S.value.max_value!==void 0&&N>S.value.max_value&&(L=S.value.max_value.toString()),m.value=L,C("update:modelValue",L),C("save",t.pointId)};return re(()=>t.modelValue,U=>{U!=null&&(m.value=U.toString())},{immediate:!0}),(U,L)=>(i(),l("div",Ss,[e("input",{value:b.value,onInput:K,type:"text",required:n.required,placeholder:n.placeholder,class:Q(["block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",n.error?"border-red-300":"border-gray-300"])},null,42,$s),n.error?(i(),l("p",Cs,O(n.error),1)):g("",!0)]))}},As={class:"mt-1 space-y-3"},Vs={key:0,class:"space-y-2"},Ts={class:"flex flex-wrap gap-2"},Us=["onClick"],Es=["value","required","minlength","maxlength","placeholder"],Ns={class:"flex justify-between items-center mt-1"},Ms={class:"text-xs text-gray-500"},Ds={key:0,class:"text-xs text-red-600"},gn={__name:"InputTextarea",props:{modelValue:String,required:Boolean,minLength:[String,Number],maxLength:[String,Number],placeholder:String,error:String,pointId:[String,Number],inspectionId:[String,Number],settings:Object},emits:["update:modelValue","save"],setup(n,{emit:Z}){const t=n,C=Z,m=$([]),S=$(""),I=U=>m.value.some(L=>L.value===U),M=U=>{I(U.value)?m.value=m.value.filter(f=>f.value!==U.value):m.value.push(U);const N=[...m.value.map(f=>f.value)];S.value.trim()&&N.push(S.value.trim());const W=N.join(", ");C("update:modelValue",W),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,notes:W})},b=U=>{const L=U.target.value;C("update:modelValue",L),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,notes:L}),K(L)},K=U=>{var f,v,A,P;if(!U){m.value=[],S.value="";return}const L=U.split(",").map(T=>T.trim()).filter(T=>T),N=((v=(f=t.settings)==null?void 0:f.damage_options)==null?void 0:v.map(T=>T.value))||[];m.value=((P=(A=t.settings)==null?void 0:A.damage_options)==null?void 0:P.filter(T=>L.includes(T.value)))||[];const W=L.filter(T=>!N.includes(T));S.value=W.join(", ")};return re(()=>t.modelValue,U=>{U!=null&&K(U)},{immediate:!0}),re(()=>{var U;return(U=t.settings)==null?void 0:U.damage_options},(U,L)=>{if(U!==L){const N=U?U.map(A=>A.value):[];m.value=m.value.filter(A=>N.includes(A.value));const f=[...m.value.map(A=>A.value)];S.value.trim()&&f.push(S.value.trim());const v=f.filter(A=>A).join(", ");C("update:modelValue",v),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,notes:v})}},{deep:!0,immediate:!1}),(U,L)=>{var N,W,f;return i(),l("div",As,[(N=n.settings)!=null&&N.enable_damage&&((W=n.settings)!=null&&W.damage_options)?(i(),l("div",Vs,[L[0]||(L[0]=e("h4",{class:"text-sm font-medium text-gray-700"},"Pilih Kerusakan:",-1)),e("div",Ts,[(i(!0),l(ke,null,Ce(n.settings.damage_options,(v,A)=>(i(),l("button",{key:A,type:"button",onClick:P=>M(v),class:Q(["px-3 py-1.5 rounded-md text-sm font-medium transition-colors border",{"border-indigo-500 bg-indigo-100 text-indigo-700":I(v.value),"border-gray-300 bg-white text-gray-700 hover:bg-gray-50":!I(v.value)}])},O(v.label),11,Us))),128))])])):g("",!0),e("div",null,[e("textarea",{value:n.modelValue,onInput:b,required:n.required,minlength:n.minLength,maxlength:n.maxLength,placeholder:n.placeholder,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150",rows:"4"},null,40,Es),e("div",Ns,[e("span",Ms,O(((f=n.modelValue)==null?void 0:f.length)||0)+"/"+O(n.maxLength||400),1),n.error?(i(),l("p",Ds,O(n.error),1)):g("",!0)])])])}}},Ps={class:"mt-1"},Ls=["value","required"],Rs={key:0,class:"mt-2 text-sm text-red-600"},js={__name:"InputSelect",props:{modelValue:String,required:Boolean,error:String,pointId:[String,Number]},emits:["update:modelValue","save"],setup(n,{emit:Z}){const t=n,C=Z,m=S=>{C("update:modelValue",S.target.value),C("save",t.pointId)};return(S,I)=>(i(),l("div",Ps,[e("select",{value:n.modelValue,onChange:m,required:n.required,class:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm transition duration-150"},I[0]||(I[0]=[e("option",{value:"",disabled:""},"Select status",-1),e("option",{value:"good"},"Good",-1),e("option",{value:"bad"},"Bad",-1),e("option",{value:"na"},"N/A",-1)]),40,Ls),n.error?(i(),l("p",Rs,O(n.error),1)):g("",!0)]))}},Bs=Ye(js,[["__scopeId","data-v-1b6c0201"]]),Os={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},Fs={class:"bg-white rounded-xl p-8 w-full max-w-sm mx-auto shadow-2xl transform transition-all duration-300 scale-100 opacity-100"},Ks={class:"text-xs text-gray-500 mt-2 text-center"},qs={class:"flex flex-row space-x-4 mb-6"},zs={class:"mt-4 text-right"},Hs={__name:"ImageSourceOptionsModal",props:{show:{type:Boolean,default:!1},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})}},emits:["close","open-webcam","trigger-gallery"],setup(n){return(Z,t)=>n.show?(i(),l("div",Os,[e("div",Fs,[t[7]||(t[7]=e("h3",{class:"text-xl font-bold text-gray-800 mb-2 text-center"},"Pilih Sumber Gambar",-1)),e("p",Ks,[t[3]||(t[3]=_e("Ambil Foto Maksimal: ")),e("b",null,O(n.settings.max_files),1),t[4]||(t[4]=_e(" Dengan Rasio & Ukuran: ")),e("b",null,O(n.settings.camera_aspect_ratio),1)]),e("div",qs,[e("button",{onClick:t[0]||(t[0]=C=>Z.$emit("trigger-camera")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-blue-50 hover:border-blue-400 hover:text-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-blue-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1),e("span",{class:"text-sm font-medium"},"Ambil Foto",-1)])),e("button",{onClick:t[1]||(t[1]=C=>Z.$emit("trigger-gallery")),class:"flex-1 flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg text-gray-700 hover:bg-indigo-50 hover:border-indigo-400 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 ease-in-out transform hover:scale-105"},t[6]||(t[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2 text-gray-500 hover:text-indigo-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("span",{class:"text-sm font-medium"},"Galeri",-1)]))]),e("div",zs,[e("button",{onClick:t[2]||(t[2]=C=>Z.$emit("close")),class:"px-5 py-2 text-sm font-medium text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2 transition-colors duration-200 ease-in-out"}," Batal ")])])])):g("",!0)}},Gs={key:0,class:"fixed inset-0 bg-black bg-opacity-95 z-50 flex flex-col items-center justify-center"},Ws={class:"w-full h-full flex flex-col"},Js={class:"flex justify-between items-center p-4 bg-black bg-opacity-70 text-white shadow-md"},Ys=["disabled"],Zs={class:"text-lg font-semibold"},Xs={class:"flex items-center gap-2"},Qs=["disabled"],eo={key:0,class:"px-4 py-2 bg-indigo-900 text-white"},to={class:"flex justify-between items-center text-sm"},no={class:"w-full bg-gray-700 rounded-full h-2 mt-1"},so={class:"flex-1 flex items-center justify-center overflow-hidden relative"},oo=["src"],ao={key:1,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-3"},io=["disabled"],lo=["disabled"],ro={key:2,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},uo={key:3,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},co=["disabled"],go=["disabled"],po=["disabled"],mo={class:"flex flex-col gap-3 p-4 bg-black bg-opacity-70 shadow-inner"},vo={class:"flex justify-between items-center w-full"},fo=["disabled"],ho={key:1,class:"flex-1"},bo=["disabled"],yo={class:"flex gap-3 w-full"},xo={key:1,class:"flex-1 px-4 py-3 bg-gradient-to-r from-indigo-700 to-sky-600 rounded-lg cursor-not-allowed flex items-center justify-center font-medium opacity-75",disabled:""},wo={class:"flex items-center gap-2"},ko={key:0,class:"text-center"},Io={__name:"PreviewModal",props:{show:Boolean,images:{type:Array,default:()=>[]},initialIndex:{type:Number,default:0},allowMultiple:Boolean,maxFiles:Number,isUploading:Boolean,aspectRatio:Number,point:Object,uploadProgress:{type:Number,default:0},currentUpload:{type:Number,default:0},totalUpload:{type:Number,default:0}},emits:["close","saveImages","removePreviewImage","triggerAddMorePhotos","update:images","retryImage"],setup(n,{emit:Z}){const t=n,C=Z,m=$(0),S=$([]),I=J(()=>S.value.length>0?S.value[m.value]:null);re(()=>t.images,P=>{S.value=P.map(T=>({...T,rotation:T.isNew&&T.rotation||0})),P.length===0&&t.show&&N()},{deep:!0,immediate:!0}),re(()=>t.show,P=>{P&&t.images.length>0&&(m.value=t.initialIndex)}),re(()=>t.uploadProgress,P=>{P===100&&console.log("Upload completed")});const M=P=>P.preview||(P.image_path?`/${P.image_path}`:""),b=P=>{if(I.value&&I.value.isNew&&!t.isUploading){const T=I.value.rotation||0;let F;P==="left"?F=T-90:F=T+90,F=(F%360+360)%360,S.value[m.value].rotation=F,C("update:images",S.value)}},K=()=>{t.isUploading||(m.value=m.value<S.value.length-1?m.value+1:0)},U=()=>{t.isUploading||(m.value=m.value>0?m.value-1:S.value.length-1)},L=()=>{t.isUploading||C("saveImages",S.value)},N=()=>{t.isUploading||C("close")},W=()=>{if(I.value&&!t.isUploading){const P=I.value,T=S.value.findIndex(F=>F.isNew&&P.isNew&&F.preview===P.preview||!F.isNew&&!P.isNew&&F.id===P.id);T!==-1&&(C("removePreviewImage",P),S.value.splice(T,1),C("update:images",S.value)),m.value>=S.value.length&&(m.value=Math.max(0,S.value.length-1)),S.value.length===0&&C("close")}},f=()=>{t.isUploading||C("triggerAddMorePhotos")},v=()=>{I.value&&!t.isUploading&&C("retryImage",I.value)},A=P=>{P.key==="Escape"&&!t.isUploading&&N()};return ot(()=>{document.addEventListener("keydown",A)}),Pt(()=>{document.removeEventListener("keydown",A)}),(P,T)=>{var F;return n.show?(i(),l("div",Gs,[e("div",Ws,[e("div",Js,[e("button",{onClick:N,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors",disabled:n.isUploading},T[2]||(T[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ys),e("div",Zs,O(((F=n.point)==null?void 0:F.name)||"Preview")+" ("+O(m.value+1)+"/"+O(S.value.length)+") ",1),e("div",Xs,[I.value&&I.value.isNew?(i(),l("button",{key:0,onClick:W,class:"p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors","aria-label":"Remove new image",disabled:n.isUploading},T[3]||(T[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)]),8,Qs)):g("",!0)])]),n.isUploading?(i(),l("div",eo,[e("div",to,[e("span",null,"Mengupload: "+O(n.currentUpload)+"/"+O(n.totalUpload),1),e("span",null,O(n.uploadProgress)+"%",1)]),e("div",no,[e("div",{class:"bg-gradient-to-r from-indigo-500 to-sky-400 h-2 rounded-full progress-bar",style:wt({width:n.uploadProgress+"%"})},null,4)])])):g("",!0),e("div",so,[e("div",{class:"relative w-full max-w-full",style:wt({paddingTop:n.aspectRatio?100/n.aspectRatio+"%":"75%"})},[I.value?(i(),l("img",{key:0,src:M(I.value),class:"absolute inset-0 w-full h-full object-contain transition-transform duration-300 ease-in-out bg-black",style:wt({transform:`rotate(${I.value.rotation}deg)`})},null,12,oo)):g("",!0),I.value&&I.value.isNew&&!I.value.isUploading&&!I.value.isFailed?(i(),l("div",ao,[e("button",{onClick:T[0]||(T[0]=H=>b("left")),class:"p-3 bg-black bg-opacity-60 text-white rounded-full hover:bg-opacity-80 transition-colors",disabled:n.isUploading,title:"Putar ke kiri"},T[4]||(T[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12a9 9 0 1018 0 9 9 0 00-18 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l3-3m0 0l3 3m-3-3v9",transform:"rotate(180 12 12)"})],-1)]),8,io),e("button",{onClick:T[1]||(T[1]=H=>b("right")),class:"p-3 bg-black bg-opacity-60 text-white rounded-full hover:bg-opacity-80 transition-colors",disabled:n.isUploading,title:"Putar ke kanan"},T[5]||(T[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12a9 9 0 1018 0 9 9 0 00-18 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l3-3m0 0l3 3m-3-3v9"})],-1)]),8,lo)])):g("",!0),I.value&&I.value.isUploading?(i(),l("div",ro,T[6]||(T[6]=[e("div",{class:"text-center text-white"},[e("div",{class:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto mb-2"}),e("p",{class:"text-sm"},"Mengupload...")],-1)]))):g("",!0),I.value&&I.value.isFailed?(i(),l("div",uo,[T[7]||(T[7]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),T[8]||(T[8]=e("p",{class:"text-lg font-medium mb-2"},"Upload Gagal",-1)),e("button",{onClick:v,class:"px-4 py-2 bg-white text-red-600 rounded-lg font-medium hover:bg-gray-100 transition-colors",disabled:n.isUploading}," Coba Lagi ",8,co)])):g("",!0)],4),S.value.length>1&&!n.isUploading?(i(),l("button",{key:0,onClick:U,class:"absolute left-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:n.isUploading},T[9]||(T[9]=[e("svg",{xmlns:"http://www.w3.org2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]),8,go)):g("",!0),S.value.length>1&&!n.isUploading?(i(),l("button",{key:1,onClick:K,class:"absolute right-4 p-3 bg-black bg-opacity-50 text-white rounded-full hover:bg-opacity-70 transition-colors",disabled:n.isUploading},T[10]||(T[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,po)):g("",!0)]),e("div",mo,[e("div",vo,[I.value&&!I.value.isNew?(i(),l("button",{key:0,onClick:W,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-red-400",disabled:n.isUploading},T[11]||(T[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),_e(" Hapus Foto ")]),8,fo)):(i(),l("div",ho)),n.allowMultiple&&S.value.length<n.maxFiles&&!n.isUploading?(i(),l("button",{key:2,onClick:f,class:"px-3 py-2 rounded-lg text-white font-medium flex items-center gap-1 transition-colors hover:text-indigo-400",disabled:n.isUploading},T[12]||(T[12]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),_e(" Tambah Foto ")]),8,bo)):g("",!0)]),e("div",yo,[n.isUploading?(i(),l("button",xo,[e("div",wo,[T[13]||(T[13]=e("div",{class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)),e("span",null,"Mengupload... "+O(n.uploadProgress)+"%",1)])])):(i(),l("button",{key:0,onClick:L,class:"flex-1 px-4 py-3 rounded-lg bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white transition-colors font-medium hover:from-indigo-600 hover:to-sky-500"}," Simpan & Upload "))]),n.isUploading?(i(),l("div",ko,T[14]||(T[14]=[e("p",{class:"text-xs text-blue-300"}," Modal akan tertutup otomatis. Upload terus berjalan di background. ",-1)]))):g("",!0)])])])):g("",!0)}}},_o=Ye(Io,[["__scopeId","data-v-0e4bb6d9"]]),So=["accept","multiple","disabled"],$o={class:"text-xs text-gray-500 mb-2"},Co=["disabled"],Ao={class:"h-full flex flex-col items-center justify-center p-4 text-center"},Vo={class:"text-xs text-gray-400 mt-1"},To={key:0,class:"flex items-center gap-4"},Uo=["src"],Eo={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},No=["disabled"],Mo={key:1,class:"flex space-x-2 overflow-x-auto pb-2 scrollbar-hide"},Do=["disabled"],Po=["onClick"],Lo=["src","onError"],Ro={key:0,class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center text-white text-xs font-bold"},jo={key:0},Bo={key:1,class:"ml-1"},Oo={key:1,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},Fo={key:2,class:"absolute inset-0 bg-red-500 bg-opacity-80 flex flex-col items-center justify-center text-white"},Ko={key:2,class:"mt-1 text-xs text-red-600"},qo={key:3,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},zo={class:"bg-white rounded-lg p-6 max-w-sm mx-4"},Ho={class:"flex flex-col gap-3"},Go={__name:"InputImage",props:{modelValue:{type:Array,default:()=>[]},error:String,inspectionId:{type:[String,Number],required:!0},pointId:{type:[String,Number],required:!0},settings:{type:Object,default:()=>({max_files:1,allowed_types:["jpg","png","jpeg"],camera_aspect_ratio:"3:4",enable_flash:!0,enable_camera_switch:!0,max_size:2048})},point:Object},emits:["update:modelValue","save","removeImage","uploaded","uploadProgress"],setup(n,{emit:Z}){const t=n,C=Z,m=$(null),S=$(null),I=$(!1),M=$(!1),b=$([]),K=$(0),U=$(!1),L=$(!1),N=$(0),W=$(0),f=$(0),v=$(!1),A=$(!1),P=$(null),T=Dt("imageSourceSetting",$("all"));Dt("cameraQualitySetting",$("HD_Std"));const F=`inspection-${t.inspectionId}-point-${t.pointId}-backup`,H=J(()=>Number(t.settings.max_files)>1),R=J(()=>t.settings.allowed_types.map(o=>`.${o}`).join(", ")),k=J(()=>{const o=t.settings.camera_aspect_ratio.split(":");if(o.length===2){const c=parseFloat(o[0]),p=parseFloat(o[1]);if(!isNaN(c)&&!isNaN(p)&&p!==0)return c/p}return 3/4}),D=J(()=>{console.log("ðŸ”„ allImages computed called");const o=[],c=new Set;for(const p of t.modelValue){if(!p||typeof p!="object"||p.id&&c.has(p.id))continue;p.id&&c.add(p.id),console.log("ðŸ“¥ Database image:",p),console.log("ðŸ“¥ Type of preview:",typeof p.preview),console.log("ðŸ“¥ Type of public_url:",typeof p.public_url);const V=ne(p);o.push({...V,rotation:V.rotation||0,isNew:!1,isUploaded:!0,isUploading:!1,isFailed:!1})}for(const p of b.value)p.id&&c.add(p.id),o.push({...p,isUploading:p.isUploading||!1,isFailed:p.isFailed||!1});return console.log("âœ… Final allImages:",o),o}),ne=o=>{if(!o||typeof o!="object")return{};const c={...o};return["preview","public_url","original_url","optimized_url"].forEach(V=>{c[V]&&(c[V]=w(c[V]))}),c.image_path&&(c.image_path=c.image_path.replace(/^storage\//,"")),c},w=o=>{if(!o||typeof o!="string")return o;let c=o.replace(/\/storage\/storage\//g,"/storage/");return c=c.replace(/\/\/storage\/storage\//g,"/storage/"),c.startsWith("storage/")&&(c=`/${c}`),!c.startsWith("/")&&!c.startsWith("http")&&(c=`/storage/${c}`),c},h=o=>{if(!o||typeof o!="object")return console.warn("âŒ safeImageSrc: image is not object",o),"";const c=s(o);return typeof c!="string"?(console.error("ðŸš¨ CRITICAL: getImageSrc returned non-string:",typeof c,c),""):(c&&console.log("âœ… safeImageSrc result:",c),c)},s=o=>{if(!o||typeof o!="object")return"";if(console.log("ðŸ” getImageSrc called with:",o),console.log("ðŸ” Available fields:",Object.keys(o)),o.preview&&typeof o.preview=="string"){const c=w(o.preview);return console.log("âœ… Using preview URL:",c),c}if(o.public_url&&typeof o.public_url=="string"){const c=w(o.public_url);return console.log("âœ… Using public_url:",c),c}if(o.original_url&&typeof o.original_url=="string"){const c=w(o.original_url);return console.log("âœ… Using original_url:",c),c}if(o.optimized_url&&typeof o.optimized_url=="string"){const c=w(o.optimized_url);return console.log("âœ… Using optimized_url:",c),c}if(o.image_path&&typeof o.image_path=="string"){const p=`/storage/${o.image_path.replace(/^\/?storage\//,"")}`;return console.log("âœ… Generated from image_path:",p),p}if(o.path&&typeof o.path=="string"){const p=`/storage/${o.path.replace(/^\/?storage\//,"")}`;return console.log("âœ… Generated from path:",p),p}return console.warn("âš ï¸ No valid image source found for:",o),""},x=o=>{console.error("âŒ Image load error for:",o),console.error("âŒ Attempted URL:",h(o)),L.value=!0;const c=B(o);if(c&&c!==h(o)){console.log("ðŸ”„ Trying fallback URL:",c);const p=event==null?void 0:event.target;p&&(p.src=c)}},B=o=>{if(!o||typeof o!="object")return"";const c=["original_url","optimized_url","public_url","preview"];for(const p of c)if(o[p]&&typeof o[p]=="string")return w(o[p]);return""},se=async()=>{I.value=!1,t.settings.enable_flash?v.value=!0:be()},be=()=>{v.value=!1;const o=document.createElement("input");o.type="file",o.accept="image/*",o.capture="environment",t.settings.enable_flash&&A.value&&o.setAttribute("flash","on"),o.onchange=async c=>{var V;const p=(V=c.target.files)==null?void 0:V[0];p&&await Ae(p)},o.click(),ce()},ce=async()=>{if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)try{const o={video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080},...t.settings.enable_flash&&A.value&&{torch:!0}},audio:!1};P.value=await navigator.mediaDevices.getUserMedia(o),ye()}catch(o){console.warn("Tidak bisa menggunakan getUserMedia, menggunakan input file biasa:",o),m.value.capture="environment",m.value.click()}},ye=()=>{const o=document.createElement("div");o.style.cssText=`
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: black;
    z-index: 9999;
    display: flex;
    flex-direction: column;
  `;const c=document.createElement("video");c.style.cssText=`
    width: 100%;
    height: 100%;
    object-fit: contain;
  `,c.srcObject=P.value,c.autoplay=!0,c.playsInline=!0;const p=document.createElement("div");if(p.style.cssText=`
    position: absolute;
    bottom: 20px;
    left: 0;
    width: 100%;
    display: flex;
    justify-content: center;
    gap: 20px;
    padding: 20px;
    background: rgba(0,0,0,0.5);
  `,t.settings.enable_flash){const d=document.createElement("button");d.textContent=A.value?"Flash: ON":"Flash: OFF",d.style.cssText=`
      padding: 10px 20px;
      background: ${A.value?"#f59e0b":"#6b7280"};
      color: white;
      border: none;
      border-radius: 5px;
      font-weight: bold;
    `,d.onclick=ve,p.appendChild(d)}const V=document.createElement("button");V.textContent="Ambil Foto",V.style.cssText=`
    padding: 10px 30px;
    background: #10b981;
    color: white;
    border: none;
    border-radius: 5px;
    font-weight: bold;
  `,V.onclick=Se,p.appendChild(V);const u=document.createElement("button");u.textContent="âœ•",u.style.cssText=`
    position: absolute;
    top: 20px;
    right: 20px;
    width: 40px;
    height: 40px;
    background: rgba(255,255,255,0.2);
    color: white;
    border: none;
    border-radius: 50%;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
  `,u.onclick=()=>{P.value&&(P.value.getTracks().forEach(d=>d.stop()),P.value=null),document.body.removeChild(o)},o.appendChild(c),o.appendChild(p),o.appendChild(u),document.body.appendChild(o)},Se=()=>{const o=document.querySelector("video[srcObject]");if(!o||!P.value)return;const c=document.createElement("canvas"),p=c.getContext("2d");c.width=o.videoWidth,c.height=o.videoHeight,p.drawImage(o,0,0,c.width,c.height),c.toBlob(async V=>{if(V){const u=new File([V],`photo_${Date.now()}.jpg`,{type:"image/jpeg",lastModified:Date.now()});P.value.getTracks().forEach(q=>q.stop()),P.value=null;const d=document.querySelector('div[style*="position: fixed; top: 0"]');d&&document.body.removeChild(d),await Ae(u)}},"image/jpeg",.9)},ve=()=>{A.value=!A.value;const o=document.querySelector("button[onclick*=toggleFlash]");if(o&&(o.textContent=A.value?"Flash: ON":"Flash: OFF",o.style.background=A.value?"#f59e0b":"#6b7280"),P.value&&P.value.getVideoTracks().length>0){const c=P.value.getVideoTracks()[0];c.getCapabilities().torch&&c.applyConstraints({advanced:[{torch:A.value}]}).catch(V=>console.error("Error setting torch:",V))}},ue=()=>{M.value&&(M.value=!1),T.value==="camera"?se():T.value==="gallery"?xe():I.value=!0},xe=()=>{I.value=!1,m.value.click()},pe=()=>{I.value=!1,D.value.length>0&&(M.value=!0)},me=()=>{M.value=!1,U.value||(b.value.forEach(o=>{o.preview&&o.preview.startsWith("blob:")&&URL.revokeObjectURL(o.preview)}),b.value=[])},Oe=o=>new Promise(c=>{const p=new FileReader;p.onload=V=>{const u=new Image;u.onload=()=>{c({file:o,preview:URL.createObjectURL(o),rotation:0,width:u.naturalWidth,height:u.naturalHeight,isNew:!0})},u.onerror=()=>{console.error("Failed to load image for dimensions:",o.name),c({file:o,preview:URL.createObjectURL(o),rotation:0,width:0,height:0,isNew:!0})},u.src=V.target.result},p.readAsDataURL(o)}),Fe=o=>{const c=o.name.split(".").pop().toLowerCase();return t.settings.allowed_types.includes(c)},we=async o=>{const p=(t.settings.max_size||2048)*1024;return new Promise(V=>{const u=new Image,d=new FileReader;d.onload=q=>{u.onload=()=>{const y=document.createElement("canvas"),j=y.getContext("2d"),te=Math.max(u.width,u.height);y.width=te,y.height=te,j.fillStyle="white",j.fillRect(0,0,te,te);const oe=(te-u.width)/2,ie=(te-u.height)/2;j.drawImage(u,oe,ie,u.width,u.height);let Ne=.9;const We=()=>{y.toBlob(Ze=>{if(Ze.size>p&&Ne>.1)Ne-=.1,We();else{const ze=new File([Ze],o.name,{type:"image/jpeg",lastModified:Date.now()});V(ze)}},"image/jpeg",Ne)};We()},u.src=q.target.result},d.readAsDataURL(o)})},Ue=async o=>{const c=Array.from(o.target.files);if(!c.length){I.value=!1,D.value.length>0&&(M.value=!0);return}try{const p=c.filter(j=>!Fe(j));if(p.length>0){const j=p.map(te=>te.name.split(".").pop()).join(", ");alert(`File type not allowed: ${j}. Allowed types: ${t.settings.allowed_types.join(", ")}`),o.target.value="";return}const V=D.value.length,u=t.settings.max_files-V,d=await Promise.all(c.slice(0,u).map(async j=>await we(j))),q=await Promise.all(d.map(Oe)),y=H.value?q:q.slice(0,1);H.value?b.value.push(...y):(b.value.forEach(j=>{j.preview&&j.preview.startsWith("blob:")&&URL.revokeObjectURL(j.preview)}),b.value=y),I.value=!1,y.length>0?(K.value=Math.max(0,D.value.length-y.length),M.value=!0):D.value.length>0&&(M.value=!0),o.target.value=""}catch(p){console.error("Error processing selected images:",p),alert("Failed to process selected images. Please try again."),I.value=!1,D.value.length>0&&(M.value=!0)}},Ae=async o=>{const c=D.value.length;if(!H.value||c<t.settings.max_files)try{const p=await we(o),V=new Image;V.onload=()=>{const u={file:p,preview:URL.createObjectURL(p),rotation:0,width:V.naturalWidth,height:V.naturalHeight,isNew:!0};H.value?b.value.push(u):(b.value.forEach(d=>{d.preview&&d.preview.startsWith("blob:")&&URL.revokeObjectURL(d.preview)}),b.value=[u]),v.value=!1,I.value=!1,K.value=D.value.length-1,M.value=!0},V.src=URL.createObjectURL(p)}catch(p){console.error("Error processing captured image:",p),alert("Failed to process captured image. Please try again.")}else alert(`Maximum ${t.settings.max_files} files allowed.`),v.value=!1,I.value=!1,D.value.length>0&&(M.value=!0)},le=(o=0)=>{K.value=o,M.value=!0},$e=o=>new Promise(c=>{if(o.rotation===0||!S.value){if(!o.isNew&&!o.file){c({file:null,width:o.width,height:o.height,isOriginal:!0});return}c({file:o.file,width:o.width,height:o.height});return}const p=new Image;p.onload=async()=>{try{const V=S.value,u=V.getContext("2d"),d=p.width,q=p.height;let y,j;o.rotation===90||o.rotation===270?(y=q,j=d):(y=d,j=q),V.width=y,V.height=j,u.clearRect(0,0,V.width,V.height),u.translate(V.width/2,V.height/2),u.rotate(o.rotation*Math.PI/180),u.drawImage(p,-d/2,-q/2,d,q),u.setTransform(1,0,0,1,0,0);const te=await new Promise(Ne=>{V.toBlob(Ne,"image/jpeg",.9)}),oe=new File([te],o.file?o.file.name:`rotated_image_${Date.now()}.jpg`,{type:"image/jpeg"}),ie=await we(oe);c({file:ie,width:y,height:j})}catch(V){console.error("Error processing rotated image:",V),c({file:o.file,width:o.width,height:o.height})}},p.onerror=()=>{console.error("Failed to load image for rotation processing:",o.preview),c({file:o.file,width:o.width,height:o.height})},p.src=o.preview}),Ve=o=>{try{const c={images:o.map(p=>{var V;return{fileName:((V=p.file)==null?void 0:V.name)||`image-${Date.now()}.jpg`,rotation:p.rotation||0,width:p.width||0,height:p.height||0,timestamp:Date.now()}}),inspectionId:t.inspectionId,pointId:t.pointId};localStorage.setItem(F,JSON.stringify(c))}catch(c){console.error("Error saving backup:",c)}},Ie=()=>{localStorage.removeItem(F)},Ee=async o=>{U.value=!0;const c=[],p=[];if(!t.pointId){alert("Error: Point ID is missing. Cannot upload image."),U.value=!1;return}try{Ve(o);for(const V of o){if(!V.isNew&&V.rotation===0&&V.id&&V.image_path){c.push({id:V.id,image_path:V.image_path,width:V.width,height:V.height,rotation:0,preview:V.preview,isUploaded:!0});continue}const{file:u,width:d,height:q,isOriginal:y}=await $e(V);if(y&&!V.isNew){c.push({id:V.id,image_path:V.image_path,width:V.width,height:V.height,rotation:V.rotation||0,preview:V.preview,isUploaded:!0});continue}u&&p.push({file:u,width:d,height:q,rotation:V.rotation||0,originalImage:V})}me(),p.length>0?await Te(p,c):(C("update:modelValue",c),C("save",t.pointId))}catch(V){console.error("Error during image processing:",V),alert("Terjadi error saat memproses gambar. Data tersimpan secara lokal.")}finally{U.value=!1}},Te=async(o,c)=>{f.value=o.length,W.value=0,N.value=0;const p=[...c];let V=0;try{for(let u=0;u<o.length;u++){const d=o[u],q=new FormData;q.append("inspection_id",t.inspectionId),q.append("point_id",t.pointId),q.append("images[]",d.file);const y=b.value.findIndex(j=>{var te;return j.preview===((te=d.originalImage)==null?void 0:te.preview)});y!==-1&&(b.value[y].isUploading=!0,b.value[y].isFailed=!1);try{const te=(await Rt.post(route("inspections.upload-image"),q,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:oe=>{if(oe.total){const ie=Math.round(oe.loaded*100/oe.total);N.value=Math.round((u+oe.loaded/oe.total)/o.length*100),W.value=u+1}}})).data.images;if(te&&te.length>0){const oe=te[0];if(p.push({id:oe.image_id,image_path:oe.path,width:oe.width||d.width||0,height:oe.height||d.height||0,rotation:d.rotation||0,preview:oe.public_url,isUploaded:!0}),y!==-1){const ie=b.value.splice(y,1)[0];ie.preview&&ie.preview.startsWith("blob:")&&URL.revokeObjectURL(ie.preview)}V++}}catch(j){console.error(`Error uploading image ${u+1}:`,j),y!==-1&&(b.value[y].isUploading=!1,b.value[y].isFailed=!0)}}V>0&&(C("update:modelValue",p),C("save",t.pointId),C("uploaded",{pointId:t.pointId,images:p,newImagesCount:V})),V===o.length&&Ie(),console.log(`âœ… Successfully uploaded ${V}/${o.length} images`)}catch(u){console.error("Error in upload process:",u),o.forEach(d=>{const q=b.value.findIndex(y=>{var j;return y.preview===((j=d.originalImage)==null?void 0:j.preview)});q!==-1&&(b.value[q].isUploading=!1,b.value[q].isFailed=!0)})}finally{N.value=0,W.value=0,f.value=0,U.value=!1}},Re=async o=>{if(!o||!o.file){console.error("No file to retry upload");return}U.value=!0;const c=[...t.modelValue];try{const p=new FormData;p.append("inspection_id",t.inspectionId),p.append("point_id",t.pointId),p.append("images[]",o.file);const V=b.value.findIndex(q=>q.preview===o.preview);V!==-1&&(b.value[V].isUploading=!0,b.value[V].isFailed=!1);const d=(await Rt.post(route("inspections.upload-image"),p,{headers:{"Content-Type":"multipart/form-data"}})).data.images;if(d&&d.length>0){const q=d[0];if(c.push({id:q.image_id,image_path:q.path,width:q.width||o.width||0,height:q.height||o.height||0,rotation:o.rotation||0,preview:q.public_url,isUploaded:!0}),V!==-1){const j=b.value.splice(V,1)[0];j.preview&&j.preview.startsWith("blob:")&&URL.revokeObjectURL(j.preview)}C("update:modelValue",c),C("save",t.pointId),C("uploaded",{pointId:t.pointId,images:c,newImagesCount:1}),b.value.some(j=>j.isFailed)||Ie(),console.log("âœ… Successfully retried upload for 1 image")}}catch(p){console.error("Error retrying upload:",p),previewIndex!==-1&&(b.value[previewIndex].isUploading=!1,b.value[previewIndex].isFailed=!0)}finally{U.value=!1}},G=o=>{if(o){if(o.id&&!o.isNew)he(o);else{const c=b.value.findIndex(p=>p.preview&&p.preview===o.preview&&p.isNew||p.id&&p.id===o.id);if(c!==-1){const p=b.value.splice(c,1)[0];p.preview&&p.preview.startsWith("blob:")&&URL.revokeObjectURL(p.preview)}C("update:modelValue",t.modelValue.filter(p=>!(p.id&&p.id===o.id)&&!(p.preview&&p.preview===o.preview)))}K.value>=D.value.length&&(K.value=Math.max(0,D.value.length-1)),D.value.length===0&&me()}},he=async o=>{var p,V;if(o.id||o.image_path)try{await Rt.delete(route("inspections.delete-image"),{data:{image_id:o.id,image_path:o.image_path}})}catch(u){console.error("Error deleting image from server:",u),(V=(p=u.response)==null?void 0:p.data)!=null&&V.message?alert(`Failed to delete image from server: ${u.response.data.message}`):alert(`Failed to delete image from server: ${u.message}`);return}o.preview&&o.preview.startsWith("blob:")&&URL.revokeObjectURL(o.preview);const c=t.modelValue.filter(u=>u.id!==o.id);C("update:modelValue",c),b.value=b.value.filter(u=>u.isNew&&o.isNew?u.preview!==o.preview:u.id!==o.id),C("removeImage",{image:o}),M.value&&D.value.length===0?me():M.value&&K.value>=D.value.length&&(K.value=Math.max(0,D.value.length-1))};return re(()=>t.modelValue,o=>{var c;console.log("ðŸ”„ modelValue updated:",o),o&&o.length>0&&(console.log("ðŸ“Š First image structure:",JSON.stringify(o[0],null,2)),console.log("ðŸ” Type of preview:",typeof((c=o[0])==null?void 0:c.preview)))},{deep:!0}),ot(()=>{try{localStorage.getItem(F)&&console.log("Found backup images, ready for recovery if needed")}catch(o){console.error("Error loading backup:",o)}}),Pt(()=>{P.value&&P.value.getTracks().forEach(o=>o.stop()),b.value.forEach(o=>{o.preview&&o.preview.startsWith("blob:")&&URL.revokeObjectURL(o.preview)})}),(o,c)=>(i(),l("div",null,[e("input",{ref_key:"galleryInput",ref:m,type:"file",accept:R.value,class:"hidden",onChange:Ue,multiple:H.value,disabled:U.value,capture:"environment"},null,40,So),e("canvas",{ref_key:"processingCanvas",ref:S,class:"hidden"},null,512),e("p",$o,"Foto Maksimal: "+O(n.settings.max_files)+" | Rasio: "+O(n.settings.camera_aspect_ratio),1),D.value.length===0?(i(),l("label",{key:0,onClick:ue,class:Q(["block w-full border-2 border-dashed rounded-lg cursor-pointer transition-colors duration-200 h-28",{"border-gray-300 hover:border-indigo-400 bg-gray-50":!0}]),disabled:U.value},[e("div",Ao,[c[4]||(c[4]=e("svg",{class:"w-8 h-8 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),c[5]||(c[5]=e("p",{class:"text-sm text-gray-600 font-medium"},"Upload Image",-1)),e("p",Vo,"Tipe: "+O(R.value),1)])],8,Co)):(i(),l("div",{key:1,class:Q(["block w-full rounded-lg transition-colors duration-200 p-2",{"border-2 border-dashed border-indigo-200 bg-indigo-50 h-auto p-2":n.settings.max_files==1,"bg-transparent":n.settings.max_files>1}]),"aria-label":"Image gallery"},[n.settings.max_files===1?(i(),l("div",To,[e("div",{class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:c[1]||(c[1]=p=>le(0))},[e("img",{src:h(D.value[0]),onError:c[0]||(c[0]=p=>x(D.value[0])),class:"w-full h-full object-cover"},null,40,Uo),D.value[0].isUploading?(i(),l("div",Eo,c[6]||(c[6]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):g("",!0)]),e("button",{onClick:c[2]||(c[2]=ct(p=>he(D.value[0]),["stop"])),type:"button",class:"flex items-center gap-1 text-red-600 font-medium hover:text-red-800 transition-colors",disabled:U.value},c[7]||(c[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.095 21H7.905a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),_e(" Hapus Foto ")]),8,No)])):(i(),l("div",Mo,[H.value&&D.value.length<n.settings.max_files?(i(),l("div",{key:0,class:"flex-shrink-0 flex flex-col items-center justify-center p-2 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-indigo-500 transition-colors w-24 h-24",onClick:ue,disabled:U.value},c[8]||(c[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("p",{class:"mt-1 text-xs text-gray-600"},"Tambah",-1)]),8,Do)):g("",!0),(i(!0),l(ke,null,Ce(D.value,(p,V)=>(i(),l("div",{key:p.id||p.preview||V,class:"relative flex-shrink-0 w-24 h-24 overflow-hidden rounded-md border border-gray-200 cursor-pointer",onClick:u=>p.isFailed?Re(p):le(V)},[e("img",{src:h(p),onError:u=>x(p),class:"w-full h-full object-cover"},null,40,Lo),p.isNew||p.rotation!==0?(i(),l("div",Ro,[p.isNew?(i(),l("span",jo,"BARU")):g("",!0),p.rotation!==0?(i(),l("span",Bo,"ROTASI")):g("",!0)])):g("",!0),p.isUploading?(i(),l("div",Oo,c[9]||(c[9]=[e("div",{class:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1)]))):g("",!0),p.isFailed?(i(),l("div",Fo,c[10]||(c[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("span",{class:"text-xs font-medium"},"Retry",-1)]))):g("",!0)],8,Po))),128))]))],2)),n.error?(i(),l("p",Ko,O(n.error),1)):g("",!0),fe(Hs,{show:I.value,settings:n.settings,onClose:pe,onOpenWebcam:se,onTriggerGallery:xe},null,8,["show","settings"]),fe(_o,{show:M.value,images:D.value,point:n.point,"initial-index":K.value,"allow-multiple":H.value,"max-files":n.settings.max_files,"is-uploading":U.value,"aspect-ratio":k.value,"upload-progress":N.value,"current-upload":W.value,"total-upload":f.value,onClose:me,onSaveImages:Ee,onRemovePreviewImage:G,onTriggerAddMorePhotos:ue,onRetryImage:Re},null,8,["show","images","point","initial-index","allow-multiple","max-files","is-uploading","aspect-ratio","upload-progress","current-upload","total-upload"]),v.value?(i(),l("div",qo,[e("div",zo,[c[11]||(c[11]=e("h3",{class:"text-lg font-semibold mb-4"},"Kontrol Kamera",-1)),e("div",Ho,[e("button",{onClick:ve,class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"}," Flash: "+O(A.value?"ON":"OFF"),1),e("button",{onClick:be,class:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600"}," Buka Kamera "),e("button",{onClick:c[3]||(c[3]=p=>v.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400"}," Batal ")])])])):g("",!0)]))}},Ot=Ye(Go,[["__scopeId","data-v-1dea058b"]]),Wo={key:0,class:"fixed inset-0 z-50 overflow-hidden"},Jo={class:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[85vh] overflow-hidden flex flex-col"},Yo={class:"px-4 pb-2 border-b border-gray-200"},Zo={class:"text-lg font-semibold text-gray-900"},Xo={key:0,class:"text-sm text-gray-500 mt-1"},Qo={class:"flex-1 overflow-y-auto p-4"},ea={key:0,class:"border-t border-gray-200 p-4 bg-gray-50"},ta={__name:"BottomSheetModal",props:{show:Boolean,title:String,subtitle:String},setup(n){return(Z,t)=>(i(),Le(gt,{name:"bottom-sheet"},{default:Be(()=>[n.show?(i(),l("div",Wo,[t[1]||(t[1]=e("div",{class:"absolute inset-0 bg-black bg-opacity-50"},null,-1)),e("div",Jo,[t[0]||(t[0]=e("div",{class:"flex justify-center py-3"},[e("div",{class:"w-12 h-1.5 bg-gray-300 rounded-full"})],-1)),e("div",Yo,[e("h3",Zo,O(n.title),1),n.subtitle?(i(),l("p",Xo,O(n.subtitle),1)):g("",!0)]),e("div",Qo,[nn(Z.$slots,"default",{},void 0,!0)]),Z.$slots.footer?(i(),l("div",ea,[nn(Z.$slots,"footer",{},void 0,!0)])):g("",!0)])])):g("",!0)]),_:3}))}},pn=Ye(ta,[["__scopeId","data-v-fd942535"]]),na={class:"space-y-4"},sa={key:0,class:"mt-2"},oa={key:1,class:"mt-2"},aa={key:2,class:"mt-2"},ia={key:3,class:"mt-2"},la={key:4,class:"mt-2"},ra={class:"text-sm font-medium text-gray-700 mb-2"},ua={key:0,class:"text-red-500"},da={key:0,class:"text-xs text-red-500"},ca=["type","name","value","checked","onChange"],ga={key:6,class:"mt-4"},pa={class:"text-sm font-medium text-gray-700 mb-2"},ma={key:0,class:"text-red-500"},va={key:0,class:"text-xs text-red-500"},fa={key:7,class:"space-y-2"},ha={key:0,class:"text-red-500"},ba={key:1,class:"text-xs text-red-500"},ya={class:"flex gap-2"},xa=["disabled"],Ft={__name:"RadioOptionModal",props:{show:Boolean,title:String,subtitle:String,name:String,options:{type:Array,default:()=>[]},selectedValue:[String,Array],notesValue:String,imagesValue:{type:Array,default:()=>[]},pointId:[String,Number],inspectionId:[String,Number],showTextarea:{type:Boolean,default:!0},showImageUpload:{type:Boolean,default:!0},selectedPoint:Object,point:Object},emits:["update:selectedValue","update:notesValue","update:imagesValue","close","save","hapus","saveTextarea","saveImage","saveText","saveNumber","saveAccount","saveDate"],setup(n,{emit:Z}){const t=n,C=Z,m=f=>C("hapus",f),S=J(()=>Array.isArray(t.selectedValue)?t.options.find(f=>t.selectedValue.includes(f.value)):t.options.find(f=>f.value===t.selectedValue)),I=J(()=>{if(Array.isArray(t.selectedValue))return t.options.filter(f=>t.selectedValue.includes(f.value));if(t.selectedValue){const f=typeof t.selectedValue=="string"?t.selectedValue.split(",").map(v=>v.trim()):[t.selectedValue];return t.options.filter(v=>f.includes(v.value))}return[]}),M=J(()=>{var f;if(Array.isArray(t.selectedValue))return I.value.some(v=>{var A;return v.multi&&((A=v.settings)==null?void 0:A.show_textarea)});{const v=t.options.find(A=>A.value===t.selectedValue);return(f=v==null?void 0:v.settings)==null?void 0:f.show_textarea}}),b=J(()=>{var f;if(Array.isArray(t.selectedValue))return I.value.some(v=>{var A;return v.multi&&((A=v.settings)==null?void 0:A.show_image_upload)});{const v=t.options.find(A=>A.value===t.selectedValue);return(f=v==null?void 0:v.settings)==null?void 0:f.show_image_upload}}),K=J(()=>{var f;if(Array.isArray(t.selectedValue)){const v=I.value.filter(F=>{var H;return F.multi&&((H=F.settings)==null?void 0:H.show_textarea)});if(v.length===0)return null;const A={...v[0].settings},P=[];v.forEach(F=>{var H;(H=F.settings)!=null&&H.damage_options&&P.push(...F.settings.damage_options)});const T=P.filter((F,H,R)=>H===R.findIndex(k=>k.value===F.value));return A.damage_options=T,{...v[0],settings:A}}else{const v=t.options.find(A=>A.value===t.selectedValue);return(f=v==null?void 0:v.settings)!=null&&f.show_textarea?v:null}}),U=J(()=>{var f;if(Array.isArray(t.selectedValue))return I.value.find(v=>{var A;return v.multi&&((A=v.settings)==null?void 0:A.show_image_upload)});{const v=t.options.find(A=>A.value===t.selectedValue);return(f=v==null?void 0:v.settings)!=null&&f.show_image_upload?v:null}});J(()=>I.value.find(f=>{var v;return f.multi&&((v=f.settings)==null?void 0:v.show_textarea)})),J(()=>I.value.find(f=>{var v;return f.multi&&((v=f.settings)==null?void 0:v.show_image_upload)}));const L=f=>Array.isArray(t.selectedValue)?t.selectedValue.includes(f.value):t.selectedValue?(typeof t.selectedValue=="string"?t.selectedValue.split(",").map(A=>A.trim()):[t.selectedValue]).includes(f.value):!1,N=(f,v)=>{let A;if(f.multi){const P=Array.isArray(t.selectedValue)?t.selectedValue:[];v.target.checked?A=[...P,f.value]:A=P.filter(T=>T!==f.value)}else A=f.value;C("update:selectedValue",A)},W=J(()=>{var v,A,P,T,F,H,R;if(t.point.input_type==="text"&&(!((v=t.notesValue)!=null&&v.trim())||t.point.settings.min_length&&t.notesValue.length<t.point.settings.min_length||t.point.settings.max_length&&t.notesValue.length>t.point.settings.max_length)||t.point.input_type==="number"&&(!((A=t.notesValue)!=null&&A.trim())||t.point.settings.min&&t.notesValue.length<t.point.settings.min||t.point.settings.max&&t.notesValue.length>t.point.settings.max)||t.point.input_type==="account"&&(!((P=t.notesValue)!=null&&P.trim())||t.point.settings.min_value&&t.notesValue.length<t.point.settings.min_value||t.point.settings.max_value&&t.notesValue.length>t.point.settings.max_value)||t.point.input_type==="date"&&(!((T=t.notesValue)!=null&&T.trim())||t.point.settings.min_date&&t.notesValue.length<t.point.settings.min_date||t.point.settings.max_date&&t.notesValue.length>t.point.settings.max_date))return!1;if(t.point.input_type==="imageTOradio"){if(t.imagesValue.length===0)return!1;const k=t.imagesValue.some(ne=>ne.status==="error"),D=t.imagesValue.some(ne=>ne.status==="uploading");if(k||D)return!1}if(t.options.length&&(!t.selectedValue||Array.isArray(t.selectedValue)&&t.selectedValue.length===0))return!1;const f=S.value;if(t.showTextarea&&((F=f==null?void 0:f.settings)!=null&&F.show_textarea)&&(!((H=t.notesValue)!=null&&H.trim())||f.settings.min_length&&t.notesValue.length<f.settings.min_length||f.settings.max_length&&t.notesValue.length>f.settings.max_length))return!1;if(t.showImageUpload&&((R=f==null?void 0:f.settings)!=null&&R.show_image_upload)){if(t.imagesValue.length===0||f.settings.max_files&&t.imagesValue.length>f.settings.max_files)return!1;const k=t.imagesValue.some(ne=>ne.status==="error"),D=t.imagesValue.some(ne=>ne.status==="uploading");if(k||D)return!1}return!0});return(f,v)=>(i(),Le(pn,{show:n.show,title:n.title,subtitle:n.subtitle,onClose:v[17]||(v[17]=A=>f.$emit("close"))},{footer:Be(()=>[n.selectedPoint?(i(),l("button",{key:0,onClick:v[14]||(v[14]=A=>m(n.pointId)),class:"flex items-center justify-center text-red-600 hover:text-red-800 mb-3"},v[19]||(v[19]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7h6m2-3H7m5 0v3"})],-1),_e(" Hapus Data ")]))):g("",!0),e("div",ya,[e("button",{type:"button",onClick:v[15]||(v[15]=A=>f.$emit("close")),class:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),e("button",{type:"button",onClick:v[16]||(v[16]=A=>f.$emit("save")),disabled:!W.value,class:"flex-1 px-4 py-2 bg-indigo-600 border border-transparent rounded-md shadow-sm text-white hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Simpan ",8,xa)])]),default:Be(()=>{var A,P,T,F,H,R,k,D,ne,w,h,s,x,B,se,be,ce,ye,Se,ve,ue,xe,pe,me,Oe,Fe,we,Ue,Ae,le,$e,Ve,Ie,Ee,Te,Re;return[e("div",na,[n.point.input_type==="text"?(i(),l("div",sa,[fe(un,{"model-value":n.notesValue,required:(A=n.point.settings)==null?void 0:A.is_required,"min-length":(P=n.point.settings)==null?void 0:P.min_length,"max-length":(T=n.point.settings)==null?void 0:T.max_length,allowSpace:(F=n.point.settings)==null?void 0:F.allow_space,textTransform:(H=n.point.settings)==null?void 0:H.text_transform,placeholder:((R=n.point.settings)==null?void 0:R.placeholder)||"Masukan text",error:f.error,"onUpdate:modelValue":v[0]||(v[0]=G=>f.$emit("update:notesValue",G)),onSave:v[1]||(v[1]=G=>f.$emit("saveText",G))},null,8,["model-value","required","min-length","max-length","allowSpace","textTransform","placeholder","error"])])):g("",!0),n.point.input_type==="number"?(i(),l("div",oa,[fe(rn,{"model-value":n.notesValue,required:(k=n.point.settings)==null?void 0:k.is_required,min:(D=n.point.settings)==null?void 0:D.min,max:(ne=n.point.settings)==null?void 0:ne.max,step:((w=n.point.settings)==null?void 0:w.step)||1,placeholder:((h=n.point.settings)==null?void 0:h.placeholder)||"Masukan number",error:f.error,"onUpdate:modelValue":v[2]||(v[2]=G=>f.$emit("update:notesValue",G)),onSave:v[3]||(v[3]=G=>f.$emit("saveNumber",G))},null,8,["model-value","required","min","max","step","placeholder","error"])])):g("",!0),n.point.input_type==="account"?(i(),l("div",aa,[fe(cn,{"model-value":n.notesValue,required:(s=n.point.settings)==null?void 0:s.is_required,placeholder:((x=n.point.settings)==null?void 0:x.placeholder)||"Masukkan nilai",error:f.error,"point-id":n.pointId,settings:n.point.settings,"onUpdate:modelValue":v[4]||(v[4]=G=>f.$emit("update:notesValue",G)),onSave:v[5]||(v[5]=G=>f.$emit("saveAccount",G))},null,8,["model-value","required","placeholder","error","point-id","settings"])])):g("",!0),n.point.input_type==="date"?(i(),l("div",ia,[fe(dn,{"model-value":n.notesValue,required:(B=n.point.settings)==null?void 0:B.is_required,"min-date":(se=n.point.settings)==null?void 0:se.min_date,"max-date":(be=n.point.settings)==null?void 0:be.max_date,error:f.error,"onUpdate:modelValue":v[6]||(v[6]=G=>f.$emit("update:notesValue",G)),onSave:v[7]||(v[7]=G=>f.$emit("saveDate",G))},null,8,["model-value","required","min-date","max-date","error"])])):g("",!0),n.point.input_type==="imageTOradio"?(i(),l("div",la,[e("h4",ra,[(ce=n.point.settings)!=null&&ce.required?(i(),l("span",ua,"*")):g("",!0)]),fe(Ot,{"model-value":n.imagesValue,"point-id":n.pointId,point:n.point.inspection_point,"inspection-id":n.inspectionId,settings:n.point.settings,"onUpdate:modelValue":v[8]||(v[8]=G=>f.$emit("update:imagesValue",G)),onSave:v[9]||(v[9]=G=>f.$emit("saveImage",G))},null,8,["model-value","point-id","point","inspection-id","settings"]),(ye=n.point.settings)!=null&&ye.required&&n.imagesValue.length===0?(i(),l("p",da," Foto wajib diupload ")):g("",!0)])):g("",!0),n.options.length?(i(),l("div",{key:5,class:Q(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(n.options.length,3)}`])},[(i(!0),l(ke,null,Ce(n.options,(G,he)=>(i(),l("label",{key:he,class:"cursor-pointer"},[e("input",{type:G.multi?"checkbox":"radio",name:G.multi?`checkbox-${n.name}`:n.name,value:G.value,checked:L(G),onChange:o=>N(G,o),class:"hidden peer"},null,40,ca),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":L(G),"border-gray-300 text-gray-700 hover:bg-gray-50":!L(G)}])},O(G.label),3)]))),128))],2)):g("",!0),b.value?(i(),l("div",ga,[e("h4",pa,[v[18]||(v[18]=_e(" Upload Foto ")),(ve=(Se=U.value)==null?void 0:Se.settings)!=null&&ve.required?(i(),l("span",ma,"*")):g("",!0)]),fe(Ot,{"model-value":n.imagesValue,"point-id":n.pointId,point:n.point,"inspection-id":n.inspectionId,settings:(ue=U.value)==null?void 0:ue.settings,"onUpdate:modelValue":v[10]||(v[10]=G=>f.$emit("update:imagesValue",G)),onSave:v[11]||(v[11]=G=>f.$emit("saveImage",G))},null,8,["model-value","point-id","point","inspection-id","settings"]),(pe=(xe=U.value)==null?void 0:xe.settings)!=null&&pe.required&&n.imagesValue.length===0?(i(),l("p",va," Foto wajib diupload ")):g("",!0)])):g("",!0),M.value?(i(),l("div",fa,[(Oe=(me=K.value)==null?void 0:me.settings)!=null&&Oe.required?(i(),l("span",ha,"*")):g("",!0),fe(gn,{"model-value":n.notesValue,"point-id":n.pointId,"inspection-id":n.inspectionId,settings:(Fe=K.value)==null?void 0:Fe.settings,required:(Ue=(we=K.value)==null?void 0:we.settings)==null?void 0:Ue.required,"min-length":(le=(Ae=K.value)==null?void 0:Ae.settings)==null?void 0:le.min_length,"max-length":(Ve=($e=K.value)==null?void 0:$e.settings)==null?void 0:Ve.max_length,placeholder:((Ee=(Ie=K.value)==null?void 0:Ie.settings)==null?void 0:Ee.placeholder)||"Tambahkan keterangan...","onUpdate:modelValue":v[12]||(v[12]=G=>f.$emit("update:notesValue",G)),onSave:v[13]||(v[13]=G=>f.$emit("saveTextarea",G))},null,8,["model-value","point-id","inspection-id","settings","required","min-length","max-length","placeholder"]),(Re=(Te=K.value)==null?void 0:Te.settings)!=null&&Re.required&&!n.notesValue?(i(),l("p",ba," Keterangan wajib diisi ")):g("",!0)])):g("",!0)])]}),_:1},8,["show","title","subtitle"]))}},wa={class:"mt-2 space-y-2"},ka=["type","name","value","checked","onChange","required"],Ia={key:0,class:"p-2 rounded-lg bg-gray-50"},_a={key:0,class:"mt-2"},Sa={class:"flex gap-2 overflow-x-auto",style:{"scrollbar-width":"none"}},$a=["src"],Ca={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},Aa={key:1,class:"mt-2"},Va={class:"text-sm text-gray-600"},Ta={key:2,class:"mt-2 text-sm text-red-600"},Ua={__name:"InputRadio",props:{modelValue:[String,Array],required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(n,{emit:Z}){const t=n,C=Z,m=$(t.notes),S=$([...t.images]),I=$(!1),M=$(""),b=$([]),K=$(""),U=$([]);J(()=>t.options.find(k=>k.value===t.modelValue));const L=J(()=>Array.isArray(t.modelValue)?t.options.filter(k=>t.modelValue.includes(k.value)):t.modelValue?[t.options.find(k=>k.value===t.modelValue)].filter(Boolean):[]),N=k=>Array.isArray(t.modelValue)?t.modelValue.includes(k.value):t.modelValue?(typeof t.modelValue=="string"?t.modelValue.split(",").map(ne=>ne.trim()):[t.modelValue]).includes(k.value):!1,W=k=>k.settings&&(k.settings.show_textarea||k.settings.show_image_upload);re(()=>t.notes,k=>{m.value=k}),re(()=>t.images,k=>{S.value=[...k]}),re(()=>t.modelValue,k=>{k?K.value=Array.isArray(k)?[...k]:k:K.value=""});const f=(k,D)=>{let ne;if(k.multi){const w=Array.isArray(t.modelValue)?t.modelValue:[];D.target.checked?ne=[...w,k.value]:ne=w.filter(h=>h!==k.value)}else ne=k.value;C("update:modelValue",ne),W(k)?A():C("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:ne,notes:"",images:[]})},v=k=>k.preview||(k.image_path?`/${k.image_path}`:k),A=()=>{K.value=t.modelValue,M.value=m.value,b.value=[...S.value],U.value=[...S.value],I.value=!0},P=()=>{M.value="",b.value=[],K.value=Array.isArray(t.modelValue)?[...t.modelValue]:t.modelValue,I.value=!1},T=k=>{b.value=k,S.value=[...k],C("update:images",[...k]),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:t.modelValue,notes:m.value,images:[...k]})},F=k=>{},H=()=>{K.value!==t.modelValue&&C("update:modelValue",K.value),m.value=M.value,C("update:notes",M.value),S.value=[...b.value],C("update:images",[...b.value]),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:K.value,notes:M.value,images:b.value}),I.value=!1},R=k=>{K.value="",M.value="",b.value=[],m.value="",S.value=[],C("update:modelValue",""),C("update:notes",""),C("update:images",[]),C("hapus",k),I.value=!1};return(k,D)=>{var ne;return i(),l("div",wa,[e("div",{class:Q(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(n.options.length,3)}`])},[(i(!0),l(ke,null,Ce(n.options,(w,h)=>(i(),l("label",{key:h,class:"cursor-pointer"},[e("input",{type:w.multi?"checkbox":"radio",name:w.multi?`checkbox-${n.pointId}`:"radio-"+n.pointId,value:w.value,checked:N(w),onChange:s=>f(w,s),class:"hidden peer",required:n.required&&!w.multi},null,40,ka),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":N(w),"border-gray-300 text-gray-700 hover:bg-gray-50":!N(w)}])},O(w.label),3)]))),128))],2),n.modelValue&&L.value.length>0&&L.value.some(w=>W(w))?(i(),l("div",Ia,[e("div",{class:"flex justify-between items-start"},[D[4]||(D[4]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail : ",-1)),e("button",{onClick:A,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),n.images.length>0&&L.value.some(w=>{var h;return(h=w.settings)==null?void 0:h.show_image_upload})?(i(),l("div",_a,[e("div",Sa,[(i(!0),l(ke,null,Ce(n.images,(w,h)=>(i(),l("div",{key:h,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:v(w),class:"w-full h-full object-cover rounded"},null,8,$a),h===3&&n.images.length>4?(i(),l("span",Ca," +"+O(n.images.length-4),1)):g("",!0)]))),128))])])):g("",!0),n.notes&&L.value.some(w=>{var h;return(h=w.settings)==null?void 0:h.show_textarea})?(i(),l("div",Aa,[e("p",Va,O(n.notes),1)])):g("",!0)])):g("",!0),I.value?(i(),Le(Ft,{key:(ne=n.selectedPoint)==null?void 0:ne.id,show:I.value,title:n.pointName||"Detail",subtitle:n.subtitle||"",name:"modal-radio-"+n.pointId,options:n.options,"selected-value":K.value,"notes-value":M.value,"images-value":b.value,"point-id":n.pointId,point:n.point,"inspection-id":n.inspectionId,"selected-point":n.selectedPoint,"onUpdate:selectedValue":D[0]||(D[0]=w=>K.value=w),"onUpdate:notesValue":D[1]||(D[1]=w=>M.value=w),"onUpdate:imagesValue":D[2]||(D[2]=w=>T(w)),onClose:P,onSave:H,onSaveTextarea:k.handleTextareaSave,onSaveImage:F,onHapus:D[3]||(D[3]=w=>R(n.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point","onSaveTextarea"])):g("",!0),n.error?(i(),l("p",Ta,O(n.error),1)):g("",!0)])}}},Ea={class:"mt-2 space-y-2"},Na={key:0,class:"flex flex-wrap gap-3"},Ma={key:1,class:"p-2"},Da={key:0,class:"mt-2"},Pa={class:"flex gap-2 overflow-x-auto scrollbar-hide"},La=["src"],Ra={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-xs"},ja=["type","name","value","checked"],Ba={key:1,class:"mt-2"},Oa={class:"text-sm text-gray-600"},Fa={key:3,class:"mt-2 text-sm text-red-600"},Ka={__name:"InputImageToRadio",props:{modelValue:[String,Array],required:Boolean,error:String,point:Object,pointId:[String,Number],pointName:String,subtitle:String,inspectionId:[String,Number],options:{type:Array,default:()=>[]},selectedPoint:Object,notes:{type:String,default:""},images:{type:Array,default:()=>[]}},emits:["update:modelValue","update:notes","update:images","save","hapus"],setup(n,{emit:Z}){const t=n,C=Z,m=$(t.notes),S=$([...t.images]),I=$(!1),M=$(""),b=$([]),K=$(""),U=$([]),L=J(()=>{if(Array.isArray(t.modelValue))return t.options.find(R=>t.modelValue.includes(R.value));if(t.modelValue){const R=typeof t.modelValue=="string"?t.modelValue.split(",").map(k=>k.trim()):[t.modelValue];return t.options.find(k=>R.includes(k.value))}return null}),N=J(()=>{if(Array.isArray(t.modelValue))return t.options.filter(R=>t.modelValue.includes(R.value));if(t.modelValue){const R=typeof t.modelValue=="string"?t.modelValue.split(",").map(k=>k.trim()):[t.modelValue];return t.options.filter(k=>R.includes(k.value))}return[]}),W=J(()=>N.value.some(R=>{var k;return R.multi&&((k=R.settings)==null?void 0:k.show_textarea)}));J(()=>N.value.find(R=>{var k;return R.multi&&((k=R.settings)==null?void 0:k.show_textarea)}));const f=R=>Array.isArray(t.modelValue)?t.modelValue.includes(R.value):t.modelValue?(typeof t.modelValue=="string"?t.modelValue.split(",").map(D=>D.trim()):[t.modelValue]).includes(R.value):!1,v=R=>R.preview||(R.image_path?`/${R.image_path}`:R);re(()=>t.notes,R=>{m.value=R});const A=()=>{K.value=t.modelValue||"",M.value=m.value,b.value=[...S.value],U.value=[...S.value],I.value=!0},P=()=>{M.value="",b.value=[],K.value="",I.value=!1},T=R=>{b.value=R,S.value=[...R],C("update:images",[...R]),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:t.modelValue,notes:m.value,images:[...R]})},F=()=>{K.value!==t.modelValue&&C("update:modelValue",K.value),m.value=M.value,C("update:notes",M.value),S.value=[...b.value],C("update:images",[...b.value]),C("save",{pointId:t.pointId,inspectionId:t.inspectionId,value:K.value,notes:M.value,images:b.value}),I.value=!1},H=R=>{K.value="",M.value="",b.value=[],m.value="",S.value=[],C("update:modelValue",""),C("update:notes",""),C("update:images",[]),C("hapus",R),I.value=!1};return(R,k)=>{var D,ne,w;return i(),l("div",Ea,[!n.modelValue&&S.value.length===0&&!m.value?(i(),l("div",Na,[e("div",{class:"relative w-28 h-28 border-2 border-dashed rounded-lg flex items-center justify-center cursor-pointer overflow-hidden",onClick:A},k[4]||(k[4]=[e("div",{class:"flex flex-col items-center text-gray-400"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",{class:"text-xs font-medium"},"Tambah")],-1)]))])):(i(),l("div",Ma,[e("div",{class:"flex justify-between items-start"},[k[5]||(k[5]=e("h4",{class:"text-sm font-medium text-gray-700"},"Detail :",-1)),e("button",{onClick:A,class:"text-sm text-indigo-600 hover:text-indigo-800"}," Edit ")]),S.value.length>0?(i(),l("div",Da,[e("div",Pa,[(i(!0),l(ke,null,Ce(S.value,(h,s)=>(i(),l("div",{key:s,class:"relative flex-shrink-0",style:{width:"130px",height:"130px"}},[e("img",{src:v(h),class:"w-full h-full object-cover rounded"},null,8,La),s===3&&S.value.length>4?(i(),l("span",Ra," +"+O(S.value.length-4),1)):g("",!0)]))),128))])])):g("",!0),e("div",{class:Q(["grid gap-2 w-full mt-2",`grid-cols-${Math.min(n.options.length,3)}`])},[(i(!0),l(ke,null,Ce(n.options,(h,s)=>(i(),l("label",{key:s,class:"cursor-pointer"},[e("input",{type:h.multi?"checkbox":"radio",name:h.multi?`checkbox-${n.pointId}`:`radio-${n.pointId}`,value:h.value,checked:f(h),disabled:!0,class:"hidden peer"},null,8,ja),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-colors whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700":f(h),"border-gray-300 text-gray-700 hover:bg-gray-50":!f(h)}])},O(h.label),3)]))),128))],2),m.value&&((ne=(D=L.value)==null?void 0:D.settings)!=null&&ne.show_textarea||W.value)?(i(),l("div",Ba,[e("p",Oa,O(m.value),1)])):g("",!0)])),I.value?(i(),Le(Ft,{key:(w=n.selectedPoint)==null?void 0:w.id,show:I.value,title:n.pointName||"Detail",subtitle:n.subtitle||"",name:"modal-radio-"+n.pointId,options:n.options,"selected-value":K.value,"notes-value":M.value,"images-value":b.value,"point-id":n.pointId,point:n.point,"inspection-id":n.inspectionId,"selected-point":n.selectedPoint,"onUpdate:selectedValue":k[0]||(k[0]=h=>K.value=h),"onUpdate:notesValue":k[1]||(k[1]=h=>M.value=h),"onUpdate:imagesValue":k[2]||(k[2]=h=>T(h)),onClose:P,onSave:F,onHapus:k[3]||(k[3]=h=>H(n.pointId))},null,8,["show","title","subtitle","name","options","selected-value","notes-value","images-value","point-id","point","inspection-id","selected-point"])):g("",!0),n.error?(i(),l("p",Fa,O(n.error),1)):g("",!0)])}}},qa={class:"text-base font-semibold text-indigo-700"},za={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ha={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ga={class:"text-base font-semibold text-indigo-700"},Wa={class:"p-4 space-y-4"},Ja={key:0,class:"flex justify-end py-1"},Ya=["onClick"],Za={key:1,class:"space-y-2"},Xa={class:"flex items-start justify-between"},Qa={class:"flex-1"},ei={class:"block text-sm font-medium text-gray-900"},ti={class:"font-bold"},ni={key:0,class:"text-red-500"},si={key:1,class:"italic text-xs text-gray-400 ml-2"},oi={key:0,class:"mt-1"},ai={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800"},ii={key:0},li={key:1},ri={key:2},ui={key:3},di={key:4},ci={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"},gi={key:9,class:"p-3 bg-gray-100 rounded text-sm text-gray-600"},pi={class:"text-xs mt-1 list-disc list-inside"},mi={key:0},vi={key:1},fi={key:2},hi={key:3},bi={key:4},yi={key:0,class:"text-center py-8 text-gray-500"},xi={key:0,class:"text-xs text-gray-400"},wi={__name:"CategorySection",props:{category:Object,form:Object,head:Object,inspectionId:String,selectedPoint:Object,car:Object},emits:["updateResult","removeImage","hapusPoint"],setup(n,{emit:Z}){const t=n,C=Z,m=Dt("vehicleFeatures",$(null));m.value=JSON.parse(localStorage.getItem("vehicle_features")||"{}"),Mt("vehicleFeatures",m);const S=$(!1),I=$([]),M=$(!0),b=$(null),K=wn(),U={MT:"Manual Transmission (MT)",AT:"Automatic Transmission (AT)",CVT:"Continuously Variable Transmission (CVT)","e-CVT":"Electronic CVT (e-CVT)",DCT:"Dual Clutch Transmission (DCT)",AMT:"Automated Manual Transmission (AMT)",IVT:"Intelligent Variable Transmission (IVT)",SSG:"Seamless Shift Gearbox (SSG)",AGS:"Auto Gear Shift (AGS)",DHT:"Dedicated Hybrid Transmission (DHT)"};ot(()=>{const w=new IntersectionObserver(([h])=>{M.value=h.isIntersecting},{threshold:.1});b.value&&w.observe(b.value),Pt(()=>{b.value&&w.unobserve(b.value)})});const L=()=>{S.value=!S.value,S.value||(I.value=[])},N=J(()=>(t.category.points||[]).some(w=>w.is_default===!1)),W=w=>!w||!Array.isArray(w)?[]:w.map(h=>U[h]||h),f=w=>{var B,se;const h=w.settings;if(!v(w))return!0;const s=(B=t.car)==null?void 0:B.transmission,x=(se=t.car)==null?void 0:se.fuel_type;return!(h.transmission&&Array.isArray(h.transmission)&&h.transmission.length>0&&s&&!h.transmission.includes(s)||h.fuel_type&&h.fuel_type.trim()!==""&&x&&h.fuel_type!==x||h.rear_door&&(!m.value||!m.value.rear_door)||h.pick_up&&(!m.value||!m.value.pick_up)||h.box&&(!m.value||!m.value.box))},v=w=>{const h=w.settings;return!!(h!=null&&h.transmission&&Array.isArray(h.transmission)&&h.transmission.length>0||h!=null&&h.fuel_type&&h.fuel_type.trim()!==""||h!=null&&h.rear_door||h!=null&&h.pick_up||h!=null&&h.box)},A=w=>v(w)&&(S.value||f(w)),P=J(()=>{const w=t.category.points||[],h=[];let s=[];return S.value?t.category.isDamageMenu?w.filter(x=>{var B;return x.is_default||F((B=x.inspection_point)==null?void 0:B.id)||S.value}):w:t.category.isDamageMenu?w.filter(x=>{var se;const B=(se=x.inspection_point)==null?void 0:se.id;return F(B)||x.is_default||I.value.includes(B)}):(w.forEach(x=>{var ve;const B=(ve=x.inspection_point)==null?void 0:ve.id,se=F(B),be=I.value.includes(B),ye=!v(x)||f(x);(x.is_default||se||be)&&ye?(s.length>0&&(h.push({is_link:!0,count:s.length,hiddenIds:s.map(ue=>ue.inspection_point.id)}),s.forEach(ue=>{I.value.includes(ue.inspection_point.id)&&h.push(ue)}),s=[]),h.push(x)):(!v(x)||f(x))&&s.push(x)}),s.length>0&&(h.push({is_link:!0,count:s.length,hiddenIds:s.map(x=>x.inspection_point.id)}),s.forEach(x=>{I.value.includes(x.inspection_point.id)&&h.push(x)})),h.filter(x=>{var B,se;return x.is_link||x.is_default||F((B=x.inspection_point)==null?void 0:B.id)||I.value.includes((se=x.inspection_point)==null?void 0:se.id)}))});J(()=>P.value.filter(w=>!w.is_link));const T=w=>{S.value=!1,w.forEach(h=>{I.value.includes(h)||I.value.push(h)})},F=w=>{if(!w)return!1;const h=K.props.existingResults[w]!==void 0,s=K.props.existingImages[w]&&K.props.existingImages[w].length>0,x=t.form.results[w]&&(t.form.results[w].status||t.form.results[w].note),B=t.form.images[w]&&t.form.images[w].length>0;return h||s||x||B},H=[{value:"good",label:"Good"},{value:"bad",label:"Bad"},{value:"na",label:"N/A"}],R=w=>{var x,B,se,be,ce,ye,Se,ve,ue;const h=t.form.results[(x=w.inspection_point)==null?void 0:x.id],s=t.form.images[(B=w.inspection_point)==null?void 0:B.id];if(!h)return!1;switch(w.input_type){case"text":case"number":case"date":case"account":case"textarea":return!!h.note;case"select":case"radio":if(!h.status)return!1;const xe=(be=(se=w.settings)==null?void 0:se.radios)==null?void 0:be.find(me=>me.value===h.status);return!(xe!=null&&xe.settings&&(xe.settings.show_textarea&&!((ce=h.note)!=null&&ce.trim())||xe.settings.show_image_upload&&(s==null?void 0:s.length)===0));case"imageTOradio":if((s==null?void 0:s.length)===0||!h.status)return!1;const pe=(Se=(ye=w.settings)==null?void 0:ye.radios)==null?void 0:Se.find(me=>me.value===h.status);return!(pe!=null&&pe.settings&&pe.settings.show_textarea&&!((ve=h.note)!=null&&ve.trim()));case"image":return(s==null?void 0:s.length)>0;default:return!!h.status||!!((ue=h.note)!=null&&ue.trim())}},k=(w,h,s)=>{C("updateResult",{pointId:w,type:s,value:h})},D=w=>{console.log("Save result for point:",w)},ne=w=>{C("hapusPoint",w)};return re(()=>t.form.results,w=>{},{deep:!0}),re(()=>t.form.images,w=>{},{deep:!0}),re(()=>t.car,w=>{console.log("Car data updated:",w)},{deep:!0}),re(m,w=>{console.log("Vehicle features updated:",w)},{deep:!0}),(w,h)=>(i(),l(ke,null,[t.head==="vertical"?(i(),l("div",{key:0,class:Q(["px-6 py-2 border-b flex items-center justify-between bg-indigo-200","fixed top-0 left-0 right-0 z-20"])},[e("h4",qa,O(n.category.name),1),N.value?(i(),l("button",{key:0,onClick:L,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},O(S.value?"Sembunyikan Semua":"Tampilkan Point Lain"),1)):g("",!0)])):g("",!0),e("div",{class:Q(["bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100",t.head==="vertical"?"pt-6":""])},[!M.value&&N.value?(i(),l("button",{key:0,onClick:L,class:"fixed top-3 right-2 z-10 bg-indigo-600 text-white p-2 rounded-full shadow-lg"},[S.value?(i(),l("svg",za,h[0]||(h[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)]))):(i(),l("svg",Ha,h[1]||(h[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.006-3.362M9.88 9.88a3 3 0 104.24 4.24M6.1 6.1l11.8 11.8"},null,-1)])))])):g("",!0),t.head==="horizontal"?(i(),l("div",{key:1,ref_key:"categoryHeader",ref:b,class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",Ga,O(n.category.name),1),N.value?(i(),l("button",{key:0,onClick:L,class:"text-sm text-indigo-700 hover:underline focus:outline-none"},O(S.value?"Sembunyikan":"Tampilkan Point Lain"),1)):g("",!0)],512)):g("",!0),e("div",Wa,[(i(!0),l(ke,null,Ce(P.value,(s,x)=>{var B,se,be,ce,ye,Se,ve,ue,xe,pe,me,Oe,Fe,we,Ue,Ae,le,$e,Ve,Ie,Ee,Te,Re,G,he,o,c,p,V,u,d,q,y,j,te,oe,ie,Ne,We,Ze,ze,pt,mt,vt,kt,at,ft,ht,it,Pe,He,Ke,lt,It,rt,Xe,ut,Qe,et,_t,St,$t,tt,Ct,At,Vt,Tt,Ut,Et;return i(),l("div",{key:x,class:Q(["space-y-2 last:border-0 last:pb-0",s.is_link?"pb-0":"pb-2 border-b border-gray-100"])},[s.is_link?(i(),l("div",Ja,[e("button",{onClick:z=>T(s.hiddenIds),class:"text-sm font-medium text-indigo-600 hover:text-indigo-800 hover:underline focus:outline-none"}," Tampilkan "+O(s.count)+" Point Tersembunyi ",9,Ya)])):(i(),l("div",Za,[e("div",Xa,[e("div",Qa,[e("label",ei,[e("span",ti,O((B=s.inspection_point)==null?void 0:B.name),1),(se=s.settings)!=null&&se.is_required?(i(),l("span",ni,"*")):g("",!0),!s.is_default&&!F((be=s.inspection_point)==null?void 0:be.id)?(i(),l("span",si," (opsional) ")):g("",!0)]),A(s)?(i(),l("div",oi,[v(s)?(i(),l("div",ai,[(ce=s.settings)!=null&&ce.transmission?(i(),l("div",ii,O(s.settings.transmission.join(", ")),1)):g("",!0),(ye=s.settings)!=null&&ye.fuel_type?(i(),l("div",li,O(s.settings.fuel_type),1)):g("",!0),(Se=s.settings)!=null&&Se.rear_door?(i(),l("div",ri," Pintu Belakang ")):g("",!0),(ve=s.settings)!=null&&ve.pick_up?(i(),l("div",ui," Tipe Pick Up ")):g("",!0),(ue=s.settings)!=null&&ue.box?(i(),l("div",di," Memiliki Box ")):g("",!0)])):g("",!0)])):g("",!0)]),R(s)?(i(),l("span",ci," âœ“ ")):g("",!0)]),s.input_type==="text"&&f(s)?(i(),Le(un,{key:0,modelValue:n.form.results[(xe=s.inspection_point)==null?void 0:xe.id].note,"onUpdate:modelValue":[z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].note=z},z=>{var _;return k((_=s.inspection_point)==null?void 0:_.id,z,"note")}],required:(pe=s.settings)==null?void 0:pe.is_required,"min-length":(me=s.settings)==null?void 0:me.min_length,"max-length":(Oe=s.settings)==null?void 0:Oe.max_length,allowSpace:(Fe=s.settings)==null?void 0:Fe.allow_space,textTransform:(we=s.settings)==null?void 0:we.text_transform,placeholder:((Ue=s.settings)==null?void 0:Ue.placeholder)||"Masukan text",error:n.form.errors[`results.${(Ae=s.inspection_point)==null?void 0:Ae.id}.note`],onSave:z=>{var _;return D((_=s.inspection_point)==null?void 0:_.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","allowSpace","textTransform","placeholder","error","onSave"])):g("",!0),s.input_type==="number"&&f(s)?(i(),Le(rn,{key:1,modelValue:n.form.results[(le=s.inspection_point)==null?void 0:le.id].note,"onUpdate:modelValue":[z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].note=z},z=>{var _;return k((_=s.inspection_point)==null?void 0:_.id,z,"note")}],required:($e=s.settings)==null?void 0:$e.is_required,min:(Ve=s.settings)==null?void 0:Ve.min,max:(Ie=s.settings)==null?void 0:Ie.max,step:((Ee=s.settings)==null?void 0:Ee.step)||1,placeholder:((Te=s.settings)==null?void 0:Te.placeholder)||"Masukan number",error:n.form.errors[`results.${(Re=s.inspection_point)==null?void 0:Re.id}.note`],onSave:z=>{var _;return D((_=s.inspection_point)==null?void 0:_.id)}},null,8,["modelValue","onUpdate:modelValue","required","min","max","step","placeholder","error","onSave"])):g("",!0),s.input_type==="account"&&f(s)?(i(),Le(cn,{key:2,modelValue:n.form.results[(G=s.inspection_point)==null?void 0:G.id].note,"onUpdate:modelValue":[z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].note=z},z=>{var _;return k((_=s.inspection_point)==null?void 0:_.id,z,"note")}],required:(he=s.settings)==null?void 0:he.is_required,placeholder:((o=s.settings)==null?void 0:o.placeholder)||"Masukkan nilai",error:n.form.errors[`results.${(c=s.inspection_point)==null?void 0:c.id}.note`],"point-id":(p=s.inspection_point)==null?void 0:p.id,settings:s.settings,onSave:z=>{var _;return D((_=s.inspection_point)==null?void 0:_.id)}},null,8,["modelValue","onUpdate:modelValue","required","placeholder","error","point-id","settings","onSave"])):g("",!0),s.input_type==="date"&&f(s)?(i(),Le(dn,{key:3,modelValue:n.form.results[(V=s.inspection_point)==null?void 0:V.id].note,"onUpdate:modelValue":[z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].note=z},z=>{var _;return k((_=s.inspection_point)==null?void 0:_.id,z,"note")}],required:(u=s.settings)==null?void 0:u.is_required,"min-date":(d=s.settings)==null?void 0:d.min_date,"max-date":(q=s.settings)==null?void 0:q.max_date,error:n.form.errors[`results.${(y=s.inspection_point)==null?void 0:y.id}.note`],onSave:z=>{var _;return D((_=s.inspection_point)==null?void 0:_.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-date","max-date","error","onSave"])):g("",!0),s.input_type==="textarea"&&f(s)?(i(),Le(gn,{key:4,modelValue:n.form.results[(j=s.inspection_point)==null?void 0:j.id].note,"onUpdate:modelValue":[z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].note=z},z=>{var _;return k((_=s.inspection_point)==null?void 0:_.id,z,"note")}],required:(te=s.settings)==null?void 0:te.is_required,"min-length":(oe=s.settings)==null?void 0:oe.min_length,"max-length":(ie=s.settings)==null?void 0:ie.max_length,placeholder:((Ne=s.settings)==null?void 0:Ne.placeholder)||"Masukkan teks di sini",settings:s.settings,error:n.form.errors[`results.${(We=s.inspection_point)==null?void 0:We.id}.note`],onSave:z=>{var _;return D((_=s.inspection_point)==null?void 0:_.id)}},null,8,["modelValue","onUpdate:modelValue","required","min-length","max-length","placeholder","settings","error","onSave"])):g("",!0),s.input_type==="radio"&&f(s)?(i(),Le(Ua,{key:5,modelValue:n.form.results[(Ze=s.inspection_point)==null?void 0:Ze.id].status,"onUpdate:modelValue":[z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].status=z},z=>{var _;return k((_=s.inspection_point)==null?void 0:_.id,z,"status")}],notes:n.form.results[(ze=s.inspection_point)==null?void 0:ze.id].note,images:n.form.images[(pt=s.inspection_point)==null?void 0:pt.id],required:(mt=s.settings)==null?void 0:mt.is_required,"point-id":(vt=s.inspection_point)==null?void 0:vt.id,point:s.inspection_point,"inspection-id":n.inspectionId,settings:s.settings,"point-name":(kt=s.inspection_point)==null?void 0:kt.name,subtitle:(at=s.inspection_point)==null?void 0:at.description,"selected-point":s.inspection_point??null,options:((ft=s.settings)==null?void 0:ft.radios)||H,error:n.form.errors[`results.${(ht=s.inspection_point)==null?void 0:ht.id}.status`],"onUpdate:notes":z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].note=z},"onUpdate:images":z=>{var _;return n.form.images[(_=s.inspection_point)==null?void 0:_.id]=z},onSave:z=>{var _;return D((_=s.inspection_point)==null?void 0:_.id)},onHapus:z=>{var _;return ne((_=s.inspection_point)==null?void 0:_.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","point","inspection-id","settings","point-name","subtitle","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):g("",!0),s.input_type==="imageTOradio"&&f(s)?(i(),Le(Ka,{key:6,modelValue:n.form.results[(it=s.inspection_point)==null?void 0:it.id].status,"onUpdate:modelValue":[z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].status=z},z=>{var _;return k((_=s.inspection_point)==null?void 0:_.id,z,"status")}],notes:n.form.results[(Pe=s.inspection_point)==null?void 0:Pe.id].note,images:n.form.images[(He=s.inspection_point)==null?void 0:He.id],required:(Ke=s.settings)==null?void 0:Ke.is_required,"point-id":(lt=s.inspection_point)==null?void 0:lt.id,"inspection-id":n.inspectionId,settings:s.settings,"point-name":(It=s.inspection_point)==null?void 0:It.name,subtitle:(rt=s.inspection_point)==null?void 0:rt.description,point:s,"selected-point":s.inspection_point??null,options:((Xe=s.settings)==null?void 0:Xe.radios)||H,error:n.form.errors[`results.${(ut=s.inspection_point)==null?void 0:ut.id}.status`],"onUpdate:notes":z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].note=z},"onUpdate:images":z=>{var _;return n.form.images[(_=s.inspection_point)==null?void 0:_.id]=z},onSave:z=>{var _;return D((_=s.inspection_point)==null?void 0:_.id)},onHapus:z=>{var _;return ne((_=s.inspection_point)==null?void 0:_.id)}},null,8,["modelValue","onUpdate:modelValue","notes","images","required","point-id","inspection-id","settings","point-name","subtitle","point","selected-point","options","error","onUpdate:notes","onUpdate:images","onSave","onHapus"])):g("",!0),s.input_type==="image"&&f(s)?(i(),Le(Ot,{key:7,modelValue:n.form.images[(Qe=s.inspection_point)==null?void 0:Qe.id],"onUpdate:modelValue":z=>{var _;return n.form.images[(_=s.inspection_point)==null?void 0:_.id]=z},error:n.form.errors[`images.${(et=s.inspection_point)==null?void 0:et.id}`],"inspection-id":n.inspectionId,"point-id":(_t=s.inspection_point)==null?void 0:_t.id,point:s.inspection_point,"point-name":(St=s.inspection_point)==null?void 0:St.name,settings:s.settings,"onUpdate:notes":z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].note=z},"onUpdate:status":z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].status=z}},null,8,["modelValue","onUpdate:modelValue","error","inspection-id","point-id","point","point-name","settings","onUpdate:notes","onUpdate:status"])):g("",!0),s.input_type==="select"&&f(s)?(i(),Le(Bs,{key:8,modelValue:n.form.results[($t=s.inspection_point)==null?void 0:$t.id].status,"onUpdate:modelValue":[z=>{var _;return n.form.results[(_=s.inspection_point)==null?void 0:_.id].status=z},z=>{var _;return k((_=s.inspection_point)==null?void 0:_.id,z,"status")}],required:(tt=s.settings)==null?void 0:tt.is_required,error:n.form.errors[`results.${(Ct=s.inspection_point)==null?void 0:Ct.id}.status`],onSave:z=>{var _;return D((_=s.inspection_point)==null?void 0:_.id)}},null,8,["modelValue","onUpdate:modelValue","required","error","onSave"])):g("",!0),!f(s)&&v(s)?(i(),l("div",gi,[h[2]||(h[2]=e("p",{class:"font-medium"},"Tidak tersedia untuk kendaraan ini",-1)),h[3]||(h[3]=e("p",{class:"text-xs mt-1"},"Point ini hanya tersedia untuk:",-1)),e("ul",pi,[(At=s.settings)!=null&&At.transmission?(i(),l("li",mi," Transmisi: "+O(W(s.settings.transmission).join(", ")),1)):g("",!0),(Vt=s.settings)!=null&&Vt.fuel_type?(i(),l("li",vi," Bahan bakar: "+O(s.settings.fuel_type),1)):g("",!0),(Tt=s.settings)!=null&&Tt.rear_door?(i(),l("li",fi,"Kendaraan dengan pintu belakang")):g("",!0),(Ut=s.settings)!=null&&Ut.pick_up?(i(),l("li",hi,"Tipe pick up")):g("",!0),(Et=s.settings)!=null&&Et.box?(i(),l("li",bi,"Kendaraan dengan box")):g("",!0)])])):g("",!0)]))],2)}),128)),P.value.filter(s=>!s.is_link).length===0?(i(),l("div",yi,[h[4]||(h[4]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),h[5]||(h[5]=e("p",{class:"mt-2 text-sm"},"Tidak ada data untuk ditampilkan",-1)),n.category.isDamageMenu?(i(),l("p",xi,' Tambahkan data melalui tombol "+" di pojok kanan bawah ')):g("",!0)])):g("",!0)])],2)],64))}},ki=Ye(wi,[["__scopeId","data-v-704b9892"]]),Ii={class:"bg-gray-50 shadow-lg rounded-xl overflow-hidden border border-gray-100"},_i={class:"p-4 space-y-4-6"},Si={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},$i=["value"],Ci={class:"p-4 space-y-4-6"},Ai={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},Vi=["value"],Ti={key:0,class:"p-4 space-y-4 bg-blue-50 rounded-lg border border-blue-200"},Ui={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-2 w-full"},Ei=["value"],Ni={class:"p-4 space-y-2"},Mi={class:"flex items-center justify-between mb-2"},Di={key:0,class:"mb-4 p-4 bg-white border border-gray-200 rounded-lg shadow-lg"},Pi={class:"flex items-center justify-between mb-3"},Li={class:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-60 overflow-y-auto"},Ri=["onClick"],ji={class:"text-sm font-medium text-gray-800 mb-1"},Bi={class:"text-xs text-gray-600 line-clamp-2"},Oi={class:"flex flex-wrap gap-1 mb-2 p-2 bg-gray-100 rounded-md"},Fi={key:0,class:"text-xs text-gray-500 mb-2 bg-gray-50 p-2 rounded border"},Ki={key:0,class:"font-bold mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},qi={key:1,class:"italic mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},zi={key:2,class:"underline mx-1 bg-indigo-100 text-indigo-700 px-2 py-1 rounded"},Hi={__name:"ConclusionSection",props:{inspectionId:{type:Number,required:!0},inspection:{type:Object,required:!0},form:{type:Object,required:!0}},emits:["updateConclusion"],setup(n,{emit:Z}){const t=n,C=Z,m=$(null),S=$(!1),I=$(!1),M=sn({bold:!1,italic:!1,underline:!1}),b=sn({flooded:"",collision:"",collision_severity:"",notes:""}),K=$([{id:1,name:"Kendaraan Normal",description:"Template untuk kendaraan dalam kondisi normal tanpa masalah signifikan (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi kendaraan secara umum: <b>BAIK</b><br>
- Tidak ditemukan indikasi kerusakan signifikan<br>
- Semua sistem berfungsi dengan normal<br>`},{id:2,name:"Kendaraan Bekas Tabrakan Ringan",description:"Template untuk kendaraan dengan riwayat tabrakan ringan (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat tabrakan dengan tingkat kerusakan: <b>RINGAN</b><br>
- Area yang terdampak: PERLU DIISI<br>
- Perbaikan yang dilakukan: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`},{id:3,name:"Kendaraan Bekas Banjir",description:"Template untuk kendaraan dengan riwayat terkena banjir (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kendaraan memiliki riwayat terkena banjir<br>
- Tingkat paparan air: PERLU DIISI<br>
- Komponen yang terdampak: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`},{id:4,name:"Kendaraan dengan Multiple Issues",description:"Template untuk kendaraan dengan beberapa masalah umum (Lengkap A, C, B)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Kondisi umum kendaraan: PERLU DIISI<br>
- Masalah utama yang ditemukan: PERLU DIISI<br>
- Komponen yang perlu perhatian: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI<br>

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`},{id:5,name:"Template Singkat",description:"Template ringkas untuk kesimpulan cepat (Ringkas)",content:`<p><strong>A. HASIL INSPEKSI:</strong></p>
- Status Keseluruhan Kendaraan: PERLU DIISI<br>
- Catatan Utama: PERLU DIISI<br>
- Status Tabrak/Banjir: PERLU DIISI`},{id:6,name:"Template Teknis Detail",description:"Template detail untuk laporan teknis lengkap (Lengkap A, C, B)",content:`<p><strong>A. LAPORAN HASIL INSPEKSI TEKNIS:</strong></p>
- Tanggal Inspeksi: PERLU DIISI<br>
- Kondisi Mesin: PERLU DIISI<br>
- Kondisi Transmisi: PERLU DIISI<br>
- Kondisi Suspensi: PERLU DIISI<br>
- Kondisi Rem: PERLU DIISI<br>
- Kondisi Body: PERLU DIISI<br>
- Kondisi Interior: PERLU DIISI<br>
- Kesimpulan Akhir: PERLU DIISI

<p><strong>C. ESTIMASI PERBAIKAN DAN PERAWATAN:</strong></p>
<p>* PERBAIKAN & PENGGANTIAN PART DALAM WAKTU DEKAT/ SEGERA:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p>* PERBAIKAN & PENGGANTIAN PART TENGGANG WAKTU MINIMAL 6 BULAN S/D 1 TAHUN KE DEPAN:</p>
- PERLU DIISI<br>
- Estimasi Biaya: PERLU DIISI
<p><em>Note: Estimasi perbaikan bisa lebih murah/lebih mahal. Opsional tergantung lokasi/daerah dan ketersediaan spare part.</em></p>`}]);$(["{PLATE_NUMBER}","{CAR_NAME}","{INSPECTION_DATE}","{DAMAGED_AREA}","{REPAIR_DETAILS}","{WATER_LEVEL}","{AFFECTED_COMPONENTS}","{OVERALL_CONDITION}","{MAIN_ISSUES}","{ATTENTION_NEEDED}","{REPAIR_COST_ESTIMATE}","{RECOMMENDATION}","{OVERALL_STATUS}","{ADDITIONAL_NOTES}","{ENGINE_CONDITION}","{TRANSMISSION_CONDITION}","{SUSPENSION_CONDITION}","{BRAKE_CONDITION}","{BODY_CONDITION}","{INTERIOR_CONDITION}","{FINAL_CONCLUSION}"]);const U=s=>{if(!s)return{};if(typeof s=="string")try{return JSON.parse(s)||{}}catch(x){return console.error("Error parsing settings JSON:",x),{}}return typeof s=="object"&&s!==null?s:{}};J(()=>U(t.inspection.settings).conclusion||{});const L=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],N=[{value:"yes",label:"Ya"},{value:"no",label:"Tidak"}],W=[{value:"light",label:"Ringan"},{value:"heavy",label:"Berat"}];ot(()=>{v(),Bt(()=>{f(),T()})});const f=()=>{m.value&&b.notes&&(m.value.innerHTML=b.notes)},v=()=>{const x=U(t.inspection.settings).conclusion||{},B=t.form.conclusion||{};b.flooded=B.flooded||x.flooded||"",b.collision=B.collision||x.collision||"",b.collision_severity=B.collision_severity||x.collision_severity||"",b.notes=B.notes||t.inspection.notes||""},A=s=>{if(!m.value)return;let x=s.content;x=x.replace(/{PLATE_NUMBER}/g,t.inspection.plate_number||"[NOMOR_PLAT]").replace(/{CAR_NAME}/g,t.inspection.car_name||"[NAMA_MOBIL]").replace(/{INSPECTION_DATE}/g,new Date().toLocaleDateString("id-ID")).replace(/{FLOOD_STATUS}/g,b.flooded==="yes"?"Pernah terkena banjir":"Tidak pernah terkena banjir").replace(/{COLLISION_STATUS}/g,b.collision==="yes"?"Pernah mengalami tabrakan":"Tidak pernah mengalami tabrakan"),m.value.innerHTML=x,b.notes=x,I.value=!1,Bt(()=>{m.value.focus(),h()})},P=()=>{m.value&&(m.value.innerHTML="",b.notes="",h())},T=()=>{if(!m.value)return;const s=window.getSelection();s.rangeCount===0||s.isCollapsed||(M.bold=document.queryCommandState("bold"),M.italic=document.queryCommandState("italic"),M.underline=document.queryCommandState("underline"))},F=s=>{if(!m.value)return;m.value.focus();const x=M[s];switch(s){case"bold":document.execCommand("bold",!1,!x);break;case"italic":document.execCommand("italic",!1,!x);break;case"underline":document.execCommand("underline",!1,!x);break}setTimeout(()=>{T(),H()},10)},H=ln.debounce(()=>{m.value&&(b.notes=m.value.innerHTML,h())},200),R=s=>{s.preventDefault(),document.execCommand("insertParagraph",!1,null)},k=s=>{s.preventDefault();const x=(s.clipboardData||window.clipboardData).getData("text/plain");document.execCommand("insertText",!1,x)},D=()=>{S.value=!0},ne=()=>{S.value=!1,m.value&&(b.notes=m.value.innerHTML,h())},w=()=>{h()},h=()=>{const s={flooded:b.flooded,collision:b.collision,collision_severity:b.collision==="yes"?b.collision_severity:null,notes:b.notes};C("updateConclusion",s)};return re(()=>t.form.conclusion,s=>{s&&(b.flooded=s.flooded!==void 0?s.flooded:b.flooded,b.collision=s.collision!==void 0?s.collision:b.collision,b.collision_severity=s.collision_severity!==void 0?s.collision_severity:b.collision_severity,b.notes=s.notes!==void 0?s.notes:b.notes,m.value&&s.notes!==void 0&&m.value.innerHTML!==s.notes&&(m.value.innerHTML=s.notes))},{deep:!0,immediate:!0}),re([()=>b.flooded,()=>b.collision,()=>b.collision_severity,()=>b.notes],()=>{h()},{deep:!0}),(s,x)=>(i(),l("div",Ii,[x[21]||(x[21]=e("div",{class:"bg-indigo-200 px-6 py-2 border-b flex items-center justify-between"},[e("h4",{class:"text-base font-semibold text-indigo-700"}," Detail Kendaraan ")],-1)),e("div",_i,[x[10]||(x[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[_e(" Apakah kendaraan pernah terkena banjir? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Si,[(i(),l(ke,null,Ce(L,B=>e("label",{key:B.value,class:"cursor-pointer"},[De(e("input",{type:"radio","onUpdate:modelValue":x[0]||(x[0]=se=>b.flooded=se),value:B.value,class:"hidden peer",onChange:w},null,40,$i),[[st,b.flooded]]),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":b.flooded===B.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":b.flooded!==B.value}])},O(B.label),3)])),64))])]),e("div",Ci,[x[12]||(x[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[_e(" Apakah kendaraan pernah mengalami tabrakan? "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Ai,[(i(),l(ke,null,Ce(N,B=>e("label",{key:B.value,class:"cursor-pointer"},[De(e("input",{type:"radio","onUpdate:modelValue":x[1]||(x[1]=se=>b.collision=se),value:B.value,class:"hidden peer",onChange:w},null,40,Vi),[[st,b.collision]]),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm scale-[0.98]":b.collision===B.value,"border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400":b.collision!==B.value}])},O(B.label),3)])),64))]),fe(gt,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 transform -translate-y-2","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-2"},{default:Be(()=>[b.collision==="yes"?(i(),l("div",Ti,[x[11]||(x[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[_e("Tingkat kerusakan: "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Ui,[(i(),l(ke,null,Ce(W,B=>e("label",{key:B.value,class:"cursor-pointer"},[De(e("input",{type:"radio","onUpdate:modelValue":x[2]||(x[2]=se=>b.collision_severity=se),value:B.value,class:"hidden peer",onChange:w},null,40,Ei),[[st,b.collision_severity]]),e("div",{class:Q(["w-full px-4 py-3 border rounded-lg text-center transition-all duration-200 ease-in-out whitespace-nowrap text-sm font-medium",{"border-blue-500 bg-blue-100 text-blue-700 shadow-sm scale-[0.98]":b.collision_severity===B.value,"border-gray-300 text-gray-700 hover:bg-white hover:border-gray-400":b.collision_severity!==B.value}])},O(B.label),3)])),64))])])):g("",!0)]),_:1})]),e("div",Ni,[e("div",Mi,[x[14]||(x[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Catatan Kesimpulan",-1)),e("button",{type:"button",onClick:x[3]||(x[3]=B=>I.value=!I.value),class:"flex items-center gap-2 px-3 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all duration-200"},x[13]||(x[13]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),_e(" Template ")]))]),fe(gt,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform scale-95","enter-to-class":"opacity-100 transform scale-100","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform scale-100","leave-to-class":"opacity-0 transform scale-95"},{default:Be(()=>[I.value?(i(),l("div",Di,[e("div",Pi,[x[16]||(x[16]=e("h5",{class:"text-sm font-semibold text-gray-700"},"Pilih Template Kesimpulan",-1)),e("button",{onClick:x[4]||(x[4]=B=>I.value=!1),class:"text-gray-400 hover:text-gray-600"},x[15]||(x[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Li,[(i(!0),l(ke,null,Ce(K.value,B=>(i(),l("button",{key:B.id,onClick:se=>A(B),class:"p-3 text-left border border-gray-200 rounded-lg hover:border-indigo-300 hover:bg-indigo-50 transition-all duration-150"},[e("div",ji,O(B.name),1),e("div",Bi,O(B.description),1)],8,Ri))),128))])])):g("",!0)]),_:1}),e("div",Oi,[e("button",{type:"button",onClick:x[5]||(x[5]=B=>F("bold")),class:Q(["p-2 rounded transition-all duration-150 ease-in-out font-medium",M.bold?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Bold"},x[17]||(x[17]=[e("strong",null,"B",-1)]),2),e("button",{type:"button",onClick:x[6]||(x[6]=B=>F("italic")),class:Q(["p-2 rounded transition-all duration-150 ease-in-out font-medium",M.italic?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Italic"},x[18]||(x[18]=[e("em",null,"I",-1)]),2),e("button",{type:"button",onClick:x[7]||(x[7]=B=>F("underline")),class:Q(["p-2 rounded transition-all duration-150 ease-in-out font-medium",M.underline?"bg-indigo-500 text-white shadow-sm":"hover:bg-gray-200 hover:shadow-sm"]),title:"Underline"},x[19]||(x[19]=[e("u",null,"U",-1)]),2),e("button",{type:"button",onClick:x[8]||(x[8]=B=>P()),class:"p-2 rounded transition-all duration-150 ease-in-out hover:bg-gray-200 hover:shadow-sm ml-2",title:"Clear Template"}," ðŸ—‘ï¸ Clear ")]),fe(gt,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 transform -translate-y-1","enter-to-class":"opacity-100 transform translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 transform translate-y-0","leave-to-class":"opacity-0 transform -translate-y-1"},{default:Be(()=>[Object.values(M).some(B=>B)?(i(),l("div",Fi,[x[20]||(x[20]=_e(" Format aktif: ")),M.bold?(i(),l("span",Ki,"Bold")):g("",!0),M.italic?(i(),l("span",qi,"Italic")):g("",!0),M.underline?(i(),l("span",zi,"Underline")):g("",!0)])):g("",!0)]),_:1}),e("div",{ref_key:"editorRef",ref:m,contenteditable:"true",class:Q(["w-full min-h-[120px] p-3 rounded-md border border-gray-300 shadow-sm transition-all duration-200 ease-in-out prose max-w-none",{"bg-white border-gray-300":!S.value,"bg-blue-50 border-indigo-500 ring-2 ring-indigo-200":S.value}]),onInput:x[9]||(x[9]=(...B)=>Y(H)&&Y(H)(...B)),onBlur:ne,onFocus:D,onKeydown:kn(R,["enter"]),onPaste:k,onMouseup:T,onKeyup:T,placeholder:"Tambahkan catatan kesimpulan inspeksi di sini..."},null,34)])]))}},Gi=Ye(Hi,[["__scopeId","data-v-6b429a8f"]]);function on(n,Z){const t=$({x:Z.x,y:Z.y}),C=$(!1),m=$(null),S=$(!1),I=$({x:0,y:0});ot(()=>{const N=localStorage.getItem(n);if(N)try{t.value=JSON.parse(N)}catch(W){console.error("Error parsing saved position:",W)}});const M=N=>{N.type.includes("touch")?(I.value.x=N.touches[0].clientX,I.value.y=N.touches[0].clientY):(I.value.x=N.clientX,I.value.y=N.clientY),m.value=setTimeout(()=>{S.value=!0,C.value=!0,console.log("Long press activated - drag mode ON")},900)},b=()=>{m.value&&(clearTimeout(m.value),m.value=null),S.value=!1};return{pos:t,dragging:C,startLongPress:M,cancelLongPress:b,onDrag:N=>{if(!C.value||!S.value)return;N.preventDefault();let W,f;N.type.includes("touch")?(W=N.touches[0].clientX,f=N.touches[0].clientY):(W=N.clientX,f=N.clientY),t.value.x=W-24,t.value.y=f-24},stopDrag:()=>{if(C.value&&S.value){console.log("Drag stopped - saving position"),C.value=!1,S.value=!1;try{localStorage.setItem(n,JSON.stringify(t.value))}catch(N){console.error("Error saving position:",N)}}b()},handleClick:N=>!C.value&&!S.value?(console.log("Regular click detected"),!0):(console.log("Click ignored - part of drag operation"),!1)}}const Wi={class:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100"},Ji={key:0,class:"fixed inset-0 bg-black bg-opacity-40 z-30 pointer-events-none transition-opacity duration-200"},Yi={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor","stroke-width":"2"},Zi={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor","stroke-width":"2"},Xi={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},Qi=["onClick","data-category"],el={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},tl={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},nl={key:3,class:"fixed inset-0 z-30"},sl={class:"mt-2 space-y-2"},ol={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},al=["onClick"],il={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},ll={key:0,class:"ml-2 inline-flex items-center justify-center w-5 h-5 text-xs rounded-full bg-green-500 text-white"},rl={key:0,class:"fixed top-4 left-1/2 transform -translate-x-1/2 bg-green-400 text-white px-4 py-2 rounded shadow-lg z-50"},ul={class:"relative overflow-hidden"},dl={key:"vehicle"},cl={key:"conclusion"},gl={key:1},pl=["disabled"],ml={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},vl={class:"space-y-4"},fl={class:"relative"},hl={class:"max-h-64 overflow-y-auto"},bl={key:0,class:"text-center py-4 text-gray-500"},yl=["onClick"],xl={class:"font-medium text-gray-900"},wl={class:"text-sm text-gray-500"},kl={class:"text-xs text-gray-400 mt-1"},Il={key:0,class:"text-xs text-green-600 mt-1"},_l={key:3,class:"fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg z-50 text-center"},Sl={class:"p-4 space-y-6"},$l={class:"flex items-center justify-between"},Cl=["aria-checked"],Al={class:"space-y-2"},Vl={class:"space-y-2"},Tl={class:"space-y-2"},Ul={class:"flex space-x-4"},El={class:"flex items-center"},Nl={class:"flex items-center"},Ml={key:0,class:"space-y-2"},Dl={class:"flex space-x-4"},Pl={class:"flex items-center"},Ll={class:"flex items-center"},Rl={key:1,class:"space-y-2"},jl={__name:"IndexLocal",props:{inspection:Object,inspectionId:Object,category:Object,car:Object,appMenus:Array,damagePoints:Array,existingResults:Object,existingImages:Object,CarDetail:Array,allInspections:Array},setup(n){var zt,Ht,Gt,Wt,Jt,Yt,Zt,Xt,Qt,en;const Z=r=>{if(!r)return{};if(typeof r=="string")try{return JSON.parse(r)||{}}catch(a){return console.error("Error parsing settings JSON:",a),{}}return typeof r=="object"&&r!==null?r:{}},t=n,C=J(()=>`inspection_data_${t.inspection.id}`),m=J(()=>`swipe_toggle_${t.inspection.id}`),S=J(()=>`image_source_${t.inspection.id}`),I=J(()=>`active_category_${t.inspection.id}`),M=()=>{try{const r=localStorage.getItem(C.value);return r?JSON.parse(r):{}}catch(r){return console.error("Error reading local storage:",r),{}}},b=r=>{try{localStorage.setItem(C.value,JSON.stringify(r))}catch(a){console.error("Error writing to local storage:",a)}},K=()=>{try{localStorage.removeItem(C.value),localStorage.removeItem(m.value),localStorage.removeItem(S.value),localStorage.removeItem(I.value)}catch(r){console.error("Error clearing local storage:",r)}},U=()=>{try{const r=localStorage.getItem(m.value);return r?JSON.parse(r):!0}catch(r){return console.error("Error reading swipe toggle state:",r),!0}},L=r=>{try{localStorage.setItem(m.value,JSON.stringify(r))}catch(a){console.error("Error writing swipe toggle state:",a)}},N=()=>{try{return localStorage.getItem(S.value)||"all"}catch(r){return console.error("Error reading image source setting:",r),"all"}},W=r=>{try{localStorage.setItem(S.value,r)}catch(a){console.error("Error writing image source setting:",a)}},f=J(()=>`camera_quality_${t.inspection.id}`),v=()=>{try{return localStorage.getItem(f.value)||"HD_Std"}catch(r){return console.error("Error reading camera quality setting:",r),"HD_Std"}},A=r=>{try{localStorage.setItem(f.value,r)}catch(a){console.error("Error writing camera quality setting:",a)}},P=()=>{try{return localStorage.getItem(I.value)||he.value[0]}catch(r){return console.error("Error reading active category:",r),he.value[0]}},T=r=>{try{localStorage.setItem(I.value,r)}catch(a){console.error("Error writing active category:",a)}},F=$(((Ht=(zt=t.category)==null?void 0:zt.settings)==null?void 0:Ht.menu_model)||"horizontal"),H=$(((Wt=(Gt=t.category)==null?void 0:Gt.settings)==null?void 0:Wt.position)||"top"),R=$(!1),k=$(!1),{pos:D,dragging:ne,startLongPress:w,cancelLongPress:h,onDrag:s,stopDrag:x,handleClick:B}=on("toggleMenuButtonPos",{x:window.innerWidth-80,y:20}),se=r=>{B(r)&&be()},be=()=>{R.value=!R.value},ce=()=>{R.value=!1},ye=r=>r?"bg-gradient-to-r from-indigo-700 to-sky-600 text-white":"bg-gray-50 hover:bg-gray-100 text-gray-700",{pos:Se,dragging:ve,startLongPress:ue,cancelLongPress:xe,onDrag:pe,stopDrag:me,handleClick:Oe}=on("damageButtonPos",{x:window.innerWidth-80,y:window.innerHeight-80}),Fe=r=>{Oe(r)&&(we.value=!0)},we=$(!1),Ue=$(!1),Ae=$(""),le=$(null),$e=$(""),Ve=$(""),Ie=$(""),Ee=$(!1),Te=$(null),Re=(r,a)=>{Ee.value=!0,Te.value=a,Nt.visit(r,{onFinish:()=>{Ee.value=!1,Te.value=null}})},G=J(()=>t.appMenus.some(r=>r.input_type==="damage")),he=J(()=>["vehicle",...t.appMenus.map(r=>String(r.id)),"conclusion"]),o=$(he.value[0]),c=$(0),p=J(()=>{if(o.value==="vehicle"||o.value==="conclusion")return null;const r=t.appMenus.find(a=>String(a.id)===o.value);return r?{...r,points:V(r.menu_point,r.input_type==="damage")}:null}),V=(r,a)=>a?(r||[]).filter(ee=>{const X=ee.inspection_point_id;return mt(X)}):r||[],u=$({plate_number:t.inspection.plate_number,car_id:t.inspection.car_id,car_name:t.inspection.car_name}),d=$({notes:t.inspection.overall_note||"",flooded:((Yt=(Jt=Z(t.inspection.settings))==null?void 0:Jt.conclusion)==null?void 0:Yt.flooded)||null,collision:((Xt=(Zt=Z(t.inspection.settings))==null?void 0:Zt.conclusion)==null?void 0:Xt.collision)||null,collision_severity:((en=(Qt=Z(t.inspection.settings))==null?void 0:Qt.conclusion)==null?void 0:en.collision_severity)||null}),y=an((()=>{const r=[...t.appMenus.flatMap(Ge=>Ge.menu_point||[]),...t.damagePoints||[]],a={},ee={};r.forEach(Ge=>{const qe=Ge.inspection_point_id,je=t.existingResults[qe];a[qe]={status:(je==null?void 0:je.status)||"",note:(je==null?void 0:je.note)||""},ee[qe]=t.existingImages[qe]||[]});const X=M(),ae={...a,...X.results||{}},de={...ee,...X.images||{}},Me={...u.value,...X.vehicleDetails||{}},ge=X.overall_note!==void 0?X.overall_note:t.inspection.overall_note||"";return{inspection_id:t.inspection.id,results:ae,images:de,overall_note:ge,plate_number:Me.plate_number,car_id:Me.car_id,car_name:Me.car_name}})());re(y,r=>{b({results:r.results,images:r.images,overall_note:r.overall_note,vehicleDetails:u.value,conclusion:d.value})},{deep:!0}),re(u,r=>{y.plate_number=r.plate_number,y.car_id=r.car_id,y.car_name=r.car_name},{deep:!0}),re(d,r=>{y.overall_note=r.notes},{deep:!0});const j=Dt("vehicleFeatures",$(null));j.value=JSON.parse(localStorage.getItem("vehicle_features")||"{}"),Mt("vehicleFeatures",j);const te=r=>{var ae,de;const a=r.settings;if(!oe(r))return!0;const ee=(ae=t.car)==null?void 0:ae.transmission,X=(de=t.car)==null?void 0:de.fuel_type;return!(a.transmission&&Array.isArray(a.transmission)&&a.transmission.length>0&&ee&&!a.transmission.includes(ee)||a.fuel_type&&a.fuel_type.trim()!==""&&X&&a.fuel_type!==X||a.rear_door&&(!j.value||!j.value.rear_door)||a.pick_up&&(!j.value||!j.value.pick_up)||a.box&&(!j.value||!j.value.box))},oe=r=>{const a=r.settings;return!!(a!=null&&a.transmission&&Array.isArray(a.transmission)&&a.transmission.length>0||a!=null&&a.fuel_type&&a.fuel_type.trim()!==""||a!=null&&a.rear_door||a!=null&&a.pick_up||a!=null&&a.box)},ie=$(!1),Ne=r=>{ie.value=r},We=$(!1),Ze=r=>{We.value=r},ze=J(()=>{var ae;const r=u.value.plate_number&&/^[A-Z]{1,2}\d{1,4}[A-Z]{0,3}$/.test(u.value.plate_number),a=!!((ae=u.value.car_name)!=null&&ae.trim()),ee=!We.value,X=!ie.value;return r&&a&&ee&&X}),pt=J(()=>{if(!Ae.value.trim())return t.damagePoints||[];const r=Ae.value.toLowerCase().trim();return(t.damagePoints||[]).filter(a=>{var ee,X,ae,de,Me;return((X=(ee=a.inspection_point)==null?void 0:ee.name)==null?void 0:X.toLowerCase().includes(r))||((de=(ae=a.inspection_point)==null?void 0:ae.description)==null?void 0:de.toLowerCase().includes(r))||((Me=vt(a))==null?void 0:Me.toLowerCase().includes(r))})}),mt=r=>{const a=y.results[r]&&(y.results[r].status||y.results[r].note),ee=y.images[r]&&y.images[r].length>0;return a||ee},vt=r=>{var a;return((a=r.inspection_point.component)==null?void 0:a.name)||"Komponen Tidak Diketahui"},kt=r=>y.results[r]||null,at=()=>{var de;const r=d.value,a=!!r.flooded,ee=!!r.collision,X=r.collision==="yes"?!!r.collision_severity:!0,ae=!!((de=r.notes)!=null&&de.trim());return a&&ee&&X&&ae},ft=J(()=>({flooded:d.value.flooded||null,collision:d.value.collision||null,collision_severity:d.value.collision_severity||null,note:d.value.notes||null,isComplete:at()})),ht=J(()=>{const r=ze.value,a=t.appMenus.every(X=>it(X)),ee=at();return r&&a&&ee}),it=r=>r.input_type==="damage"?!0:r.id==="conclusion"?at():r.id==="vehicle"?ze.value:(V(r.menu_point,!1)||[]).filter(X=>X.is_default&&te(X)).every(X=>{var ge,Ge,qe,je,bt,yt;const ae=y.results[X.inspection_point_id],de=y.images[X.inspection_point_id];if(!ae)return!1;const Me=Z(X.settings);switch(X.input_type){case"text":case"number":case"date":case"account":case"textarea":return!!((ge=ae.note)!=null&&ge.trim());case"select":case"radio":if(!ae.status)return!1;const Je=(Ge=Me.radios)==null?void 0:Ge.find(nt=>nt.value===ae.status);return!(Je!=null&&Je.settings&&(Je.settings.show_textarea&&!((qe=ae.note)!=null&&qe.trim())||Je.settings.show_image_upload&&(de==null?void 0:de.length)===0));case"imageTOradio":if((de==null?void 0:de.length)===0||!ae.status)return!1;const E=(je=Me.radios)==null?void 0:je.find(nt=>nt.value===ae.status);return!(E!=null&&E.settings&&E.settings.show_textarea&&E.settings.required&&!((bt=ae.note)!=null&&bt.trim()));case"image":return(de==null?void 0:de.length)>0;default:return!!ae.status||!!((yt=ae.note)!=null&&yt.trim())}}),Pe=$(!0),He=$(N()),Ke=$(v()),lt=$(!1),It=()=>{console.log("Opening settings modal"),lt.value=!0},rt=()=>{console.log("Closing settings modal"),lt.value=!1},Xe=$(null),ut=$([]),Qe=$(0),et=$(!1);Mt("imageSourceSetting",He),Mt("cameraQualitySetting",Ke);const _t=()=>{Pe.value=!Pe.value,L(Pe.value)},St=()=>{W(He.value),console.log("Image source setting updated to:",He.value)},$t=()=>{A(Ke.value),console.log("Camera quality setting updated to:",Ke.value)},tt=()=>{Xe.value&&Bt(()=>{const r=Xe.value.querySelector(`[data-category="${o.value}"]`);if(!r)return;const a=Xe.value,ee=a.clientWidth,X=r.offsetLeft,ae=r.clientWidth,de=X-ee/2+ae/2;a.scrollTo({left:de,behavior:"smooth"})})},Ct=()=>Qe.value===0?(Qe.value=1,et.value=!0,setTimeout(()=>{Qe.value=0,et.value=!1},2e3),window.history.pushState(null,null,window.location.href),!1):(Qe.value=0,et.value=!1,Nt.visit(route("job.index")),!0),At=()=>{window.history.state===null&&window.history.replaceState({isBackButtonControlled:!0},""),window.history.pushState({isBackButtonControlled:!0},""),window.addEventListener("popstate",r=>{r.state&&r.state.isBackButtonControlled&&(r.preventDefault(),Ct())})},Vt=r=>{le.value=r;const a=r.inspection_point_id,ee=y.results[a]||{};$e.value=ee.status||"",Ve.value=ee.note||"",we.value=!1,Ue.value=!0},Tt=r=>{le.value&&(y.images[le.value.inspection_point_id]=r)},Ut=()=>{if(le.value){const r=le.value.inspection_point_id;y.results[r]={...y.results[r],status:$e.value,note:Ve.value},Ie.value="Data berhasil disimpan di lokal!",setTimeout(()=>Ie.value="",1e3)}Lt()},Et=({pointId:r,type:a,value:ee})=>{var X;(X=y.results[r])!=null&&X.hasOwnProperty(a)&&(y.results[r][a]=ee)},z=async r=>{if(r&&confirm("Apakah kamu yakin ingin menghapus data ini?")){try{await Nt.post(route("inspections.delete-result"),{inspection_id:t.inspection.id,point_id:r},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{y.results[r]&&(y.results[r]={status:"",note:""}),y.images[r]&&(y.images[r]=[]),Ie.value="Data berhasil dihapus!",setTimeout(()=>Ie.value="",1e3)},onError:a=>{console.error("Error menghapus hasil:",a)}})}catch(a){console.error("Error menghapus hasil:",a)}Lt()}},_=r=>{Object.assign(u.value,r),Ne(!0)},mn=r=>{console.log("Save car details locally:",r)},vn=r=>{console.log("Received conclusion data from child:",r),d.value={...d.value,...r},y.overall_note=r.notes||"",console.log("Conclusion state updated:",d.value)},fn=()=>{if(!ht.value){alert("Harap lengkapi semua menu inspeksi termasuk kesimpulan sebelum submit final");return}if(!confirm("Apakah Anda yakin ingin mengirim semua data inspeksi? Data lokal akan dihapus setelah berhasil dikirim."))return;k.value=!0;const r={...y.data(),overall_note:d.value.notes,conclusion:{notes:d.value.notes,flooded:d.value.flooded,collision:d.value.collision,collision_severity:d.value.collision_severity}};Nt.post(route("inspections.final-submit-local",{id:t.inspection.id}),r,{preserveScroll:!0,onSuccess:()=>{K()},onError:a=>{console.error("Kesalahan pengiriman:",a),k.value=!1}})},hn=({pointId:r,imageId:a})=>{y.images[r]&&(y.images[r]=y.images[r].filter(ee=>ee.id!==a))},Kt=()=>{we.value=!1,Ae.value=""},Lt=()=>{Ue.value=!1,le.value=null,$e.value="",Ve.value=""},bn=()=>{},dt=r=>{o.value=r,T(r),tt()},qt=r=>{let a=c.value+r;a>=0&&a<he.value.length&&(o.value=he.value[a],tt())},yn=()=>{let r=0,a=0,ee=null;const X=ge=>{Pe.value&&(r=ge.changedTouches[0].screenX)},ae=ge=>{Pe.value&&(a=ge.changedTouches[0].screenX,de())},de=()=>{if(!Pe.value)return;const ge=250;a<r-ge?qt(1):a>r+ge&&qt(-1)},Me=()=>{const ge=document.querySelector(".relative.overflow-hidden");return ge&&(ge.addEventListener("touchstart",X,{passive:!0}),ge.addEventListener("touchend",ae,{passive:!0})),()=>{ge&&(ge.removeEventListener("touchstart",X),ge.removeEventListener("touchend",ae))}};return ee=Me(),re(Pe,ge=>{ee&&ee(),ge&&(ee=Me())}),()=>{ee&&ee()}};return re(o,(r,a)=>{tt()}),re(o,r=>{c.value=he.value.indexOf(r)}),re(Ke,r=>{$t()}),ot(()=>{const r=M();if(Pe.value=U(),He.value=N(),Ke.value=v(),r.vehicleDetails&&(Object.assign(u.value,r.vehicleDetails),y.plate_number=r.vehicleDetails.plate_number,y.car_id=r.vehicleDetails.car_id,y.car_name=r.vehicleDetails.car_name),r.conclusion)console.log("Loading conclusion from localStorage:",r.conclusion),Object.assign(d.value,r.conclusion),y.overall_note=r.conclusion.notes||"";else{const X=Z(t.inspection.settings).conclusion||{};d.value={notes:t.inspection.notes||"",flooded:X.flooded||"",collision:X.collision||"",collision_severity:X.collision_severity||""},y.overall_note=t.inspection.notes||""}r.results&&Object.assign(y.results,r.results),r.images&&Object.assign(y.images,r.images);const a=P();he.value.includes(a)?o.value=a:(o.value=he.value[0],T(he.value[0])),yn(),At(),setTimeout(()=>{tt()},100)}),(r,a)=>{var ee,X,ae,de,Me,ge,Ge,qe,je,bt,yt,Je;return i(),l("div",Wi,[Y(ve)||Y(ne)?(i(),l("div",Ji)):g("",!0),F.value==="vertical"?(i(),l("button",{key:1,onMousedown:a[0]||(a[0]=(...E)=>Y(w)&&Y(w)(...E)),onMouseup:a[1]||(a[1]=(...E)=>Y(x)&&Y(x)(...E)),onMouseleave:a[2]||(a[2]=(...E)=>Y(h)&&Y(h)(...E)),onMousemove:a[3]||(a[3]=(...E)=>Y(s)&&Y(s)(...E)),onTouchstart:a[4]||(a[4]=(...E)=>Y(w)&&Y(w)(...E)),onTouchend:a[5]||(a[5]=(...E)=>Y(x)&&Y(x)(...E)),onTouchmove:a[6]||(a[6]=(...E)=>Y(s)&&Y(s)(...E)),onClick:se,class:"fixed z-40 p-4 bg-gradient-to-r from-indigo-700 to-sky-600 text-white border shadow-lg rounded-full hover:shadow-xl transition",style:wt({left:Y(D).x+"px",top:Y(D).y+"px"}),"aria-label":"Toggle vertical menu"},[R.value?(i(),l("svg",Zi,a[31]||(a[31]=[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]))):(i(),l("svg",Yi,a[30]||(a[30]=[e("path",{"fill-rule":"evenodd",d:"M3 5h14v2H3V5zm0 4h10v2H3V9zm0 4h6v2H3v-2z","clip-rule":"evenodd"},null,-1)])))],36)):g("",!0),F.value==="horizontal"?(i(),l("div",{key:2,class:Q(["z-10 bg-white shadow-sm",{"sticky top-0 mb-2":H.value==="top","fixed bottom-0 left-0 right-0":H.value==="bottom"}])},[e("div",{ref_key:"menuContainer",ref:Xe,class:"flex overflow-x-auto scrollbar-hide py-3 px-4 space-x-2 menu-container",onScroll:bn},[e("button",{onClick:It,class:"flex-shrink-0 p-2 rounded-full text-gray-600 hover:text-gray-800 hover:bg-gray-100 transition-colors duration-200",title:"Pengaturan"},a[32]||(a[32]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])),e("button",{ref_key:"menuItems",ref:ut,onClick:a[7]||(a[7]=E=>dt("vehicle")),class:Q(["flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors duration-200 menu-item",{"bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white":o.value==="vehicle","bg-gray-100 text-gray-700 hover:bg-gray-200":o.value!=="vehicle"}]),"data-category":"vehicle"},[a[33]||(a[33]=_e(" Detail Kendaraan ")),ze.value?(i(),l("span",Xi," âœ“ ")):g("",!0)],2),(i(!0),l(ke,null,Ce(n.appMenus,E=>(i(),l("button",{key:E.id,ref_for:!0,ref_key:"menuItems",ref:ut,onClick:nt=>dt(String(E.id)),class:Q(["flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors duration-200 menu-item",{"bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white":o.value===String(E.id),"bg-gray-100 text-gray-700 hover:bg-gray-200":o.value!==String(E.id)}]),"data-category":String(E.id)},[_e(O(E.name)+" ",1),it(E)?(i(),l("span",el," âœ“ ")):g("",!0)],10,Qi))),128)),e("button",{ref_key:"menuItems",ref:ut,onClick:a[8]||(a[8]=E=>dt("conclusion")),class:Q(["flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors duration-200 menu-item",{"bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white":o.value==="conclusion","bg-gray-100 text-gray-700 hover:bg-gray-200":o.value!=="conclusion"}]),"data-category":"conclusion"},[a[34]||(a[34]=_e(" Kesimpulan ")),ft.value.isComplete?(i(),l("span",tl," âœ“ ")):g("",!0)],2)],544)],2)):g("",!0),F.value==="vertical"&&R.value?(i(),l("div",nl,[e("div",{class:"absolute inset-0 bg-black bg-opacity-30",onClick:ce}),e("div",{class:Q(["absolute z-40 w-60 bg-white rounded-xl shadow-xl p-2 max-h-[75vh] overflow-y-auto",{"top-16 right-4":H.value==="top-right","top-16 left-4":H.value==="top-left","bottom-16 right-4":H.value==="bottom-right","bottom-16 left-4":H.value==="bottom-left"}])},[e("div",{class:"flex items-center justify-between px-2 py-1 border-b"},[a[35]||(a[35]=e("div",{class:"text-sm font-semibold"},"Pilih Menu",-1)),e("button",{onClick:ce,class:"text-xs text-gray-500 hover:text-gray-700"},"Tutup")]),e("div",sl,[e("button",{onClick:a[9]||(a[9]=E=>{dt("vehicle"),ce()}),class:Q([ye(o.value==="vehicle"),"w-full flex items-center justify-between px-3 py-2 rounded-md text-sm"])},[a[36]||(a[36]=e("span",null,"Detail Kendaraan",-1)),ze.value?(i(),l("span",ol,"âœ“")):g("",!0)],2),(i(!0),l(ke,null,Ce(n.appMenus,E=>(i(),l("button",{key:`vmenu-${E.id}`,onClick:()=>{dt(String(E.id)),ce()},class:Q([ye(o.value===String(E.id)),"w-full flex items-center justify-between px-3 py-2 rounded-md text-sm"])},[e("span",null,O(E.name),1),it(E)?(i(),l("span",il,"âœ“")):g("",!0)],10,al))),128)),e("button",{onClick:a[10]||(a[10]=E=>{dt("conclusion"),ce()}),class:Q([ye(o.value==="conclusion"),"w-full flex items-center justify-between px-3 py-2 rounded-md text-sm"])},[a[37]||(a[37]=e("span",null,"Kesimpulan",-1)),ft.value.isComplete?(i(),l("span",ll,"âœ“")):g("",!0)],2)])],2)])):g("",!0),e("div",{class:Q(["max-w-7xl mx-auto px-2 sm:px-4 lg:px-6 py-1",{"pb-4 pt-1":H.value==="top","pb-20 pt-4":H.value==="bottom","pb-4 pt-4":F.value==="vertical"}])},[fe(gt,{name:"fade"},{default:Be(()=>[Ie.value?(i(),l("div",rl,O(Ie.value),1)):g("",!0)]),_:1}),e("div",ul,[fe(gt,{name:"category-slide",mode:"out-in"},{default:Be(()=>[o.value==="vehicle"?(i(),l("div",dl,[fe(bs,{inspection:n.inspection,CarDetail:n.CarDetail,allInspections:t.allInspections,onUpdateVehicle:_,onSaveCarDetails:mn,"onUpdate:validation":Ze,"onUpdate:hasUnsavedChanges":Ne},null,8,["inspection","CarDetail","allInspections"])])):p.value&&o.value!=="conclusion"?(i(),l("div",{key:p.value.id},[fe(ki,{category:p.value,"inspection-id":n.inspection.id,car:t.car,form:Y(y),head:F.value,onUpdateResult:Et,onHapusPoint:z,onRemoveImage:hn},null,8,["category","inspection-id","car","form","head"])])):o.value==="conclusion"?(i(),l("div",cl,[fe(Gi,{form:{conclusion:d.value},"inspection-id":n.inspection.id,inspection:n.inspection,settings:n.inspection.settings||{},onUpdateConclusion:vn},null,8,["form","inspection-id","inspection","settings"])])):g("",!0)]),_:1})]),o.value==="conclusion"?(i(),l("div",{key:0,class:Q(["flex justify-end gap-4 mt-2 p-4 bg-white rounded-xl shadow-md",{"mb-4":H.value==="top","mb-20":H.value==="bottom"}])},[fe(Y(In),{href:r.route("inspections.pending",n.inspectionId),as:"button",type:"button",disabled:Ee.value&&Te.value==="pending",onClick:a[11]||(a[11]=ct(E=>Re(r.route("inspections.pending",n.inspectionId),"pending"),["prevent"])),class:"inline-flex items-center justify-center px-3 py-1.5 text-sm font-medium rounded-md shadow-sm bg-yellow-500 text-white hover:bg-yellow-600 transition disabled:opacity-50 disabled:cursor-not-allowed"},{default:Be(()=>[Ee.value&&Te.value==="pending"?(i(),l(ke,{key:0},[a[38]||(a[38]=e("svg",{class:"animate-spin h-4 w-4 text-white mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),a[39]||(a[39]=e("span",null,"Memproses...",-1))],64)):(i(),l("span",gl,"Tunda"))]),_:1},8,["href","disabled"]),e("button",{type:"button",onClick:fn,disabled:!ht.value||k.value,class:"w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm bg-gradient-to-r from-indigo-700 to-sky-600 shadow-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"},[k.value?(i(),l("svg",ml,a[40]||(a[40]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):g("",!0),e("span",null,O(k.value?"Mengirim...":"Final Kirim Inspeksi"),1)],8,pl)],2)):g("",!0),G.value?(i(),l("button",{key:1,onMousedown:a[12]||(a[12]=(...E)=>Y(ue)&&Y(ue)(...E)),onMouseup:a[13]||(a[13]=(...E)=>Y(me)&&Y(me)(...E)),onMouseleave:a[14]||(a[14]=(...E)=>Y(xe)&&Y(xe)(...E)),onMousemove:a[15]||(a[15]=(...E)=>Y(pe)&&Y(pe)(...E)),onTouchstart:a[16]||(a[16]=(...E)=>Y(ue)&&Y(ue)(...E)),onTouchend:a[17]||(a[17]=(...E)=>Y(me)&&Y(me)(...E)),onTouchmove:a[18]||(a[18]=(...E)=>Y(pe)&&Y(pe)(...E)),onClick:Fe,class:"fixed z-5 p-4 bg-gradient-to-r from-indigo-700 to-sky-600 text-white rounded-full shadow-lg",style:wt({left:Y(Se).x+"px",top:Y(Se).y+"px"})},a[41]||(a[41]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1)]),36)):g("",!0),fe(pn,{show:we.value,title:"Cari Point Inspeksi",subtitle:"Pilih point inspeksi untuk ditambahkan",onClose:Kt},{default:Be(()=>[e("button",{onClick:Kt,class:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors z-10"},a[42]||(a[42]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),e("div",vl,[e("div",fl,[De(e("input",{"onUpdate:modelValue":a[19]||(a[19]=E=>Ae.value=E),type:"text",placeholder:"Cari point inspeksi...",class:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[xt,Ae.value]]),a[43]||(a[43]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),e("div",hl,[pt.value.length===0?(i(),l("div",bl," Tidak ada point yang ditemukan ")):g("",!0),(i(!0),l(ke,null,Ce(pt.value,E=>{var nt,tn;return i(),l("button",{key:E.id,onClick:Bl=>Vt(E),class:"w-full text-left p-3 border-b border-gray-200 hover:bg-gray-50 transition-colors"},[e("div",xl,O((nt=E.inspection_point)==null?void 0:nt.name),1),e("div",wl,O((tn=E.inspection_point)==null?void 0:tn.description),1),e("div",kl,O(vt(E)),1),mt(E.inspection_point_id)?(i(),l("div",Il," âœ“ Sudah ada data ")):g("",!0)],8,yl)}),128))])])]),_:1},8,["show"]),Ue.value?(i(),Le(Ft,{key:(ee=le.value)==null?void 0:ee.id,show:Ue.value,title:((ae=(X=le.value)==null?void 0:X.inspection_point)==null?void 0:ae.name)||"Detail Point",subtitle:(Me=(de=le.value)==null?void 0:de.inspection_point)==null?void 0:Me.description,name:`point-${(ge=le.value)==null?void 0:ge.id}`,"inspection-id":n.inspection.id,"point-id":(Ge=le.value)==null?void 0:Ge.inspection_point_id,settings:((qe=le.value)==null?void 0:qe.settings)||{},options:((bt=(je=le.value)==null?void 0:je.settings)==null?void 0:bt.radios)||[],"selected-Point":le.value,"selected-value":$e.value,"images-value":Y(y).images[(yt=le.value)==null?void 0:yt.inspection_point_id],"notes-value":Ve.value,point:le.value,"existing-data":kt((Je=le.value)==null?void 0:Je.inspection_point_id),"onUpdate:selectedValue":a[20]||(a[20]=E=>$e.value=E),"onUpdate:notesValue":a[21]||(a[21]=E=>Ve.value=E),"onUpdate:imagesValue":Tt,onSave:Ut,onClose:Lt,onHapus:z},null,8,["show","title","subtitle","name","inspection-id","point-id","settings","options","selected-Point","selected-value","images-value","notes-value","point","existing-data"])):g("",!0),et.value?(i(),l("div",_l,a[44]||(a[44]=[e("p",{class:"text-sm"},"Tekan sekali lagi untuk keluar dari inspeksi",-1),e("p",{class:"text-xs text-gray-300 mt-1"},"Data inspeksi telah disimpan secara lokal",-1)]))):g("",!0),lt.value?(i(),l("div",{key:4,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:rt},[e("div",{class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto",onClick:a[29]||(a[29]=ct(()=>{},["stop"]))},[e("div",{class:"flex items-center justify-between p-4 border-b"},[a[46]||(a[46]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Pengaturan Inspeksi",-1)),e("button",{onClick:rt,class:"text-gray-400 hover:text-gray-600 transition-colors"},a[45]||(a[45]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Sl,[e("div",$l,[a[47]||(a[47]=e("div",null,[e("label",{class:"text-sm font-medium text-gray-700"},"Swipe Gesture"),e("p",{class:"text-xs text-gray-500"},"Aktifkan navigasi dengan geser")],-1)),e("button",{onClick:_t,type:"button",class:Q(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",Pe.value?"bg-indigo-600":"bg-gray-200"]),role:"switch","aria-checked":Pe.value},[e("span",{"aria-hidden":"true",class:Q(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",Pe.value?"translate-x-5":"translate-x-0"])},null,2)],10,Cl)]),e("div",Al,[a[49]||(a[49]=e("label",{class:"text-sm font-medium text-gray-700"},"Sumber Gambar",-1)),De(e("select",{"onUpdate:modelValue":a[22]||(a[22]=E=>He.value=E),onChange:St,class:"w-full text-sm border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},a[48]||(a[48]=[e("option",{value:"all"},"Tanya",-1),e("option",{value:"camera"},"Kamera",-1),e("option",{value:"gallery"},"Galeri",-1)]),544),[[jt,He.value]])]),e("div",Vl,[a[51]||(a[51]=e("label",{class:"text-sm font-medium text-gray-700"},"Kualitas Kamera",-1)),De(e("select",{"onUpdate:modelValue":a[23]||(a[23]=E=>Ke.value=E),class:"w-full text-sm border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},a[50]||(a[50]=[e("option",{value:"HD_Std"},"HD Std",-1),e("option",{value:"4K"},"4K Rtc",-1),e("option",{value:"HD"},"HD Rtc",-1),e("option",{value:"SD"},"SD Rtc",-1)]),512),[[jt,Ke.value]])]),e("div",Tl,[a[54]||(a[54]=e("label",{class:"text-sm font-medium text-gray-700"},"Mode Menu",-1)),e("div",Ul,[e("label",El,[De(e("input",{type:"radio","onUpdate:modelValue":a[24]||(a[24]=E=>F.value=E),value:"horizontal",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[st,F.value]]),a[52]||(a[52]=e("span",{class:"ml-2 text-sm text-gray-700"},"Scroll samping",-1))]),e("label",Nl,[De(e("input",{type:"radio","onUpdate:modelValue":a[25]||(a[25]=E=>F.value=E),value:"vertical",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[st,F.value]]),a[53]||(a[53]=e("span",{class:"ml-2 text-sm text-gray-700"},"Menu Ngambang",-1))])])]),F.value==="horizontal"?(i(),l("div",Ml,[a[57]||(a[57]=e("label",{class:"text-sm font-medium text-gray-700"},"Posisi Menu",-1)),e("div",Dl,[e("label",Pl,[De(e("input",{type:"radio","onUpdate:modelValue":a[26]||(a[26]=E=>H.value=E),value:"top",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[st,H.value]]),a[55]||(a[55]=e("span",{class:"ml-2 text-sm text-gray-700"},"Atas",-1))]),e("label",Ll,[De(e("input",{type:"radio","onUpdate:modelValue":a[27]||(a[27]=E=>H.value=E),value:"bottom",class:"text-indigo-600 focus:ring-indigo-500"},null,512),[[st,H.value]]),a[56]||(a[56]=e("span",{class:"ml-2 text-sm text-gray-700"},"Bawah",-1))])])])):g("",!0),F.value==="vertical"?(i(),l("div",Rl,[a[59]||(a[59]=e("label",{class:"text-sm font-medium text-gray-700"},"Posisi Menu Vertikal",-1)),De(e("select",{"onUpdate:modelValue":a[28]||(a[28]=E=>H.value=E),class:"w-full text-sm border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},a[58]||(a[58]=[e("option",{value:"top-right"},"Atas Kanan",-1),e("option",{value:"top-left"},"Atas Kiri",-1),e("option",{value:"bottom-right"},"Bawah Kanan",-1),e("option",{value:"bottom-left"},"Bawah Kiri",-1)]),512),[[jt,H.value]])])):g("",!0)]),e("div",{class:"flex justify-end p-4 border-t bg-gray-50"},[e("button",{onClick:rt,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"}," Tutup ")])])])):g("",!0)],2)])}}},Wl=Ye(jl,[["__scopeId","data-v-4458efc6"]]);export{Wl as default};
