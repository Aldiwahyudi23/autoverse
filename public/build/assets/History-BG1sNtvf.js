import{c as n,o as a,d as e,r as v,q,G as F,j as U,w as x,k as l,u as c,v as H,b,t as o,z as _,A as J,F as w,m as k,I as D,f as g,n as j,S,W as f}from"./vendor-BAtEjGXf.js";import{A as P}from"./AppLayout-CZWK4OuS.js";import{_ as Y}from"./app-BkcWaOmJ.js";import{r as z,a as C}from"./XMarkIcon-d2CgnwY8.js";import{a as K,r as E,C as G}from"./car-DI6xen22.js";import{r as Z}from"./ClipboardDocumentListIcon-BhHUu85M.js";function Q(i,u){return a(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"})])}const X={class:"w-full px-4 sm:px-6 lg:px-6 py-6"},ee={class:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-4"},te={class:"text-xl md:text-3xl font-bold text-gray-900 text-center sm:text-left"},se={class:"bg-white rounded-lg shadow-md p-3 mb-6"},re={key:0,class:"flex items-center justify-between"},ae={class:"relative flex-1"},ne=["placeholder"],oe={key:1,class:"flex items-center justify-between gap-2"},ie={class:"flex items-center gap-2 flex-1"},le=["value"],ce=["value"],de={key:0,class:"bg-blue-50 border border-blue-200 rounded-md p-3 mb-4"},ue={class:"text-sm text-blue-800 flex items-center gap-2"},me={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},pe={class:"px-4 py-2 border-b"},he={key:0,class:"px-4 py-3 bg-gray-50 border-b"},ge={class:"flex items-center justify-between"},ve={class:"flex items-center"},xe={class:"text-sm text-gray-600"},fe=["href"],ye={class:"p-4 flex justify-between items-start"},be={class:"flex items-center mb-1"},_e={class:"text-sm font-semibold text-blue-700 ml-7 -mt-1"},we={class:"px-4 py-3 bg-gray-50 border-t border-gray-100"},ke={class:"flex items-center"},Se={class:"text-sm font-medium text-gray-800"},$e={key:0},Re={class:"text-gray-600"},De={key:1},je={class:"flex items-center mt-2"},Ce={class:"text-sm font-bold text-gray-900"},Ie={class:"px-4 py-3 bg-gray-50 border-t border-gray-100"},Me={class:"flex items-center mb-1"},Ae={class:"text-sm font-semibold text-gray-800 ml-7 -mt-1"},Le={class:"p-4"},Be={key:2,class:"text-center py-8 bg-white rounded-lg shadow-md"},Te={class:"text-gray-500"},Ne={class:"text-center mt-6"},Ve={__name:"History",props:{tasks:Array,encryptedIds:Object,filters:Object,availableMonths:Object,currentMonth:Number,currentYear:Number,userRole:String},setup(i){const u=i,y=r=>{switch(r){case"draft":return"Dibuat";case"in_progress":return"Dalam Proses";case"pending":return"Menunggu";case"pending_review":return"Menunggu Review";case"approved":return"Disetujui";case"rejected":return"Ditolak";case"revision":return"Revisi";case"completed":return"Selesai";case"cancelled":return"Dibatalkan";default:return r}},I=r=>{switch(r){case"approved":case"completed":return"bg-green-100 text-green-800";case"rejected":case"cancelled":return"bg-red-100 text-red-800";case"pending_review":return"bg-purple-100 text-purple-800";case"revision":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},m=v(!1),d=v(u.filters.search),p=v(u.filters.month),h=v(u.filters.year),M=[{value:1,name:"Jan"},{value:2,name:"Feb"},{value:3,name:"Mar"},{value:4,name:"Apr"},{value:5,name:"Mei"},{value:6,name:"Jun"},{value:7,name:"Jul"},{value:8,name:"Ags"},{value:9,name:"Sep"},{value:10,name:"Okt"},{value:11,name:"Nov"},{value:12,name:"Des"}],A=q(()=>Object.keys(u.availableMonths||{}).sort((r,s)=>s-r)),L=()=>u.userRole==="quality_control"?"Review Detail":"Lihat Detail",B=()=>{f.get(route("inspections.history"),{month:p.value,year:h.value,search:""},{preserveState:!0,replace:!0})};let $=null;const T=()=>{clearTimeout($),$=setTimeout(()=>{f.get(route("inspections.history"),{search:d.value},{preserveState:!0,replace:!0})},300)},N=()=>{m.value=!0,d.value="",f.get(route("inspections.history"),{search:""},{preserveState:!0,replace:!0})},R=()=>{m.value=!1,d.value="",f.get(route("inspections.history"),{month:p.value,year:h.value,search:""},{preserveState:!0,replace:!0})};F([p,h],()=>{m.value||B()});const V=r=>{if(!r)return"";let s=r.replace(/\D/g,"");return s.startsWith("0")&&(s="62"+s.substring(1)),s.startsWith("62")||(s="62"+s),s},O=r=>{if(!r)return"";const t=new Date(r.inspection_date).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),W=r.car?`${r.car.brand.name} ${r.car.model.name} ${r.car.type.name}`:r.car_name;return`Halo, ada update untuk inspeksi:

ðŸ“… *${t}*
ðŸš— *${W}*
ðŸ“ *${r.plate_number}*

Status saat ini: ${y(r.status)}

Mohon dicek kembali. Terima kasih!`};return(r,s)=>(a(),U(P,null,{default:x(()=>[l(c(H),{title:"Riwayat Inspeksi"}),e("div",X,[e("div",ee,[e("h3",te,o(i.userRole==="admin_plant"?"Riwayat Semua Inspeksi":i.userRole==="quality_control"?"Riwayat Review & Revisi":"Riwayat Inspeksi Saya"),1)]),e("div",se,[m.value?(a(),n("div",re,[e("div",ae,[_(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>d.value=t),onInput:T,type:"text",placeholder:i.userRole==="inspector"?"Cari berdasarkan plat atau nama mobil...":"Cari berdasarkan plat, nama mobil, atau inspector...",class:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",autofocus:""},null,40,ne),[[J,d.value]]),e("button",{onClick:R,class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600"},[l(c(z),{class:"h-5 w-5"})])])])):(a(),n("div",oe,[e("div",ie,[l(c(Q),{class:"h-4 w-4 text-gray-500 flex-shrink-0"}),_(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>p.value=t),class:"px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 text-sm"},[(a(),n(w,null,k(M,t=>e("option",{key:t.value,value:t.value},o(t.name),9,le)),64))],512),[[D,p.value]]),_(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>h.value=t),class:"px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 text-sm"},[(a(!0),n(w,null,k(A.value,t=>(a(),n("option",{key:t,value:t},o(t),9,ce))),128))],512),[[D,h.value]])]),e("button",{onClick:N,class:"p-1 text-gray-400 hover:text-gray-600 transition-colors"},[l(c(C),{class:"h-5 w-5"})])]))]),!m.value&&d.value?(a(),n("div",de,[e("p",ue,[l(c(C),{class:"h-4 w-4"}),g(' Menampilkan hasil pencarian: "'+o(d.value)+'" ',1),e("button",{onClick:R,class:"text-blue-600 hover:text-blue-800 ml-2"}," Ã— Hapus pencarian ")])])):b("",!0),i.tasks.length>0?(a(),n("div",me,[(a(!0),n(w,null,k(i.tasks,t=>(a(),n("div",{key:t.id,class:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition"},[e("div",pe,[e("span",{class:j(["px-2 py-1 text-xs font-medium rounded-full",I(t.status)])},o(y(t.status).toUpperCase()),3)]),(i.userRole==="admin_plant"||i.userRole==="quality_control")&&t.user?(a(),n("div",he,[e("div",ge,[e("div",ve,[l(c(K),{class:"h-4 w-4 text-gray-500 mr-2"}),e("div",null,[s[3]||(s[3]=e("p",{class:"text-sm font-medium text-gray-700"},"Inspector",-1)),e("p",xe,o(t.user.name),1)])]),i.userRole==="admin_plant"&&t.user.phone?(a(),n("a",{key:0,href:`https://wa.me/${V(t.user.phone)}?text=${encodeURIComponent(O(t))}`,target:"_blank",class:"text-green-600 hover:text-green-800 transition",title:"Kirim pesan WhatsApp ke inspector"},s[4]||(s[4]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.465 3.488"})],-1)]),8,fe)):b("",!0)])])):b("",!0),e("div",ye,[e("div",null,[e("div",be,[l(c(E),{class:"h-5 w-5 text-blue-500 mr-2"}),s[5]||(s[5]=e("span",{class:"text-sm font-medium text-gray-600"},"Jadwal",-1))]),e("p",_e,o(new Date(t.inspection_date).toLocaleDateString("id-ID",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})),1)]),l(c(S),{href:r.route("inspection.log",{inspection:i.encryptedIds[t.id]}),class:"text-xs font-semibold text-indigo-600 hover:underline"},{default:x(()=>s[6]||(s[6]=[g(" Lihat Log ")])),_:2,__:[6]},1032,["href"])]),e("div",we,[e("div",ke,[l(c(G),{class:"h-5 w-5 text-gray-500 mr-2"}),e("div",Se,[t.car?(a(),n("div",$e,[g(o(`${t.car.brand.name} ${t.car.model.name} ${t.car.type.name} ${(t.car.cc/1e3).toFixed(1)} ${t.car.transmission} ${t.car.year}`)+" ",1),e("span",Re,"("+o(t.car.fuel_type)+")",1)])):(a(),n("div",De,o(t.car_name),1))])]),e("div",je,[s[7]||(s[7]=e("span",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500 mr-2"},"NO POLISI:",-1)),e("span",Ce,o(t.plate_number),1)])]),e("div",Ie,[e("div",Me,[l(c(Z),{class:"h-5 w-5 text-green-500 mr-2"}),s[8]||(s[8]=e("span",{class:"text-sm font-medium text-gray-600"},"Status",-1))]),e("p",Ae,o(y(t.status)),1)]),e("div",Le,[l(c(S),{href:r.route("inspections.review",{id:i.encryptedIds[t.id]}),class:j(["inline-flex items-center justify-center w-full px-3 py-2 font-medium rounded-md text-sm transition-colors",i.userRole==="quality_control"?"bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:from-purple-700 hover:to-pink-700":"bg-gradient-to-r from-indigo-700 to-sky-600 text-white hover:from-indigo-800 hover:to-sky-700"])},{default:x(()=>[g(o(L()),1)]),_:2},1032,["href","class"])])]))),128))])):(a(),n("div",Be,[e("p",Te,o(d.value?"Tidak ditemukan hasil pencarian":"Belum ada riwayat inspeksi untuk periode ini"),1)])),e("div",Ne,[l(c(S),{href:r.route("job.index"),class:"inline-block px-4 py-2 text-sm font-medium text-indigo-600 border border-indigo-600 rounded-md hover:bg-blue-50"},{default:x(()=>s[9]||(s[9]=[g(" Kembali ke Tugas ")])),_:1,__:[9]},8,["href"])])])]),_:1}))}},Je=Y(Ve,[["__scopeId","data-v-5ecc18a0"]]);export{Je as default};
