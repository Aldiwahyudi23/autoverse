import{r as M,q as oe,G as ce,c as A,o as y,d as i,b as P,z as N,A as de,n as $e,t as S,u as I,F as V,m as O,f as pe,g as je,I as Z,J as Qe,x as Ze,p as Xe,H as ye,E as qe,j as xe,w as et,k as Se,v as tt,C as st,y as Ae}from"./vendor-g77w9U1W.js";import{A as at}from"./AppLayout-BmDQdJtK.js";import{l as nt}from"./lodash-CGXsUT3p.js";import{_ as rt}from"./app-o8vJnppO.js";const ot={class:"mb-2"},it={class:"flex items-center space-x-2"},lt=["disabled"],ut=["disabled"],ct={key:1,class:"mt-2 text-sm text-red-600"},dt={key:2,class:"mt-2 text-sm text-green-600"},gt={key:3,class:"mt-2 text-sm text-yellow-600"},ht={__name:"PlateNumberInput",props:{plateNumber:String,inspections:Array},emits:["update:plateNumber","plateValidityUpdate","carDataUpdate"],setup(s,{emit:e}){const t=s,n=e,a=M(""),r=M(""),o=M(""),l=M(""),g=M(""),c=M(""),d=M(!0),m={BL:"Aceh",BB:"Tapanuli (Sumatera Utara)",BK:"Medan, Deli Serdang, Binjai (Sumatera Utara)",BA:"Sumatera Barat",BM:"Riau",BH:"Jambi",BD:"Bengkulu",BG:"Sumatera Selatan",BN:"Bangka Belitung",BE:"Lampung",A:"Banten (Serang, Pandeglang, Cilegon, Lebak)",B:"Jakarta, Depok, Tangerang, Bekasi (Jadetabek)",D:"Bandung, Cimahi",E:"Cirebon, Indramayu, Majalengka, Kuningan",F:"Bogor, Sukabumi, Cianjur",T:"Karawang, Purwakarta, Subang, Bekasi Kabupaten, sebagian Cikampek",Z:"Garut, Tasikmalaya, Ciamis, Banjar, Sumedang",G:"Pekalongan, Tegal, Brebes, Pemalang, Batang",H:"Semarang, Kendal, Salatiga, Demak",K:"Pati, Kudus, Rembang, Blora, Jepara",R:"Banyumas, Cilacap, Purbalingga, Banjarnegara",AA:"Magelang, Temanggung, Purworejo, Wonosobo",AB:"DI Yogyakarta (Sleman, Bantul, Gunungkidul, Kulonprogo, Kota Jogja)",AD:"Surakarta (Solo), Sragen, Boyolali, Klaten, Wonogiri, Sukoharjo, Karanganyar",L:"Surabaya",M:"Madura (Bangkalan, Sampang, Pamekasan, Sumenep)",N:"Malang, Pasuruan, Probolinggo, Lumajang, Batu",P:"Jember, Banyuwangi, Bondowoso, Situbondo",S:"Bojonegoro, Lamongan, Tuban, Mojokerto, Jombang",W:"Sidoarjo, Gresik",AE:"Madiun, Magetan, Ngawi, Ponorogo, Pacitan",AG:"Kediri, Blitar, Tulungagung, Trenggalek",DK:"Bali",DR:"Lombok (NTB)",EA:"Sumbawa, Dompu, Bima (NTB)",DH:"Nusa Tenggara Timur (Kupang, Timor)",EB:"Flores, Lembata",ED:"Sumba",DA:"Kalimantan Selatan (Banjarmasin, Banjarbaru, dll.)",KB:"Kalimantan Barat (Pontianak, Singkawang, dll.)",KH:"Kalimantan Tengah (Palangkaraya, Sampit, dll.)",KT:"Kalimantan Timur (Balikpapan, Samarinda, Bontang, dll.)",KU:"Kalimantan Utara (Tarakan, Nunukan, Malinau, Tana Tidung, Bulungan)",DB:"Sulawesi Utara (Manado, Bitung, Minahasa, dll.)",DL:"Sangihe, Talaud (Sulut)",DM:"Gorontalo",DN:"Sulawesi Tengah (Palu, Poso, Banggai, dll.)",DT:"Sulawesi Tenggara (Kendari, Bau-bau, Kolaka, dll.)",DD:"Sulawesi Selatan (Makassar, Gowa, Bone, dll.)",DC:"Polewali Mandar, Majene, Mamasa (Sulbar)",DW:"Mamuju, Pasangkayu, Mamuju Tengah (Sulbar)",DE:"Maluku (Ambon, Maluku Tengah, dll.)",DG:"Maluku Utara (Ternate, Halmahera, dll.)",PA:"Papua (Jayapura, Merauke, dll.)",PB:"Papua Barat (Manokwari, Sorong, Fakfak, dll.)"},_=()=>{const p=`${a.value}${r.value}${o.value}`.toUpperCase();n("update:plateNumber",p)},B=p=>{p==="area"?a.value=a.value.toUpperCase().replace(/[^A-Z]/g,""):p==="number"?r.value=r.value.replace(/[^0-9]/g,""):p==="suffix"&&(o.value=o.value.toUpperCase().replace(/[^A-Z]/g,"")),_(),D()},D=()=>{a.value&&m[a.value]?(g.value=`âœ… ${a.value} = ${m[a.value]}`,d.value=!1):a.value?(g.value=`ðŸš« Kode wilayah "${a.value}" tidak valid`,d.value=!0):(g.value="âš  Masukkan kode wilayah (contoh: D, B, DK)",d.value=!0)},T=oe(()=>a.value.trim().length>=1&&r.value.trim().length>=1&&!d.value);ce(T,p=>{n("plateValidityUpdate",p)}),ce([a,r,o],()=>{l.value="",c.value=""}),ce(()=>t.plateNumber,p=>{p.length>=3&&v(p)});const v=p=>{const x=t.inspections.filter(E=>E.plate_number===p);if(x.length>0){const E=["draft","in_progress","pending","pending_review","revision"],w=x.find(R=>E.includes(R.status));if(w){l.value=`Nomor plat ini sedang dalam proses inspeksi dengan status: ${w.status.replace(/_/g," ").toUpperCase()}. Selesaikan inspeksi tersebut terlebih dahulu.`,n("plateValidityUpdate",!1);return}const H=x.filter(R=>["approved","rejected","completed","cancelled"].includes(R.status));if(H.length>0){H.sort((j,F)=>new Date(F.created_at)-new Date(j.created_at));const R=H[0];n("carDataUpdate",{id:R.car_id,name:R.car_name}),c.value=`Nomor plat ini sudah pernah diperiksa ${H.length} kali sebelumnya.`}}};return(p,x)=>(y(),A("div",ot,[x[6]||(x[6]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nomor Plat Kendaraan ",-1)),i("div",it,[N(i("input",{"onUpdate:modelValue":x[0]||(x[0]=E=>a.value=E),type:"text",placeholder:"D",class:"w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition",onInput:x[1]||(x[1]=E=>B("area")),maxlength:"2"},null,544),[[de,a.value]]),N(i("input",{"onUpdate:modelValue":x[2]||(x[2]=E=>r.value=E),type:"tel",pattern:"[0-9]*",placeholder:"1234",class:"w-2/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition",onInput:x[3]||(x[3]=E=>B("number")),disabled:d.value,maxlength:"4"},null,40,lt),[[de,r.value]]),N(i("input",{"onUpdate:modelValue":x[4]||(x[4]=E=>o.value=E),type:"text",placeholder:"ABC",class:"w-1/4 rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-center transition",onInput:x[5]||(x[5]=E=>B("suffix")),disabled:d.value,maxlength:"3"},null,40,ut),[[de,o.value]])]),g.value?(y(),A("div",{key:0,class:$e(["mt-2 text-sm",d.value?"text-red-600":"text-green-600"])},S(g.value),3)):P("",!0),l.value?(y(),A("div",ct,S(l.value),1)):P("",!0),c.value?(y(),A("div",dt,S(c.value),1)):P("",!0),T.value?P("",!0):(y(),A("div",gt," âš  Kolom kode wilayah dan nomor plat harus diisi "))]))}};function X(s){return Array.isArray?Array.isArray(s):Re(s)==="[object Array]"}function pt(s){if(typeof s=="string")return s;let e=s+"";return e=="0"&&1/s==-1/0?"-0":e}function ft(s){return s==null?"":pt(s)}function Y(s){return typeof s=="string"}function Ne(s){return typeof s=="number"}function mt(s){return s===!0||s===!1||vt(s)&&Re(s)=="[object Boolean]"}function Ke(s){return typeof s=="object"}function vt(s){return Ke(s)&&s!==null}function z(s){return s!=null}function _e(s){return!s.trim().length}function Re(s){return s==null?s===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(s)}const bt="Incorrect 'index' type",yt=s=>`Invalid value for key ${s}`,xt=s=>`Pattern length exceeds max of ${s}.`,At=s=>`Missing ${s} property in key`,_t=s=>`Property 'weight' in key '${s}' must be a positive integer`,Ie=Object.prototype.hasOwnProperty;class kt{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(n=>{let a=Ve(n);this._keys.push(a),this._keyMap[a.id]=a,t+=a.weight}),this._keys.forEach(n=>{n.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Ve(s){let e=null,t=null,n=null,a=1,r=null;if(Y(s)||X(s))n=s,e=Te(s),t=ke(s);else{if(!Ie.call(s,"name"))throw new Error(At("name"));const o=s.name;if(n=o,Ie.call(s,"weight")&&(a=s.weight,a<=0))throw new Error(_t(o));e=Te(o),t=ke(o),r=s.getFn}return{path:e,id:t,weight:a,src:n,getFn:r}}function Te(s){return X(s)?s:s.split(".")}function ke(s){return X(s)?s.join("."):s}function Ct(s,e){let t=[],n=!1;const a=(r,o,l)=>{if(z(r))if(!o[l])t.push(r);else{let g=o[l];const c=r[g];if(!z(c))return;if(l===o.length-1&&(Y(c)||Ne(c)||mt(c)))t.push(ft(c));else if(X(c)){n=!0;for(let d=0,m=c.length;d<m;d+=1)a(c[d],o,l+1)}else o.length&&a(c,o,l+1)}};return a(s,Y(e)?e.split("."):e,0),n?t:t[0]}const wt={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Bt={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(s,e)=>s.score===e.score?s.idx<e.idx?-1:1:s.score<e.score?-1:1},Mt={location:0,threshold:.6,distance:100},Et={useExtendedSearch:!1,getFn:Ct,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var C={...Bt,...wt,...Mt,...Et};const $t=/[^ ]+/g;function Dt(s=1,e=3){const t=new Map,n=Math.pow(10,e);return{get(a){const r=a.match($t).length;if(t.has(r))return t.get(r);const o=1/Math.pow(r,.5*s),l=parseFloat(Math.round(o*n)/n);return t.set(r,l),l},clear(){t.clear()}}}class De{constructor({getFn:e=C.getFn,fieldNormWeight:t=C.fieldNormWeight}={}){this.norm=Dt(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((t,n)=>{this._keysMap[t.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Y(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){const t=this.size();Y(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!z(e)||_e(e))return;let n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}_addObject(e,t){let n={i:t,$:{}};this.keys.forEach((a,r)=>{let o=a.getFn?a.getFn(e):this.getFn(e,a.path);if(z(o)){if(X(o)){let l=[];const g=[{nestedArrIndex:-1,value:o}];for(;g.length;){const{nestedArrIndex:c,value:d}=g.pop();if(z(d))if(Y(d)&&!_e(d)){let m={v:d,i:c,n:this.norm.get(d)};l.push(m)}else X(d)&&d.forEach((m,_)=>{g.push({nestedArrIndex:_,value:m})})}n.$[r]=l}else if(Y(o)&&!_e(o)){let l={v:o,n:this.norm.get(o)};n.$[r]=l}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function Ue(s,e,{getFn:t=C.getFn,fieldNormWeight:n=C.fieldNormWeight}={}){const a=new De({getFn:t,fieldNormWeight:n});return a.setKeys(s.map(Ve)),a.setSources(e),a.create(),a}function St(s,{getFn:e=C.getFn,fieldNormWeight:t=C.fieldNormWeight}={}){const{keys:n,records:a}=s,r=new De({getFn:e,fieldNormWeight:t});return r.setKeys(n),r.setIndexRecords(a),r}function he(s,{errors:e=0,currentLocation:t=0,expectedLocation:n=0,distance:a=C.distance,ignoreLocation:r=C.ignoreLocation}={}){const o=e/s.length;if(r)return o;const l=Math.abs(n-t);return a?o+l/a:l?1:o}function It(s=[],e=C.minMatchCharLength){let t=[],n=-1,a=-1,r=0;for(let o=s.length;r<o;r+=1){let l=s[r];l&&n===-1?n=r:!l&&n!==-1&&(a=r-1,a-n+1>=e&&t.push([n,a]),n=-1)}return s[r-1]&&r-n>=e&&t.push([n,r-1]),t}const ie=32;function Tt(s,e,t,{location:n=C.location,distance:a=C.distance,threshold:r=C.threshold,findAllMatches:o=C.findAllMatches,minMatchCharLength:l=C.minMatchCharLength,includeMatches:g=C.includeMatches,ignoreLocation:c=C.ignoreLocation}={}){if(e.length>ie)throw new Error(xt(ie));const d=e.length,m=s.length,_=Math.max(0,Math.min(n,m));let B=r,D=_;const T=l>1||g,v=T?Array(m):[];let p;for(;(p=s.indexOf(e,D))>-1;){let j=he(e,{currentLocation:p,expectedLocation:_,distance:a,ignoreLocation:c});if(B=Math.min(j,B),D=p+d,T){let F=0;for(;F<d;)v[p+F]=1,F+=1}}D=-1;let x=[],E=1,w=d+m;const H=1<<d-1;for(let j=0;j<d;j+=1){let F=0,G=w;for(;F<G;)he(e,{errors:j,currentLocation:_+G,expectedLocation:_,distance:a,ignoreLocation:c})<=B?F=G:w=G,G=Math.floor((w-F)/2+F);w=G;let ae=Math.max(1,_-G+1),q=o?m:Math.min(_+G,m)+d,J=Array(q+2);J[q+1]=(1<<j)-1;for(let K=q;K>=ae;K-=1){let Q=K-1,ne=t[s.charAt(Q)];if(T&&(v[Q]=+!!ne),J[K]=(J[K+1]<<1|1)&ne,j&&(J[K]|=(x[K+1]|x[K])<<1|1|x[K+1]),J[K]&H&&(E=he(e,{errors:j,currentLocation:Q,expectedLocation:_,distance:a,ignoreLocation:c}),E<=B)){if(B=E,D=Q,D<=_)break;ae=Math.max(1,2*_-D)}}if(he(e,{errors:j+1,currentLocation:_,expectedLocation:_,distance:a,ignoreLocation:c})>B)break;x=J}const R={isMatch:D>=0,score:Math.max(.001,E)};if(T){const j=It(v,l);j.length?g&&(R.indices=j):R.isMatch=!1}return R}function Ft(s){let e={};for(let t=0,n=s.length;t<n;t+=1){const a=s.charAt(t);e[a]=(e[a]||0)|1<<n-t-1}return e}const fe=String.prototype.normalize?s=>s.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):s=>s;class Oe{constructor(e,{location:t=C.location,threshold:n=C.threshold,distance:a=C.distance,includeMatches:r=C.includeMatches,findAllMatches:o=C.findAllMatches,minMatchCharLength:l=C.minMatchCharLength,isCaseSensitive:g=C.isCaseSensitive,ignoreDiacritics:c=C.ignoreDiacritics,ignoreLocation:d=C.ignoreLocation}={}){if(this.options={location:t,threshold:n,distance:a,includeMatches:r,findAllMatches:o,minMatchCharLength:l,isCaseSensitive:g,ignoreDiacritics:c,ignoreLocation:d},e=g?e:e.toLowerCase(),e=c?fe(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const m=(B,D)=>{this.chunks.push({pattern:B,alphabet:Ft(B),startIndex:D})},_=this.pattern.length;if(_>ie){let B=0;const D=_%ie,T=_-D;for(;B<T;)m(this.pattern.substr(B,ie),B),B+=ie;if(D){const v=_-ie;m(this.pattern.substr(v),v)}}else m(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,ignoreDiacritics:n,includeMatches:a}=this.options;if(e=t?e:e.toLowerCase(),e=n?fe(e):e,this.pattern===e){let T={isMatch:!0,score:0};return a&&(T.indices=[[0,e.length-1]]),T}const{location:r,distance:o,threshold:l,findAllMatches:g,minMatchCharLength:c,ignoreLocation:d}=this.options;let m=[],_=0,B=!1;this.chunks.forEach(({pattern:T,alphabet:v,startIndex:p})=>{const{isMatch:x,score:E,indices:w}=Tt(e,T,v,{location:r+p,distance:o,threshold:l,findAllMatches:g,minMatchCharLength:c,includeMatches:a,ignoreLocation:d});x&&(B=!0),_+=E,x&&w&&(m=[...m,...w])});let D={isMatch:B,score:B?_/this.chunks.length:1};return B&&a&&(D.indices=m),D}}class se{constructor(e){this.pattern=e}static isMultiMatch(e){return Fe(e,this.multiRegex)}static isSingleMatch(e){return Fe(e,this.singleRegex)}search(){}}function Fe(s,e){const t=s.match(e);return t?t[1]:null}class Pt extends se{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Lt extends se{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const n=e.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class jt extends se{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Nt extends se{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class Kt extends se{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class Rt extends se{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class ze extends se{constructor(e,{location:t=C.location,threshold:n=C.threshold,distance:a=C.distance,includeMatches:r=C.includeMatches,findAllMatches:o=C.findAllMatches,minMatchCharLength:l=C.minMatchCharLength,isCaseSensitive:g=C.isCaseSensitive,ignoreDiacritics:c=C.ignoreDiacritics,ignoreLocation:d=C.ignoreLocation}={}){super(e),this._bitapSearch=new Oe(e,{location:t,threshold:n,distance:a,includeMatches:r,findAllMatches:o,minMatchCharLength:l,isCaseSensitive:g,ignoreDiacritics:c,ignoreLocation:d})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Ge extends se{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t=0,n;const a=[],r=this.pattern.length;for(;(n=e.indexOf(this.pattern,t))>-1;)t=n+r,a.push([n,t-1]);const o=!!a.length;return{isMatch:o,score:o?0:1,indices:a}}}const Ce=[Pt,Ge,jt,Nt,Rt,Kt,Lt,ze],Pe=Ce.length,Vt=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Ut="|";function Ot(s,e={}){return s.split(Ut).map(t=>{let n=t.trim().split(Vt).filter(r=>r&&!!r.trim()),a=[];for(let r=0,o=n.length;r<o;r+=1){const l=n[r];let g=!1,c=-1;for(;!g&&++c<Pe;){const d=Ce[c];let m=d.isMultiMatch(l);m&&(a.push(new d(m,e)),g=!0)}if(!g)for(c=-1;++c<Pe;){const d=Ce[c];let m=d.isSingleMatch(l);if(m){a.push(new d(m,e));break}}}return a})}const zt=new Set([ze.type,Ge.type]);class Gt{constructor(e,{isCaseSensitive:t=C.isCaseSensitive,ignoreDiacritics:n=C.ignoreDiacritics,includeMatches:a=C.includeMatches,minMatchCharLength:r=C.minMatchCharLength,ignoreLocation:o=C.ignoreLocation,findAllMatches:l=C.findAllMatches,location:g=C.location,threshold:c=C.threshold,distance:d=C.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:n,includeMatches:a,minMatchCharLength:r,findAllMatches:l,ignoreLocation:o,location:g,threshold:c,distance:d},e=t?e:e.toLowerCase(),e=n?fe(e):e,this.pattern=e,this.query=Ot(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:a,ignoreDiacritics:r}=this.options;e=a?e:e.toLowerCase(),e=r?fe(e):e;let o=0,l=[],g=0;for(let c=0,d=t.length;c<d;c+=1){const m=t[c];l.length=0,o=0;for(let _=0,B=m.length;_<B;_+=1){const D=m[_],{isMatch:T,indices:v,score:p}=D.search(e);if(T){if(o+=1,g+=p,n){const x=D.constructor.type;zt.has(x)?l=[...l,...v]:l.push(v)}}else{g=0,o=0,l.length=0;break}}if(o){let _={isMatch:!0,score:g/o};return n&&(_.indices=l),_}}return{isMatch:!1,score:1}}}const we=[];function Wt(...s){we.push(...s)}function Be(s,e){for(let t=0,n=we.length;t<n;t+=1){let a=we[t];if(a.condition(s,e))return new a(s,e)}return new Oe(s,e)}const me={AND:"$and",OR:"$or"},Me={PATH:"$path",PATTERN:"$val"},Ee=s=>!!(s[me.AND]||s[me.OR]),Ht=s=>!!s[Me.PATH],Jt=s=>!X(s)&&Ke(s)&&!Ee(s),Le=s=>({[me.AND]:Object.keys(s).map(e=>({[e]:s[e]}))});function We(s,e,{auto:t=!0}={}){const n=a=>{let r=Object.keys(a);const o=Ht(a);if(!o&&r.length>1&&!Ee(a))return n(Le(a));if(Jt(a)){const g=o?a[Me.PATH]:r[0],c=o?a[Me.PATTERN]:a[g];if(!Y(c))throw new Error(yt(g));const d={keyId:ke(g),pattern:c};return t&&(d.searcher=Be(c,e)),d}let l={children:[],operator:r[0]};return r.forEach(g=>{const c=a[g];X(c)&&c.forEach(d=>{l.children.push(n(d))})}),l};return Ee(s)||(s=Le(s)),n(s)}function Yt(s,{ignoreFieldNorm:e=C.ignoreFieldNorm}){s.forEach(t=>{let n=1;t.matches.forEach(({key:a,norm:r,score:o})=>{const l=a?a.weight:null;n*=Math.pow(o===0&&l?Number.EPSILON:o,(l||1)*(e?1:r))}),t.score=n})}function Qt(s,e){const t=s.matches;e.matches=[],z(t)&&t.forEach(n=>{if(!z(n.indices)||!n.indices.length)return;const{indices:a,value:r}=n;let o={indices:a,value:r};n.key&&(o.key=n.key.src),n.idx>-1&&(o.refIndex=n.idx),e.matches.push(o)})}function Zt(s,e){e.score=s.score}function Xt(s,e,{includeMatches:t=C.includeMatches,includeScore:n=C.includeScore}={}){const a=[];return t&&a.push(Qt),n&&a.push(Zt),s.map(r=>{const{idx:o}=r,l={item:e[o],refIndex:o};return a.length&&a.forEach(g=>{g(r,l)}),l})}class ge{constructor(e,t={},n){this.options={...C,...t},this.options.useExtendedSearch,this._keyStore=new kt(this.options.keys),this.setCollection(e,n)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof De))throw new Error(bt);this._myIndex=t||Ue(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){z(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const t=[];for(let n=0,a=this._docs.length;n<a;n+=1){const r=this._docs[n];e(r,n)&&(this.removeAt(n),n-=1,a-=1,t.push(r))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){const{includeMatches:n,includeScore:a,shouldSort:r,sortFn:o,ignoreFieldNorm:l}=this.options;let g=Y(e)?Y(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Yt(g,{ignoreFieldNorm:l}),r&&g.sort(o),Ne(t)&&t>-1&&(g=g.slice(0,t)),Xt(g,this._docs,{includeMatches:n,includeScore:a})}_searchStringList(e){const t=Be(e,this.options),{records:n}=this._myIndex,a=[];return n.forEach(({v:r,i:o,n:l})=>{if(!z(r))return;const{isMatch:g,score:c,indices:d}=t.searchIn(r);g&&a.push({item:r,idx:o,matches:[{score:c,value:r,norm:l,indices:d}]})}),a}_searchLogical(e){const t=We(e,this.options),n=(l,g,c)=>{if(!l.children){const{keyId:m,searcher:_}=l,B=this._findMatches({key:this._keyStore.get(m),value:this._myIndex.getValueForItemAtKeyId(g,m),searcher:_});return B&&B.length?[{idx:c,item:g,matches:B}]:[]}const d=[];for(let m=0,_=l.children.length;m<_;m+=1){const B=l.children[m],D=n(B,g,c);if(D.length)d.push(...D);else if(l.operator===me.AND)return[]}return d},a=this._myIndex.records,r={},o=[];return a.forEach(({$:l,i:g})=>{if(z(l)){let c=n(t,l,g);c.length&&(r[g]||(r[g]={idx:g,item:l,matches:[]},o.push(r[g])),c.forEach(({matches:d})=>{r[g].matches.push(...d)}))}}),o}_searchObjectList(e){const t=Be(e,this.options),{keys:n,records:a}=this._myIndex,r=[];return a.forEach(({$:o,i:l})=>{if(!z(o))return;let g=[];n.forEach((c,d)=>{g.push(...this._findMatches({key:c,value:o[d],searcher:t}))}),g.length&&r.push({idx:l,item:o,matches:g})}),r}_findMatches({key:e,value:t,searcher:n}){if(!z(t))return[];let a=[];if(X(t))t.forEach(({v:r,i:o,n:l})=>{if(!z(r))return;const{isMatch:g,score:c,indices:d}=n.searchIn(r);g&&a.push({score:c,key:e,value:r,idx:o,norm:l,indices:d})});else{const{v:r,n:o}=t,{isMatch:l,score:g,indices:c}=n.searchIn(r);l&&a.push({score:g,key:e,value:r,norm:o,indices:c})}return a}}ge.version="7.1.0";ge.createIndex=Ue;ge.parseIndex=St;ge.config=C;ge.parseQuery=We;Wt(Gt);const qt={class:"mb-2"},es={class:"relative"},ts={key:0,class:"absolute right-3 top-3"},ss={key:1,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},as={key:0},ns=["onMousedown"],rs={class:"font-medium text-gray-900"},os={key:1,class:"p-4 text-sm text-gray-500 text-center"},is={key:0,class:"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200"},ls={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},us=["onClick"],cs=["src","alt"],ds={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},gs={class:"text-white text-xs text-center"},hs={__name:"CarSearchInput",props:{carId:[Number,String],carName:String,carDetail:Array},emits:["update:carId","update:carName","carSelected","carImagesLoaded"],setup(s,{emit:e}){const t=s,n=e,a=M(""),r=M(!1),o=M(!1),l=M([]),g=M(null),c=M([]),d=v=>{var x,E,w;if(!v)return"";const p=[];return(x=v.brand)!=null&&x.name&&p.push(v.brand.name),(E=v.model)!=null&&E.name&&p.push(v.model.name),(w=v.type)!=null&&w.name&&p.push(v.type.name),v.cc&&p.push((v.cc/1e3).toFixed(1)),v.transmission&&p.push(v.transmission),v.year&&p.push(v.year.toString()),v.fuel_type&&p.push(v.fuel_type),v.production_period&&p.push(`(${v.production_period})`),p.join(" ")},m=nt.debounce(()=>{if(!a.value.trim()){l.value=[],r.value=!1;return}o.value=!0;const v=a.value.trim(),p=t.carDetail.map(w=>({...w,formattedName:d(w)})),E=new ge(p,{keys:["formattedName"],threshold:.6,findAllMatches:!0,includeScore:!0}).search(v).slice(0,10);l.value=E.map(w=>w.item),r.value=!0,o.value=!1},300),_=()=>{setTimeout(()=>{r.value=!1},200)},B=async v=>{g.value=v,a.value=d(v),n("update:carId",v.id),n("update:carName",d(v)),n("carSelected",v),r.value=!1;const p=await D(v.id);n("carImagesLoaded",p)},D=async v=>{try{const p=await fetch(`/api/cars/${v}/images`);if(p.ok){const x=await p.json(),E=Array.isArray(x)?x:[];return c.value=E,E}else return c.value=[],[]}catch(p){return console.error("Error loading car images:",p),c.value=[],[]}},T=v=>!v||!v.file_path?"":`/storage/${v.file_path}`;return ce(()=>t.carId,v=>{v||(g.value=null,a.value="",c.value=[])}),ce(a,v=>{(!g.value||d(g.value)!==v)&&(n("update:carId",null),g.value=null,c.value=[])}),(v,p)=>(y(),A(V,null,[i("div",qt,[p[5]||(p[5]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nama Mobil ",-1)),i("div",es,[N(i("input",{"onUpdate:modelValue":p[0]||(p[0]=x=>a.value=x),type:"text",placeholder:"Cari atau ketik nama mobil...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",onInput:p[1]||(p[1]=(...x)=>I(m)&&I(m)(...x)),onFocus:p[2]||(p[2]=x=>r.value=!0),onBlur:_},null,544),[[de,a.value]]),o.value?(y(),A("div",ts,p[3]||(p[3]=[i("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[i("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),i("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):P("",!0),r.value?(y(),A("div",ss,[l.value.length>0?(y(),A("div",as,[(y(!0),A(V,null,O(l.value,x=>(y(),A("div",{key:x.id,class:"px-4 py-2 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onMousedown:E=>B(x)},[i("div",rs,S(d(x)),1)],40,ns))),128))])):(y(),A("div",os,p[4]||(p[4]=[pe(" Tidak ada data mobil yang cocok. "),i("br",null,null,-1),pe(" Silakan input manual dengan format: "),i("br",null,null,-1),i("span",{class:"font-medium text-gray-800"},"Toyota Avanza 1.5 G AT Bensin 2019",-1)])))])):P("",!0)])]),g.value&&c.value.length>0?(y(),A("div",is,[p[6]||(p[6]=i("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),i("div",ls,[(y(!0),A(V,null,O(c.value,(x,E)=>(y(),A("div",{key:x.id||E,class:"relative group cursor-pointer",onClick:w=>v.openLightbox(E)},[i("img",{src:T(x),alt:x.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,cs),x.note?(y(),A("div",ds,[i("p",gs,S(x.note),1)])):P("",!0)],8,us))),128))])])):P("",!0)],64))}},ps={class:"mb-2"},fs={class:"mb-4"},ms=["disabled"],vs=["value"],bs={class:"mb-4"},ys=["disabled"],xs=["value"],As={class:"mb-4"},_s=["disabled"],ks=["value"],Cs={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},ws=["disabled"],Bs=["value"],Ms=["disabled"],Es=["value"],$s={class:"mb-4"},Ds={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},Ss=["value","disabled"],Is={class:"mb-4"},Ts=["disabled"],Fs=["value"],Ps={class:"mb-4"},Ls=["disabled"],js=["value"],Ns={key:0,class:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg"},Ks={class:"text-green-700"},Rs={key:1,class:"mt-2 text-sm text-gray-500 flex items-center"},Vs={__name:"CarSelectionWizard",props:{carDetail:Array},emits:["car-selected","car-images-loaded"],setup(s,{emit:e}){const t=e,n=M(""),a=M(""),r=M(""),o=M(""),l=M(""),g=M(""),c=M(""),d=M(""),m=M(null),_=M([]),B=M([]),D=M([]),T=M([]),v=M([]),p=M([]),x=M([]),E=M([]),w=M({brand:!1,model:!1,type:!1,capacity:!1,year:!1,transmission:!1,fuel:!1,period:!1}),H=oe(()=>Object.values(w.value).some(k=>k)),R=k=>(k/1e3).toFixed(1)+"L",j=k=>{const h={AT:{category:"AT",label:"Automatic"},MT:{category:"MT",label:"Manual"},CVT:{category:"AT",label:"CVT"},"e-CVT":{category:"AT",label:"e-CVT"},DCT:{category:"AT",label:"DCT"},IVT:{category:"AT",label:"IVT"},SSG:{category:"AT",label:"SSG"},AGS:{category:"AT",label:"AGS"},DHT:{category:"AT",label:"DHT"},AMT:{category:"MT",label:"AMT"}}[k];return h?h.label==="Automatic"||h.label==="Manual"?h.category:`${h.category} (${h.label})`:k},F=async(k,u={})=>{const h=new AbortController,L=setTimeout(()=>h.abort(),5e3);try{const U=await fetch(k,{...u,signal:h.signal});return clearTimeout(L),U}catch(U){throw clearTimeout(L),U}},G=async()=>{w.value.brand=!0;try{const k=await F("/api/car-brands");_.value=await k.json()}catch(k){console.error("Error fetching brands:",k)}finally{w.value.brand=!1}},ae=async k=>{if(k){w.value.model=!0;try{const u=await F(`/api/car-models/${k}`);B.value=await u.json()}catch(u){console.error("Error fetching models:",u)}finally{w.value.model=!1}}},q=async k=>{if(k){w.value.type=!0;try{const u=await F(`/api/car-types/${k}`);D.value=await u.json()}catch(u){console.error("Error fetching types:",u)}finally{w.value.type=!1}}},J=async k=>{if(k){w.value.capacity=!0;try{const u=await F(`/api/car-capacities/${k}`);T.value=await u.json()}catch(u){console.error("Error fetching capacities:",u)}finally{w.value.capacity=!1}}},le=async(k,u)=>{if(!(!k||!u)){w.value.year=!0;try{const h=await F(`/api/car-years/${k}/${u}`);v.value=await h.json()}catch(h){console.error("Error fetching years:",h)}finally{w.value.year=!1}}},K=async(k,u,h)=>{if(!(!k||!u||!h)){w.value.transmission=!0;try{const L=await F(`/api/car-transmissions/${k}/${u}/${h}`);p.value=await L.json()}catch(L){console.error("Error fetching transmissions:",L)}finally{w.value.transmission=!1}}},Q=async(k,u,h,L)=>{if(!(!k||!u||!h||!L)){w.value.fuel=!0;try{const U=await F(`/api/car-fuels/${k}/${u}/${h}/${L}`);x.value=await U.json()}catch(U){console.error("Error fetching fuels:",U)}finally{w.value.fuel=!1}}},ne=async(k,u,h,L,U)=>{if(!(!k||!u||!h||!L||!U)){w.value.period=!0;try{const ue=await F(`/api/car-periods/${k}/${u}/${h}/${L}/${U}`);E.value=await ue.json()}catch(ue){console.error("Error fetching periods:",ue)}finally{w.value.period=!1}}},ve=async k=>{try{const u=await fetch(`/api/cars/${k}/images`);if(u.ok){const h=await u.json(),L=Array.isArray(h)?h:[];return t("car-images-loaded",L),L}return[]}catch(u){return console.error("Error loading car images:",u),[]}},b=async(k,u,h,L,U,ue)=>{if(!(!k||!u||!h||!L||!U||!ue))try{const be=await F(`/api/car-details/${k}/${u}/${h}/${L}/${U}/${ue}`);m.value=await be.json(),m.value&&(t("car-selected",m.value),await ve(m.value.id))}catch(be){console.error("Error fetching car detail:",be)}},f=()=>{re(["model","type","capacity","year","transmission","fuel","period"]),n.value&&ae(n.value)},W=()=>{re(["type","capacity","year","transmission","fuel","period"]),a.value&&q(a.value)},$=()=>{re(["capacity","year","transmission","fuel","period"]),r.value&&J(r.value)},ee=()=>{re(["year","transmission","fuel","period"]),r.value&&o.value&&le(r.value,o.value)},te=()=>{re(["transmission","fuel","period"]),r.value&&o.value&&l.value&&K(r.value,o.value,l.value)},He=()=>{re(["fuel","period"]),r.value&&o.value&&l.value&&g.value&&Q(r.value,o.value,l.value,g.value)},Je=()=>{re(["period"]),r.value&&o.value&&l.value&&g.value&&c.value&&ne(r.value,o.value,l.value,g.value,c.value)},Ye=()=>{m.value=null,r.value&&o.value&&l.value&&g.value&&c.value&&d.value&&b(r.value,o.value,l.value,g.value,c.value,d.value)},re=k=>{k.forEach(u=>{u==="model"&&(a.value=""),u==="type"&&(r.value=""),u==="capacity"&&(o.value=""),u==="year"&&(l.value=""),u==="transmission"&&(g.value=""),u==="fuel"&&(c.value=""),u==="period"&&(d.value="")}),m.value=null,k.includes("model")&&(B.value=[]),k.includes("type")&&(D.value=[]),k.includes("capacity")&&(T.value=[]),k.includes("year")&&(v.value=[]),k.includes("transmission")&&(p.value=[]),k.includes("fuel")&&(x.value=[]),k.includes("period")&&(E.value=[])};return je(()=>{G()}),(k,u)=>(y(),A("div",ps,[i("div",fs,[u[9]||(u[9]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Brand",-1)),N(i("select",{"onUpdate:modelValue":u[0]||(u[0]=h=>n.value=h),onChange:f,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",disabled:w.value.brand},[u[8]||(u[8]=i("option",{value:""},"Pilih Brand",-1)),(y(!0),A(V,null,O(_.value,h=>(y(),A("option",{key:h.id,value:h.id},S(h.name),9,vs))),128))],40,ms),[[Z,n.value]])]),i("div",bs,[u[11]||(u[11]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Model",-1)),N(i("select",{"onUpdate:modelValue":u[1]||(u[1]=h=>a.value=h),onChange:W,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",disabled:!n.value||w.value.model},[u[10]||(u[10]=i("option",{disabled:"",value:""},"Pilih Model",-1)),(y(!0),A(V,null,O(B.value,h=>(y(),A("option",{key:h.id,value:h.id},S(h.name),9,xs))),128))],40,ys),[[Z,a.value]])]),i("div",As,[u[13]||(u[13]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type/Varian",-1)),N(i("select",{"onUpdate:modelValue":u[2]||(u[2]=h=>r.value=h),onChange:$,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",disabled:!a.value||w.value.type},[u[12]||(u[12]=i("option",{disabled:"",value:""},"Pilih Type",-1)),(y(!0),A(V,null,O(D.value,h=>(y(),A("option",{key:h.id,value:h.id},S(h.name),9,ks))),128))],40,_s),[[Z,r.value]])]),i("div",Cs,[i("div",null,[u[15]||(u[15]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Kapasitas Mesin",-1)),N(i("select",{"onUpdate:modelValue":u[3]||(u[3]=h=>o.value=h),onChange:ee,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",disabled:!r.value||w.value.capacity},[u[14]||(u[14]=i("option",{disabled:"",value:""},"Pilih Kapasitas",-1)),(y(!0),A(V,null,O(T.value,h=>(y(),A("option",{key:h.cc,value:h.cc},S(h.display),9,Bs))),128))],40,ws),[[Z,o.value]])]),i("div",null,[u[17]||(u[17]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tahun",-1)),N(i("select",{"onUpdate:modelValue":u[4]||(u[4]=h=>l.value=h),onChange:te,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",disabled:!o.value||w.value.year},[u[16]||(u[16]=i("option",{disabled:"",value:""},"Pilih Tahun",-1)),(y(!0),A(V,null,O(v.value,h=>(y(),A("option",{key:h.year,value:h.year},S(h.year),9,Es))),128))],40,Ms),[[Z,l.value]])])]),i("div",$s,[u[18]||(u[18]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Transmisi",-1)),i("div",Ds,[(y(!0),A(V,null,O(p.value,h=>(y(),A("label",{key:h.transmission,class:$e(["flex items-center justify-center cursor-pointer rounded-xl border p-3 text-sm font-medium transition-all duration-200",{"border-indigo-500 bg-indigo-50 text-indigo-700 shadow-sm":g.value===h.transmission,"border-gray-300 text-gray-700 hover:border-indigo-300":g.value!==h.transmission}])},[N(i("input",{type:"radio","onUpdate:modelValue":u[5]||(u[5]=L=>g.value=L),value:h.transmission,onChange:He,class:"sr-only",disabled:!l.value||w.value.transmission},null,40,Ss),[[Qe,g.value]]),pe(" "+S(j(h.transmission)),1)],2))),128))])]),i("div",Is,[u[20]||(u[20]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Bahan Bakar",-1)),N(i("select",{"onUpdate:modelValue":u[6]||(u[6]=h=>c.value=h),onChange:Je,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",disabled:!g.value||w.value.fuel},[u[19]||(u[19]=i("option",{disabled:"",value:""},"Pilih Bahan Bakar",-1)),(y(!0),A(V,null,O(x.value,h=>(y(),A("option",{key:h.fuel_type,value:h.fuel_type},S(h.fuel_type),9,Fs))),128))],40,Ts),[[Z,c.value]])]),i("div",Ps,[u[22]||(u[22]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Periode Produksi",-1)),N(i("select",{"onUpdate:modelValue":u[7]||(u[7]=h=>d.value=h),onChange:Ye,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",disabled:!c.value||w.value.period},[u[21]||(u[21]=i("option",{disbaled:"",value:""},"Pilih Periode Produksi",-1)),(y(!0),A(V,null,O(E.value,h=>(y(),A("option",{key:h.production_period,value:h.production_period},S(h.production_period),9,js))),128))],40,Ls),[[Z,d.value]])]),m.value?(y(),A("div",Ns,[u[23]||(u[23]=i("h4",{class:"font-medium text-green-800 mb-2"},"Mobil Terpilih:",-1)),i("p",Ks,S(m.value.brand.name)+" "+S(m.value.model.name)+" "+S(m.value.type.name)+" "+S(R(m.value.cc))+" "+S(j(m.value.transmission))+" "+S(m.value.fuel_type)+" "+S(m.value.year)+" ("+S(m.value.production_period)+")",1)])):P("",!0),H.value?(y(),A("div",Rs,u[24]||(u[24]=[i("svg",{class:"animate-spin h-4 w-4 mr-2 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[i("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),i("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),pe(" Memuat data... ")]))):P("",!0)]))}},Us={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},Os={class:"space-y-6 bg-white rounded-xl shadow-md p-6"},zs={key:0,class:"mb-4 text-sm text-red-600 bg-red-100 p-3 rounded-md"},Gs={class:"mb-2 flex justify-end"},Ws={class:"mb-4"},Hs=["value"],Js={class:"mb-4 flex items-center justify-between"},Ys={class:"relative inline-flex items-center cursor-pointer"},Qs=["disabled"],Zs={key:3,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Xs=["min"],qs={key:0,class:"mb-6"},ea=["value"],ta={class:"mt-6 flex justify-end"},sa=["disabled"],aa={key:4,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},na={key:0,class:"mb-4"},ra=["innerHTML"],oa={key:1},ia={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"},la=["onClick"],ua=["src","alt"],ca={key:0,class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center p-2"},da={class:"text-white text-xs text-center"},ga={key:2,class:"text-center py-4 text-gray-500 text-sm"},ha={class:"relative max-w-4xl max-h-full w-full h-full flex items-center justify-center"},pa=["src","alt"],fa={key:2,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black bg-opacity-50 px-3 py-1 rounded-full text-sm"},ma={key:3,class:"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 px-3 py-1 rounded text-sm max-w-md"},va={__name:"Index",props:{CarDetail:Array,Category:Array,team:Array,inspection:Array,activeInspections:Boolean},setup(s){const e=s,t=Ze({plate_number:"",car_id:null,car_name:"",category_id:"",is_scheduled:!1,scheduled_at_date:null,scheduled_at_time:null,inspector_id:null}),n=Xe(),a=n.props.global.user,r=n.props.global.region,o=n.props.global.has_roles,l=M(!1),g=M(new Date().toISOString().split("T")[0]),c=M(null),d=M([]),m=M(!1),_=M(0),B=M("search"),D=()=>{B.value=B.value==="search"?"wizard":"search",t.car_id=null,t.car_name="",c.value=null,d.value=[]},T=oe(()=>o.includes("admin_plann"));ye(()=>{T.value&&(t.is_scheduled=!0)});const v=b=>{var f,W,$;b.car_id&&b.car_name?(t.car_id=b.car_id,t.car_name=b.car_name,c.value=e.CarDetail.find(ee=>ee.id===b.car_id)||null):b.id&&(t.car_id=b.id,t.car_name=`${(f=b.brand)==null?void 0:f.name} ${(W=b.model)==null?void 0:W.name} ${($=b.type)==null?void 0:$.name} ${H(b.cc)} ${R(b.transmission)} ${b.fuel_type} ${b.year} (${b.production_period})`,c.value=b)},p=oe(()=>e.activeInspections),x=oe(()=>!(!t.plate_number.trim()||!t.category_id||!t.car_id&&!t.car_name.trim()||t.is_scheduled&&(!t.scheduled_at_date||!t.scheduled_at_time)||(o.includes("Admin")||o.includes("coordinator"))&&!t.inspector_id)),E=oe(()=>t.is_scheduled?"Buat Jadwal":"Mulai Inspeksi"),w=oe(()=>{const b=e.team.filter(te=>te.status==="active"),f=o.includes("Admin"),W=o.includes("admin_plann"),$=o.includes("coordinator"),ee=o.includes("admin_region");return f||W?b:$?b.filter(te=>te.region_id===r.id):ee?b.filter(te=>te.region_id===r.id):[]}),H=b=>(b/1e3).toFixed(1)+"L",R=b=>({AT:"Automatic",MT:"Manual",CVT:"CVT",AMT:"AMT"})[b]||b,j=b=>{l.value=!b},F=b=>{console.log("Car data received from plate validation:",b),b?(t.car_id=b.id,t.car_name=b.name,b.id&&(c.value=e.CarDetail.find(f=>f.id===b.id)||null,c.value&&G(c.value.id)),b.inspectionData&&console.log("Inspection data available:",b.inspectionData)):(t.car_id=null,t.car_name="",c.value=null,d.value=[])},G=async b=>{try{const f=await fetch(`/api/cars/${b}/images`);if(f.ok){const W=await f.json();d.value=Array.isArray(W)?W:[]}else d.value=[]}catch(f){console.error("Error loading car images:",f),d.value=[]}},ae=b=>{d.value=b},q=b=>b!=null&&b.file_path?`/storage/${b.file_path}`:"",J=b=>{_.value=b,m.value=!0,document.body.style.overflow="hidden"},le=()=>{m.value=!1,document.body.style.overflow=""},K=()=>{_.value=(_.value+1)%d.value.length},Q=()=>{_.value=(_.value-1+d.value.length)%d.value.length},ne=b=>{if(m.value)switch(b.key){case"Escape":le();break;case"ArrowRight":K();break;case"ArrowLeft":Q();break}};ye(()=>{const b=o.includes("Admin")||o.includes("coordinator");t.inspector_id=(a==null?void 0:a.id)||null}),ye(()=>{p.value&&(t.is_scheduled=!0)}),ce(()=>t.car_id,b=>{b?c.value=e.CarDetail.find(f=>f.id===b)||null:(c.value=null,d.value=[])}),je(()=>{window.addEventListener("keydown",ne)}),qe(()=>{window.removeEventListener("keydown",ne)});const ve=()=>{t.plate_number,t.car_id,t.car_name,t.category_id,t.is_scheduled,t.inspector_id,t.is_scheduled&&`${t.scheduled_at_date}${t.scheduled_at_time}`,t.post(route("inspections.store"),{preserveScroll:!0,onSuccess:()=>{},onError:()=>{}})};return(b,f)=>(y(),xe(at,{title:"Buat Inspeksi Baru"},{default:et(()=>{var W;return[Se(I(tt),{title:"Inspek Baru"}),i("div",Us,[i("div",Os,[f[22]||(f[22]=i("div",{class:"mb-4"},[i("h3",{class:"text-xl md:text-3xl font-bold text-gray-900 mb-6 text-center"},"Buat Inspeksi Baru"),i("p",{class:"text-gray-600"},"Isi detail kendaraan dan jadwal untuk memulai inspeksi.")],-1)),I(t).errors.form_error?(y(),A("div",zs,S(I(t).errors.form_error),1)):P("",!0),Se(ht,{"plate-number":I(t).plate_number,"onUpdate:plateNumber":f[0]||(f[0]=$=>I(t).plate_number=$),inspections:e.inspection,"car-detail":e.CarDetail,onPlateValidityUpdate:j,onCarDataUpdate:F},null,8,["plate-number","inspections","car-detail"]),i("div",Gs,[i("button",{onClick:D,class:"text-sm text-indigo-600 hover:text-indigo-800 underline"},S(B.value==="search"?"Ganti ke Pilihan Dropdown":"Ganti ke Pencarian Teks"),1)]),B.value==="search"?(y(),xe(hs,{key:1,"car-id":I(t).car_id,"onUpdate:carId":f[1]||(f[1]=$=>I(t).car_id=$),"car-name":I(t).car_name,"onUpdate:carName":f[2]||(f[2]=$=>I(t).car_name=$),"car-detail":e.CarDetail,onCarSelected:v,onCarImagesLoaded:ae},null,8,["car-id","car-name","car-detail"])):(y(),xe(Vs,{key:2,"car-detail":e.CarDetail,onCarSelected:v,onCarImagesLoaded:ae},null,8,["car-detail"])),i("div",Ws,[f[10]||(f[10]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2",for:"category"}," Kategori Inspeksi ",-1)),N(i("select",{id:"category","onUpdate:modelValue":f[3]||(f[3]=$=>I(t).category_id=$),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:""},[f[9]||(f[9]=i("option",{value:"",disabled:""},"Pilih Kategori",-1)),(y(!0),A(V,null,O(s.Category,$=>(y(),A("option",{key:$.id,value:$.id},S($.name),9,Hs))),128))],512),[[Z,I(t).category_id]])]),i("div",Js,[f[12]||(f[12]=i("label",{for:"schedule-toggle",class:"text-sm font-medium text-gray-700"},"Jadwalkan Inspeksi?",-1)),i("label",Ys,[N(i("input",{type:"checkbox","onUpdate:modelValue":f[4]||(f[4]=$=>I(t).is_scheduled=$),id:"schedule-toggle",class:"sr-only peer",disabled:p.value||T.value},null,8,Qs),[[st,I(t).is_scheduled]]),f[11]||(f[11]=i("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-700"},null,-1))])]),I(t).is_scheduled?(y(),A("div",Zs,[i("div",null,[f[13]||(f[13]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2",for:"schedule-date"}," Tanggal ",-1)),N(i("input",{type:"date",id:"schedule-date","onUpdate:modelValue":f[5]||(f[5]=$=>I(t).scheduled_at_date=$),min:g.value,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:""},null,8,Xs),[[de,I(t).scheduled_at_date]])]),i("div",null,[f[14]||(f[14]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2",for:"schedule-time"}," Waktu ",-1)),N(i("input",{type:"time",id:"schedule-time","onUpdate:modelValue":f[6]||(f[6]=$=>I(t).scheduled_at_time=$),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:""},null,512),[[de,I(t).scheduled_at_time]])]),I(o).includes("Admin")||I(o).includes("coordinator")||I(o).includes("admin_plann")?(y(),A("div",qs,[f[16]||(f[16]=i("label",{class:"block text-sm font-medium text-gray-700 mb-2",for:"inspector"}," Pilih Inspektor ",-1)),N(i("select",{id:"inspector","onUpdate:modelValue":f[7]||(f[7]=$=>I(t).inspector_id=$),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",required:""},[f[15]||(f[15]=i("option",{value:"",disabled:""},"Pilih Inspektor",-1)),(y(!0),A(V,null,O(w.value,$=>(y(),A("option",{key:$.id,value:$.user.id},S($.user.name),9,ea))),128))],512),[[Z,I(t).inspector_id]])])):P("",!0)])):P("",!0),i("div",ta,[i("button",{onClick:ve,disabled:!x.value||I(t).processing||l.value,class:$e({"px-6 py-2 rounded-md text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed":!0,"bg-gradient-to-r from-indigo-700 to-sky-600 border border-transparent text-white hover:bg-blue-700":!I(t).is_scheduled,"bg-gradient-to-r from-green-700 to-indigo-600 border-transparent text-white hover:bg-green-700":I(t).is_scheduled})},S(E.value),11,sa)]),I(t).car_id&&c.value?(y(),A("div",aa,[c.value.description?(y(),A("div",na,[f[17]||(f[17]=i("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Deskripsi:",-1)),i("div",{class:"prose prose-sm max-w-none text-gray-600",innerHTML:c.value.description},null,8,ra)])):P("",!0),d.value.length>0?(y(),A("div",oa,[f[18]||(f[18]=i("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"Gambar Mobil:",-1)),i("div",ia,[(y(!0),A(V,null,O(d.value,($,ee)=>(y(),A("div",{key:$.id||ee,class:"relative group cursor-pointer",onClick:te=>J(ee)},[i("img",{src:q($),alt:$.name||"Car Image",class:"w-full h-24 object-cover rounded-lg border border-gray-200 transition-transform duration-200 group-hover:scale-105"},null,8,ua),$.note?(y(),A("div",ca,[i("p",da,S($.note),1)])):P("",!0)],8,la))),128))])])):(y(),A("div",ga," Tidak ada gambar tersedia untuk mobil ini "))])):P("",!0),m.value?(y(),A("div",{key:5,class:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:le},[i("div",ha,[i("button",{onClick:le,class:"absolute top-4 right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-colors"},f[19]||(f[19]=[i("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),d.value.length>1?(y(),A("button",{key:0,onClick:Ae(Q,["stop"]),class:"absolute left-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},f[20]||(f[20]=[i("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]))):P("",!0),d.value.length>1?(y(),A("button",{key:1,onClick:Ae(K,["stop"]),class:"absolute right-4 z-10 text-white bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-colors"},f[21]||(f[21]=[i("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))):P("",!0),i("img",{src:q(d.value[_.value]),alt:"Car Image "+(_.value+1),class:"max-w-full max-h-full object-contain",onClick:f[8]||(f[8]=Ae(()=>{},["stop"]))},null,8,pa),d.value.length>1?(y(),A("div",fa,S(_.value+1)+" / "+S(d.value.length),1)):P("",!0),(W=d.value[_.value])!=null&&W.note?(y(),A("div",ma,S(d.value[_.value].note),1)):P("",!0)])])):P("",!0)])])]}),_:1}))}},_a=rt(va,[["__scopeId","data-v-360e3cf5"]]);export{_a as default};
