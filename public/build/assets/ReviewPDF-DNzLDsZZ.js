import{r as $,q as M,O as xt,c as a,o,b as x,d as t,t as u,y as dt,z as H,f as F,A as st,I as lt,F as E,a as at,G as ht,j as kt,m as V,n as Q,p as _t,g as wt,k as It,N as Ct}from"./vendor-g77w9U1W.js";import{_ as $t}from"./app-BGMV3ZMb.js";const jt={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},Dt={class:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4"},Et={class:"flex items-center justify-between p-4 border-b"},Mt={class:"text-lg font-bold"},Bt={class:"p-4"},St={class:"space-y-4"},Tt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ft={class:"relative"},Nt={class:"flex justify-end space-x-3 mt-6 pt-4 border-t"},Pt=["disabled"],Rt=["disabled"],At={key:0},Ut={key:1},Vt={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},zt={class:"bg-white rounded-lg shadow-xl w-96 mx-4"},Ot={class:"p-6"},qt={class:"text-gray-700 mb-6"},Lt={class:"flex justify-end space-x-3"},Ht=["disabled"],Kt={key:0},Gt={key:1},Jt={__name:"RepairEstimationModal",props:{showModal:Boolean,estimationData:Object,inspectionId:[String,Number],encryptedIds:String},emits:["close","saved","deleted"],setup(h,{emit:w}){const v=h,k=w,b=$(!1),I=$(!1),j=M(()=>{var g;return!!((g=v.estimationData)!=null&&g.id)}),i=xt({part_name:"",repair_description:"",urgency:"segera",status:"perlu",estimated_cost:0,notes:""}),z=M({get:()=>i.estimated_cost?new Intl.NumberFormat("id-ID").format(i.estimated_cost):"",set:g=>{const r=g.replace(/[^\d]/g,"");i.estimated_cost=r?parseInt(r,10):0}}),K=()=>{i.part_name="",i.repair_description="",i.urgency="segera",i.status="perlu",i.estimated_cost=0,i.notes=""},R=g=>{const y=g.target.value.replace(/[^\d]/g,"");y?(i.estimated_cost=parseInt(y,10),g.target.value=new Intl.NumberFormat("id-ID").format(i.estimated_cost)):(i.estimated_cost=0,g.target.value="")},N=g=>{i.estimated_cost>0&&(g.target.value=new Intl.NumberFormat("id-ID").format(i.estimated_cost))};v.estimationData&&v.showModal&&Object.assign(i,v.estimationData);const P=async()=>{let g=null;j.value?k("saved",{...i,id:v.estimationData.id}):(g="temp-"+Date.now(),k("saved",{...i,id:g}));try{b.value=!0;const r=j.value?route("repair-estimations.update",{inspection:v.inspectionId,repair_estimation:v.estimationData.id}):route("repair-estimations.store",v.inspectionId),y=j.value?"put":"post",d=await at[y](r,i);k("saved",d.data),D()}catch(r){g&&k("error",g),console.error("Error saving estimation:",r),alert("Gagal menyimpan estimasi. Silakan coba lagi.")}finally{b.value=!1}},O=()=>{I.value=!0},n=async()=>{try{b.value=!0,await at.delete(route("repair-estimations.destroy",{inspection:v.inspectionId,repair_estimation:v.estimationData.id})),k("deleted",v.estimationData.id),I.value=!1,D()}catch(g){console.error("Error deleting estimation:",g),alert("Gagal menghapus estimasi. Silakan coba lagi.")}finally{b.value=!1}},D=()=>{K(),k("close")};return(g,r)=>(o(),a(E,null,[h.showModal?(o(),a("div",jt,[t("div",Dt,[t("div",Et,[t("h3",Mt,u(j.value?"Edit Estimasi Perbaikan":"Tambah Estimasi Perbaikan"),1),t("button",{onClick:D,class:"text-gray-400 hover:text-gray-600"},r[7]||(r[7]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",Bt,[t("form",{onSubmit:dt(P,["prevent"])},[t("div",St,[t("div",null,[r[8]||(r[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[F(" Nama Part/Komponen "),t("span",{class:"text-red-500"},"*")],-1)),H(t("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=y=>i.part_name=y),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Contoh: Radiator, Rem Depan, dll"},null,512),[[st,i.part_name]])]),t("div",null,[r[9]||(r[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[F(" Deskripsi Perbaikan "),t("span",{class:"text-red-500"},"*")],-1)),H(t("textarea",{"onUpdate:modelValue":r[1]||(r[1]=y=>i.repair_description=y),required:"",rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Jelaskan jenis perbaikan yang diperlukan"},null,512),[[st,i.repair_description]])]),t("div",Tt,[t("div",null,[r[11]||(r[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[F(" Urgensi "),t("span",{class:"text-red-500"},"*")],-1)),H(t("select",{"onUpdate:modelValue":r[2]||(r[2]=y=>i.urgency=y),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},r[10]||(r[10]=[t("option",{value:"segera"},"Segera",-1),t("option",{value:"jangka_panjang"},"Jangka Panjang",-1)]),512),[[lt,i.urgency]])]),t("div",null,[r[13]||(r[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[F(" Status "),t("span",{class:"text-red-500"},"*")],-1)),H(t("select",{"onUpdate:modelValue":r[3]||(r[3]=y=>i.status=y),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},r[12]||(r[12]=[t("option",{value:"perlu"},"Perlu",-1),t("option",{value:"disarankan"},"Disarankan",-1),t("option",{value:"opsional"},"Opsional",-1)]),512),[[lt,i.status]])])]),t("div",null,[r[15]||(r[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[F(" Estimasi Biaya (Rp) "),t("span",{class:"text-red-500"},"*")],-1)),t("div",Ft,[r[14]||(r[14]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("span",{class:"text-gray-500"},"Rp")],-1)),H(t("input",{type:"text","onUpdate:modelValue":r[4]||(r[4]=y=>z.value=y),onInput:R,onBlur:N,required:"",class:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0"},null,544),[[st,z.value]])]),r[16]||(r[16]=t("p",{class:"text-xs text-gray-500 mt-1"}," Masukkan angka tanpa titik atau koma ",-1))]),t("div",null,[r[17]||(r[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Catatan Tambahan ",-1)),H(t("textarea",{"onUpdate:modelValue":r[5]||(r[5]=y=>i.notes=y),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Catatan khusus atau informasi tambahan"},null,512),[[st,i.notes]])])]),t("div",Nt,[t("button",{type:"button",onClick:D,class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500"}," Batal "),j.value?(o(),a("button",{key:0,type:"button",onClick:O,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",disabled:b.value}," Hapus ",8,Pt)):x("",!0),t("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b.value},[b.value?(o(),a("span",At,r[18]||(r[18]=[t("svg",{class:"animate-spin h-5 w-5 inline-block",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),F(" Menyimpan... ")]))):(o(),a("span",Ut,u(j.value?"Update":"Simpan"),1))],8,Rt)])],32)])])])):x("",!0),I.value?(o(),a("div",Vt,[t("div",zt,[t("div",Ot,[r[21]||(r[21]=t("h3",{class:"text-lg font-bold mb-4"},"Konfirmasi Hapus",-1)),t("p",qt,[r[19]||(r[19]=F(' Apakah Anda yakin ingin menghapus estimasi perbaikan untuk "')),t("strong",null,u(i.part_name),1),r[20]||(r[20]=F('"? '))]),t("div",Lt,[t("button",{onClick:r[6]||(r[6]=y=>I.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Batal "),t("button",{onClick:n,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",disabled:b.value},[b.value?(o(),a("span",Kt,"Menghapus...")):(o(),a("span",Gt,"Ya, Hapus"))],8,Ht)])])])])):x("",!0)],64))}},Wt={class:"mt-8 pt-6 border-t border-gray-300"},Yt={class:"flex justify-between items-center mb-4"},Qt={key:0,class:"overflow-x-auto"},Xt={class:"w-full border-collapse border border-gray-300 rounded-lg overflow-hidden"},Zt={class:"bg-gray-100"},te={key:0,class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},ee={class:"p-3 border border-gray-300"},se={class:"p-3 border border-gray-300 font-medium"},oe={class:"p-3 border border-gray-300"},ae={class:"p-3 border border-gray-300"},re={class:"flex flex-col gap-1"},ne={class:"p-3 border border-gray-300 font-bold text-right"},ie={key:0,class:"p-3 border border-gray-300"},le={class:"flex gap-2"},de=["onClick"],ue=["onClick"],ce={class:"bg-gray-100"},ge=["colspan"],pe={key:1,class:"text-center py-8 border border-dashed border-gray-300 rounded-lg"},me={__name:"RepairEstimationSection",props:{estimations:{type:Array,default:()=>[]},inspectionId:{type:[String,Number],required:!0},encryptedIds:{type:String,required:!0},canEdit:{type:Boolean,default:!1}},emits:["update:estimations","update:totalCost"],setup(h,{emit:w}){const v=h,k=w,b=$(!1),I=$(null),j=M(()=>v.estimations.reduce((d,l)=>d+parseFloat(l.estimated_cost||0),0));ht(j,d=>{k("update:totalCost",d)});const i=d=>d?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(d):"Rp 0",z=d=>d==="segera"?"Segera":"Jangka Panjang",K=d=>({perlu:"Perlu",disarankan:"Disarankan",opsional:"Opsional"})[d]||d,R=d=>`inline-block px-2 py-1 rounded-full text-xs font-medium ${{segera:"bg-red-100 text-red-800",jangka_panjang:"bg-yellow-100 text-yellow-800"}[d]||"bg-gray-100 text-gray-800"}`,N=d=>`inline-block px-2 py-1 rounded-full text-xs font-medium ${{perlu:"bg-red-100 text-red-800",disarankan:"bg-yellow-100 text-yellow-800",opsional:"bg-blue-100 text-blue-800"}[d]||"bg-gray-100 text-gray-800"}`,P=()=>{I.value=null,b.value=!0},O=d=>{I.value=d,b.value=!0},n=d=>{I.value=d,b.value=!0},D=()=>{b.value=!1,I.value=null},g=d=>{const l=v.estimations.findIndex(f=>f.id===d.id);if(l!==-1){const f=[...v.estimations];f[l]=d,k("update:estimations",f)}else k("update:estimations",[...v.estimations,d]);D()},r=d=>{const l=v.estimations.filter(f=>f.id!==d);k("update:estimations",l),D()},y=d=>{const l=v.estimations.filter(f=>f.id!==d);k("update:estimations",l)};return(d,l)=>(o(),a("div",Wt,[t("div",Yt,[l[1]||(l[1]=t("h2",{class:"text-2xl font-bold text-gray-800"},"Estimasi Perbaikan",-1)),h.canEdit?(o(),a("button",{key:0,onClick:P,class:"bg-green-600 text-white px-4 py-2 rounded-lg shadow hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors duration-200 flex items-center gap-2"},l[0]||(l[0]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),F(" Tambah Estimasi ")]))):x("",!0)]),h.estimations.length>0?(o(),a("div",Qt,[t("table",Xt,[t("thead",Zt,[t("tr",null,[l[2]||(l[2]=t("th",{class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},"No",-1)),l[3]||(l[3]=t("th",{class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},"Part/Komponen",-1)),l[4]||(l[4]=t("th",{class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},"Deskripsi Perbaikan",-1)),l[5]||(l[5]=t("th",{class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},"Urgensi & Status",-1)),l[6]||(l[6]=t("th",{class:"p-3 border border-gray-300 text-left font-bold text-gray-700"},"Estimasi Biaya",-1)),h.canEdit?(o(),a("th",te,"Aksi")):x("",!0)])]),t("tbody",null,[(o(!0),a(E,null,V(h.estimations,(f,X)=>(o(),a("tr",{key:f.id,class:Q(X%2===0?"bg-white":"bg-gray-50")},[t("td",ee,u(X+1),1),t("td",se,u(f.part_name),1),t("td",oe,u(f.repair_description),1),t("td",ae,[t("div",re,[t("span",{class:Q(R(f.urgency))},u(z(f.urgency)),3),t("span",{class:Q(N(f.status))},u(K(f.status)),3)])]),t("td",ne,u(i(f.estimated_cost)),1),h.canEdit?(o(),a("td",ie,[t("div",le,[t("button",{onClick:G=>O(f),class:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm"}," Edit ",8,de),t("button",{onClick:G=>n(f),class:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm"}," Hapus ",8,ue)])])):x("",!0)],2))),128))]),t("tfoot",ce,[t("tr",null,[l[7]||(l[7]=t("td",{colspan:"4",class:"p-3 border border-gray-300 text-right font-bold"}," Total Estimasi: ",-1)),t("td",{colspan:h.canEdit?2:1,class:"p-3 border border-gray-300 font-bold text-right text-green-700"},u(i(j.value)),9,ge)])])])])):(o(),a("div",pe,[l[8]||(l[8]=t("svg",{class:"w-12 h-12 text-gray-400 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),l[9]||(l[9]=t("p",{class:"text-gray-500"},"Belum ada estimasi perbaikan.",-1)),h.canEdit?(o(),a("button",{key:0,onClick:P,class:"mt-3 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700"}," Tambah Estimasi Pertama ")):x("",!0)])),b.value?(o(),kt(Jt,{key:2,"show-modal":b.value,"estimation-data":I.value,"inspection-id":h.inspectionId,"encrypted-ids":h.encryptedIds,onClose:D,onSaved:g,onDeleted:r,onError:y},null,8,["show-modal","estimation-data","inspection-id","encrypted-ids"])):x("",!0)]))}},be={class:"p-6 bg-white rounded-lg shadow-md"},ye={key:0},fe={class:"header flex flex-col gap-5 mb-6 mt-6"},ve={class:"flex items-center gap-5"},xe=["src"],he={key:1,class:"w-40 h-40 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-gray-400"},ke={class:"mt-8"},_e={class:"text-3xl font-bold m-0 text-gray-800"},we={key:0,class:"car-info"},Ie={class:"w-full border-collapse border border-gray-300 rounded-lg overflow-hidden"},Ce={class:"bg-gray-50"},$e={class:"p-2 border border-gray-300 text-gray-600"},je={class:"bg-gray-50"},De={class:"p-2 border border-gray-300 text-gray-600"},Ee={class:"p-2 border border-gray-300 text-gray-600"},Me={class:"bg-gray-50"},Be={class:"p-2 border border-gray-300 text-gray-600"},Se={class:"p-2 border border-gray-300 text-gray-600"},Te={class:"bg-gray-50"},Fe={class:"p-2 border border-gray-300 text-gray-600"},Ne={class:"p-2 border border-gray-300 text-gray-600"},Pe={class:"bg-gray-50"},Re={class:"p-2 border border-gray-300 text-gray-600"},Ae={class:"p-2 border border-gray-300 text-gray-600"},Ue={class:"bg-gray-50"},Ve={class:"p-2 border border-gray-300 text-gray-600"},ze={class:"bg-gray-50"},Oe={class:"p-2 border border-gray-300 text-gray-600"},qe={class:"bg-gray-50"},Le={class:"p-2 border border-gray-300 text-gray-600"},He={class:"bg-gray-50"},Ke={class:"p-2 border border-gray-300 text-gray-600"},Ge={class:"bg-gray-50"},Je={class:"p-2 border border-gray-300 text-gray-600"},We={key:1,style:{width:"100%",margin:"15px 0","border-collapse":"collapse"}},Ye={style:{width:"50%",padding:"6px","vertical-align":"top"}},Qe={style:{"text-align":"center"}},Xe={key:0,src:"/images/icons/banjir.png",alt:"Banjir",style:{width:"80px",height:"80px",display:"block",margin:"0 auto"}},Ze={key:1,src:"/images/icons/aman.png",alt:"Aman",style:{width:"80px",height:"80px",display:"block",margin:"0 auto"}},ts={key:2,style:{"font-weight":"bold","font-size":"15px",color:"#dc3545","margin-top":"8px","margin-bottom":"0"}},es={key:3,style:{"font-weight":"bold","font-size":"15px",color:"#28a745","margin-top":"8px","margin-bottom":"0"}},ss={style:{width:"50%",padding:"6px","vertical-align":"top"}},os={style:{"text-align":"center"}},as=["src"],rs={key:2,class:"conclusion p-4 bg-gray-50 border-l-4 border-gray-800 rounded-lg"},ns={class:"m-0 text-gray-600"},is=["innerHTML"],ls={class:"component-title bg-gray-100 px-3 py-2 border-l-4 border-gray-800 font-bold rounded-l-lg"},ds={key:0,class:"images flex flex-wrap gap-2 mt-4"},us=["src","onClick"],cs={key:1,class:"w-28 h-28 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-xs text-gray-400"},gs={class:"point-name inline-block min-w-[160px] font-bold align-top text-gray-700"},ps={class:"point-content inline-block w-[calc(100%-70px)] align-top"},ms={key:0,class:"status-badges-container"},bs={key:1,class:"point-note italic text-gray-600 my-1"},ys={key:0,class:"inspection-images flex flex-wrap gap-2 mt-4"},fs=["src","onClick"],vs={key:1,class:"w-20 h-20 border border-gray-300 rounded-lg flex items-center justify-center bg-gray-100 text-xs text-gray-400"},xs={key:1,class:"textarea-note italic text-gray-600 my-2"},hs={key:0,class:"mt-2 mb-6"},ks={key:1,class:"flex flex-col items-center justify-center h-96 text-center"},_s=["href"],ws={key:2,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},Is={class:"bg-white p-6 rounded-lg shadow-xl w-96 max-w-sm"},Cs={class:"flex justify-end space-x-4"},$s=["disabled"],js={key:0},Ds={key:1},Es={key:1,class:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors duration-200 cursor-not-allowed"},Ms={class:"relative w-full h-full flex items-center justify-center p-4"},Bs=["src"],Ss={key:1,class:"text-white text-lg"},Ts={__name:"ReviewPDF",props:{inspection:{type:Object,required:!0},menu_points:{type:Array,default:()=>[]},coverImage:{type:Object,default:null},encryptedIds:Object,repairEstimations:{type:Array,default:()=>[]},totalRepairCost:{type:Number,default:0}},setup(h){const w=h,v=_t(),k=$(!1),b=$(!1),I=$(w.repairEstimations),j=$(w.totalRepairCost),i=M(()=>{var s;return((s=v.props.global)==null?void 0:s.has_roles)||[]});M(()=>i.value.includes("quality_control")||i.value.includes("qc"));const z=M(()=>(i.value.includes("quality_control")||i.value.includes("qc"))&&n.value.status==="pending_review"),K=M(()=>(i.value.includes("quality_control")||i.value.includes("qc"))&&n.value.status==="pending_review"),R=$(!1),N=$(""),P=s=>{N.value=s,R.value=!0},O=()=>{R.value=!1,N.value=""},n=$(w.inspection),D=$(w.menu_points),g=$(w.coverImage),r=async()=>{if(n.value.status==="in_progress")try{const s=await at.get(route("inspections.detail",w.encryptedIds));n.value=s.data.inspection,D.value=s.data.menu_points,g.value=s.data.coverImage,I.value=s.data.repairEstimations||[],j.value=s.data.totalRepairCost||0}catch(s){console.error("Polling gagal:",s)}};wt(()=>{setInterval(r,5e3)});const y=s=>{I.value=s},d=s=>{j.value=s},l=M(()=>{if(!D.value)return[];const s=new Map;D.value.forEach(c=>{var C;const p=(C=c.inspection_point)==null?void 0:C.component,m=(p==null?void 0:p.id)||0;s.has(m)||s.set(m,{component:p||{id:0,name:"Tanpa Komponen",order:9999},points:[]}),s.get(m).points.push(c)});const e=Array.from(s.values()).sort((c,p)=>c.component.order===p.component.order?new Date(c.component.created_at)-new Date(p.component.created_at):(c.component.order||9999)-(p.component.order||9999));return e.forEach(c=>{c.points.sort((p,m)=>p.order===m.order?new Date(p.created_at)-new Date(m.created_at):(p.order||9999)-(m.order||9999))}),e}),f=()=>{b.value=!0,setTimeout(()=>{window.location.href=route("inspections.download.pdf",w.encryptedIds),b.value=!1,k.value=!1},2e3)},X=M(()=>{const s=w.menu_points.some(c=>J(c)||W(c)),e=w.coverImage&&w.coverImage.image_path;return s||e}),G=s=>s&&s.length>0,q=s=>`/${s}`,J=s=>{var e;return((e=s.inspection_point)==null?void 0:e.results)&&s.inspection_point.results.length>0},W=s=>{var e;return((e=s.inspection_point)==null?void 0:e.images)&&s.inspection_point.images.length>0},rt=s=>J(s)&&s.inspection_point.results[0].note,Z=s=>{var c,p;if(!J(s))return[];const e=(p=(c=s.inspection_point)==null?void 0:c.results[0])==null?void 0:p.status;return e?Array.isArray(e)?e:typeof e=="string"&&e.includes(",")?e.split(",").map(m=>m.trim()).filter(m=>m.length>0):[e]:[]},ut=s=>{const e=s.input_type||"",c=Z(s);return["radio","imageTOradio"].includes(e)&&c.length>0},ct=s=>{const e=s.input_type||"";return["text","number","date","textarea"].includes(e)&&rt(s)},gt=s=>{var p,m,C;const e=s.input_type||"",c=s.settings||{};if((p=s.inspection_point)!=null&&p.results[0],e==="image"&&W(s)||e==="imageTOradio"&&W(s))return!0;if(e==="radio"){const B=Z(s);for(const A of B)if((((C=(((m=c.radios)==null?void 0:m.find(et=>et.value===A))||{}).settings)==null?void 0:C.show_image_upload)||!1)&&W(s))return!0}return!1},pt=s=>{var p,m,C;const e=s.settings||{};(p=s.inspection_point)!=null&&p.results[0];const c=Z(s);for(const B of c)if((C=(((m=e.radios)==null?void 0:m.find(L=>L.value===B))||{}).settings)!=null&&C.show_textarea)return!0;return!1},mt=s=>{if(!s)return"status-warning";const e=String(s).toLowerCase().trim();return["normal","ada","baik","good","ok"].includes(e)?"status-good":["tidak normal","tidak ada","rusak","bad","not ok"].includes(e)?"status-bad":"status-warning"},bt=s=>{var m;const e=s.input_type||"",c=((m=s.inspection_point)==null?void 0:m.results[0])||{},p=s.settings||{};if(e==="account"&&c.note){const C=c.note.replace(/[^\d.-]/g,""),B=parseFloat(C);if(isNaN(B))return c.note;const A=p.currency_symbol||"Rp";return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:2}).format(B).replace("Rp",A)}return c.note},yt=M(()=>{if(!n.value.settings||n.value.settings.conclusion.collision!=="yes")return"/images/icons/aman.png";const s=n.value.settings.conclusion.collision_severity;return s==="moderate"?"/images/icons/beruntun.png":s==="heavy"?"/images/icons/berat.png":"/images/icons/ringan.png"}),ft=M(()=>{if(!n.value.settings||n.value.settings.conclusion.collision!=="yes")return"Bebas Tabrak";const s=n.value.settings.conclusion.collision_severity;return s==="moderate"?"Tabrak Beruntun":s==="heavy"?"Tabrak Berat":"Tabrak Ringan"}),vt=M(()=>{if(!n.value.settings||n.value.settings.conclusion.collision!=="yes")return"#28a745";const s=n.value.settings.conclusion.collision_severity;return s==="moderate"?"#fd7e14":s==="heavy"?"#dc3545":"#ffc107"});return(s,e)=>{var c,p,m,C,B,A,L,tt,et,nt,it;return o(),a("div",be,[X.value?(o(),a("div",ye,[t("div",fe,[t("div",ve,[g.value&&G(g.value.image_path)?(o(),a("img",{key:0,src:q(g.value.image_path),alt:"Foto Utama",class:"w-40 h-40 object-cover rounded-lg border border-gray-300 cursor-pointer hover:opacity-90 transition-opacity",onClick:e[0]||(e[0]=S=>P(q(g.value.image_path)))},null,8,xe)):(o(),a("div",he,e[4]||(e[4]=[t("span",null,"Gambar tidak tersedia",-1)]))),t("div",ke,[t("h2",_e,u(n.value.car_name),1)])]),n.value.car_id?(o(),a("div",we,[t("table",Ie,[t("tr",Ce,[e[5]||(e[5]=t("td",{class:"p-2 border border-gray-300 font-bold w-1/3 text-gray-700"},"ID Order",-1)),t("td",$e,u(n.value.order_code),1)]),t("tr",je,[e[6]||(e[6]=t("td",{class:"p-2 border border-gray-300 font-bold w-1/3 text-gray-700"},"Nomor Polisi",-1)),t("td",De,u(n.value.plate_number),1)]),t("tr",null,[e[7]||(e[7]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Merek",-1)),t("td",Ee,u((p=(c=n.value.car)==null?void 0:c.brand)==null?void 0:p.name),1)]),t("tr",Me,[e[8]||(e[8]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Model",-1)),t("td",Be,u((C=(m=n.value.car)==null?void 0:m.model)==null?void 0:C.name),1)]),t("tr",null,[e[9]||(e[9]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Tipe",-1)),t("td",Se,u((A=(B=n.value.car)==null?void 0:B.type)==null?void 0:A.name),1)]),t("tr",Te,[e[10]||(e[10]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"CC",-1)),t("td",Fe,u((L=n.value.car)==null?void 0:L.cc),1)]),t("tr",null,[e[11]||(e[11]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Bahan Bakar",-1)),t("td",Ne,u((tt=n.value.car)==null?void 0:tt.fuel_type),1)]),t("tr",Pe,[e[12]||(e[12]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Transmisi",-1)),t("td",Re,u((et=n.value.car)==null?void 0:et.transmission),1)]),t("tr",null,[e[13]||(e[13]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Periode Model",-1)),t("td",Ae,u(((nt=n.value.car)==null?void 0:nt.production_period)||"-"),1)]),t("tr",Ue,[e[14]||(e[14]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Tahun Pembuatan",-1)),t("td",Ve,u((it=n.value.car)==null?void 0:it.year),1)]),t("tr",ze,[e[15]||(e[15]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"Warna",-1)),t("td",Oe,u(n.value.color),1)]),t("tr",qe,[e[16]||(e[16]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"No Rangka",-1)),t("td",Le,u(n.value.noka),1)]),t("tr",He,[e[17]||(e[17]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"No Mesin",-1)),t("td",Ke,u(n.value.nosin),1)]),t("tr",Ge,[e[18]||(e[18]=t("td",{class:"p-2 border border-gray-300 font-bold text-gray-700"},"KM",-1)),t("td",Je,u(n.value.km),1)])])])):x("",!0),n.value.settings?(o(),a("table",We,[t("tr",null,[t("td",Ye,[t("div",Qe,[n.value.settings.conclusion.flooded==="yes"?(o(),a("img",Xe)):(o(),a("img",Ze)),n.value.settings.conclusion.flooded==="yes"?(o(),a("p",ts," Bekas Banjir ")):(o(),a("p",es," Bebas Banjir "))])]),t("td",ss,[t("div",os,[n.value.settings.conclusion.collision==="yes"?(o(),a(E,{key:0},[t("img",{src:yt.value,alt:"Tabrak",style:{width:"80px",height:"80px",display:"block",margin:"0 auto"}},null,8,as),t("p",{style:Ct({fontWeight:"bold",fontSize:"15px",color:vt.value,marginTop:"8px",marginBottom:"0"})},u(ft.value),5)],64)):(o(),a(E,{key:1},[e[19]||(e[19]=t("img",{src:"/images/icons/aman.png",alt:"Aman",style:{width:"80px",height:"80px",display:"block",margin:"0 auto"}},null,-1)),e[20]||(e[20]=t("p",{style:{"font-weight":"bold","font-size":"15px",color:"#28a745","margin-top":"8px","margin-bottom":"0"}}," Bebas Tabrak ",-1))],64))])])])])):x("",!0),n.value.notes?(o(),a("div",rs,[e[21]||(e[21]=t("h3",{class:"text-lg font-bold mb-2 text-gray-800"},"Kesimpulan Inspeksi:",-1)),t("p",ns,[t("div",{innerHTML:n.value.notes||"-"},null,8,is)])])):x("",!0)]),e[25]||(e[25]=t("h2",{class:"text-2xl font-bold border-b-2 border-gray-800 pb-2 mb-6"},"Hasil Inspeksi",-1)),(o(!0),a(E,null,V(l.value,S=>(o(),a("div",{key:S.component.id,class:Q(["section mb-6",S.component.name==="Foto Kendaraan"?"photo-component":""])},[t("div",ls,u(S.component.name||"Tanpa Komponen"),1),S.component.name==="Foto Kendaraan"?(o(),a("div",ds,[(o(!0),a(E,null,V(S.points,_=>{var Y;return o(),a("div",{key:_.id},[(o(!0),a(E,null,V((Y=_.inspection_point)==null?void 0:Y.images,(U,ot)=>(o(),a("div",{key:U.id,class:"image-container"},[G(U.image_path)?(o(),a("img",{key:0,src:q(U.image_path),alt:"Foto Kendaraan",class:"w-28 h-28 object-cover border border-gray-300 rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:T=>P(q(U.image_path))},null,8,us)):(o(),a("div",cs,e[22]||(e[22]=[t("span",null,"Gambar tidak ditemukan",-1)])))]))),128))])}),128))])):(o(!0),a(E,{key:1},V(S.points,_=>{var Y,U,ot;return o(),a("div",{key:_.id,class:"point ml-4 py-3 border-b border-gray-100"},[J(_)||W(_)?(o(),a(E,{key:0},[t("span",gs,u(((Y=_.inspection_point)==null?void 0:Y.name)||"-"),1),t("div",ps,[J(_)?(o(),a(E,{key:0},[ut(_)?(o(),a("div",ms,[(o(!0),a(E,null,V(Z(_),T=>(o(),a("span",{key:T,class:Q(["status-badge",mt(T)])},u(T.trim()),3))),128))])):x("",!0),ct(_)?(o(),a("div",bs,u(bt(_)),1)):x("",!0)],64)):x("",!0)]),gt(_)?(o(),a("div",ys,[(o(!0),a(E,null,V((U=_.inspection_point)==null?void 0:U.images,(T,Fs)=>(o(),a("div",{key:T.id,class:"image-container"},[G(T.image_path)?(o(),a("img",{key:0,src:q(T.image_path),alt:"image",class:"w-20 h-20 object-cover border border-gray-300 rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:Ns=>P(q(T.image_path))},null,8,fs)):(o(),a("div",vs,e[23]||(e[23]=[t("span",null,"Gambar tidak ditemukan",-1)])))]))),128))])):x("",!0),pt(_)&&rt(_)?(o(),a("div",xs,u((ot=_.inspection_point)==null?void 0:ot.results[0].note),1)):x("",!0)],64)):x("",!0)])}),128))],2))),128)),It(me,{estimations:I.value,"inspection-id":n.value.id,"encrypted-ids":h.encryptedIds,"can-edit":z.value,"onUpdate:estimations":y,"onUpdate:totalCost":d},null,8,["estimations","inspection-id","encrypted-ids","can-edit"]),K.value?(o(),a("div",hs,[t("button",{onClick:e[1]||(e[1]=S=>k.value=!0),class:"bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200"}," Setujui Laporan "),e[24]||(e[24]=t("p",{class:"text-sm text-gray-500 mt-2 italic"}," Catatan: Halaman ini hanya simulasi dan mungkin berbeda dengan tampilan file PDF. Silakan periksa lebih detail untuk memastikan tidak ada kesalahan. Jika sudah yakin, silakan setujui untuk proses selanjutnya. ",-1))])):x("",!0)])):(o(),a("div",ks,[e[26]||(e[26]=t("p",{class:"text-lg font-semibold text-gray-700"}," Data sudah tidak ada, karena sudah dijadikan PDF. ",-1)),t("a",{href:s.route("inspections.download.approved.pdf",h.encryptedIds),class:"mt-4 inline-block bg-blue-600 text-white px-6 py-3 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"}," Download PDF ",8,_s)])),k.value?(o(),a("div",ws,[t("div",Is,[e[28]||(e[28]=t("h3",{class:"text-lg font-bold mb-4"},"Konfirmasi Laporan",-1)),e[29]||(e[29]=t("p",{class:"text-gray-700 mb-6"}," Apakah Anda yakin semua data sudah sesuai? Setelah disetujui, laporan akan diproses menjadi file PDF. ",-1)),t("div",Cs,[t("button",{onClick:e[2]||(e[2]=S=>k.value=!1),class:"bg-gray-300 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-400"}," Batal "),n.value.file?(o(),a("button",Es,e[27]||(e[27]=[t("span",null,"Laporan sudah di buat",-1)]))):(o(),a("button",{key:0,onClick:f,class:"bg-sky-600 text-white px-4 py-2 rounded-lg hover:bg-sky-700 transition-colors duration-200",disabled:b.value},[b.value?(o(),a("span",js,"Membuat file PDF...")):(o(),a("span",Ds,"Setujui Laporan"))],8,$s))])])])):x("",!0),R.value?(o(),a("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:O},[t("div",Ms,[t("button",{onClick:O,class:"absolute top-4 right-4 z-10 bg-black bg-opacity-50 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-opacity-70 transition-all"},e[30]||(e[30]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),N.value?(o(),a("img",{key:0,src:N.value,alt:"Full size image",class:"max-w-[90vw] max-h-[90vh] w-auto h-auto object-contain",onClick:e[3]||(e[3]=dt(()=>{},["stop"]))},null,8,Bs)):(o(),a("div",Ss," Gambar tidak dapat dimuat "))])])):x("",!0)])}}},As=$t(Ts,[["__scopeId","data-v-7e556c38"]]);export{As as default};
